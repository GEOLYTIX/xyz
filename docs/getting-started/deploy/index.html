<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="/xyz/public/icons/favicon.ico">
  <title>Deployments</title>
  <style>

    body {
      margin: 0;
      padding: 0;
    }

    .grid {
      font-family: system-ui;
      display:grid;
      grid-template-columns: 200px 5fr;
      max-width: 1100px;
      margin: auto;
      padding: 0 30px;
    }

    #toggle {
        display: none;
    }

    #toggle:hover {
      cursor: pointer;
    }

    #nav {
      grid-column: 1;
      padding-inline-start: 0px;
      list-style-type: none;
      padding-right: 20px;
      margin: 10px 0;
      position: fixed;
    }

    #nav > *:first-child {
      line-height: 1;
      font-size: 30px;
      font-weight: bold;
    }

    #content {
      grid-column: 2;
      padding-left: 20px;
      border-left: 1px solid #ddd;
      margin: 10px 0;
      overflow: hidden;
    }

    #content > *:first-child {
      margin: 0;
    }

    .active {
      font-weight: bold;
    }

    a {
      text-decoration: none;
      white-space: nowrap;
      color: #333;
    }

    h1, h2, h3 {
      margin-bottom: 0.5em;
    }

    p {
      margin-top: 0.5em;
      line-height: 1.5;
    }

    li {
      line-height: 1.5;
    }

    li.__0 {
      padding-left: 0;
    }

    li.__1 {
      padding-left: 0;
    }

    li.__2 {
      padding-left: 0;
    }

    li.__3 {
      padding-left: 20px;
    }

    li.__4 {
      padding-left: 40px;
    }

    pre {
      display: block;
      font-family: monospace;
      white-space: pre;
      margin: 1em 2px;
      padding: 15px;
      box-shadow: 0 0 2px #555;
      overflow-x: auto;
      background-color: #f0f0f0;
    }

    code {
      font-family: monospace;
      background-color: #f0f0f0;
    }

    *:not(pre) > code {
      padding: 5px;
    }

    #content a {
      color: #090;
    }

    #content img {
      max-width: 100%;
      display: block;
      margin: 0 auto;
    }

    @media only screen and (max-width: 700px) {
      .grid {
        grid-template-columns: 0 1fr;
        padding: 0 0 0 40px;
      }

      #toggle {
        display: block;
        position: fixed;
        top: 10px;
        left: 10px;        
        width: 20px;
        height: 30px;
        background: repeating-linear-gradient(#ddd, #fff 10px);
      }

      #nav {
        display: none;
      }

      #content {
        border-left: none;
        padding: 0 20px 0 1px;
        overflow: hidden;
      }
    }

    .show_nav {
      grid-template-columns: 1fr 2fr;
    }

    .show_nav > #nav {
      display: block;
    }

    .show_nav > #content * {
      font-size: 30%;
      padding: 0;
      overflow: hidden;
    }
  </style>

</head>

<body>

  <div class="grid">

    <div id="toggle"></div>

    <ul id="nav">
      
      
      
      <li class="__0 ">
        <a href="/xyz/docs/">XYZ</a>
      </li>
      
      
      
      <li class="__1 ">
        <a href="/xyz/docs/getting-started/">Getting started</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <li class="__1 ">
        <a href="/xyz/docs/getting-started/access/">Access</a>
      </li>
      
      
      
      <li class="__2 active">
        <a href="/xyz/docs/getting-started/deploy/">Deployments</a>
      </li>
      
      
      
      <li class="__2 ">
        <a href="/xyz/docs/getting-started/environment-settings/">Environment Settings</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      

    </ul>

    <div id="content">
      <h2>Deploying serverless functions to Vercel</h2>
<p>The XYZ host was designed to be deployed as Serverless Functions. By keeping memory uptake and the total number of functions to a minimum it is possible to deploy XYZ for free on Vercel's Hobby plan.</p>
<p>A command line interface must be installed in order to deploy to the Now platform.</p>
<pre><code>npm i -g vercel
</code></pre>
<p>With the CLI installed and logged in to a valid Vercel account it is possible to deploy a zero config XYZ host by typing <code>vercel</code> in the project root. For successive deployments it is necessary to set a production flag in order to bring the latest deployment to production.</p>
<pre><code>vercel --prod
</code></pre>
<p>The project will be deployed and build according to the <a href="https://github.com/GEOLYTIX/xyz/blob/master/now.json">now.json</a> which is located in the project's root.</p>
<pre><code>{
  &quot;version&quot;: 2,
  &quot;regions&quot;: [
    &quot;lhr1&quot;
  ],
  &quot;builds&quot;: [
    {
      &quot;src&quot;: &quot;/public/**&quot;,
      &quot;use&quot;: &quot;@now/static&quot;
    },
    {
      &quot;src&quot;: &quot;/docs/**&quot;,
      &quot;use&quot;: &quot;@now/static&quot;
    },
    {
      &quot;src&quot;: &quot;/api/*.js&quot;,
      &quot;use&quot;: &quot;@now/node&quot;,
      &quot;config&quot;: {
        &quot;includeFiles&quot;: [
          &quot;public/**&quot;
        ]
      }
    }
  ],
  &quot;trailingSlash&quot;: false,
  &quot;headers&quot;: [
    {
      &quot;source&quot;: &quot;/(.*)&quot;,
      &quot;headers&quot;: [
        {
          &quot;key&quot;: &quot;Access-Control-Allow-Origin&quot;,
          &quot;value&quot;: &quot;*&quot;
        },
        {
          &quot;key&quot;: &quot;Access-Control-Allow-Headers&quot;,
          &quot;value&quot;: &quot;Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With&quot;
        },
        {
          &quot;key&quot;: &quot;Content-Security-Policy&quot;,
          &quot;value&quot;: &quot;default-src 'self'; base-uri 'self'; object-src 'self'; worker-src 'self' blob:; frame-src 'self' www.google.com www.gstatic.com; form-action 'self'; style-src 'self' 'unsafe-inline' fonts.googleapis.com cdn.jsdelivr.net; font-src 'self' fonts.gstatic.com cdn.jsdelivr.net; script-src 'self' 'unsafe-inline' www.google.com www.gstatic.com cdn.jsdelivr.net blob:; img-src 'self' api.ordnancesurvey.co.uk *.tile.openstreetmap.org api.mapbox.com res.cloudinary.com *.global.ssl.fastly.net raw.githubusercontent.com cdn.jsdelivr.net gitcdn.xyz data:&quot;
        }
      ]
    }
  ],
  &quot;rewrites&quot;: [
    {
      &quot;source&quot;: &quot;/api/query/:_template?&quot;,
      &quot;destination&quot;: &quot;/api/query.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/provider/:provider?&quot;,
      &quot;destination&quot;: &quot;/api/provider.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/layer/:format?/:z?/:x?/:y?&quot;,
      &quot;destination&quot;: &quot;/api/layer.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/location/:method?&quot;,
      &quot;destination&quot;: &quot;/api/location.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/workspace/:method?/:key?&quot;,
      &quot;destination&quot;: &quot;/api/workspace.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/user/:method?/:key?&quot;,
      &quot;destination&quot;: &quot;/api/user.js&quot;
    },
    {
      &quot;source&quot;: &quot;/api/(.*)&quot;,
      &quot;destination&quot;: &quot;/api/$1.js&quot;
    },
    {
      &quot;source&quot;: &quot;/docs/(.*)&quot;,
      &quot;destination&quot;: &quot;/docs/$1/$2&quot;
    },
    {
      &quot;source&quot;: &quot;/docs&quot;,
      &quot;destination&quot;: &quot;/docs/index.html&quot;
    },
    {
      &quot;source&quot;: &quot;/(public|workspaces|views|css|js|icons)/(.*)&quot;,
      &quot;destination&quot;: &quot;/public/$1/$2&quot;
    },
    {
      &quot;source&quot;: &quot;/view/:_template?/:access?&quot;,
      &quot;destination&quot;: &quot;/api/view.js&quot;
    },
    {
      &quot;source&quot;: &quot;/:access?&quot;,
      &quot;destination&quot;: &quot;/api/view.js&quot;
    },
    {
      &quot;source&quot;: &quot;/&quot;,
      &quot;destination&quot;: &quot;/api/view.js&quot;
    }
  ]
}
</code></pre>
<p>Environment settings for Now deployments may be added as an env block to the now.json.</p>

    </div>

  </div>

</body>

<script>
    const toggle = document.getElementById('toggle');

    toggle.onclick = e => { e.target.parentElement.classList.toggle('show_nav'); };
</script>

</html>