<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="https://geolytix.github.io/xyz/public/icons/favicon.ico">
  <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  <title>Geometry</title>
  <style>

    html, body {
      margin: 0;
      padding: 0;
    }

    .header-anchor {
      font-size: 80%;
    }

    .grid {
      font-family: system-ui;
      display: grid;
      grid-template-columns: min-content minmax(0, 1fr);
      max-width: 1100px;
      margin-right: auto;
      padding-right: 30px;
    }

    iframe {
      border: none;
    }

    #toggle {
        display: none;
    }

    #toggle:hover {
      cursor: pointer;
    }

    #nav {
      grid-column: 1;
      /* transform: rotateY(180deg); */
      padding: 10px 20px 20px 20px;
    }

    #nav > ul {
      /* transform: rotateY(180deg); */
      padding-inline-start: 0px;
      list-style-type: none;
      margin: 0;
    }

    #nav > ul > :first-child > a {
      padding-top: 10px;
      line-height: 1;
      font-size: 30px;
      font-weight: bold;
    }

    #content {
      grid-column: 2;
      padding-top: 6px;
      padding-left: 20px;
      border-left: 1px solid #ddd;
    }

    #content > *:first-child {
      margin: 0;
    }

    .active {
      font-weight: bold;
    }

    a {
      text-decoration: none;
      white-space: nowrap;
      color: #333;
    }

    h1, h2, h3 {
      margin-bottom: 0.5em;
    }

    p {
      margin-top: 0.5em;
      line-height: 1.5;
    }

    li {
      line-height: 1.5;
    }

    li.__0 {
      padding-left: 0;
    }

    li.__1 {
      padding-left: 0;
    }

    li.__2 {
      padding-left: 10px;
    }

    li.__3 {
      padding-left: 20px;
    }

    li.__4 {
      padding-left: 30px;
    }

    pre {
      display: block;
      font-family: monospace;
      white-space: pre;
      margin: 1em 2px;
      padding: 15px;
      box-shadow: 0 0 2px #555;
      overflow-x: auto;
      background-color: #f0f0f0;
    }

    code {
      font-family: monospace;
      background-color: #f0f0f0;
    }

    *:not(pre) > code {
      padding: 5px;
    }

    #content a {
      color: #090;
    }

    #content img {
      max-width: 100%;
      display: block;
      margin: 0 auto;
    }

    @media only screen and (max-width: 700px) {
      .grid {
        grid-template-columns: 0 minmax(0, 1fr);
        padding: 0 0 0 40px;
      }

      #toggle {
        display: block;
        position: fixed;
        top: 10px;
        left: 10px;        
        width: 20px;
        height: 30px;
        background: repeating-linear-gradient(#ddd, #fff 10px);
      }

      #nav {
        display: none;
      }

      #content {
        border-left: none;
        padding: 0 20px 0 1px;
      }
    }

    .show_nav {
      grid-template-columns: min-content minmax(0, 1fr);
    }

    .show_nav > #nav {
      display: block;
    }

    .show_nav > #content * {
      font-size: 30%;
      padding: 0;
      overflow: hidden;
    }
  </style>

</head>

<body>

  <div class="grid">

    <div id="toggle"></div>

    <div id="nav">

      <ul>
      
        
        <li class="__1 ">
          <a href="/xyz/docs/">XYZ</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/getting-started/">Getting started</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/deploy/">Deployments</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/design/">Design</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/design/icons/">Icons</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/develop/">Develop</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/develop/api/">API</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/gazetteer/">Gazetteer</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/layer/">Layer</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/location/">Location</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/provider/">Provider</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/proxy/">Proxy</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/query/">Query</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/user/">User</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/view/">View</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/api/workspace/">Workspace</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/develop/authentication/">Authentication</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/develop/filter/">SQL Filter</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/develop/lib/library/">Library</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/dataviews/">Dataviews</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/layers/">Layers</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/locations/">Locations</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/mapview/">Mapview</a>
        </li>
        
        <li class="__4 ">
          <a href="/xyz/docs/develop/lib/mapview/interactions/">Interactions</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/plugins/">Plugins</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/tabview/">Tabview</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/develop/lib/webpack/">Webpack</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/develop/views/">Application Views</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/document/">Document</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/environment-settings/">Environment Settings</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/logging/">Logging</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/mapp/">Mapp</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/security/">Security</a>
        </li>
        
        <li class="__1 ">
          <a href="/xyz/docs/workspace/workspaces/">Workspace</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/dataviews/">Dataviews</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/dataviews/charts/">Charts</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/dataviews/tables/">Tables</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/layer/">Layer</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/cluster/">Cluster</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/editing/">Layer editing</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/geojson/">GeoJson</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/grid/">Hex Grid</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/mvt/">MVT</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/themes/">Themes</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/layer/tile/">Tile Layer</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/locales/">Locale</a>
        </li>
        
        <li class="__3 ">
          <a href="/xyz/docs/workspace/locales/gazetteer/">Gazetteer</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/locations/infoj/">Location</a>
        </li>
        
        <li class="__3 active">
          <a href="/xyz/docs/workspace/locations/geometry/">Geometry</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/roles/">Roles</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/src/">Source Links</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/styles/">Styles</a>
        </li>
        
        <li class="__2 ">
          <a href="/xyz/docs/workspace/templates/">Templates</a>
        </li>
        
  
      </ul>

    </div>


    <div id="content">
      <h1 id="additional-geometries">Additional geometries <a class="header-anchor" href="#additional-geometries">¶</a></h1>
<p><code>&quot;type&quot;: &quot;geometry&quot;</code></p>
<p>Entry of type &quot;geometry&quot; allows to visualize geometries associated with selected location. This is often used for representation of catchments, isolines, boundaries relevant to selected location.</p>
<p>The basic setup:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>   <br>	<span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Isoline 5min"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"isoline_5min"</span><span class="token punctuation">,</span><br>	<span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_AsGeoJSON(isoline_5min)"</span><br><span class="token punctuation">}</span></code></pre>
<p>This entry uses &quot;geojson&quot; layer type therefore geometry value is passed as GeoJSON object.</p>
<p>In order to display by default set:</p>
<pre class="language-json"><code class="language-json"><span class="token property">"display"</span><span class="token operator">:</span> <span class="token boolean">true</span></code></pre>
<p>This type supports isolines provided by third party APIs, currently (© HERE)[<a href="https://www.here.com/">https://www.here.com/</a>]</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"HERE drivetime 5 min"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"isoline_5min"</span><span class="token punctuation">,</span><br>	<span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_asGeoJson(isoline_5min)"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>		<span class="token property">"isoline_here"</span><span class="token operator">:</span> <span class="token punctuation">{</span>  <br>			<span class="token property">"minutes"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><br>			<span class="token property">"departure"</span><span class="token operator">:</span> <span class="token string">"2019-11-16T18:30:00"</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>  <span class="token comment">// "name" is used as custom checkbox name</span><br>  <span class="token comment">// request returns 5 minute drivetime isochrone from Here API</span><br>  <span class="token comment">// departure is an optional setting to return drivetime for a certain date/time.</span></code></pre>
<p>Supported HERE API request parameters:</p>
<p>mode: 'car', 'pedestrian', 'truck', 'carHOV', defaults to 'car'<br>
rangetype: 'time', 'distance', defaults to 'time'<br>
distance: distance in kilometres when &quot;rangetype&quot;: &quot;distance&quot;</p>
<p>(© Mapbox)[<a href="https://www.mapbox.com/about/maps">https://www.mapbox.com/about/maps</a>]</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Mapbox drivetime 5 min"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"isoline_5min"</span><span class="token punctuation">,</span><br>	<span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_asGeoJson(isoline_5min)"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>		<span class="token property">"isoline_mapbox"</span><span class="token operator">:</span> <span class="token punctuation">{</span>  <br>			<span class="token property">"minutes"</span><span class="token operator">:</span> <span class="token number">5</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br>  <span class="token comment">// request returns 5 minute drivetime isochrone from Mapbox API</span></code></pre>
<ul>
<li>Skip &quot;minutes&quot; parameter to use custom slider.<br>
Use &quot;meta&quot; property for both providers in order to store details of most recent isoline. This value can be displayed as a separate entry of type <code>&quot;json&quot;</code>.</li>
</ul>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Custom HERE Catchment (1)"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"_isoline_custom1"</span><span class="token punctuation">,</span><br>	<span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_asGeoJson(isoline_custom1)"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>    <span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    	<span class="token property">"meta"</span><span class="token operator">:</span> <span class="token string">"isoline_custom1_meta"</span><span class="token punctuation">,</span><br>        <span class="token property">"isoline_here"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>and (TomTom Reachable Range API)[<a href="https://developer.tomtom.com/routing-api/routing-api-documentation-routing/calculate-reachable-range">https://developer.tomtom.com/routing-api/routing-api-documentation-routing/calculate-reachable-range</a>]</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"TomTom Reachable Range"</span><span class="token punctuation">,</span><br>    <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>    <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"isoline_tomtom"</span><span class="token punctuation">,</span><br>    <span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_AsGeoJSON(isoline_tomtom)"</span><span class="token punctuation">,</span><br>    <span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token property">"meta"</span><span class="token operator">:</span> <span class="token string">"isoline_tomtom_meta"</span><span class="token punctuation">,</span><br>        <span class="token property">"isoline_tomtom"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>For TomTom parameters see API Documentation. Default request parameters used here are:</p>
<ul>
<li>timeBudgetInSec, defaults to 10*60 seconds,</li>
<li>routeType, defaults to 'fastest',</li>
<li>travelMode, defaults to 'car'.</li>
</ul>
<p>Please note that third party API isolines are only available for features with geometry type &quot;Point&quot;.<br>
If defined for non-point features control will be skipped.</p>
<p>Geometry can also support &quot;query&quot; parameter which is independent from selected location. It is useful for more complex geometries which may only be requested when needed.</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"All catchments - query"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"collection"</span><span class="token punctuation">,</span><br>	<span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"Shops with all catchments"</span><br><span class="token punctuation">}</span></code></pre>
<p>Query should return GeoJSON object as value for given field.</p>
<p>Geometry takes selection style by default and can also accept geojson style object:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Catchment"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"catchment"</span><span class="token punctuation">,</span><br>	<span class="token property">"fieldfx"</span><span class="token operator">:</span> <span class="token string">"ST_asGeoJson(catchment)"</span><span class="token punctuation">,</span><br>	<span class="token property">"display"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>	    <span class="token property">"strokeColor"</span><span class="token operator">:</span> <span class="token string">"#E6C229"</span><span class="token punctuation">,</span><br>        <span class="token property">"strokeWidth"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><br>        <span class="token property">"fillOpacity"</span><span class="token operator">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span><br>        <span class="token property">"fillColor"</span><span class="token operator">:</span> <span class="token string">"#E6C229"</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Additional geometries has be also displayed as multi geometries with thematic styling.<br>
The following example demonstrates multi geometry returned from a query template along with thematic styling and optional legend:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>	<span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"All catchments - query"</span><span class="token punctuation">,</span><br>	<span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"geometry"</span><span class="token punctuation">,</span><br>	<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"collection"</span><span class="token punctuation">,</span><br>	<span class="token property">"display"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>	<span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"Shops with catchments all catchments"</span><span class="token punctuation">,</span><br>	<span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>	    <span class="token property">"theme"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>	        <span class="token property">"legend"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"categorized"</span><span class="token punctuation">,</span><br>            <span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"catchment"</span><span class="token punctuation">,</span><br>            <span class="token property">"cat"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                <span class="token property">"primary"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                    <span class="token property">"label"</span><span class="token operator">:</span> <span class="token string">"Primary"</span><span class="token punctuation">,</span><br>                    <span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                        <span class="token property">"strokeColor"</span><span class="token operator">:</span> <span class="token string">"#5E08E4"</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillOpacity"</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillColor"</span><span class="token operator">:</span> <span class="token string">"#5E08E4"</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><span class="token punctuation">,</span><br>                <span class="token property">"secondary"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                    <span class="token property">"label"</span><span class="token operator">:</span> <span class="token string">"Secondary"</span><span class="token punctuation">,</span><br>                    <span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                        <span class="token property">"strokeColor"</span><span class="token operator">:</span> <span class="token string">"#D15CF1"</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillOpacity"</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillColor"</span><span class="token operator">:</span> <span class="token string">"#D15CF1"</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><span class="token punctuation">,</span><br>                <span class="token property">"tertiary"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                    <span class="token property">"label"</span><span class="token operator">:</span> <span class="token string">"Tertiary"</span><span class="token punctuation">,</span><br>                    <span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>                        <span class="token property">"strokeColor"</span><span class="token operator">:</span> <span class="token string">"#FFB9F2"</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillOpacity"</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span><br>                        <span class="token property">"fillColor"</span><span class="token operator">:</span> <span class="token string">"#FFB9F2"</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><span class="token comment">// "legend": true - optional legend</span></code></pre>
<p>Query used for multi geometry in the above example:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> jsonb_build_object<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'FeatureCollection'</span><span class="token punctuation">,</span> <span class="token string">'features'</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>features<span class="token punctuation">)</span> <span class="token keyword">AS</span> collection<br><span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> jsonb_build_array<span class="token punctuation">(</span>jsonb_build_object<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'Feature'</span><span class="token punctuation">,</span> <span class="token string">'properties'</span><span class="token punctuation">,</span><br>                                                  jsonb_build_object<span class="token punctuation">(</span><span class="token string">'catchment'</span><span class="token punctuation">,</span> <span class="token string">'primary'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'geometry'</span><span class="token punctuation">,</span><br>                                                  ST_AsGeoJson<span class="token punctuation">(</span>catchment_primary<span class="token punctuation">)</span>::jsonb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>                               jsonb_build_object<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'Feature'</span><span class="token punctuation">,</span> <span class="token string">'properties'</span><span class="token punctuation">,</span><br>                                                  jsonb_build_object<span class="token punctuation">(</span><span class="token string">'catchment'</span><span class="token punctuation">,</span> <span class="token string">'secondary'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'geometry'</span><span class="token punctuation">,</span><br>                                                  ST_AsGeoJson<span class="token punctuation">(</span>catchment_secondary<span class="token punctuation">)</span>::jsonb<span class="token punctuation">)</span><span class="token punctuation">,</span><br>                               jsonb_build_object<span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'Feature'</span><span class="token punctuation">,</span> <span class="token string">'properties'</span><span class="token punctuation">,</span><br>                                                  jsonb_build_object<span class="token punctuation">(</span><span class="token string">'catchment'</span><span class="token punctuation">,</span> <span class="token string">'tertiary'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'geometry'</span><span class="token punctuation">,</span><br>                                                  ST_AsGeoJson<span class="token punctuation">(</span>catchment_tertiary<span class="token punctuation">)</span>::jsonb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> features<br>      <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> dev<span class="token punctuation">.</span>storelist_1507__19 <span class="token keyword">where</span> id <span class="token operator">=</span> ${id}<span class="token punctuation">)</span> a<span class="token punctuation">)</span> b</code></pre>
<h4 id="applied-z-index">Applied z-index <a class="header-anchor" href="#applied-z-index">¶</a></h4>
<ul>
<li>Layer is by default drawn on z-index: 1 unless configured otherwise.</li>
<li>The layer brought to front is drawn on z-index: 1000.</li>
<li>Selected location is drawn on z-index: 1999.</li>
<li>Additional geometries are drawn on z-index: 999, just below most top layer and under feature of selected location.</li>
</ul>
<h2 id="editing-additional-geometries">Editing additional geometries <a class="header-anchor" href="#editing-additional-geometries">¶</a></h2>
<p>Additional geometries can be drawn manually using map interaction modules.</p>
<p>In order to allow manual creation of shapes set any of the following:</p>
<pre class="language-json"><code class="language-json">	<span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>		<span class="token property">"polygon"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>	  <span class="token property">"circle"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>		<span class="token property">"rectangle"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>		<span class="token property">"line"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>		<span class="token property">"freehand"</span><span class="token operator">:</span> <span class="token boolean">true</span><br>	<span class="token punctuation">}</span></code></pre>
<p>Each shape can be manually created and edited when existing.</p>
<p>In order to allow manual editing of isolines returned from third party APIs:</p>
<pre class="language-json"><code class="language-json"><span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>	<span class="token property">"isoline_here"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>		<span class="token property">"geometry"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>		<span class="token property">"minutes"</span><span class="token operator">:</span> <span class="token number">10</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><span class="token comment">// 10-minute Here isoline with enabled manual editing</span><br><br><span class="token property">"edit"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>	<span class="token property">"isoline_mapbox"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>		<span class="token property">"geometry"</span><span class="token operator">:</span> <span class="token boolean">true</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><span class="token comment">// custom Mapbox isoline with enabled manual editing</span></code></pre>

    </div>

  </div>

</body>

<script>
    const toggle = document.getElementById('toggle');

    toggle.onclick = e => { e.target.parentElement.classList.toggle('show_nav'); };
</script>

</html>