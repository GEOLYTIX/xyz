<!DOCTYPE html>
<html lang="en">

<head data-dir="{{dir}}" data-user="{{user}}" data-login="{{login}}">

  <title>GEOLYTIX Skunkworks</title>

  <link rel="icon" type="image/x-icon" href="{{dir}}/icons/favicon.ico" />

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="{{dir}}/css/mapp.css" />
  <link rel="stylesheet" href="{{dir}}/css/ui.css" />

  <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.9.0/build/ol.js" defer></script>

  <script type="module" src="{{dir}}/js/lib/mapp.js" defer></script>
  <script type="module" src="{{dir}}/js/lib/ui.js" defer></script>
    
  <style>
    * {
      margin: 0;
      padding: 0;
      font-family: Arial, Helvetica, sans-serif;
    }

    body {
      display: grid;
      grid-template-columns: 300px 1fr;
    }

    #CTRL {
      grid-column: 1;
      width: 100%;
      height: 100%;
      background: oldlace;
      padding: 1em;
      display: flex;
      flex-direction: column;
    }
    
    #Map {
      position: absolute;
      grid-column: 2;
      width: 100%;
      height: 100%;
    }

    #CTRL > button {
      font-size: 1.5em;
      padding: 0.3em;
      width: 100%;
      margin-bottom: 5px;
    }

  </style>

</head>

<body>

  <div id="CTRL">
    <button id="ToggleData">Toggle Data</button>
  </div>
  <div id="Map" class="tabulator">
  </div>

</body>

<script>

  window.onload = async () => {

    const dataview = await mapp.ui.Dataview({
      "target": "Map",
      "table": {
        "data": [
          { "id": 1010000015, "store_name": "Aldi Kingstanding Birmingham", "town": "Birmingham" },
          { "id": 1010001899, "store_name": "M&S Princess Park SF", "town": "Sutton Coldfield" },
          { "id": 1010011645, "store_name": "Co-op Hawthorn Road Kingstanding", "town": "Birmingham" },
          { "id": 1010000021, "store_name": "Aldi New Oscott Birmingham", "town": "Sutton Coldfield" },
          { "id": 1010006895, "store_name": "Lidl New Oscott Birmingham", "town": "Sutton Coldfield" },
          { "id": 1010006127, "store_name": "Tesco New Oscott Extra", "town": "Sutton Coldfield" }
        ],
        "columns": [
          {
            "field": "id",
            "title": "ID"
          },
          {
            "field": "store_name",
            "title": "Store"
          },
          {
            "field": "town",
            "title": "Town",
            headerSort: false,
          }
        ]
      }
    })
    

    // dataview.Tabulator.on("rowClick", function (e, row) {
    //   alert("Row " + row.getData().id + " Clicked!!!!");
    // });

    // console.log(dataview.Tabulator)

    // const dataview = await mapp.ui.Dataview({
    //   "target": "Map",
    //   "query": "retail_points_list",
    //   "host": "/latest",
    //   "table": {
    //     "columns": [
    //       {
    //         "field": "id",
    //         "title": "ID"
    //       },
    //       {
    //         "field": "store_name",
    //         "title": "Store"
    //       },
    //       {
    //         "field": "town",
    //         "title": "Town"
    //       }
    //     ]
    //   }
    // }).then(dv => dv.update())

    // const dataview = await mapp.ui.Dataview({
    //   "target": "Map",
    //   data: null,
    //   chart: {}
    // })

    // document.getElementById('ToggleData').onclick = e => {

    //   dataview.setData(null)
    // }

  }

</script>

</html>