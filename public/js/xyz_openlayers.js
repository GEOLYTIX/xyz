/*! For license information please see xyz_openlayers.js.LICENSE.txt */
(()=>{var t={7057:(e,t)=>{"use strict";function o(e,t,o){void 0===o&&(o={});var i={type:"Feature"};return(0===o.id||o.id)&&(i.id=o.id),o.bbox&&(i.bbox=o.bbox),i.properties=t||{},i.geometry=e,i}function i(e,t,i){return void 0===i&&(i={}),o({type:"Point",coordinates:e},t,i)}function n(e,t,i){void 0===i&&(i={});for(var n=0,r=e;n<r.length;n++){var a=r[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:e},t,i)}function r(e,t,i){if(void 0===i&&(i={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:e},t,i)}function a(e,t){void 0===t&&(t={});var o={type:"FeatureCollection"};return t.id&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.features=e,o}function s(e,t,i){return void 0===i&&(i={}),o({type:"MultiLineString",coordinates:e},t,i)}function l(e,t,i){return void 0===i&&(i={}),o({type:"MultiPoint",coordinates:e},t,i)}function c(e,t,i){return void 0===i&&(i={}),o({type:"MultiPolygon",coordinates:e},t,i)}function u(e,o){void 0===o&&(o="kilometers");var i=t.factors[o];if(!i)throw new Error(o+" units is invalid");return e*i}function d(e,o){void 0===o&&(o="kilometers");var i=t.factors[o];if(!i)throw new Error(o+" units is invalid");return e/i}function h(e){return 180*(e%(2*Math.PI))/Math.PI}function p(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=o,t.geometry=function(e,t,o){switch(void 0===o&&(o={}),e){case"Point":return i(t).geometry;case"LineString":return r(t).geometry;case"Polygon":return n(t).geometry;case"MultiPoint":return l(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid")}},t.point=i,t.points=function(e,t,o){return void 0===o&&(o={}),a(e.map((function(e){return i(e,t)})),o)},t.polygon=n,t.polygons=function(e,t,o){return void 0===o&&(o={}),a(e.map((function(e){return n(e,t)})),o)},t.lineString=r,t.lineStrings=function(e,t,o){return void 0===o&&(o={}),a(e.map((function(e){return r(e,t)})),o)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=l,t.multiPolygon=c,t.geometryCollection=function(e,t,i){return void 0===i&&(i={}),o({type:"GeometryCollection",geometries:e},t,i)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var o=Math.pow(10,t||0);return Math.round(e*o)/o},t.radiansToLength=u,t.lengthToRadians=d,t.lengthToDegrees=function(e,t){return h(d(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,o){if(void 0===t&&(t="kilometers"),void 0===o&&(o="kilometers"),!(e>=0))throw new Error("length must be a positive number");return u(d(e,t),o)},t.convertArea=function(e,o,i){if(void 0===o&&(o="meters"),void 0===i&&(i="kilometers"),!(e>=0))throw new Error("area must be a positive number");var n=t.areaFactors[o];if(!n)throw new Error("invalid original units");var r=t.areaFactors[i];if(!r)throw new Error("invalid final units");return e/n*r},t.isNumber=p,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!p(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},1848:(e,t,o)=>{"use strict";var i=o(7057);function n(e,t,o,i,n,r,a,s){var l,c,u,d,h={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(l=(s-r)*(o-e)-(a-n)*(i-t))?null!==h.x&&null!==h.y&&h:(d=(o-e)*(c=t-r)-(i-t)*(u=e-n),c=((a-n)*c-(s-r)*u)/l,u=d/l,h.x=e+c*(o-e),h.y=t+c*(i-t),c>=0&&c<=1&&(h.onLine1=!0),u>=0&&u<=1&&(h.onLine2=!0),!(!h.onLine1||!h.onLine2)&&[h.x,h.y])}t.Z=function(e){var t,o,r={type:"FeatureCollection",features:[]};if("LineString"===(o="Feature"===e.type?e.geometry:e).type)t=[o.coordinates];else if("MultiLineString"===o.type)t=o.coordinates;else if("MultiPolygon"===o.type)t=[].concat.apply([],o.coordinates);else{if("Polygon"!==o.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");t=o.coordinates}return t.forEach((function(e){t.forEach((function(t){for(var o=0;o<e.length-1;o++)for(var a=o;a<t.length-1;a++){if(e===t){if(1===Math.abs(o-a))continue;if(0===o&&a===e.length-2&&e[o][0]===e[e.length-1][0]&&e[o][1]===e[e.length-1][1])continue}var s=n(e[o][0],e[o][1],e[o+1][0],e[o+1][1],t[a][0],t[a][1],t[a+1][0],t[a+1][1]);s&&r.features.push(i.point([s[0],s[1]]))}}))})),r}},7757:function(e,t,o){e.exports=function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},o=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var o={};for(var i in t)t.hasOwnProperty(i)&&(o[t[i]]=i);var n=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var r in n)if(n.hasOwnProperty(r)){if(!("channels"in n[r]))throw new Error("missing channels property: "+r);if(!("labels"in n[r]))throw new Error("missing channel labels property: "+r);if(n[r].labels.length!==n[r].channels)throw new Error("channel and label counts mismatch: "+r);var a=n[r].channels,s=n[r].labels;delete n[r].channels,delete n[r].labels,Object.defineProperty(n[r],"channels",{value:a}),Object.defineProperty(n[r],"labels",{value:s})}n.rgb.hsl=function(e){var t,o,i=e[0]/255,n=e[1]/255,r=e[2]/255,a=Math.min(i,n,r),s=Math.max(i,n,r),l=s-a;return s===a?t=0:i===s?t=(n-r)/l:n===s?t=2+(r-i)/l:r===s&&(t=4+(i-n)/l),(t=Math.min(60*t,360))<0&&(t+=360),o=(a+s)/2,[t,100*(s===a?0:o<=.5?l/(s+a):l/(2-s-a)),100*o]},n.rgb.hsv=function(e){var t,o,i,n,r,a=e[0]/255,s=e[1]/255,l=e[2]/255,c=Math.max(a,s,l),u=c-Math.min(a,s,l),d=function(e){return(c-e)/6/u+.5};return 0===u?n=r=0:(r=u/c,t=d(a),o=d(s),i=d(l),a===c?n=i-o:s===c?n=1/3+t-i:l===c&&(n=2/3+o-t),n<0?n+=1:n>1&&(n-=1)),[360*n,100*r,100*c]},n.rgb.hwb=function(e){var t=e[0],o=e[1],i=e[2];return[n.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(o,i))*100,100*(i=1-1/255*Math.max(t,Math.max(o,i)))]},n.rgb.cmyk=function(e){var t,o=e[0]/255,i=e[1]/255,n=e[2]/255;return[100*((1-o-(t=Math.min(1-o,1-i,1-n)))/(1-t)||0),100*((1-i-t)/(1-t)||0),100*((1-n-t)/(1-t)||0),100*t]},n.rgb.keyword=function(e){var i=o[e];if(i)return i;var n,r,a,s=1/0;for(var l in t)if(t.hasOwnProperty(l)){var c=t[l],u=(r=e,a=c,Math.pow(r[0]-a[0],2)+Math.pow(r[1]-a[1],2)+Math.pow(r[2]-a[2],2));u<s&&(s=u,n=l)}return n},n.keyword.rgb=function(e){return t[e]},n.rgb.xyz=function(e){var t=e[0]/255,o=e[1]/255,i=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)+.1805*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*t+.7152*o+.0722*i),100*(.0193*t+.1192*o+.9505*i)]},n.rgb.lab=function(e){var t=n.rgb.xyz(e),o=t[0],i=t[1],r=t[2];return i/=100,r/=108.883,o=(o/=95.047)>.008856?Math.pow(o,1/3):7.787*o+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(o-i),200*(i-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},n.hsl.rgb=function(e){var t,o,i,n,r,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0===s)return[r=255*l,r,r];t=2*l-(o=l<.5?l*(1+s):l+s-l*s),n=[0,0,0];for(var c=0;c<3;c++)(i=a+1/3*-(c-1))<0&&i++,i>1&&i--,r=6*i<1?t+6*(o-t)*i:2*i<1?o:3*i<2?t+(o-t)*(2/3-i)*6:t,n[c]=255*r;return n},n.hsl.hsv=function(e){var t=e[0],o=e[1]/100,i=e[2]/100,n=o,r=Math.max(i,.01);return o*=(i*=2)<=1?i:2-i,n*=r<=1?r:2-r,[t,100*(0===i?2*n/(r+n):2*o/(i+o)),(i+o)/2*100]},n.hsv.rgb=function(e){var t=e[0]/60,o=e[1]/100,i=e[2]/100,n=Math.floor(t)%6,r=t-Math.floor(t),a=255*i*(1-o),s=255*i*(1-o*r),l=255*i*(1-o*(1-r));switch(i*=255,n){case 0:return[i,l,a];case 1:return[s,i,a];case 2:return[a,i,l];case 3:return[a,s,i];case 4:return[l,a,i];case 5:return[i,a,s]}},n.hsv.hsl=function(e){var t,o,i,n=e[0],r=e[1]/100,a=e[2]/100,s=Math.max(a,.01);return i=(2-r)*a,o=r*s,[n,100*(o=(o/=(t=(2-r)*s)<=1?t:2-t)||0),100*(i/=2)]},n.hwb.rgb=function(e){var t,o,i,n,r,a,s,l=e[0]/360,c=e[1]/100,u=e[2]/100,d=c+u;switch(d>1&&(c/=d,u/=d),i=6*l-(t=Math.floor(6*l)),0!=(1&t)&&(i=1-i),n=c+i*((o=1-u)-c),t){default:case 6:case 0:r=o,a=n,s=c;break;case 1:r=n,a=o,s=c;break;case 2:r=c,a=o,s=n;break;case 3:r=c,a=n,s=o;break;case 4:r=n,a=c,s=o;break;case 5:r=o,a=c,s=n}return[255*r,255*a,255*s]},n.cmyk.rgb=function(e){var t=e[0]/100,o=e[1]/100,i=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,o*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n))]},n.xyz.rgb=function(e){var t,o,i,n=e[0]/100,r=e[1]/100,a=e[2]/100;return o=-.9689*n+1.8758*r+.0415*a,i=.0557*n+-.204*r+1.057*a,t=(t=3.2406*n+-1.5372*r+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:12.92*o,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(t=Math.min(Math.max(0,t),1)),255*(o=Math.min(Math.max(0,o),1)),255*(i=Math.min(Math.max(0,i),1))]},n.xyz.lab=function(e){var t=e[0],o=e[1],i=e[2];return o/=100,i/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116)-16,500*(t-o),200*(o-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},n.lab.xyz=function(e){var t,o,i,n=e[0];t=e[1]/500+(o=(n+16)/116),i=o-e[2]/200;var r=Math.pow(o,3),a=Math.pow(t,3),s=Math.pow(i,3);return o=r>.008856?r:(o-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,i=s>.008856?s:(i-16/116)/7.787,[t*=95.047,o*=100,i*=108.883]},n.lab.lch=function(e){var t,o=e[0],i=e[1],n=e[2];return(t=360*Math.atan2(n,i)/2/Math.PI)<0&&(t+=360),[o,Math.sqrt(i*i+n*n),t]},n.lch.lab=function(e){var t,o=e[0],i=e[1];return t=e[2]/360*2*Math.PI,[o,i*Math.cos(t),i*Math.sin(t)]},n.rgb.ansi16=function(e){var t=e[0],o=e[1],i=e[2],r=1 in arguments?arguments[1]:n.rgb.hsv(e)[2];if(0===(r=Math.round(r/50)))return 30;var a=30+(Math.round(i/255)<<2|Math.round(o/255)<<1|Math.round(t/255));return 2===r&&(a+=60),a},n.hsv.ansi16=function(e){return n.rgb.ansi16(n.hsv.rgb(e),e[2])},n.rgb.ansi256=function(e){var t=e[0],o=e[1],i=e[2];return t===o&&o===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(o/255*5)+Math.round(i/255*5)},n.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var o=.5*(1+~~(e>50));return[(1&t)*o*255,(t>>1&1)*o*255,(t>>2&1)*o*255]},n.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var o;return e-=16,[Math.floor(e/36)/5*255,Math.floor((o=e%36)/6)/5*255,o%6/5*255]},n.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},n.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var o=t[0];3===t[0].length&&(o=o.split("").map((function(e){return e+e})).join(""));var i=parseInt(o,16);return[i>>16&255,i>>8&255,255&i]},n.rgb.hcg=function(e){var t,o=e[0]/255,i=e[1]/255,n=e[2]/255,r=Math.max(Math.max(o,i),n),a=Math.min(Math.min(o,i),n),s=r-a;return t=s<=0?0:r===o?(i-n)/s%6:r===i?2+(n-o)/s:4+(o-i)/s+4,t/=6,[360*(t%=1),100*s,100*(s<1?a/(1-s):0)]},n.hsl.hcg=function(e){var t=e[1]/100,o=e[2]/100,i=1,n=0;return(i=o<.5?2*t*o:2*t*(1-o))<1&&(n=(o-.5*i)/(1-i)),[e[0],100*i,100*n]},n.hsv.hcg=function(e){var t=e[1]/100,o=e[2]/100,i=t*o,n=0;return i<1&&(n=(o-i)/(1-i)),[e[0],100*i,100*n]},n.hcg.rgb=function(e){var t=e[0]/360,o=e[1]/100,i=e[2]/100;if(0===o)return[255*i,255*i,255*i];var n,r=[0,0,0],a=t%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=l,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=l,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=l}return n=(1-o)*i,[255*(o*r[0]+n),255*(o*r[1]+n),255*(o*r[2]+n)]},n.hcg.hsv=function(e){var t=e[1]/100,o=t+e[2]/100*(1-t),i=0;return o>0&&(i=t/o),[e[0],100*i,100*o]},n.hcg.hsl=function(e){var t=e[1]/100,o=e[2]/100*(1-t)+.5*t,i=0;return o>0&&o<.5?i=t/(2*o):o>=.5&&o<1&&(i=t/(2*(1-o))),[e[0],100*i,100*o]},n.hcg.hwb=function(e){var t=e[1]/100,o=t+e[2]/100*(1-t);return[e[0],100*(o-t),100*(1-o)]},n.hwb.hcg=function(e){var t=e[1]/100,o=1-e[2]/100,i=o-t,n=0;return i<1&&(n=(o-i)/(1-i)),[e[0],100*i,100*n]},n.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},n.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},n.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},n.gray.hsl=n.gray.hsv=function(e){return[0,0,e[0]]},n.gray.hwb=function(e){return[0,100,e[0]]},n.gray.cmyk=function(e){return[0,0,0,e[0]]},n.gray.lab=function(e){return[e[0],0,0]},n.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),o=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(o.length)+o},n.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}}));function i(e){var t=function(){for(var e={},t=Object.keys(o),i=t.length,n=0;n<i;n++)e[t[n]]={distance:-1,parent:null};return e}(),i=[e];for(t[e].distance=0;i.length;)for(var n=i.pop(),r=Object.keys(o[n]),a=r.length,s=0;s<a;s++){var l=r[s],c=t[l];-1===c.distance&&(c.distance=t[n].distance+1,c.parent=n,i.unshift(l))}return t}function n(e,t){return function(o){return t(e(o))}}function r(e,t){for(var i=[t[e].parent,e],r=o[t[e].parent][e],a=t[e].parent;t[a].parent;)i.unshift(t[a].parent),r=n(o[t[a].parent][a],r),a=t[a].parent;return r.conversion=i,r}o.rgb,o.hsl,o.hsv,o.hwb,o.cmyk,o.xyz,o.lab,o.lch,o.hex,o.keyword,o.ansi16,o.ansi256,o.hcg,o.apple,o.gray;var a={};Object.keys(o).forEach((function(e){a[e]={},Object.defineProperty(a[e],"channels",{value:o[e].channels}),Object.defineProperty(a[e],"labels",{value:o[e].labels});var t=function(e){for(var t=i(e),o={},n=Object.keys(t),a=n.length,s=0;s<a;s++){var l=n[s];null!==t[l].parent&&(o[l]=r(l,t))}return o}(e);Object.keys(t).forEach((function(o){var i=t[o];a[e][o]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var o=e(t);if("object"==typeof o)for(var i=o.length,n=0;n<i;n++)o[n]=Math.round(o[n]);return o};return"conversion"in e&&(t.conversion=e.conversion),t}(i),a[e][o].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(i)}))}));var s=a,l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},c={getRgba:u,getHsla:d,getRgb:function(e){var t=u(e);return t&&t.slice(0,3)},getHsl:function(e){var t=d(e);return t&&t.slice(0,3)},getHwb:h,getAlpha:function(e){var t=u(e);return t||(t=d(e))||(t=h(e))?t[3]:void 0},hexString:function(e,t){return t=void 0!==t&&3===e.length?t:e[3],"#"+v(e[0])+v(e[1])+v(e[2])+(t>=0&&t<1?v(Math.round(255*t)):"")},rgbString:function(e,t){return t<1||e[3]&&e[3]<1?p(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},rgbaString:p,percentString:function(e,t){if(t<1||e[3]&&e[3]<1)return f(e,t);var o=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return"rgb("+o+"%, "+i+"%, "+n+"%)"},percentaString:f,hslString:function(e,t){return t<1||e[3]&&e[3]<1?m(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"},hslaString:m,hwbString:function(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"},keyword:function(e){return b[e.slice(0,3)]}};function u(e){if(e){var t=[0,0,0],o=1,i=e.match(/^#([a-fA-F0-9]{3,4})$/i),n="";if(i){n=(i=i[1])[3];for(var r=0;r<t.length;r++)t[r]=parseInt(i[r]+i[r],16);n&&(o=Math.round(parseInt(n+n,16)/255*100)/100)}else if(i=e.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){for(n=i[2],i=i[1],r=0;r<t.length;r++)t[r]=parseInt(i.slice(2*r,2*r+2),16);n&&(o=Math.round(parseInt(n,16)/255*100)/100)}else if(i=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<t.length;r++)t[r]=parseInt(i[r+1]);o=parseFloat(i[4])}else if(i=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<t.length;r++)t[r]=Math.round(2.55*parseFloat(i[r+1]));o=parseFloat(i[4])}else if(i=e.match(/(\w+)/)){if("transparent"==i[1])return[0,0,0,0];if(!(t=l[i[1]]))return}for(r=0;r<t.length;r++)t[r]=g(t[r],0,255);return o=o||0==o?g(o,0,1):1,t[3]=o,t}}function d(e){if(e){var t=e.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var o=parseFloat(t[4]);return[g(parseInt(t[1]),0,360),g(parseFloat(t[2]),0,100),g(parseFloat(t[3]),0,100),g(isNaN(o)?1:o,0,1)]}}}function h(e){if(e){var t=e.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var o=parseFloat(t[4]);return[g(parseInt(t[1]),0,360),g(parseFloat(t[2]),0,100),g(parseFloat(t[3]),0,100),g(isNaN(o)?1:o,0,1)]}}}function p(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function f(e,t){return"rgba("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%, "+(t||e[3]||1)+")"}function m(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function g(e,t,o){return Math.min(Math.max(t,e),o)}function v(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var b={};for(var y in l)b[l[y]]=y;var w=function(e){return e instanceof w?e:this instanceof w?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof e?(t=c.getRgba(e))?this.setValues("rgb",t):(t=c.getHsla(e))?this.setValues("hsl",t):(t=c.getHwb(e))&&this.setValues("hwb",t):"object"==typeof e&&(void 0!==(t=e).r||void 0!==t.red?this.setValues("rgb",t):void 0!==t.l||void 0!==t.lightness?this.setValues("hsl",t):void 0!==t.v||void 0!==t.value?this.setValues("hsv",t):void 0!==t.w||void 0!==t.whiteness?this.setValues("hwb",t):void 0===t.c&&void 0===t.cyan||this.setValues("cmyk",t)))):new w(e);var t};w.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;return 1!==e.alpha?e.hwb.concat([e.alpha]):e.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return e&&(e=(e%=360)<0?360+e:e),this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return c.hexString(this.values.rgb)},rgbString:function(){return c.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return c.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return c.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return c.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return c.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return c.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return c.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){for(var e=this.values.rgb,t=[],o=0;o<e.length;o++){var i=e[o]/255;t[o]=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),o=e.luminosity();return t>o?(t+.05)/(o+.05):(o+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;t<3;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){var t=this.values.hsl;return t[2]+=t[2]*e,this.setValues("hsl",t),this},darken:function(e){var t=this.values.hsl;return t[2]-=t[2]*e,this.setValues("hsl",t),this},saturate:function(e){var t=this.values.hsl;return t[1]+=t[1]*e,this.setValues("hsl",t),this},desaturate:function(e){var t=this.values.hsl;return t[1]-=t[1]*e,this.setValues("hsl",t),this},whiten:function(e){var t=this.values.hwb;return t[1]+=t[1]*e,this.setValues("hwb",t),this},blacken:function(e){var t=this.values.hwb;return t[2]+=t[2]*e,this.setValues("hwb",t),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){var t=this.values.alpha;return this.setValues("alpha",t-t*e),this},opaquer:function(e){var t=this.values.alpha;return this.setValues("alpha",t+t*e),this},rotate:function(e){var t=this.values.hsl,o=(t[0]+e)%360;return t[0]=o<0?360+o:o,this.setValues("hsl",t),this},mix:function(e,t){var o=e,i=void 0===t?.5:t,n=2*i-1,r=this.alpha()-o.alpha(),a=((n*r==-1?n:(n+r)/(1+n*r))+1)/2,s=1-a;return this.rgb(a*this.red()+s*o.red(),a*this.green()+s*o.green(),a*this.blue()+s*o.blue()).alpha(this.alpha()*i+o.alpha()*(1-i))},toJSON:function(){return this.rgb()},clone:function(){var e,t,o=new w,i=this.values,n=o.values;for(var r in i)i.hasOwnProperty(r)&&(e=i[r],"[object Array]"===(t={}.toString.call(e))?n[r]=e.slice(0):"[object Number]"===t?n[r]=e:console.error("unexpected color value:",e));return o}},w.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},w.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},w.prototype.getValues=function(e){for(var t=this.values,o={},i=0;i<e.length;i++)o[e.charAt(i)]=t[e][i];return 1!==t.alpha&&(o.a=t.alpha),o},w.prototype.setValues=function(e,t){var o,i,n=this.values,r=this.spaces,a=this.maxes,l=1;if(this.valid=!0,"alpha"===e)l=t;else if(t.length)n[e]=t.slice(0,e.length),l=t[e.length];else if(void 0!==t[e.charAt(0)]){for(o=0;o<e.length;o++)n[e][o]=t[e.charAt(o)];l=t.a}else if(void 0!==t[r[e][0]]){var c=r[e];for(o=0;o<e.length;o++)n[e][o]=t[c[o]];l=t.alpha}if(n.alpha=Math.max(0,Math.min(1,void 0===l?n.alpha:l)),"alpha"===e)return!1;for(o=0;o<e.length;o++)i=Math.max(0,Math.min(a[e][o],n[e][o])),n[e][o]=Math.round(i);for(var u in r)u!==e&&(n[u]=s[e][u](n[e]));return!0},w.prototype.setSpace=function(e,t){var o=t[0];return void 0===o?this.getValues(e):("number"==typeof o&&(o=Array.prototype.slice.call(t)),this.setValues(e,o),this)},w.prototype.setChannel=function(e,t,o){var i=this.values[e];return void 0===o?i[t]:(o===i[t]||(i[t]=o,this.setValues(e,i)),this)},"undefined"!=typeof window&&(window.Color=w);var x,C=w,E={noop:function(){},uid:(x=0,function(){return x++}),isNullOrUndef:function(e){return null==e},isArray:function(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.substr(0,7)&&"Array]"===t.substr(-6)},isObject:function(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)},isFinite:function(e){return("number"==typeof e||e instanceof Number)&&isFinite(e)},valueOrDefault:function(e,t){return void 0===e?t:e},valueAtIndexOrDefault:function(e,t,o){return E.valueOrDefault(E.isArray(e)?e[t]:e,o)},callback:function(e,t,o){if(e&&"function"==typeof e.call)return e.apply(o,t)},each:function(e,t,o,i){var n,r,a;if(E.isArray(e))if(r=e.length,i)for(n=r-1;n>=0;n--)t.call(o,e[n],n);else for(n=0;n<r;n++)t.call(o,e[n],n);else if(E.isObject(e))for(r=(a=Object.keys(e)).length,n=0;n<r;n++)t.call(o,e[a[n]],a[n])},arrayEquals:function(e,t){var o,i,n,r;if(!e||!t||e.length!==t.length)return!1;for(o=0,i=e.length;o<i;++o)if(n=e[o],r=t[o],n instanceof Array&&r instanceof Array){if(!E.arrayEquals(n,r))return!1}else if(n!==r)return!1;return!0},clone:function(e){if(E.isArray(e))return e.map(E.clone);if(E.isObject(e)){for(var t={},o=Object.keys(e),i=o.length,n=0;n<i;++n)t[o[n]]=E.clone(e[o[n]]);return t}return e},_merger:function(e,t,o,i){var n=t[e],r=o[e];E.isObject(n)&&E.isObject(r)?E.merge(n,r,i):t[e]=E.clone(r)},_mergerIf:function(e,t,o){var i=t[e],n=o[e];E.isObject(i)&&E.isObject(n)?E.mergeIf(i,n):t.hasOwnProperty(e)||(t[e]=E.clone(n))},merge:function(e,t,o){var i,n,r,a,s,l=E.isArray(t)?t:[t],c=l.length;if(!E.isObject(e))return e;for(i=(o=o||{}).merger||E._merger,n=0;n<c;++n)if(t=l[n],E.isObject(t))for(s=0,a=(r=Object.keys(t)).length;s<a;++s)i(r[s],e,t,o);return e},mergeIf:function(e,t){return E.merge(e,t,{merger:E._mergerIf})},extend:Object.assign||function(e){return E.merge(e,[].slice.call(arguments,1),{merger:function(e,t,o){t[e]=o[e]}})},inherits:function(e){var t=this,o=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},i=function(){this.constructor=o};return i.prototype=t.prototype,o.prototype=new i,o.extend=E.inherits,e&&E.extend(o.prototype,e),o.__super__=t.prototype,o},_deprecated:function(e,t,o,i){void 0!==t&&console.warn(e+': "'+o+'" is deprecated. Please use "'+i+'" instead')}},k=E;E.callCallback=E.callback,E.indexOf=function(e,t,o){return Array.prototype.indexOf.call(e,t,o)},E.getValueOrDefault=E.valueOrDefault,E.getValueAtIndexOrDefault=E.valueAtIndexOrDefault;var M={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,o=0,i=1;return 0===e?0:1===e?1:(o||(o=.3),i<1?(i=1,t=o/4):t=o/(2*Math.PI)*Math.asin(1/i),-i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/o))},easeOutElastic:function(e){var t=1.70158,o=0,i=1;return 0===e?0:1===e?1:(o||(o=.3),i<1?(i=1,t=o/4):t=o/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/o)+1)},easeInOutElastic:function(e){var t=1.70158,o=0,i=1;return 0===e?0:2==(e/=.5)?1:(o||(o=.45),i<1?(i=1,t=o/4):t=o/(2*Math.PI)*Math.asin(1/i),e<1?i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/o)*-.5:i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/o)*.5+1)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-M.easeOutBounce(1-e)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*M.easeInBounce(2*e):.5*M.easeOutBounce(2*e-1)+.5}},_={effects:M};k.easingEffects=M;var D=Math.PI,S=D/180,R=2*D,T=D/2,L=D/4,P=2*D/3,A={clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function(e,t,o,i,n,r){if(r){var a=Math.min(r,n/2,i/2),s=t+a,l=o+a,c=t+i-a,u=o+n-a;e.moveTo(t,l),s<c&&l<u?(e.arc(s,l,a,-D,-T),e.arc(c,l,a,-T,0),e.arc(c,u,a,0,T),e.arc(s,u,a,T,D)):s<c?(e.moveTo(s,o),e.arc(c,l,a,-T,T),e.arc(s,l,a,T,D+T)):l<u?(e.arc(s,l,a,-D,0),e.arc(s,u,a,0,D)):e.arc(s,l,a,-D,D),e.closePath(),e.moveTo(t,o)}else e.rect(t,o,i,n)},drawPoint:function(e,t,o,i,n,r){var a,s,l,c,u,d=(r||0)*S;if(t&&"object"==typeof t&&("[object HTMLImageElement]"===(a=t.toString())||"[object HTMLCanvasElement]"===a))return e.save(),e.translate(i,n),e.rotate(d),e.drawImage(t,-t.width/2,-t.height/2,t.width,t.height),void e.restore();if(!(isNaN(o)||o<=0)){switch(e.beginPath(),t){default:e.arc(i,n,o,0,R),e.closePath();break;case"triangle":e.moveTo(i+Math.sin(d)*o,n-Math.cos(d)*o),d+=P,e.lineTo(i+Math.sin(d)*o,n-Math.cos(d)*o),d+=P,e.lineTo(i+Math.sin(d)*o,n-Math.cos(d)*o),e.closePath();break;case"rectRounded":c=o-(u=.516*o),s=Math.cos(d+L)*c,l=Math.sin(d+L)*c,e.arc(i-s,n-l,u,d-D,d-T),e.arc(i+l,n-s,u,d-T,d),e.arc(i+s,n+l,u,d,d+T),e.arc(i-l,n+s,u,d+T,d+D),e.closePath();break;case"rect":if(!r){c=Math.SQRT1_2*o,e.rect(i-c,n-c,2*c,2*c);break}d+=L;case"rectRot":s=Math.cos(d)*o,l=Math.sin(d)*o,e.moveTo(i-s,n-l),e.lineTo(i+l,n-s),e.lineTo(i+s,n+l),e.lineTo(i-l,n+s),e.closePath();break;case"crossRot":d+=L;case"cross":s=Math.cos(d)*o,l=Math.sin(d)*o,e.moveTo(i-s,n-l),e.lineTo(i+s,n+l),e.moveTo(i+l,n-s),e.lineTo(i-l,n+s);break;case"star":s=Math.cos(d)*o,l=Math.sin(d)*o,e.moveTo(i-s,n-l),e.lineTo(i+s,n+l),e.moveTo(i+l,n-s),e.lineTo(i-l,n+s),d+=L,s=Math.cos(d)*o,l=Math.sin(d)*o,e.moveTo(i-s,n-l),e.lineTo(i+s,n+l),e.moveTo(i+l,n-s),e.lineTo(i-l,n+s);break;case"line":s=Math.cos(d)*o,l=Math.sin(d)*o,e.moveTo(i-s,n-l),e.lineTo(i+s,n+l);break;case"dash":e.moveTo(i,n),e.lineTo(i+Math.cos(d)*o,n+Math.sin(d)*o)}e.fill(),e.stroke()}},_isPointInArea:function(e,t){return e.x>t.left-1e-6&&e.x<t.right+1e-6&&e.y>t.top-1e-6&&e.y<t.bottom+1e-6},clipArea:function(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()},unclipArea:function(e){e.restore()},lineTo:function(e,t,o,i){var n=o.steppedLine;if(n){if("middle"===n){var r=(t.x+o.x)/2;e.lineTo(r,i?o.y:t.y),e.lineTo(r,i?t.y:o.y)}else"after"===n&&!i||"after"!==n&&i?e.lineTo(t.x,o.y):e.lineTo(o.x,t.y);e.lineTo(o.x,o.y)}else o.tension?e.bezierCurveTo(i?t.controlPointPreviousX:t.controlPointNextX,i?t.controlPointPreviousY:t.controlPointNextY,i?o.controlPointNextX:o.controlPointPreviousX,i?o.controlPointNextY:o.controlPointPreviousY,o.x,o.y):e.lineTo(o.x,o.y)}},F=A;k.clear=A.clear,k.drawRoundedRectangle=function(e){e.beginPath(),A.roundedRect.apply(A,arguments)};var O={_set:function(e,t){return k.merge(this[e]||(this[e]={}),t)}};O._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var z=O,I=k.valueOrDefault,j={toLineHeight:function(e,t){var o=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!o||"normal"===o[1])return 1.2*t;switch(e=+o[2],o[3]){case"px":return e;case"%":e/=100}return t*e},toPadding:function(e){var t,o,i,n;return k.isObject(e)?(t=+e.top||0,o=+e.right||0,i=+e.bottom||0,n=+e.left||0):t=o=i=n=+e||0,{top:t,right:o,bottom:i,left:n,height:t+i,width:n+o}},_parseFont:function(e){var t=z.global,o=I(e.fontSize,t.defaultFontSize),i={family:I(e.fontFamily,t.defaultFontFamily),lineHeight:k.options.toLineHeight(I(e.lineHeight,t.defaultLineHeight),o),size:o,style:I(e.fontStyle,t.defaultFontStyle),weight:null,string:""};return i.string=function(e){return!e||k.isNullOrUndef(e.size)||k.isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(i),i},resolve:function(e,t,o,i){var n,r,a,s=!0;for(n=0,r=e.length;n<r;++n)if(void 0!==(a=e[n])&&(void 0!==t&&"function"==typeof a&&(a=a(t),s=!1),void 0!==o&&k.isArray(a)&&(a=a[o],s=!1),void 0!==a))return i&&!s&&(i.cacheable=!1),a}},N={_factorize:function(e){var t,o=[],i=Math.sqrt(e);for(t=1;t<i;t++)e%t==0&&(o.push(t),o.push(e/t));return i===(0|i)&&o.push(i),o.sort((function(e,t){return e-t})).pop(),o},log10:Math.log10||function(e){var t=Math.log(e)*Math.LOG10E,o=Math.round(t);return e===Math.pow(10,o)?o:t}},H=N;k.log10=N.log10;var B=k,V=_,W=F,$=j,G=H,q={getRtlAdapter:function(e,t,o){return e?function(e,t){return{x:function(o){return e+e+t-o},setWidth:function(e){t=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}}(t,o):{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}},overrideTextDirection:function(e,t){var o,i;"ltr"!==t&&"rtl"!==t||(i=[(o=e.canvas.style).getPropertyValue("direction"),o.getPropertyPriority("direction")],o.setProperty("direction",t,"important"),e.prevTextDirection=i)},restoreTextDirection:function(e){var t=e.prevTextDirection;void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}};B.easing=V,B.canvas=W,B.options=$,B.math=G,B.rtl=q;var Y=function(e){B.extend(this,e),this.initialize.apply(this,arguments)};B.extend(Y.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){var e=this;return e._view||(e._view=B.extend({},e._model)),e._start={},e},transition:function(e){var t=this,o=t._model,i=t._start,n=t._view;return o&&1!==e?(n||(n=t._view={}),i||(i=t._start={}),function(e,t,o,i){var n,r,a,s,l,c,u,d,h,p=Object.keys(o);for(n=0,r=p.length;n<r;++n)if(c=o[a=p[n]],t.hasOwnProperty(a)||(t[a]=c),(s=t[a])!==c&&"_"!==a[0]){if(e.hasOwnProperty(a)||(e[a]=s),(u=typeof c)==typeof(l=e[a]))if("string"===u){if((d=C(l)).valid&&(h=C(c)).valid){t[a]=h.mix(d,i).rgbString();continue}}else if(B.isFinite(l)&&B.isFinite(c)){t[a]=l+(c-l)*i;continue}t[a]=c}}(i,n,o,e),t):(t._view=B.extend({},o),t._start=null,t)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return B.isNumber(this._model.x)&&B.isNumber(this._model.y)}}),Y.extend=B.inherits;var U=Y,X=U.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),J=X;Object.defineProperty(X.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(X.prototype,"chartInstance",{get:function(){return this.chart},set:function(e){this.chart=e}}),z._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:B.noop,onComplete:B.noop}});var K={animations:[],request:null,addAnimation:function(e,t,o,i){var n,r,a=this.animations;for(t.chart=e,t.startTime=Date.now(),t.duration=o,i||(e.animating=!0),n=0,r=a.length;n<r;++n)if(a[n].chart===e)return void(a[n]=t);a.push(t),1===a.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var t=B.findIndex(this.animations,(function(t){return t.chart===e}));-1!==t&&(this.animations.splice(t,1),e.animating=!1)},requestAnimationFrame:function(){var e=this;null===e.request&&(e.request=B.requestAnimFrame.call(window,(function(){e.request=null,e.startDigest()})))},startDigest:function(){this.advance(),this.animations.length>0&&this.requestAnimationFrame()},advance:function(){for(var e,t,o,i,n=this.animations,r=0;r<n.length;)t=(e=n[r]).chart,o=e.numSteps,i=Math.floor((Date.now()-e.startTime)/e.duration*o)+1,e.currentStep=Math.min(i,o),B.callback(e.render,[t,e],t),B.callback(e.onAnimationProgress,[e],t),e.currentStep>=o?(B.callback(e.onAnimationComplete,[e],t),t.animating=!1,n.splice(r,1)):++r}},Z=B.options.resolve,Q=["push","pop","shift","splice","unshift"];function ee(e,t){var o=e._chartjs;if(o){var i=o.listeners,n=i.indexOf(t);-1!==n&&i.splice(n,1),i.length>0||(Q.forEach((function(t){delete e[t]})),delete e._chartjs)}}var te=function(e,t){this.initialize(e,t)};B.extend(te.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(e,t){var o=this;o.chart=e,o.index=t,o.linkScales(),o.addElements(),o._type=o.getMeta().type},updateIndex:function(e){this.index=e},linkScales:function(){var e=this.getMeta(),t=this.chart,o=t.scales,i=this.getDataset(),n=t.options.scales;null!==e.xAxisID&&e.xAxisID in o&&!i.xAxisID||(e.xAxisID=i.xAxisID||n.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in o&&!i.yAxisID||(e.yAxisID=i.yAxisID||n.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&ee(this._data,this)},createMetaDataset:function(){var e=this.datasetElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(e){var t=this.dataElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index,_index:e})},addElements:function(){var e,t,o=this.getMeta(),i=this.getDataset().data||[],n=o.data;for(e=0,t=i.length;e<t;++e)n[e]=n[e]||this.createMetaData(e);o.dataset=o.dataset||this.createMetaDataset()},addElementAndReset:function(e){var t=this.createMetaData(e);this.getMeta().data.splice(e,0,t),this.updateElement(t,e,!0)},buildOrUpdateElements:function(){var e,t,o=this,i=o.getDataset(),n=i.data||(i.data=[]);o._data!==n&&(o._data&&ee(o._data,o),n&&Object.isExtensible(n)&&(t=o,(e=n)._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Q.forEach((function(t){var o="onData"+t.charAt(0).toUpperCase()+t.slice(1),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){var t=Array.prototype.slice.call(arguments),n=i.apply(this,t);return B.each(e._chartjs.listeners,(function(e){"function"==typeof e[o]&&e[o].apply(e,t)})),n}})})))),o._data=n),o.resyncElements()},_configure:function(){this._config=B.merge({},[this.chart.options.datasets[this._type],this.getDataset()],{merger:function(e,t,o){"_meta"!==e&&"data"!==e&&B._merger(e,t,o)}})},_update:function(e){this._configure(),this._cachedDataOpts=null,this.update(e)},update:B.noop,transition:function(e){for(var t=this.getMeta(),o=t.data||[],i=o.length,n=0;n<i;++n)o[n].transition(e);t.dataset&&t.dataset.transition(e)},draw:function(){var e=this.getMeta(),t=e.data||[],o=t.length,i=0;for(e.dataset&&e.dataset.draw();i<o;++i)t[i].draw()},getStyle:function(e){var t,o=this.getMeta(),i=o.dataset;return this._configure(),i&&void 0===e?t=this._resolveDatasetElementOptions(i||{}):(e=e||0,t=this._resolveDataElementOptions(o.data[e]||{},e)),!1!==t.fill&&null!==t.fill||(t.backgroundColor=t.borderColor),t},_resolveDatasetElementOptions:function(e,t){var o,i,n,r,a=this,s=a.chart,l=a._config,c=e.custom||{},u=s.options.elements[a.datasetElementType.prototype._type]||{},d=a._datasetElementOptions,h={},p={chart:s,dataset:a.getDataset(),datasetIndex:a.index,hover:t};for(o=0,i=d.length;o<i;++o)n=d[o],r=t?"hover"+n.charAt(0).toUpperCase()+n.slice(1):n,h[n]=Z([c[r],l[r],u[r]],p);return h},_resolveDataElementOptions:function(e,t){var o=this,i=e&&e.custom,n=o._cachedDataOpts;if(n&&!i)return n;var r,a,s,l,c=o.chart,u=o._config,d=c.options.elements[o.dataElementType.prototype._type]||{},h=o._dataElementOptions,p={},f={chart:c,dataIndex:t,dataset:o.getDataset(),datasetIndex:o.index},m={cacheable:!i};if(i=i||{},B.isArray(h))for(a=0,s=h.length;a<s;++a)p[l=h[a]]=Z([i[l],u[l],d[l]],f,t,m);else for(a=0,s=(r=Object.keys(h)).length;a<s;++a)p[l=r[a]]=Z([i[l],u[h[l]],u[l],d[l]],f,t,m);return m.cacheable&&(o._cachedDataOpts=Object.freeze(p)),p},removeHoverStyle:function(e){B.merge(e._model,e.$previousStyle||{}),delete e.$previousStyle},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],o=e._index,i=e.custom||{},n=e._model,r=B.getHoverColor;e.$previousStyle={backgroundColor:n.backgroundColor,borderColor:n.borderColor,borderWidth:n.borderWidth},n.backgroundColor=Z([i.hoverBackgroundColor,t.hoverBackgroundColor,r(n.backgroundColor)],void 0,o),n.borderColor=Z([i.hoverBorderColor,t.hoverBorderColor,r(n.borderColor)],void 0,o),n.borderWidth=Z([i.hoverBorderWidth,t.hoverBorderWidth,n.borderWidth],void 0,o)},_removeDatasetHoverStyle:function(){var e=this.getMeta().dataset;e&&this.removeHoverStyle(e)},_setDatasetHoverStyle:function(){var e,t,o,i,n,r,a=this.getMeta().dataset,s={};if(a){for(r=a._model,n=this._resolveDatasetElementOptions(a,!0),e=0,t=(i=Object.keys(n)).length;e<t;++e)s[o=i[e]]=r[o],r[o]=n[o];a.$previousStyle=s}},resyncElements:function(){var e=this.getMeta(),t=this.getDataset().data,o=e.data.length,i=t.length;i<o?e.data.splice(i,o-i):i>o&&this.insertElements(o,i-o)},insertElements:function(e,t){for(var o=0;o<t;++o)this.addElementAndReset(e+o)},onDataPush:function(){var e=arguments.length;this.insertElements(this.getDataset().data.length-e,e)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(e,t){this.getMeta().data.splice(e,t),this.insertElements(e,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),te.extend=B.inherits;var oe=te,ie=2*Math.PI;function ne(e,t){var o=t.startAngle,i=t.endAngle,n=t.pixelMargin,r=n/t.outerRadius,a=t.x,s=t.y;e.beginPath(),e.arc(a,s,t.outerRadius,o-r,i+r),t.innerRadius>n?(r=n/t.innerRadius,e.arc(a,s,t.innerRadius-n,i+r,o-r,!0)):e.arc(a,s,n,i+Math.PI/2,o-Math.PI/2),e.closePath(),e.clip()}function re(e,t,o){var i="inner"===t.borderAlign;i?(e.lineWidth=2*t.borderWidth,e.lineJoin="round"):(e.lineWidth=t.borderWidth,e.lineJoin="bevel"),o.fullCircles&&function(e,t,o,i){var n,r=o.endAngle;for(i&&(o.endAngle=o.startAngle+ie,ne(e,o),o.endAngle=r,o.endAngle===o.startAngle&&o.fullCircles&&(o.endAngle+=ie,o.fullCircles--)),e.beginPath(),e.arc(o.x,o.y,o.innerRadius,o.startAngle+ie,o.startAngle,!0),n=0;n<o.fullCircles;++n)e.stroke();for(e.beginPath(),e.arc(o.x,o.y,t.outerRadius,o.startAngle,o.startAngle+ie),n=0;n<o.fullCircles;++n)e.stroke()}(e,t,o,i),i&&ne(e,o),e.beginPath(),e.arc(o.x,o.y,t.outerRadius,o.startAngle,o.endAngle),e.arc(o.x,o.y,o.innerRadius,o.endAngle,o.startAngle,!0),e.closePath(),e.stroke()}z._set("global",{elements:{arc:{backgroundColor:z.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var ae=U.extend({_type:"arc",inLabelRange:function(e){var t=this._view;return!!t&&Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)},inRange:function(e,t){var o=this._view;if(o){for(var i=B.getAngleFromPoint(o,{x:e,y:t}),n=i.angle,r=i.distance,a=o.startAngle,s=o.endAngle;s<a;)s+=ie;for(;n>s;)n-=ie;for(;n<a;)n+=ie;var l=n>=a&&n<=s,c=r>=o.innerRadius&&r<=o.outerRadius;return l&&c}return!1},getCenterPoint:function(){var e=this._view,t=(e.startAngle+e.endAngle)/2,o=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*o,y:e.y+Math.sin(t)*o}},getArea:function(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,o=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*o,y:e.y+Math.sin(t)*o}},draw:function(){var e,t=this._chart.ctx,o=this._view,i="inner"===o.borderAlign?.33:0,n={x:o.x,y:o.y,innerRadius:o.innerRadius,outerRadius:Math.max(o.outerRadius-i,0),pixelMargin:i,startAngle:o.startAngle,endAngle:o.endAngle,fullCircles:Math.floor(o.circumference/ie)};if(t.save(),t.fillStyle=o.backgroundColor,t.strokeStyle=o.borderColor,n.fullCircles){for(n.endAngle=n.startAngle+ie,t.beginPath(),t.arc(n.x,n.y,n.outerRadius,n.startAngle,n.endAngle),t.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,!0),t.closePath(),e=0;e<n.fullCircles;++e)t.fill();n.endAngle=n.startAngle+o.circumference%ie}t.beginPath(),t.arc(n.x,n.y,n.outerRadius,n.startAngle,n.endAngle),t.arc(n.x,n.y,n.innerRadius,n.endAngle,n.startAngle,!0),t.closePath(),t.fill(),o.borderWidth&&re(t,o,n),t.restore()}}),se=B.valueOrDefault,le=z.global.defaultColor;z._set("global",{elements:{line:{tension:.4,backgroundColor:le,borderWidth:3,borderColor:le,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var ce=U.extend({_type:"line",draw:function(){var e,t,o,i=this,n=i._view,r=i._chart.ctx,a=n.spanGaps,s=i._children.slice(),l=z.global,c=l.elements.line,u=-1,d=i._loop;if(s.length){if(i._loop){for(e=0;e<s.length;++e)if(t=B.previousItem(s,e),!s[e]._view.skip&&t._view.skip){s=s.slice(e).concat(s.slice(0,e)),d=a;break}d&&s.push(s[0])}for(r.save(),r.lineCap=n.borderCapStyle||c.borderCapStyle,r.setLineDash&&r.setLineDash(n.borderDash||c.borderDash),r.lineDashOffset=se(n.borderDashOffset,c.borderDashOffset),r.lineJoin=n.borderJoinStyle||c.borderJoinStyle,r.lineWidth=se(n.borderWidth,c.borderWidth),r.strokeStyle=n.borderColor||l.defaultColor,r.beginPath(),(o=s[0]._view).skip||(r.moveTo(o.x,o.y),u=0),e=1;e<s.length;++e)o=s[e]._view,t=-1===u?B.previousItem(s,e):s[u],o.skip||(u!==e-1&&!a||-1===u?r.moveTo(o.x,o.y):B.canvas.lineTo(r,t._view,o),u=e);d&&r.closePath(),r.stroke(),r.restore()}}}),ue=B.valueOrDefault,de=z.global.defaultColor;function he(e){var t=this._view;return!!t&&Math.abs(e-t.x)<t.radius+t.hitRadius}z._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:de,borderColor:de,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var pe=U.extend({_type:"point",inRange:function(e,t){var o=this._view;return!!o&&Math.pow(e-o.x,2)+Math.pow(t-o.y,2)<Math.pow(o.hitRadius+o.radius,2)},inLabelRange:he,inXRange:he,inYRange:function(e){var t=this._view;return!!t&&Math.abs(e-t.y)<t.radius+t.hitRadius},getCenterPoint:function(){var e=this._view;return{x:e.x,y:e.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(e){var t=this._view,o=this._chart.ctx,i=t.pointStyle,n=t.rotation,r=t.radius,a=t.x,s=t.y,l=z.global,c=l.defaultColor;t.skip||(void 0===e||B.canvas._isPointInArea(t,e))&&(o.strokeStyle=t.borderColor||c,o.lineWidth=ue(t.borderWidth,l.elements.point.borderWidth),o.fillStyle=t.backgroundColor||c,B.canvas.drawPoint(o,i,r,a,s,n))}}),fe=z.global.defaultColor;function me(e){return e&&void 0!==e.width}function ge(e){var t,o,i,n,r;return me(e)?(r=e.width/2,t=e.x-r,o=e.x+r,i=Math.min(e.y,e.base),n=Math.max(e.y,e.base)):(r=e.height/2,t=Math.min(e.x,e.base),o=Math.max(e.x,e.base),i=e.y-r,n=e.y+r),{left:t,top:i,right:o,bottom:n}}function ve(e,t,o){return e===t?o:e===o?t:e}function be(e,t,o){var i,n,r,a,s=e.borderWidth,l=function(e){var t=e.borderSkipped,o={};return t?(e.horizontal?e.base>e.x&&(t=ve(t,"left","right")):e.base<e.y&&(t=ve(t,"bottom","top")),o[t]=!0,o):o}(e);return B.isObject(s)?(i=+s.top||0,n=+s.right||0,r=+s.bottom||0,a=+s.left||0):i=n=r=a=+s||0,{t:l.top||i<0?0:i>o?o:i,r:l.right||n<0?0:n>t?t:n,b:l.bottom||r<0?0:r>o?o:r,l:l.left||a<0?0:a>t?t:a}}function ye(e,t,o){var i=null===t,n=null===o,r=!(!e||i&&n)&&ge(e);return r&&(i||t>=r.left&&t<=r.right)&&(n||o>=r.top&&o<=r.bottom)}z._set("global",{elements:{rectangle:{backgroundColor:fe,borderColor:fe,borderSkipped:"bottom",borderWidth:0}}});var we=U.extend({_type:"rectangle",draw:function(){var e=this._chart.ctx,t=this._view,o=function(e){var t=ge(e),o=t.right-t.left,i=t.bottom-t.top,n=be(e,o/2,i/2);return{outer:{x:t.left,y:t.top,w:o,h:i},inner:{x:t.left+n.l,y:t.top+n.t,w:o-n.l-n.r,h:i-n.t-n.b}}}(t),i=o.outer,n=o.inner;e.fillStyle=t.backgroundColor,e.fillRect(i.x,i.y,i.w,i.h),i.w===n.w&&i.h===n.h||(e.save(),e.beginPath(),e.rect(i.x,i.y,i.w,i.h),e.clip(),e.fillStyle=t.borderColor,e.rect(n.x,n.y,n.w,n.h),e.fill("evenodd"),e.restore())},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){return ye(this._view,e,t)},inLabelRange:function(e,t){var o=this._view;return me(o)?ye(o,e,null):ye(o,null,t)},inXRange:function(e){return ye(this._view,e,null)},inYRange:function(e){return ye(this._view,null,e)},getCenterPoint:function(){var e,t,o=this._view;return me(o)?(e=o.x,t=(o.y+o.base)/2):(e=(o.x+o.base)/2,t=o.y),{x:e,y:t}},getArea:function(){var e=this._view;return me(e)?e.width*Math.abs(e.y-e.base):e.height*Math.abs(e.x-e.base)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}}),xe={},Ce=ae,Ee=ce,ke=pe,Me=we;xe.Arc=Ce,xe.Line=Ee,xe.Point=ke,xe.Rectangle=Me;var _e=B._deprecated,De=B.valueOrDefault;function Se(e,t,o){var i,n,r=o.barThickness,a=t.stackCount,s=t.pixels[e],l=B.isNullOrUndef(r)?function(e,t){var o,i,n,r,a=e._length;for(n=1,r=t.length;n<r;++n)a=Math.min(a,Math.abs(t[n]-t[n-1]));for(n=0,r=e.getTicks().length;n<r;++n)i=e.getPixelForTick(n),a=n>0?Math.min(a,Math.abs(i-o)):a,o=i;return a}(t.scale,t.pixels):-1;return B.isNullOrUndef(r)?(i=l*o.categoryPercentage,n=o.barPercentage):(i=r*a,n=1),{chunk:i/a,ratio:n,start:s-i/2}}z._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),z._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var Re=oe.extend({dataElementType:xe.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var e,t,o=this;oe.prototype.initialize.apply(o,arguments),(e=o.getMeta()).stack=o.getDataset().stack,e.bar=!0,t=o._getIndexScale().options,_e("bar chart",t.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),_e("bar chart",t.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness"),_e("bar chart",t.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),_e("bar chart",o._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),_e("bar chart",t.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(e){var t,o,i=this.getMeta().data;for(this._ruler=this.getRuler(),t=0,o=i.length;t<o;++t)this.updateElement(i[t],t,e)},updateElement:function(e,t,o){var i=this,n=i.getMeta(),r=i.getDataset(),a=i._resolveDataElementOptions(e,t);e._xScale=i.getScaleForId(n.xAxisID),e._yScale=i.getScaleForId(n.yAxisID),e._datasetIndex=i.index,e._index=t,e._model={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderSkipped:a.borderSkipped,borderWidth:a.borderWidth,datasetLabel:r.label,label:i.chart.data.labels[t]},B.isArray(r.data[t])&&(e._model.borderSkipped=null),i._updateElementGeometry(e,t,o,a),e.pivot()},_updateElementGeometry:function(e,t,o,i){var n=this,r=e._model,a=n._getValueScale(),s=a.getBasePixel(),l=a.isHorizontal(),c=n._ruler||n.getRuler(),u=n.calculateBarValuePixels(n.index,t,i),d=n.calculateBarIndexPixels(n.index,t,c,i);r.horizontal=l,r.base=o?s:u.base,r.x=l?o?s:u.head:d.center,r.y=l?d.center:o?s:u.head,r.height=l?d.size:void 0,r.width=l?void 0:d.size},_getStacks:function(e){var t,o,i=this._getIndexScale(),n=i._getMatchingVisibleMetas(this._type),r=i.options.stacked,a=n.length,s=[];for(t=0;t<a&&(o=n[t],(!1===r||-1===s.indexOf(o.stack)||void 0===r&&void 0===o.stack)&&s.push(o.stack),o.index!==e);++t);return s},getStackCount:function(){return this._getStacks().length},getStackIndex:function(e,t){var o=this._getStacks(e),i=void 0!==t?o.indexOf(t):-1;return-1===i?o.length-1:i},getRuler:function(){var e,t,o=this._getIndexScale(),i=[];for(e=0,t=this.getMeta().data.length;e<t;++e)i.push(o.getPixelForValue(null,e,this.index));return{pixels:i,start:o._startPixel,end:o._endPixel,stackCount:this.getStackCount(),scale:o}},calculateBarValuePixels:function(e,t,o){var i,n,r,a,s,l,c,u=this.chart,d=this._getValueScale(),h=d.isHorizontal(),p=u.data.datasets,f=d._getMatchingVisibleMetas(this._type),m=d._parseValue(p[e].data[t]),g=o.minBarLength,v=d.options.stacked,b=this.getMeta().stack,y=void 0===m.start?0:m.max>=0&&m.min>=0?m.min:m.max,w=void 0===m.start?m.end:m.max>=0&&m.min>=0?m.max-m.min:m.min-m.max,x=f.length;if(v||void 0===v&&void 0!==b)for(i=0;i<x&&(n=f[i]).index!==e;++i)n.stack===b&&(r=void 0===(c=d._parseValue(p[n.index].data[t])).start?c.end:c.min>=0&&c.max>=0?c.max:c.min,(m.min<0&&r<0||m.max>=0&&r>0)&&(y+=r));return a=d.getPixelForValue(y),l=(s=d.getPixelForValue(y+w))-a,void 0!==g&&Math.abs(l)<g&&(l=g,s=w>=0&&!h||w<0&&h?a-g:a+g),{size:l,base:a,head:s,center:s+l/2}},calculateBarIndexPixels:function(e,t,o,i){var n="flex"===i.barThickness?function(e,t,o){var i,n=t.pixels,r=n[e],a=e>0?n[e-1]:null,s=e<n.length-1?n[e+1]:null,l=o.categoryPercentage;return null===a&&(a=r-(null===s?t.end-t.start:s-r)),null===s&&(s=r+r-a),i=r-(r-Math.min(a,s))/2*l,{chunk:Math.abs(s-a)/2*l/t.stackCount,ratio:o.barPercentage,start:i}}(t,o,i):Se(t,o,i),r=this.getStackIndex(e,this.getMeta().stack),a=n.start+n.chunk*r+n.chunk/2,s=Math.min(De(i.maxBarThickness,1/0),n.chunk*n.ratio);return{base:a-s/2,head:a+s/2,center:a,size:s}},draw:function(){var e=this.chart,t=this._getValueScale(),o=this.getMeta().data,i=this.getDataset(),n=o.length,r=0;for(B.canvas.clipArea(e.ctx,e.chartArea);r<n;++r){var a=t._parseValue(i.data[r]);isNaN(a.min)||isNaN(a.max)||o[r].draw()}B.canvas.unclipArea(e.ctx)},_resolveDataElementOptions:function(){var e=this,t=B.extend({},oe.prototype._resolveDataElementOptions.apply(e,arguments)),o=e._getIndexScale().options,i=e._getValueScale().options;return t.barPercentage=De(o.barPercentage,t.barPercentage),t.barThickness=De(o.barThickness,t.barThickness),t.categoryPercentage=De(o.categoryPercentage,t.categoryPercentage),t.maxBarThickness=De(o.maxBarThickness,t.maxBarThickness),t.minBarLength=De(i.minBarLength,t.minBarLength),t}}),Te=B.valueOrDefault,Le=B.options.resolve;z._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){var o=t.datasets[e.datasetIndex].label||"",i=t.datasets[e.datasetIndex].data[e.index];return o+": ("+e.xLabel+", "+e.yLabel+", "+i.r+")"}}}});var Pe=oe.extend({dataElementType:xe.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(e){var t=this,o=t.getMeta().data;B.each(o,(function(o,i){t.updateElement(o,i,e)}))},updateElement:function(e,t,o){var i=this,n=i.getMeta(),r=e.custom||{},a=i.getScaleForId(n.xAxisID),s=i.getScaleForId(n.yAxisID),l=i._resolveDataElementOptions(e,t),c=i.getDataset().data[t],u=i.index,d=o?a.getPixelForDecimal(.5):a.getPixelForValue("object"==typeof c?c:NaN,t,u),h=o?s.getBasePixel():s.getPixelForValue(c,t,u);e._xScale=a,e._yScale=s,e._options=l,e._datasetIndex=u,e._index=t,e._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:o?0:l.radius,skip:r.skip||isNaN(d)||isNaN(h),x:d,y:h},e.pivot()},setHoverStyle:function(e){var t=e._model,o=e._options,i=B.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=Te(o.hoverBackgroundColor,i(o.backgroundColor)),t.borderColor=Te(o.hoverBorderColor,i(o.borderColor)),t.borderWidth=Te(o.hoverBorderWidth,o.borderWidth),t.radius=o.radius+o.hoverRadius},_resolveDataElementOptions:function(e,t){var o=this,i=o.chart,n=o.getDataset(),r=e.custom||{},a=n.data[t]||{},s=oe.prototype._resolveDataElementOptions.apply(o,arguments),l={chart:i,dataIndex:t,dataset:n,datasetIndex:o.index};return o._cachedDataOpts===s&&(s=B.extend({},s)),s.radius=Le([r.radius,a.r,o._config.radius,i.options.elements.point.radius],l,t),s}}),Ae=B.valueOrDefault,Fe=Math.PI,Oe=2*Fe,ze=Fe/2;z._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(e){var t,o,i,n=document.createElement("ul"),r=e.data,a=r.datasets,s=r.labels;if(n.setAttribute("class",e.id+"-legend"),a.length)for(t=0,o=a[0].data.length;t<o;++t)(i=n.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[t],s[t]&&i.appendChild(document.createTextNode(s[t]));return n.outerHTML},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(o,i){var n=e.getDatasetMeta(0),r=n.controller.getStyle(i);return{text:o,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(t.datasets[0].data[i])||n.data[i].hidden,index:i}})):[]}},onClick:function(e,t){var o,i,n,r=t.index,a=this.chart;for(o=0,i=(a.data.datasets||[]).length;o<i;++o)(n=a.getDatasetMeta(o)).data[r]&&(n.data[r].hidden=!n.data[r].hidden);a.update()}},cutoutPercentage:50,rotation:-ze,circumference:Oe,tooltips:{callbacks:{title:function(){return""},label:function(e,t){var o=t.labels[e.index],i=": "+t.datasets[e.datasetIndex].data[e.index];return B.isArray(o)?(o=o.slice())[0]+=i:o+=i,o}}}});var Ie=oe.extend({dataElementType:xe.Arc,linkScales:B.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(e){for(var t=0,o=0;o<e;++o)this.chart.isDatasetVisible(o)&&++t;return t},update:function(e){var t,o,i,n,r=this,a=r.chart,s=a.chartArea,l=a.options,c=1,u=1,d=0,h=0,p=r.getMeta(),f=p.data,m=l.cutoutPercentage/100||0,g=l.circumference,v=r._getRingWeight(r.index);if(g<Oe){var b=l.rotation%Oe,y=(b+=b>=Fe?-Oe:b<-Fe?Oe:0)+g,w=Math.cos(b),x=Math.sin(b),C=Math.cos(y),E=Math.sin(y),k=b<=0&&y>=0||y>=Oe,M=b<=ze&&y>=ze||y>=Oe+ze,_=b<=-ze&&y>=-ze||y>=Fe+ze,D=b===-Fe||y>=Fe?-1:Math.min(w,w*m,C,C*m),S=_?-1:Math.min(x,x*m,E,E*m),R=k?1:Math.max(w,w*m,C,C*m),T=M?1:Math.max(x,x*m,E,E*m);c=(R-D)/2,u=(T-S)/2,d=-(R+D)/2,h=-(T+S)/2}for(i=0,n=f.length;i<n;++i)f[i]._options=r._resolveDataElementOptions(f[i],i);for(a.borderWidth=r.getMaxBorderWidth(),t=(s.right-s.left-a.borderWidth)/c,o=(s.bottom-s.top-a.borderWidth)/u,a.outerRadius=Math.max(Math.min(t,o)/2,0),a.innerRadius=Math.max(a.outerRadius*m,0),a.radiusLength=(a.outerRadius-a.innerRadius)/(r._getVisibleDatasetWeightTotal()||1),a.offsetX=d*a.outerRadius,a.offsetY=h*a.outerRadius,p.total=r.calculateTotal(),r.outerRadius=a.outerRadius-a.radiusLength*r._getRingWeightOffset(r.index),r.innerRadius=Math.max(r.outerRadius-a.radiusLength*v,0),i=0,n=f.length;i<n;++i)r.updateElement(f[i],i,e)},updateElement:function(e,t,o){var i=this,n=i.chart,r=n.chartArea,a=n.options,s=a.animation,l=(r.left+r.right)/2,c=(r.top+r.bottom)/2,u=a.rotation,d=a.rotation,h=i.getDataset(),p=o&&s.animateRotate||e.hidden?0:i.calculateCircumference(h.data[t])*(a.circumference/Oe),f=o&&s.animateScale?0:i.innerRadius,m=o&&s.animateScale?0:i.outerRadius,g=e._options||{};B.extend(e,{_datasetIndex:i.index,_index:t,_model:{backgroundColor:g.backgroundColor,borderColor:g.borderColor,borderWidth:g.borderWidth,borderAlign:g.borderAlign,x:l+n.offsetX,y:c+n.offsetY,startAngle:u,endAngle:d,circumference:p,outerRadius:m,innerRadius:f,label:B.valueAtIndexOrDefault(h.label,t,n.data.labels[t])}});var v=e._model;o&&s.animateRotate||(v.startAngle=0===t?a.rotation:i.getMeta().data[t-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),e.pivot()},calculateTotal:function(){var e,t=this.getDataset(),o=this.getMeta(),i=0;return B.each(o.data,(function(o,n){e=t.data[n],isNaN(e)||o.hidden||(i+=Math.abs(e))})),i},calculateCircumference:function(e){var t=this.getMeta().total;return t>0&&!isNaN(e)?Oe*(Math.abs(e)/t):0},getMaxBorderWidth:function(e){var t,o,i,n,r,a,s,l,c=0,u=this.chart;if(!e)for(t=0,o=u.data.datasets.length;t<o;++t)if(u.isDatasetVisible(t)){e=(i=u.getDatasetMeta(t)).data,t!==this.index&&(r=i.controller);break}if(!e)return 0;for(t=0,o=e.length;t<o;++t)n=e[t],r?(r._configure(),a=r._resolveDataElementOptions(n,t)):a=n._options,"inner"!==a.borderAlign&&(s=a.borderWidth,c=(l=a.hoverBorderWidth)>(c=s>c?s:c)?l:c);return c},setHoverStyle:function(e){var t=e._model,o=e._options,i=B.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=Ae(o.hoverBackgroundColor,i(o.backgroundColor)),t.borderColor=Ae(o.hoverBorderColor,i(o.borderColor)),t.borderWidth=Ae(o.hoverBorderWidth,o.borderWidth)},_getRingWeightOffset:function(e){for(var t=0,o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(t+=this._getRingWeight(o));return t},_getRingWeight:function(e){return Math.max(Ae(this.chart.data.datasets[e].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});z._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),z._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var je=Re.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Ne=B.valueOrDefault,He=B.options.resolve,Be=B.canvas._isPointInArea;function Ve(e,t){var o=e&&e.options.ticks||{},i=o.reverse,n=void 0===o.min?t:0,r=void 0===o.max?t:0;return{start:i?r:n,end:i?n:r}}function We(e,t,o){var i=o/2,n=Ve(e,i),r=Ve(t,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}function $e(e){var t,o,i,n;return B.isObject(e)?(t=e.top,o=e.right,i=e.bottom,n=e.left):t=o=i=n=e,{top:t,right:o,bottom:i,left:n}}z._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var Ge=oe.extend({datasetElementType:xe.Line,dataElementType:xe.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(e){var t,o,i=this,n=i.getMeta(),r=n.dataset,a=n.data||[],s=i.chart.options,l=i._config,c=i._showLine=Ne(l.showLine,s.showLines);for(i._xScale=i.getScaleForId(n.xAxisID),i._yScale=i.getScaleForId(n.yAxisID),c&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=i._yScale,r._datasetIndex=i.index,r._children=a,r._model=i._resolveDatasetElementOptions(r),r.pivot()),t=0,o=a.length;t<o;++t)i.updateElement(a[t],t,e);for(c&&0!==r._model.tension&&i.updateBezierControlPoints(),t=0,o=a.length;t<o;++t)a[t].pivot()},updateElement:function(e,t,o){var i,n,r=this,a=r.getMeta(),s=e.custom||{},l=r.getDataset(),c=r.index,u=l.data[t],d=r._xScale,h=r._yScale,p=a.dataset._model,f=r._resolveDataElementOptions(e,t);i=d.getPixelForValue("object"==typeof u?u:NaN,t,c),n=o?h.getBasePixel():r.calculatePointY(u,t,c),e._xScale=d,e._yScale=h,e._options=f,e._datasetIndex=c,e._index=t,e._model={x:i,y:n,skip:s.skip||isNaN(i)||isNaN(n),radius:f.radius,pointStyle:f.pointStyle,rotation:f.rotation,backgroundColor:f.backgroundColor,borderColor:f.borderColor,borderWidth:f.borderWidth,tension:Ne(s.tension,p?p.tension:0),steppedLine:!!p&&p.steppedLine,hitRadius:f.hitRadius}},_resolveDatasetElementOptions:function(e){var t=this,o=t._config,i=e.custom||{},n=t.chart.options,r=n.elements.line,a=oe.prototype._resolveDatasetElementOptions.apply(t,arguments);return a.spanGaps=Ne(o.spanGaps,n.spanGaps),a.tension=Ne(o.lineTension,r.tension),a.steppedLine=He([i.steppedLine,o.steppedLine,r.stepped]),a.clip=$e(Ne(o.clip,We(t._xScale,t._yScale,a.borderWidth))),a},calculatePointY:function(e,t,o){var i,n,r,a,s,l,c,u=this.chart,d=this._yScale,h=0,p=0;if(d.options.stacked){for(s=+d.getRightValue(e),c=(l=u._getSortedVisibleDatasetMetas()).length,i=0;i<c&&(r=l[i]).index!==o;++i)n=u.data.datasets[r.index],"line"===r.type&&r.yAxisID===d.id&&((a=+d.getRightValue(n.data[t]))<0?p+=a||0:h+=a||0);return s<0?d.getPixelForValue(p+s):d.getPixelForValue(h+s)}return d.getPixelForValue(e)},updateBezierControlPoints:function(){var e,t,o,i,n=this.chart,r=this.getMeta(),a=r.dataset._model,s=n.chartArea,l=r.data||[];function c(e,t,o){return Math.max(Math.min(e,o),t)}if(a.spanGaps&&(l=l.filter((function(e){return!e._model.skip}))),"monotone"===a.cubicInterpolationMode)B.splineCurveMonotone(l);else for(e=0,t=l.length;e<t;++e)o=l[e]._model,i=B.splineCurve(B.previousItem(l,e)._model,o,B.nextItem(l,e)._model,a.tension),o.controlPointPreviousX=i.previous.x,o.controlPointPreviousY=i.previous.y,o.controlPointNextX=i.next.x,o.controlPointNextY=i.next.y;if(n.options.elements.line.capBezierPoints)for(e=0,t=l.length;e<t;++e)o=l[e]._model,Be(o,s)&&(e>0&&Be(l[e-1]._model,s)&&(o.controlPointPreviousX=c(o.controlPointPreviousX,s.left,s.right),o.controlPointPreviousY=c(o.controlPointPreviousY,s.top,s.bottom)),e<l.length-1&&Be(l[e+1]._model,s)&&(o.controlPointNextX=c(o.controlPointNextX,s.left,s.right),o.controlPointNextY=c(o.controlPointNextY,s.top,s.bottom)))},draw:function(){var e,t=this.chart,o=this.getMeta(),i=o.data||[],n=t.chartArea,r=t.canvas,a=0,s=i.length;for(this._showLine&&(e=o.dataset._model.clip,B.canvas.clipArea(t.ctx,{left:!1===e.left?0:n.left-e.left,right:!1===e.right?r.width:n.right+e.right,top:!1===e.top?0:n.top-e.top,bottom:!1===e.bottom?r.height:n.bottom+e.bottom}),o.dataset.draw(),B.canvas.unclipArea(t.ctx));a<s;++a)i[a].draw(n)},setHoverStyle:function(e){var t=e._model,o=e._options,i=B.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=Ne(o.hoverBackgroundColor,i(o.backgroundColor)),t.borderColor=Ne(o.hoverBorderColor,i(o.borderColor)),t.borderWidth=Ne(o.hoverBorderWidth,o.borderWidth),t.radius=Ne(o.hoverRadius,o.radius)}}),qe=B.options.resolve;z._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(e){var t,o,i,n=document.createElement("ul"),r=e.data,a=r.datasets,s=r.labels;if(n.setAttribute("class",e.id+"-legend"),a.length)for(t=0,o=a[0].data.length;t<o;++t)(i=n.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[t],s[t]&&i.appendChild(document.createTextNode(s[t]));return n.outerHTML},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(o,i){var n=e.getDatasetMeta(0),r=n.controller.getStyle(i);return{text:o,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(t.datasets[0].data[i])||n.data[i].hidden,index:i}})):[]}},onClick:function(e,t){var o,i,n,r=t.index,a=this.chart;for(o=0,i=(a.data.datasets||[]).length;o<i;++o)(n=a.getDatasetMeta(o)).data[r].hidden=!n.data[r].hidden;a.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}});var Ye=oe.extend({dataElementType:xe.Arc,linkScales:B.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t,o,i,n=this,r=n.getDataset(),a=n.getMeta(),s=n.chart.options.startAngle||0,l=n._starts=[],c=n._angles=[],u=a.data;for(n._updateRadius(),a.count=n.countVisibleElements(),t=0,o=r.data.length;t<o;t++)l[t]=s,i=n._computeAngle(t),c[t]=i,s+=i;for(t=0,o=u.length;t<o;++t)u[t]._options=n._resolveDataElementOptions(u[t],t),n.updateElement(u[t],t,e)},_updateRadius:function(){var e=this,t=e.chart,o=t.chartArea,i=t.options,n=Math.min(o.right-o.left,o.bottom-o.top);t.outerRadius=Math.max(n/2,0),t.innerRadius=Math.max(i.cutoutPercentage?t.outerRadius/100*i.cutoutPercentage:1,0),t.radiusLength=(t.outerRadius-t.innerRadius)/t.getVisibleDatasetCount(),e.outerRadius=t.outerRadius-t.radiusLength*e.index,e.innerRadius=e.outerRadius-t.radiusLength},updateElement:function(e,t,o){var i=this,n=i.chart,r=i.getDataset(),a=n.options,s=a.animation,l=n.scale,c=n.data.labels,u=l.xCenter,d=l.yCenter,h=a.startAngle,p=e.hidden?0:l.getDistanceFromCenterForValue(r.data[t]),f=i._starts[t],m=f+(e.hidden?0:i._angles[t]),g=s.animateScale?0:l.getDistanceFromCenterForValue(r.data[t]),v=e._options||{};B.extend(e,{_datasetIndex:i.index,_index:t,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:u,y:d,innerRadius:0,outerRadius:o?g:p,startAngle:o&&s.animateRotate?h:f,endAngle:o&&s.animateRotate?h:m,label:B.valueAtIndexOrDefault(c,t,c[t])}}),e.pivot()},countVisibleElements:function(){var e=this.getDataset(),t=this.getMeta(),o=0;return B.each(t.data,(function(t,i){isNaN(e.data[i])||t.hidden||o++})),o},setHoverStyle:function(e){var t=e._model,o=e._options,i=B.getHoverColor,n=B.valueOrDefault;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=n(o.hoverBackgroundColor,i(o.backgroundColor)),t.borderColor=n(o.hoverBorderColor,i(o.borderColor)),t.borderWidth=n(o.hoverBorderWidth,o.borderWidth)},_computeAngle:function(e){var t=this,o=this.getMeta().count,i=t.getDataset(),n=t.getMeta();if(isNaN(i.data[e])||n.data[e].hidden)return 0;var r={chart:t.chart,dataIndex:e,dataset:i,datasetIndex:t.index};return qe([t.chart.options.elements.arc.angle,2*Math.PI/o],r,e)}});z._set("pie",B.clone(z.doughnut)),z._set("pie",{cutoutPercentage:0});var Ue=Ie,Xe=B.valueOrDefault;z._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var Je=oe.extend({datasetElementType:xe.Line,dataElementType:xe.Point,linkScales:B.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t,o,i=this,n=i.getMeta(),r=n.dataset,a=n.data||[],s=i.chart.scale,l=i._config;for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=s,r._datasetIndex=i.index,r._children=a,r._loop=!0,r._model=i._resolveDatasetElementOptions(r),r.pivot(),t=0,o=a.length;t<o;++t)i.updateElement(a[t],t,e);for(i.updateBezierControlPoints(),t=0,o=a.length;t<o;++t)a[t].pivot()},updateElement:function(e,t,o){var i=this,n=e.custom||{},r=i.getDataset(),a=i.chart.scale,s=a.getPointPositionForValue(t,r.data[t]),l=i._resolveDataElementOptions(e,t),c=i.getMeta().dataset._model,u=o?a.xCenter:s.x,d=o?a.yCenter:s.y;e._scale=a,e._options=l,e._datasetIndex=i.index,e._index=t,e._model={x:u,y:d,skip:n.skip||isNaN(u)||isNaN(d),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:Xe(n.tension,c?c.tension:0),hitRadius:l.hitRadius}},_resolveDatasetElementOptions:function(){var e=this,t=e._config,o=e.chart.options,i=oe.prototype._resolveDatasetElementOptions.apply(e,arguments);return i.spanGaps=Xe(t.spanGaps,o.spanGaps),i.tension=Xe(t.lineTension,o.elements.line.tension),i},updateBezierControlPoints:function(){var e,t,o,i,n=this.getMeta(),r=this.chart.chartArea,a=n.data||[];function s(e,t,o){return Math.max(Math.min(e,o),t)}for(n.dataset._model.spanGaps&&(a=a.filter((function(e){return!e._model.skip}))),e=0,t=a.length;e<t;++e)o=a[e]._model,i=B.splineCurve(B.previousItem(a,e,!0)._model,o,B.nextItem(a,e,!0)._model,o.tension),o.controlPointPreviousX=s(i.previous.x,r.left,r.right),o.controlPointPreviousY=s(i.previous.y,r.top,r.bottom),o.controlPointNextX=s(i.next.x,r.left,r.right),o.controlPointNextY=s(i.next.y,r.top,r.bottom)},setHoverStyle:function(e){var t=e._model,o=e._options,i=B.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=Xe(o.hoverBackgroundColor,i(o.backgroundColor)),t.borderColor=Xe(o.hoverBorderColor,i(o.borderColor)),t.borderWidth=Xe(o.hoverBorderWidth,o.borderWidth),t.radius=Xe(o.hoverRadius,o.radius)}});z._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}}),z._set("global",{datasets:{scatter:{showLine:!1}}});var Ke={bar:Re,bubble:Pe,doughnut:Ie,horizontalBar:je,line:Ge,polarArea:Ye,pie:Ue,radar:Je,scatter:Ge};function Ze(e,t){return e.native?{x:e.x,y:e.y}:B.getRelativePosition(e,t)}function Qe(e,t){var o,i,n,r,a,s,l=e._getSortedVisibleDatasetMetas();for(i=0,r=l.length;i<r;++i)for(n=0,a=(o=l[i].data).length;n<a;++n)(s=o[n])._view.skip||t(s)}function et(e,t){var o=[];return Qe(e,(function(e){e.inRange(t.x,t.y)&&o.push(e)})),o}function tt(e,t,o,i){var n=Number.POSITIVE_INFINITY,r=[];return Qe(e,(function(e){if(!o||e.inRange(t.x,t.y)){var a=e.getCenterPoint(),s=i(t,a);s<n?(r=[e],n=s):s===n&&r.push(e)}})),r}function ot(e){var t=-1!==e.indexOf("x"),o=-1!==e.indexOf("y");return function(e,i){var n=t?Math.abs(e.x-i.x):0,r=o?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}}function it(e,t,o){var i=Ze(t,e);o.axis=o.axis||"x";var n=ot(o.axis),r=o.intersect?et(e,i):tt(e,i,!1,n),a=[];return r.length?(e._getSortedVisibleDatasetMetas().forEach((function(e){var t=e.data[r[0]._index];t&&!t._view.skip&&a.push(t)})),a):[]}var nt={modes:{single:function(e,t){var o=Ze(t,e),i=[];return Qe(e,(function(e){if(e.inRange(o.x,o.y))return i.push(e),i})),i.slice(0,1)},label:it,index:it,dataset:function(e,t,o){var i=Ze(t,e);o.axis=o.axis||"xy";var n=ot(o.axis),r=o.intersect?et(e,i):tt(e,i,!1,n);return r.length>0&&(r=e.getDatasetMeta(r[0]._datasetIndex).data),r},"x-axis":function(e,t){return it(e,t,{intersect:!1})},point:function(e,t){return et(e,Ze(t,e))},nearest:function(e,t,o){var i=Ze(t,e);o.axis=o.axis||"xy";var n=ot(o.axis);return tt(e,i,o.intersect,n)},x:function(e,t,o){var i=Ze(t,e),n=[],r=!1;return Qe(e,(function(e){e.inXRange(i.x)&&n.push(e),e.inRange(i.x,i.y)&&(r=!0)})),o.intersect&&!r&&(n=[]),n},y:function(e,t,o){var i=Ze(t,e),n=[],r=!1;return Qe(e,(function(e){e.inYRange(i.y)&&n.push(e),e.inRange(i.x,i.y)&&(r=!0)})),o.intersect&&!r&&(n=[]),n}}},rt=B.extend;function at(e,t){return B.where(e,(function(e){return e.pos===t}))}function st(e,t){return e.sort((function(e,o){var i=t?o:e,n=t?e:o;return i.weight===n.weight?i.index-n.index:i.weight-n.weight}))}function lt(e,t,o,i){return Math.max(e[o],t[o])+Math.max(e[i],t[i])}function ct(e,t,o){var i,n,r=o.box,a=e.maxPadding;if(o.size&&(e[o.pos]-=o.size),o.size=o.horizontal?r.height:r.width,e[o.pos]+=o.size,r.getPadding){var s=r.getPadding();a.top=Math.max(a.top,s.top),a.left=Math.max(a.left,s.left),a.bottom=Math.max(a.bottom,s.bottom),a.right=Math.max(a.right,s.right)}if(i=t.outerWidth-lt(a,e,"left","right"),n=t.outerHeight-lt(a,e,"top","bottom"),i!==e.w||n!==e.h)return e.w=i,e.h=n,o.horizontal?i!==e.w:n!==e.h}function ut(e,t){var o=t.maxPadding;function i(e){var i={left:0,top:0,right:0,bottom:0};return e.forEach((function(e){i[e]=Math.max(t[e],o[e])})),i}return i(e?["left","right"]:["top","bottom"])}function dt(e,t,o){var i,n,r,a,s,l,c=[];for(i=0,n=e.length;i<n;++i)(a=(r=e[i]).box).update(r.width||t.w,r.height||t.h,ut(r.horizontal,t)),ct(t,o,r)&&(l=!0,c.length&&(s=!0)),a.fullWidth||c.push(r);return s&&dt(c,t,o)||l}function ht(e,t,o){var i,n,r,a,s=o.padding,l=t.x,c=t.y;for(i=0,n=e.length;i<n;++i)a=(r=e[i]).box,r.horizontal?(a.left=a.fullWidth?s.left:t.left,a.right=a.fullWidth?o.outerWidth-s.right:t.left+t.w,a.top=c,a.bottom=c+a.height,a.width=a.right-a.left,c=a.bottom):(a.left=l,a.right=l+a.width,a.top=t.top,a.bottom=t.top+t.h,a.height=a.bottom-a.top,l=a.right);t.x=l,t.y=c}z._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var pt,ft={defaults:{},addBox:function(e,t){e.boxes||(e.boxes=[]),t.fullWidth=t.fullWidth||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(){t.draw.apply(t,arguments)}}]},e.boxes.push(t)},removeBox:function(e,t){var o=e.boxes?e.boxes.indexOf(t):-1;-1!==o&&e.boxes.splice(o,1)},configure:function(e,t,o){for(var i,n=["fullWidth","position","weight"],r=n.length,a=0;a<r;++a)i=n[a],o.hasOwnProperty(i)&&(t[i]=o[i])},update:function(e,t,o){if(e){var i=e.options.layout||{},n=B.options.toPadding(i.padding),r=t-n.width,a=o-n.height,s=function(e){var t=function(e){var t,o,i,n=[];for(t=0,o=(e||[]).length;t<o;++t)i=e[t],n.push({index:t,box:i,pos:i.position,horizontal:i.isHorizontal(),weight:i.weight});return n}(e),o=st(at(t,"left"),!0),i=st(at(t,"right")),n=st(at(t,"top"),!0),r=st(at(t,"bottom"));return{leftAndTop:o.concat(n),rightAndBottom:i.concat(r),chartArea:at(t,"chartArea"),vertical:o.concat(i),horizontal:n.concat(r)}}(e.boxes),l=s.vertical,c=s.horizontal,u=Object.freeze({outerWidth:t,outerHeight:o,padding:n,availableWidth:r,vBoxMaxWidth:r/2/l.length,hBoxMaxHeight:a/2}),d=rt({maxPadding:rt({},n),w:r,h:a,x:n.left,y:n.top},n);!function(e,t){var o,i,n;for(o=0,i=e.length;o<i;++o)(n=e[o]).width=n.horizontal?n.box.fullWidth&&t.availableWidth:t.vBoxMaxWidth,n.height=n.horizontal&&t.hBoxMaxHeight}(l.concat(c),u),dt(l,d,u),dt(c,d,u)&&dt(l,d,u),function(e){var t=e.maxPadding;function o(o){var i=Math.max(t[o]-e[o],0);return e[o]+=i,i}e.y+=o("top"),e.x+=o("left"),o("right"),o("bottom")}(d),ht(s.leftAndTop,d,u),d.x+=d.w,d.y+=d.h,ht(s.rightAndBottom,d,u),e.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h},B.each(s.chartArea,(function(t){var o=t.box;rt(o,e.chartArea),o.update(d.w,d.h)}))}}},mt=(pt=Object.freeze({__proto__:null,default:"/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n"}))&&pt.default||pt,gt=["animationstart","webkitAnimationStart"],vt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function bt(e,t){var o=B.getStyle(e,t),i=o&&o.match(/^(\d+)(\.\d+)?px$/);return i?Number(i[1]):void 0}var yt=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("e",null,t)}catch(e){}return e}()&&{passive:!0};function wt(e,t,o){e.addEventListener(t,o,yt)}function xt(e,t,o){e.removeEventListener(t,o,yt)}function Ct(e,t,o,i,n){return{type:e,chart:t,native:n||null,x:void 0!==o?o:null,y:void 0!==i?i:null}}function Et(e){var t=document.createElement("div");return t.className=e||"",t}function kt(e,t,o){var i,n,r,a,s=e.$chartjs||(e.$chartjs={}),l=s.resizer=function(e){var t=Et("chartjs-size-monitor"),o=Et("chartjs-size-monitor-expand"),i=Et("chartjs-size-monitor-shrink");o.appendChild(Et()),i.appendChild(Et()),t.appendChild(o),t.appendChild(i),t._reset=function(){o.scrollLeft=1e6,o.scrollTop=1e6,i.scrollLeft=1e6,i.scrollTop=1e6};var n=function(){t._reset(),e()};return wt(o,"scroll",n.bind(o,"expand")),wt(i,"scroll",n.bind(i,"shrink")),t}((i=function(){if(s.resizer){var i=o.options.maintainAspectRatio&&e.parentNode,n=i?i.clientWidth:0;t(Ct("resize",o)),i&&i.clientWidth<n&&o.canvas&&t(Ct("resize",o))}},r=!1,a=[],function(){a=Array.prototype.slice.call(arguments),n=n||this,r||(r=!0,B.requestAnimFrame.call(window,(function(){r=!1,i.apply(n,a)})))}));!function(e,t){var o=e.$chartjs||(e.$chartjs={}),i=o.renderProxy=function(e){"chartjs-render-animation"===e.animationName&&t()};B.each(gt,(function(t){wt(e,t,i)})),o.reflow=!!e.offsetParent,e.classList.add("chartjs-render-monitor")}(e,(function(){if(s.resizer){var t=e.parentNode;t&&t!==l.parentNode&&t.insertBefore(l,t.firstChild),l._reset()}}))}function Mt(e){var t=e.$chartjs||{},o=t.resizer;delete t.resizer,function(e){var t=e.$chartjs||{},o=t.renderProxy;o&&(B.each(gt,(function(t){xt(e,t,o)})),delete t.renderProxy),e.classList.remove("chartjs-render-monitor")}(e),o&&o.parentNode&&o.parentNode.removeChild(o)}var _t={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(e){if(!this.disableCSSInjection){var t=e.getRootNode?e.getRootNode():document;!function(e,t){var o=e.$chartjs||(e.$chartjs={});if(!o.containsStyles){o.containsStyles=!0,t="/* Chart.js */\n"+t;var i=document.createElement("style");i.setAttribute("type","text/css"),i.appendChild(document.createTextNode(t)),e.appendChild(i)}}(t.host?t:document.head,mt)}},acquireContext:function(e,t){"string"==typeof e?e=document.getElementById(e):e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas);var o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(this._ensureLoaded(e),function(e,t){var o=e.style,i=e.getAttribute("height"),n=e.getAttribute("width");if(e.$chartjs={initial:{height:i,width:n,style:{display:o.display,height:o.height,width:o.width}}},o.display=o.display||"block",null===n||""===n){var r=bt(e,"width");void 0!==r&&(e.width=r)}if(null===i||""===i)if(""===e.style.height)e.height=e.width/(t.options.aspectRatio||2);else{var a=bt(e,"height");void 0!==r&&(e.height=a)}}(e,t),o):null},releaseContext:function(e){var t=e.canvas;if(t.$chartjs){var o=t.$chartjs.initial;["height","width"].forEach((function(e){var i=o[e];B.isNullOrUndef(i)?t.removeAttribute(e):t.setAttribute(e,i)})),B.each(o.style||{},(function(e,o){t.style[o]=e})),t.width=t.width,delete t.$chartjs}},addEventListener:function(e,t,o){var i=e.canvas;if("resize"!==t){var n=o.$chartjs||(o.$chartjs={});wt(i,t,(n.proxies||(n.proxies={}))[e.id+"_"+t]=function(t){o(function(e,t){var o=vt[e.type]||e.type,i=B.getRelativePosition(e,t);return Ct(o,t,i.x,i.y,e)}(t,e))})}else kt(i,o,e)},removeEventListener:function(e,t,o){var i=e.canvas;if("resize"!==t){var n=((o.$chartjs||{}).proxies||{})[e.id+"_"+t];n&&xt(i,t,n)}else Mt(i)}};B.addEvent=wt,B.removeEvent=xt;var Dt=_t._enabled?_t:{acquireContext:function(e){return e&&e.canvas&&(e=e.canvas),e&&e.getContext("2d")||null}},St=B.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},Dt);z._set("global",{plugins:{}});var Rt={_plugins:[],_cacheId:0,register:function(e){var t=this._plugins;[].concat(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),this._cacheId++},unregister:function(e){var t=this._plugins;[].concat(e).forEach((function(e){var o=t.indexOf(e);-1!==o&&t.splice(o,1)})),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(e,t,o){var i,n,r,a,s,l=this.descriptors(e),c=l.length;for(i=0;i<c;++i)if("function"==typeof(s=(r=(n=l[i]).plugin)[t])&&((a=[e].concat(o||[])).push(n.options),!1===s.apply(r,a)))return!1;return!0},descriptors:function(e){var t=e.$plugins||(e.$plugins={});if(t.id===this._cacheId)return t.descriptors;var o=[],i=[],n=e&&e.config||{},r=n.options&&n.options.plugins||{};return this._plugins.concat(n.plugins||[]).forEach((function(e){if(-1===o.indexOf(e)){var t=e.id,n=r[t];!1!==n&&(!0===n&&(n=B.clone(z.global.plugins[t])),o.push(e),i.push({plugin:e,options:n||{}}))}})),t.descriptors=i,t.id=this._cacheId,i},_invalidate:function(e){delete e.$plugins}},Tt={constructors:{},defaults:{},registerScaleType:function(e,t,o){this.constructors[e]=t,this.defaults[e]=B.clone(o)},getScaleConstructor:function(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function(e){return this.defaults.hasOwnProperty(e)?B.merge({},[z.scale,this.defaults[e]]):{}},updateScaleDefaults:function(e,t){this.defaults.hasOwnProperty(e)&&(this.defaults[e]=B.extend(this.defaults[e],t))},addScalesToLayout:function(e){B.each(e.scales,(function(t){t.fullWidth=t.options.fullWidth,t.position=t.options.position,t.weight=t.options.weight,ft.addBox(e,t)}))}},Lt=B.valueOrDefault,Pt=B.rtl.getRtlAdapter;z._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:B.noop,title:function(e,t){var o="",i=t.labels,n=i?i.length:0;if(e.length>0){var r=e[0];r.label?o=r.label:r.xLabel?o=r.xLabel:n>0&&r.index<n&&(o=i[r.index])}return o},afterTitle:B.noop,beforeBody:B.noop,beforeLabel:B.noop,label:function(e,t){var o=t.datasets[e.datasetIndex].label||"";return o&&(o+=": "),B.isNullOrUndef(e.value)?o+=e.yLabel:o+=e.value,o},labelColor:function(e,t){var o=t.getDatasetMeta(e.datasetIndex).data[e.index]._view;return{borderColor:o.borderColor,backgroundColor:o.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:B.noop,afterBody:B.noop,beforeFooter:B.noop,footer:B.noop,afterFooter:B.noop}}});var At={average:function(e){if(!e.length)return!1;var t,o,i=0,n=0,r=0;for(t=0,o=e.length;t<o;++t){var a=e[t];if(a&&a.hasValue()){var s=a.tooltipPosition();i+=s.x,n+=s.y,++r}}return{x:i/r,y:n/r}},nearest:function(e,t){var o,i,n,r=t.x,a=t.y,s=Number.POSITIVE_INFINITY;for(o=0,i=e.length;o<i;++o){var l=e[o];if(l&&l.hasValue()){var c=l.getCenterPoint(),u=B.distanceBetweenPoints(t,c);u<s&&(s=u,n=l)}}if(n){var d=n.tooltipPosition();r=d.x,a=d.y}return{x:r,y:a}}};function Ft(e,t){return t&&(B.isArray(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Ot(e){return("string"==typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function zt(e){var t=z.global;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,rtl:e.rtl,textDirection:e.textDirection,bodyFontColor:e.bodyFontColor,_bodyFontFamily:Lt(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:Lt(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:Lt(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:Lt(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:Lt(e.titleFontStyle,t.defaultFontStyle),titleFontSize:Lt(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:Lt(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:Lt(e.footerFontStyle,t.defaultFontStyle),footerFontSize:Lt(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}function It(e,t){return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-e.xPadding:e.x+e.xPadding}function jt(e){return Ft([],Ot(e))}var Nt=U.extend({initialize:function(){this._model=zt(this._options),this._lastActive=[]},getTitle:function(){var e=this,t=e._options,o=t.callbacks,i=o.beforeTitle.apply(e,arguments),n=o.title.apply(e,arguments),r=o.afterTitle.apply(e,arguments),a=[];return a=Ft(a,Ot(i)),a=Ft(a,Ot(n)),a=Ft(a,Ot(r))},getBeforeBody:function(){return jt(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(e,t){var o=this,i=o._options.callbacks,n=[];return B.each(e,(function(e){var r={before:[],lines:[],after:[]};Ft(r.before,Ot(i.beforeLabel.call(o,e,t))),Ft(r.lines,i.label.call(o,e,t)),Ft(r.after,Ot(i.afterLabel.call(o,e,t))),n.push(r)})),n},getAfterBody:function(){return jt(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var e=this,t=e._options.callbacks,o=t.beforeFooter.apply(e,arguments),i=t.footer.apply(e,arguments),n=t.afterFooter.apply(e,arguments),r=[];return r=Ft(r,Ot(o)),r=Ft(r,Ot(i)),r=Ft(r,Ot(n))},update:function(e){var t,o,i,n,r,a,s,l,c,u,d=this,h=d._options,p=d._model,f=d._model=zt(h),m=d._active,g=d._data,v={xAlign:p.xAlign,yAlign:p.yAlign},b={x:p.x,y:p.y},y={width:p.width,height:p.height},w={x:p.caretX,y:p.caretY};if(m.length){f.opacity=1;var x=[],C=[];w=At[h.position].call(d,m,d._eventPosition);var E=[];for(t=0,o=m.length;t<o;++t)E.push((i=m[t],n=void 0,r=void 0,a=void 0,s=void 0,l=void 0,c=void 0,u=void 0,n=i._xScale,r=i._yScale||i._scale,a=i._index,s=i._datasetIndex,l=i._chart.getDatasetMeta(s).controller,c=l._getIndexScale(),u=l._getValueScale(),{xLabel:n?n.getLabelForIndex(a,s):"",yLabel:r?r.getLabelForIndex(a,s):"",label:c?""+c.getLabelForIndex(a,s):"",value:u?""+u.getLabelForIndex(a,s):"",index:a,datasetIndex:s,x:i._model.x,y:i._model.y}));h.filter&&(E=E.filter((function(e){return h.filter(e,g)}))),h.itemSort&&(E=E.sort((function(e,t){return h.itemSort(e,t,g)}))),B.each(E,(function(e){x.push(h.callbacks.labelColor.call(d,e,d._chart)),C.push(h.callbacks.labelTextColor.call(d,e,d._chart))})),f.title=d.getTitle(E,g),f.beforeBody=d.getBeforeBody(E,g),f.body=d.getBody(E,g),f.afterBody=d.getAfterBody(E,g),f.footer=d.getFooter(E,g),f.x=w.x,f.y=w.y,f.caretPadding=h.caretPadding,f.labelColors=x,f.labelTextColors=C,f.dataPoints=E,y=function(e,t){var o=e._chart.ctx,i=2*t.yPadding,n=0,r=t.body,a=r.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0);a+=t.beforeBody.length+t.afterBody.length;var s=t.title.length,l=t.footer.length,c=t.titleFontSize,u=t.bodyFontSize,d=t.footerFontSize;i+=s*c,i+=s?(s-1)*t.titleSpacing:0,i+=s?t.titleMarginBottom:0,i+=a*u,i+=a?(a-1)*t.bodySpacing:0,i+=l?t.footerMarginTop:0,i+=l*d,i+=l?(l-1)*t.footerSpacing:0;var h=0,p=function(e){n=Math.max(n,o.measureText(e).width+h)};return o.font=B.fontString(c,t._titleFontStyle,t._titleFontFamily),B.each(t.title,p),o.font=B.fontString(u,t._bodyFontStyle,t._bodyFontFamily),B.each(t.beforeBody.concat(t.afterBody),p),h=t.displayColors?u+2:0,B.each(r,(function(e){B.each(e.before,p),B.each(e.lines,p),B.each(e.after,p)})),h=0,o.font=B.fontString(d,t._footerFontStyle,t._footerFontFamily),B.each(t.footer,p),{width:n+=2*t.xPadding,height:i}}(this,f),b=function(e,t,o,i){var n=e.x,r=e.y,a=e.caretSize,s=e.caretPadding,l=e.cornerRadius,c=o.xAlign,u=o.yAlign,d=a+s,h=l+s;return"right"===c?n-=t.width:"center"===c&&((n-=t.width/2)+t.width>i.width&&(n=i.width-t.width),n<0&&(n=0)),"top"===u?r+=d:r-="bottom"===u?t.height+d:t.height/2,"center"===u?"left"===c?n+=d:"right"===c&&(n-=d):"left"===c?n-=h:"right"===c&&(n+=h),{x:n,y:r}}(f,y,v=function(e,t){var o,i,n,r,a,s=e._model,l=e._chart,c=e._chart.chartArea,u="center",d="center";s.y<t.height?d="top":s.y>l.height-t.height&&(d="bottom");var h=(c.left+c.right)/2,p=(c.top+c.bottom)/2;"center"===d?(o=function(e){return e<=h},i=function(e){return e>h}):(o=function(e){return e<=t.width/2},i=function(e){return e>=l.width-t.width/2}),n=function(e){return e+t.width+s.caretSize+s.caretPadding>l.width},r=function(e){return e-t.width-s.caretSize-s.caretPadding<0},a=function(e){return e<=p?"top":"bottom"},o(s.x)?(u="left",n(s.x)&&(u="center",d=a(s.y))):i(s.x)&&(u="right",r(s.x)&&(u="center",d=a(s.y)));var f=e._options;return{xAlign:f.xAlign?f.xAlign:u,yAlign:f.yAlign?f.yAlign:d}}(this,y),d._chart)}else f.opacity=0;return f.xAlign=v.xAlign,f.yAlign=v.yAlign,f.x=b.x,f.y=b.y,f.width=y.width,f.height=y.height,f.caretX=w.x,f.caretY=w.y,d._model=f,e&&h.custom&&h.custom.call(d,f),d},drawCaret:function(e,t){var o=this._chart.ctx,i=this._view,n=this.getCaretPosition(e,t,i);o.lineTo(n.x1,n.y1),o.lineTo(n.x2,n.y2),o.lineTo(n.x3,n.y3)},getCaretPosition:function(e,t,o){var i,n,r,a,s,l,c=o.caretSize,u=o.cornerRadius,d=o.xAlign,h=o.yAlign,p=e.x,f=e.y,m=t.width,g=t.height;if("center"===h)s=f+g/2,"left"===d?(n=(i=p)-c,r=i,a=s+c,l=s-c):(n=(i=p+m)+c,r=i,a=s-c,l=s+c);else if("left"===d?(i=(n=p+u+c)-c,r=n+c):"right"===d?(i=(n=p+m-u-c)-c,r=n+c):(i=(n=o.caretX)-c,r=n+c),"top"===h)s=(a=f)-c,l=a;else{s=(a=f+g)+c,l=a;var v=r;r=i,i=v}return{x1:i,x2:n,x3:r,y1:a,y2:s,y3:l}},drawTitle:function(e,t,o){var i,n,r,a=t.title,s=a.length;if(s){var l=Pt(t.rtl,t.x,t.width);for(e.x=It(t,t._titleAlign),o.textAlign=l.textAlign(t._titleAlign),o.textBaseline="middle",i=t.titleFontSize,n=t.titleSpacing,o.fillStyle=t.titleFontColor,o.font=B.fontString(i,t._titleFontStyle,t._titleFontFamily),r=0;r<s;++r)o.fillText(a[r],l.x(e.x),e.y+i/2),e.y+=i+n,r+1===s&&(e.y+=t.titleMarginBottom-n)}},drawBody:function(e,t,o){var i,n,r,a,s,l,c,u,d=t.bodyFontSize,h=t.bodySpacing,p=t._bodyAlign,f=t.body,m=t.displayColors,g=0,v=m?It(t,"left"):0,b=Pt(t.rtl,t.x,t.width),y=function(t){o.fillText(t,b.x(e.x+g),e.y+d/2),e.y+=d+h},w=b.textAlign(p);for(o.textAlign=p,o.textBaseline="middle",o.font=B.fontString(d,t._bodyFontStyle,t._bodyFontFamily),e.x=It(t,w),o.fillStyle=t.bodyFontColor,B.each(t.beforeBody,y),g=m&&"right"!==w?"center"===p?d/2+1:d+2:0,s=0,c=f.length;s<c;++s){for(i=f[s],n=t.labelTextColors[s],r=t.labelColors[s],o.fillStyle=n,B.each(i.before,y),l=0,u=(a=i.lines).length;l<u;++l){if(m){var x=b.x(v);o.fillStyle=t.legendColorBackground,o.fillRect(b.leftForLtr(x,d),e.y,d,d),o.lineWidth=1,o.strokeStyle=r.borderColor,o.strokeRect(b.leftForLtr(x,d),e.y,d,d),o.fillStyle=r.backgroundColor,o.fillRect(b.leftForLtr(b.xPlus(x,1),d-2),e.y+1,d-2,d-2),o.fillStyle=n}y(a[l])}B.each(i.after,y)}g=0,B.each(t.afterBody,y),e.y-=h},drawFooter:function(e,t,o){var i,n,r=t.footer,a=r.length;if(a){var s=Pt(t.rtl,t.x,t.width);for(e.x=It(t,t._footerAlign),e.y+=t.footerMarginTop,o.textAlign=s.textAlign(t._footerAlign),o.textBaseline="middle",i=t.footerFontSize,o.fillStyle=t.footerFontColor,o.font=B.fontString(i,t._footerFontStyle,t._footerFontFamily),n=0;n<a;++n)o.fillText(r[n],s.x(e.x),e.y+i/2),e.y+=i+t.footerSpacing}},drawBackground:function(e,t,o,i){o.fillStyle=t.backgroundColor,o.strokeStyle=t.borderColor,o.lineWidth=t.borderWidth;var n=t.xAlign,r=t.yAlign,a=e.x,s=e.y,l=i.width,c=i.height,u=t.cornerRadius;o.beginPath(),o.moveTo(a+u,s),"top"===r&&this.drawCaret(e,i),o.lineTo(a+l-u,s),o.quadraticCurveTo(a+l,s,a+l,s+u),"center"===r&&"right"===n&&this.drawCaret(e,i),o.lineTo(a+l,s+c-u),o.quadraticCurveTo(a+l,s+c,a+l-u,s+c),"bottom"===r&&this.drawCaret(e,i),o.lineTo(a+u,s+c),o.quadraticCurveTo(a,s+c,a,s+c-u),"center"===r&&"left"===n&&this.drawCaret(e,i),o.lineTo(a,s+u),o.quadraticCurveTo(a,s,a+u,s),o.closePath(),o.fill(),t.borderWidth>0&&o.stroke()},draw:function(){var e=this._chart.ctx,t=this._view;if(0!==t.opacity){var o={width:t.width,height:t.height},i={x:t.x,y:t.y},n=Math.abs(t.opacity<.001)?0:t.opacity,r=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;this._options.enabled&&r&&(e.save(),e.globalAlpha=n,this.drawBackground(i,t,e,o),i.y+=t.yPadding,B.rtl.overrideTextDirection(e,t.textDirection),this.drawTitle(i,t,e),this.drawBody(i,t,e),this.drawFooter(i,t,e),B.rtl.restoreTextDirection(e,t.textDirection),e.restore())}},handleEvent:function(e){var t,o=this,i=o._options;return o._lastActive=o._lastActive||[],"mouseout"===e.type?o._active=[]:(o._active=o._chart.getElementsAtEventForMode(e,i.mode,i),i.reverse&&o._active.reverse()),(t=!B.arrayEquals(o._active,o._lastActive))&&(o._lastActive=o._active,(i.enabled||i.custom)&&(o._eventPosition={x:e.x,y:e.y},o.update(!0),o.pivot())),t}}),Ht=At,Bt=Nt;Bt.positioners=Ht;var Vt=B.valueOrDefault;function Wt(){return B.merge({},[].slice.call(arguments),{merger:function(e,t,o,i){if("xAxes"===e||"yAxes"===e){var n,r,a,s=o[e].length;for(t[e]||(t[e]=[]),n=0;n<s;++n)a=o[e][n],r=Vt(a.type,"xAxes"===e?"category":"linear"),n>=t[e].length&&t[e].push({}),!t[e][n].type||a.type&&a.type!==t[e][n].type?B.merge(t[e][n],[Tt.getScaleDefaults(r),a]):B.merge(t[e][n],a)}else B._merger(e,t,o,i)}})}function $t(){return B.merge({},[].slice.call(arguments),{merger:function(e,t,o,i){var n=t[e]||{},r=o[e];"scales"===e?t[e]=Wt(n,r):"scale"===e?t[e]=B.merge(n,[Tt.getScaleDefaults(r.type),r]):B._merger(e,t,o,i)}})}function Gt(e){var t=e.options;B.each(e.scales,(function(t){ft.removeBox(e,t)})),t=$t(z.global,z[e.config.type],t),e.options=e.config.options=t,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=t.tooltips,e.tooltip.initialize()}function qt(e,t,o){var i,n=function(e){return e.id===i};do{i=t+o++}while(B.findIndex(e,n)>=0);return i}function Yt(e){return"top"===e||"bottom"===e}function Ut(e,t){return function(o,i){return o[e]===i[e]?o[t]-i[t]:o[e]-i[e]}}z._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var Xt=function(e,t){return this.construct(e,t),this};B.extend(Xt.prototype,{construct:function(e,t){var o=this;t=function(e){var t=(e=e||{}).data=e.data||{};return t.datasets=t.datasets||[],t.labels=t.labels||[],e.options=$t(z.global,z[e.type],e.options||{}),e}(t);var i=St.acquireContext(e,t),n=i&&i.canvas,r=n&&n.height,a=n&&n.width;o.id=B.uid(),o.ctx=i,o.canvas=n,o.config=t,o.width=a,o.height=r,o.aspectRatio=r?a/r:null,o.options=t.options,o._bufferedRender=!1,o._layers=[],o.chart=o,o.controller=o,Xt.instances[o.id]=o,Object.defineProperty(o,"data",{get:function(){return o.config.data},set:function(e){o.config.data=e}}),i&&n?(o.initialize(),o.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var e=this;return Rt.notify(e,"beforeInit"),B.retinaScale(e,e.options.devicePixelRatio),e.bindEvents(),e.options.responsive&&e.resize(!0),e.initToolTip(),Rt.notify(e,"afterInit"),e},clear:function(){return B.canvas.clear(this),this},stop:function(){return K.cancelAnimation(this),this},resize:function(e){var t=this,o=t.options,i=t.canvas,n=o.maintainAspectRatio&&t.aspectRatio||null,r=Math.max(0,Math.floor(B.getMaximumWidth(i))),a=Math.max(0,Math.floor(n?r/n:B.getMaximumHeight(i)));if((t.width!==r||t.height!==a)&&(i.width=t.width=r,i.height=t.height=a,i.style.width=r+"px",i.style.height=a+"px",B.retinaScale(t,o.devicePixelRatio),!e)){var s={width:r,height:a};Rt.notify(t,"resize",[s]),o.onResize&&o.onResize(t,s),t.stop(),t.update({duration:o.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var e=this.options,t=e.scales||{},o=e.scale;B.each(t.xAxes,(function(e,o){e.id||(e.id=qt(t.xAxes,"x-axis-",o))})),B.each(t.yAxes,(function(e,o){e.id||(e.id=qt(t.yAxes,"y-axis-",o))})),o&&(o.id=o.id||"scale")},buildOrUpdateScales:function(){var e=this,t=e.options,o=e.scales||{},i=[],n=Object.keys(o).reduce((function(e,t){return e[t]=!1,e}),{});t.scales&&(i=i.concat((t.scales.xAxes||[]).map((function(e){return{options:e,dtype:"category",dposition:"bottom"}})),(t.scales.yAxes||[]).map((function(e){return{options:e,dtype:"linear",dposition:"left"}})))),t.scale&&i.push({options:t.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),B.each(i,(function(t){var i=t.options,r=i.id,a=Vt(i.type,t.dtype);Yt(i.position)!==Yt(t.dposition)&&(i.position=t.dposition),n[r]=!0;var s=null;if(r in o&&o[r].type===a)(s=o[r]).options=i,s.ctx=e.ctx,s.chart=e;else{var l=Tt.getScaleConstructor(a);if(!l)return;s=new l({id:r,type:a,options:i,ctx:e.ctx,chart:e}),o[s.id]=s}s.mergeTicksOptions(),t.isDefault&&(e.scale=s)})),B.each(n,(function(e,t){e||delete o[t]})),e.scales=o,Tt.addScalesToLayout(this)},buildOrUpdateControllers:function(){var e,t,o=this,i=[],n=o.data.datasets;for(e=0,t=n.length;e<t;e++){var r=n[e],a=o.getDatasetMeta(e),s=r.type||o.config.type;if(a.type&&a.type!==s&&(o.destroyDatasetMeta(e),a=o.getDatasetMeta(e)),a.type=s,a.order=r.order||0,a.index=e,a.controller)a.controller.updateIndex(e),a.controller.linkScales();else{var l=Ke[a.type];if(void 0===l)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new l(o,e),i.push(a.controller)}}return i},resetElements:function(){var e=this;B.each(e.data.datasets,(function(t,o){e.getDatasetMeta(o).controller.reset()}),e)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(e){var t,o,i=this;if(e&&"object"==typeof e||(e={duration:e,lazy:arguments[1]}),Gt(i),Rt._invalidate(i),!1!==Rt.notify(i,"beforeUpdate")){i.tooltip._data=i.data;var n=i.buildOrUpdateControllers();for(t=0,o=i.data.datasets.length;t<o;t++)i.getDatasetMeta(t).controller.buildOrUpdateElements();i.updateLayout(),i.options.animation&&i.options.animation.duration&&B.each(n,(function(e){e.reset()})),i.updateDatasets(),i.tooltip.initialize(),i.lastActive=[],Rt.notify(i,"afterUpdate"),i._layers.sort(Ut("z","_idx")),i._bufferedRender?i._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}:i.render(e)}},updateLayout:function(){var e=this;!1!==Rt.notify(e,"beforeLayout")&&(ft.update(this,this.width,this.height),e._layers=[],B.each(e.boxes,(function(t){t._configure&&t._configure(),e._layers.push.apply(e._layers,t._layers())}),e),e._layers.forEach((function(e,t){e._idx=t})),Rt.notify(e,"afterScaleUpdate"),Rt.notify(e,"afterLayout"))},updateDatasets:function(){if(!1!==Rt.notify(this,"beforeDatasetsUpdate")){for(var e=0,t=this.data.datasets.length;e<t;++e)this.updateDataset(e);Rt.notify(this,"afterDatasetsUpdate")}},updateDataset:function(e){var t=this.getDatasetMeta(e),o={meta:t,index:e};!1!==Rt.notify(this,"beforeDatasetUpdate",[o])&&(t.controller._update(),Rt.notify(this,"afterDatasetUpdate",[o]))},render:function(e){var t=this;e&&"object"==typeof e||(e={duration:e,lazy:arguments[1]});var o=t.options.animation,i=Vt(e.duration,o&&o.duration),n=e.lazy;if(!1!==Rt.notify(t,"beforeRender")){var r=function(e){Rt.notify(t,"afterRender"),B.callback(o&&o.onComplete,[e],t)};if(o&&i){var a=new J({numSteps:i/16.66,easing:e.easing||o.easing,render:function(e,t){var o=B.easing.effects[t.easing],i=t.currentStep,n=i/t.numSteps;e.draw(o(n),n,i)},onAnimationProgress:o.onProgress,onAnimationComplete:r});K.addAnimation(t,a,i,n)}else t.draw(),r(new J({numSteps:0,chart:t}));return t}},draw:function(e){var t,o,i=this;if(i.clear(),B.isNullOrUndef(e)&&(e=1),i.transition(e),!(i.width<=0||i.height<=0)&&!1!==Rt.notify(i,"beforeDraw",[e])){for(o=i._layers,t=0;t<o.length&&o[t].z<=0;++t)o[t].draw(i.chartArea);for(i.drawDatasets(e);t<o.length;++t)o[t].draw(i.chartArea);i._drawTooltip(e),Rt.notify(i,"afterDraw",[e])}},transition:function(e){for(var t=0,o=(this.data.datasets||[]).length;t<o;++t)this.isDatasetVisible(t)&&this.getDatasetMeta(t).controller.transition(e);this.tooltip.transition(e)},_getSortedDatasetMetas:function(e){var t,o,i=[];for(t=0,o=(this.data.datasets||[]).length;t<o;++t)e&&!this.isDatasetVisible(t)||i.push(this.getDatasetMeta(t));return i.sort(Ut("order","index")),i},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(e){var t,o;if(!1!==Rt.notify(this,"beforeDatasetsDraw",[e])){for(o=(t=this._getSortedVisibleDatasetMetas()).length-1;o>=0;--o)this.drawDataset(t[o],e);Rt.notify(this,"afterDatasetsDraw",[e])}},drawDataset:function(e,t){var o={meta:e,index:e.index,easingValue:t};!1!==Rt.notify(this,"beforeDatasetDraw",[o])&&(e.controller.draw(t),Rt.notify(this,"afterDatasetDraw",[o]))},_drawTooltip:function(e){var t=this.tooltip,o={tooltip:t,easingValue:e};!1!==Rt.notify(this,"beforeTooltipDraw",[o])&&(t.draw(),Rt.notify(this,"afterTooltipDraw",[o]))},getElementAtEvent:function(e){return nt.modes.single(this,e)},getElementsAtEvent:function(e){return nt.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return nt.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,t,o){var i=nt.modes[t];return"function"==typeof i?i(this,e,o):[]},getDatasetAtEvent:function(e){return nt.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(e){var t=this.data.datasets[e];t._meta||(t._meta={});var o=t._meta[this.id];return o||(o=t._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t.order||0,index:e}),o},getVisibleDatasetCount:function(){for(var e=0,t=0,o=this.data.datasets.length;t<o;++t)this.isDatasetVisible(t)&&e++;return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return"boolean"==typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(e){var t=this.id,o=this.data.datasets[e],i=o._meta&&o._meta[t];i&&(i.controller.destroy(),delete o._meta[t])},destroy:function(){var e,t,o=this,i=o.canvas;for(o.stop(),e=0,t=o.data.datasets.length;e<t;++e)o.destroyDatasetMeta(e);i&&(o.unbindEvents(),B.canvas.clear(o),St.releaseContext(o.ctx),o.canvas=null,o.ctx=null),Rt.notify(o,"destroy"),delete Xt.instances[o.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var e=this;e.tooltip=new Bt({_chart:e,_chartInstance:e,_data:e.data,_options:e.options.tooltips},e)},bindEvents:function(){var e=this,t=e._listeners={},o=function(){e.eventHandler.apply(e,arguments)};B.each(e.options.events,(function(i){St.addEventListener(e,i,o),t[i]=o})),e.options.responsive&&(o=function(){e.resize()},St.addEventListener(e,"resize",o),t.resize=o)},unbindEvents:function(){var e=this,t=e._listeners;t&&(delete e._listeners,B.each(t,(function(t,o){St.removeEventListener(e,o,t)})))},updateHoverStyle:function(e,t,o){var i,n,r,a=o?"set":"remove";for(n=0,r=e.length;n<r;++n)(i=e[n])&&this.getDatasetMeta(i._datasetIndex).controller[a+"HoverStyle"](i);"dataset"===t&&this.getDatasetMeta(e[0]._datasetIndex).controller["_"+a+"DatasetHoverStyle"]()},eventHandler:function(e){var t=this,o=t.tooltip;if(!1!==Rt.notify(t,"beforeEvent",[e])){t._bufferedRender=!0,t._bufferedRequest=null;var i=t.handleEvent(e);o&&(i=o._start?o.handleEvent(e):i|o.handleEvent(e)),Rt.notify(t,"afterEvent",[e]);var n=t._bufferedRequest;return n?t.render(n):i&&!t.animating&&(t.stop(),t.render({duration:t.options.hover.animationDuration,lazy:!0})),t._bufferedRender=!1,t._bufferedRequest=null,t}},handleEvent:function(e){var t,o=this,i=o.options||{},n=i.hover;return o.lastActive=o.lastActive||[],"mouseout"===e.type?o.active=[]:o.active=o.getElementsAtEventForMode(e,n.mode,n),B.callback(i.onHover||i.hover.onHover,[e.native,o.active],o),"mouseup"!==e.type&&"click"!==e.type||i.onClick&&i.onClick.call(o,e.native,o.active),o.lastActive.length&&o.updateHoverStyle(o.lastActive,n.mode,!1),o.active.length&&n.mode&&o.updateHoverStyle(o.active,n.mode,!0),t=!B.arrayEquals(o.active,o.lastActive),o.lastActive=o.active,t}}),Xt.instances={};var Jt=Xt;function Kt(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function Zt(e){this.options=e||{}}Xt.Controller=Xt,Xt.types={},B.configMerge=$t,B.scaleMerge=Wt,B.extend(Zt.prototype,{formats:Kt,parse:Kt,format:Kt,add:Kt,diff:Kt,startOf:Kt,endOf:Kt,_create:function(e){return e}}),Zt.override=function(e){B.extend(Zt.prototype,e)};var Qt={_date:Zt},eo={formatters:{values:function(e){return B.isArray(e)?e:""+e},linear:function(e,t,o){var i=o.length>3?o[2]-o[1]:o[1]-o[0];Math.abs(i)>1&&e!==Math.floor(e)&&(i=e-Math.floor(e));var n=B.log10(Math.abs(i)),r="";if(0!==e)if(Math.max(Math.abs(o[0]),Math.abs(o[o.length-1]))<1e-4){var a=B.log10(Math.abs(e)),s=Math.floor(a)-Math.floor(n);s=Math.max(Math.min(s,20),0),r=e.toExponential(s)}else{var l=-1*Math.floor(n);l=Math.max(Math.min(l,20),0),r=e.toFixed(l)}else r="0";return r},logarithmic:function(e,t,o){var i=e/Math.pow(10,Math.floor(B.log10(e)));return 0===e?"0":1===i||2===i||5===i||0===t||t===o.length-1?e.toExponential():""}}},to=B.isArray,oo=B.isNullOrUndef,io=B.valueOrDefault,no=B.valueAtIndexOrDefault;function ro(e,t,o){var i,n=e.getTicks().length,r=Math.min(t,n-1),a=e.getPixelForTick(r),s=e._startPixel,l=e._endPixel;if(!(o&&(i=1===n?Math.max(a-s,l-a):0===t?(e.getPixelForTick(1)-a)/2:(a-e.getPixelForTick(r-1))/2,(a+=r<t?i:-i)<s-1e-6||a>l+1e-6)))return a}function ao(e,t,o,i){var n,r,a,s,l,c,u,d,h,p,f,m,g,v=o.length,b=[],y=[],w=[];for(n=0;n<v;++n){if(s=o[n].label,l=o[n].major?t.major:t.minor,e.font=c=l.string,u=i[c]=i[c]||{data:{},gc:[]},d=l.lineHeight,h=p=0,oo(s)||to(s)){if(to(s))for(r=0,a=s.length;r<a;++r)f=s[r],oo(f)||to(f)||(h=B.measureText(e,u.data,u.gc,h,f),p+=d)}else h=B.measureText(e,u.data,u.gc,h,s),p=d;b.push(h),y.push(p),w.push(d/2)}function x(e){return{width:b[e]||0,height:y[e]||0,offset:w[e]||0}}return function(e,t){B.each(e,(function(e){var o,i=e.gc,n=i.length/2;if(n>t){for(o=0;o<n;++o)delete e.data[i[o]];i.splice(0,n)}}))}(i,v),m=b.indexOf(Math.max.apply(null,b)),g=y.indexOf(Math.max.apply(null,y)),{first:x(0),last:x(v-1),widest:x(m),highest:x(g)}}function so(e){return e.drawTicks?e.tickMarkLength:0}function lo(e){var t,o;return e.display?(t=B.options._parseFont(e),o=B.options.toPadding(e.padding),t.lineHeight+o.height):0}function co(e,t){return B.extend(B.options._parseFont({fontFamily:io(t.fontFamily,e.fontFamily),fontSize:io(t.fontSize,e.fontSize),fontStyle:io(t.fontStyle,e.fontStyle),lineHeight:io(t.lineHeight,e.lineHeight)}),{color:B.options.resolve([t.fontColor,e.fontColor,z.global.defaultFontColor])})}function uo(e){var t=co(e,e.minor);return{minor:t,major:e.major.enabled?co(e,e.major):t}}function ho(e){var t,o,i,n=[];for(o=0,i=e.length;o<i;++o)void 0!==(t=e[o])._index&&n.push(t);return n}function po(e,t,o,i){var n,r,a,s,l=io(o,0),c=Math.min(io(i,e.length),e.length),u=0;for(t=Math.ceil(t),i&&(t=(n=i-o)/Math.floor(n/t)),s=l;s<0;)u++,s=Math.round(l+u*t);for(r=Math.max(l,0);r<c;r++)a=e[r],r===s?(a._index=r,u++,s=Math.round(l+u*t)):delete a.label}z._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:eo.formatters.values,minor:{},major:{}}});var fo=U.extend({zeroLineIndex:0,getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){B.callback(this.options.beforeUpdate,[this])},update:function(e,t,o){var i,n,r,a,s,l=this,c=l.options.ticks,u=c.sampleSize;if(l.beforeUpdate(),l.maxWidth=e,l.maxHeight=t,l.margins=B.extend({left:0,right:0,top:0,bottom:0},o),l._ticks=null,l.ticks=null,l._labelSizes=null,l._maxLabelLines=0,l.longestLabelWidth=0,l.longestTextCache=l.longestTextCache||{},l._gridLineItems=null,l._labelItems=null,l.beforeSetDimensions(),l.setDimensions(),l.afterSetDimensions(),l.beforeDataLimits(),l.determineDataLimits(),l.afterDataLimits(),l.beforeBuildTicks(),a=l.buildTicks()||[],(!(a=l.afterBuildTicks(a)||a)||!a.length)&&l.ticks)for(a=[],i=0,n=l.ticks.length;i<n;++i)a.push({value:l.ticks[i],major:!1});return l._ticks=a,s=u<a.length,r=l._convertTicksToLabels(s?function(e,t){for(var o=[],i=e.length/t,n=0,r=e.length;n<r;n+=i)o.push(e[Math.floor(n)]);return o}(a,u):a),l._configure(),l.beforeCalculateTickRotation(),l.calculateTickRotation(),l.afterCalculateTickRotation(),l.beforeFit(),l.fit(),l.afterFit(),l._ticksToDraw=c.display&&(c.autoSkip||"auto"===c.source)?l._autoSkip(a):a,s&&(r=l._convertTicksToLabels(l._ticksToDraw)),l.ticks=r,l.afterUpdate(),l.minSize},_configure:function(){var e,t,o=this,i=o.options.ticks.reverse;o.isHorizontal()?(e=o.left,t=o.right):(e=o.top,t=o.bottom,i=!i),o._startPixel=e,o._endPixel=t,o._reversePixels=i,o._length=t-e},afterUpdate:function(){B.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){B.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0},afterSetDimensions:function(){B.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){B.callback(this.options.beforeDataLimits,[this])},determineDataLimits:B.noop,afterDataLimits:function(){B.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){B.callback(this.options.beforeBuildTicks,[this])},buildTicks:B.noop,afterBuildTicks:function(e){var t=this;return to(e)&&e.length?B.callback(t.options.afterBuildTicks,[t,e]):(t.ticks=B.callback(t.options.afterBuildTicks,[t,t.ticks])||t.ticks,e)},beforeTickToLabelConversion:function(){B.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var e=this.options.ticks;this.ticks=this.ticks.map(e.userCallback||e.callback,this)},afterTickToLabelConversion:function(){B.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){B.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var e,t,o,i,n,r,a,s=this,l=s.options,c=l.ticks,u=s.getTicks().length,d=c.minRotation||0,h=c.maxRotation,p=d;!s._isVisible()||!c.display||d>=h||u<=1||!s.isHorizontal()?s.labelRotation=d:(t=(e=s._getLabelSizes()).widest.width,o=e.highest.height-e.highest.offset,i=Math.min(s.maxWidth,s.chart.width-t),t+6>(n=l.offset?s.maxWidth/u:i/(u-1))&&(n=i/(u-(l.offset?.5:1)),r=s.maxHeight-so(l.gridLines)-c.padding-lo(l.scaleLabel),a=Math.sqrt(t*t+o*o),p=B.toDegrees(Math.min(Math.asin(Math.min((e.highest.height+6)/n,1)),Math.asin(Math.min(r/a,1))-Math.asin(o/a))),p=Math.max(d,Math.min(h,p))),s.labelRotation=p)},afterCalculateTickRotation:function(){B.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){B.callback(this.options.beforeFit,[this])},fit:function(){var e=this,t=e.minSize={width:0,height:0},o=e.chart,i=e.options,n=i.ticks,r=i.scaleLabel,a=i.gridLines,s=e._isVisible(),l="bottom"===i.position,c=e.isHorizontal();if(c?t.width=e.maxWidth:s&&(t.width=so(a)+lo(r)),c?s&&(t.height=so(a)+lo(r)):t.height=e.maxHeight,n.display&&s){var u=uo(n),d=e._getLabelSizes(),h=d.first,p=d.last,f=d.widest,m=d.highest,g=.4*u.minor.lineHeight,v=n.padding;if(c){var b=0!==e.labelRotation,y=B.toRadians(e.labelRotation),w=Math.cos(y),x=Math.sin(y),C=x*f.width+w*(m.height-(b?m.offset:0))+(b?0:g);t.height=Math.min(e.maxHeight,t.height+C+v);var E,k,M=e.getPixelForTick(0)-e.left,_=e.right-e.getPixelForTick(e.getTicks().length-1);b?(E=l?w*h.width+x*h.offset:x*(h.height-h.offset),k=l?x*(p.height-p.offset):w*p.width+x*p.offset):(E=h.width/2,k=p.width/2),e.paddingLeft=Math.max((E-M)*e.width/(e.width-M),0)+3,e.paddingRight=Math.max((k-_)*e.width/(e.width-_),0)+3}else{var D=n.mirror?0:f.width+v+g;t.width=Math.min(e.maxWidth,t.width+D),e.paddingTop=h.height/2,e.paddingBottom=p.height/2}}e.handleMargins(),c?(e.width=e._length=o.width-e.margins.left-e.margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=o.height-e.margins.top-e.margins.bottom)},handleMargins:function(){var e=this;e.margins&&(e.margins.left=Math.max(e.paddingLeft,e.margins.left),e.margins.top=Math.max(e.paddingTop,e.margins.top),e.margins.right=Math.max(e.paddingRight,e.margins.right),e.margins.bottom=Math.max(e.paddingBottom,e.margins.bottom))},afterFit:function(){B.callback(this.options.afterFit,[this])},isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(e){if(oo(e))return NaN;if(("number"==typeof e||e instanceof Number)&&!isFinite(e))return NaN;if(e)if(this.isHorizontal()){if(void 0!==e.x)return this.getRightValue(e.x)}else if(void 0!==e.y)return this.getRightValue(e.y);return e},_convertTicksToLabels:function(e){var t,o,i,n=this;for(n.ticks=e.map((function(e){return e.value})),n.beforeTickToLabelConversion(),t=n.convertTicksToLabels(e)||n.ticks,n.afterTickToLabelConversion(),o=0,i=e.length;o<i;++o)e[o].label=t[o];return t},_getLabelSizes:function(){var e=this,t=e._labelSizes;return t||(e._labelSizes=t=ao(e.ctx,uo(e.options.ticks),e.getTicks(),e.longestTextCache),e.longestLabelWidth=t.widest.width),t},_parseValue:function(e){var t,o,i,n;return to(e)?(t=+this.getRightValue(e[0]),o=+this.getRightValue(e[1]),i=Math.min(t,o),n=Math.max(t,o)):(t=void 0,o=e=+this.getRightValue(e),i=e,n=e),{min:i,max:n,start:t,end:o}},_getScaleLabel:function(e){var t=this._parseValue(e);return void 0!==t.start?"["+t.start+", "+t.end+"]":+this.getRightValue(e)},getLabelForIndex:B.noop,getPixelForValue:B.noop,getValueForPixel:B.noop,getPixelForTick:function(e){var t=this.options.offset,o=this._ticks.length,i=1/Math.max(o-(t?0:1),1);return e<0||e>o-1?null:this.getPixelForDecimal(e*i+(t?i/2:0))},getPixelForDecimal:function(e){return this._reversePixels&&(e=1-e),this._startPixel+e*this._length},getDecimalForPixel:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var e=this.min,t=this.max;return this.beginAtZero?0:e<0&&t<0?t:e>0&&t>0?e:0},_autoSkip:function(e){var t,o,i,n,r=this.options.ticks,a=this._length,s=r.maxTicksLimit||a/this._tickSize()+1,l=r.major.enabled?function(e){var t,o,i=[];for(t=0,o=e.length;t<o;t++)e[t].major&&i.push(t);return i}(e):[],c=l.length,u=l[0],d=l[c-1];if(c>s)return function(e,t,o){var i,n,r=0,a=t[0];for(o=Math.ceil(o),i=0;i<e.length;i++)n=e[i],i===a?(n._index=i,a=t[++r*o]):delete n.label}(e,l,c/s),ho(e);if(i=function(e,t,o,i){var n,r,a,s,l=function(e){var t,o,i=e.length;if(i<2)return!1;for(o=e[0],t=1;t<i;++t)if(e[t]-e[t-1]!==o)return!1;return o}(e),c=(t.length-1)/i;if(!l)return Math.max(c,1);for(a=0,s=(n=B.math._factorize(l)).length-1;a<s;a++)if((r=n[a])>c)return r;return Math.max(c,1)}(l,e,0,s),c>0){for(t=0,o=c-1;t<o;t++)po(e,i,l[t],l[t+1]);return n=c>1?(d-u)/(c-1):null,po(e,i,B.isNullOrUndef(n)?0:u-n,u),po(e,i,d,B.isNullOrUndef(n)?e.length:d+n),ho(e)}return po(e,i),ho(e)},_tickSize:function(){var e=this.options.ticks,t=B.toRadians(this.labelRotation),o=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),n=this._getLabelSizes(),r=e.autoSkipPadding||0,a=n?n.widest.width+r:0,s=n?n.highest.height+r:0;return this.isHorizontal()?s*o>a*i?a/o:s/i:s*i<a*o?s/o:a/i},_isVisible:function(){var e,t,o,i=this.chart,n=this.options.display;if("auto"!==n)return!!n;for(e=0,t=i.data.datasets.length;e<t;++e)if(i.isDatasetVisible(e)&&((o=i.getDatasetMeta(e)).xAxisID===this.id||o.yAxisID===this.id))return!0;return!1},_computeGridLineItems:function(e){var t,o,i,n,r,a,s,l,c,u,d,h,p,f,m,g,v,b=this,y=b.chart,w=b.options,x=w.gridLines,C=w.position,E=x.offsetGridLines,k=b.isHorizontal(),M=b._ticksToDraw,_=M.length+(E?1:0),D=so(x),S=[],R=x.drawBorder?no(x.lineWidth,0,0):0,T=R/2,L=B._alignPixel,P=function(e){return L(y,e,R)};for("top"===C?(t=P(b.bottom),s=b.bottom-D,c=t-T,d=P(e.top)+T,p=e.bottom):"bottom"===C?(t=P(b.top),d=e.top,p=P(e.bottom)-T,s=t+T,c=b.top+D):"left"===C?(t=P(b.right),a=b.right-D,l=t-T,u=P(e.left)+T,h=e.right):(t=P(b.left),u=e.left,h=P(e.right)-T,a=t+T,l=b.left+D),o=0;o<_;++o)i=M[o]||{},oo(i.label)&&o<M.length||(o===b.zeroLineIndex&&w.offset===E?(f=x.zeroLineWidth,m=x.zeroLineColor,g=x.zeroLineBorderDash||[],v=x.zeroLineBorderDashOffset||0):(f=no(x.lineWidth,o,1),m=no(x.color,o,"rgba(0,0,0,0.1)"),g=x.borderDash||[],v=x.borderDashOffset||0),void 0!==(n=ro(b,i._index||o,E))&&(r=L(y,n,f),k?a=l=u=h=r:s=c=d=p=r,S.push({tx1:a,ty1:s,tx2:l,ty2:c,x1:u,y1:d,x2:h,y2:p,width:f,color:m,borderDash:g,borderDashOffset:v})));return S.ticksLength=_,S.borderValue=t,S},_computeLabelItems:function(){var e,t,o,i,n,r,a,s,l,c,u,d,h=this,p=h.options,f=p.ticks,m=p.position,g=f.mirror,v=h.isHorizontal(),b=h._ticksToDraw,y=uo(f),w=f.padding,x=so(p.gridLines),C=-B.toRadians(h.labelRotation),E=[];for("top"===m?(r=h.bottom-x-w,a=C?"left":"center"):"bottom"===m?(r=h.top+x+w,a=C?"right":"center"):"left"===m?(n=h.right-(g?0:x)-w,a=g?"left":"right"):(n=h.left+(g?0:x)+w,a=g?"right":"left"),e=0,t=b.length;e<t;++e)i=(o=b[e]).label,oo(i)||(s=h.getPixelForTick(o._index||e)+f.labelOffset,c=(l=o.major?y.major:y.minor).lineHeight,u=to(i)?i.length:1,v?(n=s,d="top"===m?((C?1:.5)-u)*c:(C?0:.5)*c):(r=s,d=(1-u)*c/2),E.push({x:n,y:r,rotation:C,label:i,font:l,textOffset:d,textAlign:a}));return E},_drawGrid:function(e){var t=this,o=t.options.gridLines;if(o.display){var i,n,r,a,s,l=t.ctx,c=t.chart,u=B._alignPixel,d=o.drawBorder?no(o.lineWidth,0,0):0,h=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));for(r=0,a=h.length;r<a;++r)i=(s=h[r]).width,n=s.color,i&&n&&(l.save(),l.lineWidth=i,l.strokeStyle=n,l.setLineDash&&(l.setLineDash(s.borderDash),l.lineDashOffset=s.borderDashOffset),l.beginPath(),o.drawTicks&&(l.moveTo(s.tx1,s.ty1),l.lineTo(s.tx2,s.ty2)),o.drawOnChartArea&&(l.moveTo(s.x1,s.y1),l.lineTo(s.x2,s.y2)),l.stroke(),l.restore());if(d){var p,f,m,g,v=d,b=no(o.lineWidth,h.ticksLength-1,1),y=h.borderValue;t.isHorizontal()?(p=u(c,t.left,v)-v/2,f=u(c,t.right,b)+b/2,m=g=y):(m=u(c,t.top,v)-v/2,g=u(c,t.bottom,b)+b/2,p=f=y),l.lineWidth=d,l.strokeStyle=no(o.color,0),l.beginPath(),l.moveTo(p,m),l.lineTo(f,g),l.stroke()}}},_drawLabels:function(){var e=this;if(e.options.ticks.display){var t,o,i,n,r,a,s,l,c=e.ctx,u=e._labelItems||(e._labelItems=e._computeLabelItems());for(t=0,i=u.length;t<i;++t){if(a=(r=u[t]).font,c.save(),c.translate(r.x,r.y),c.rotate(r.rotation),c.font=a.string,c.fillStyle=a.color,c.textBaseline="middle",c.textAlign=r.textAlign,s=r.label,l=r.textOffset,to(s))for(o=0,n=s.length;o<n;++o)c.fillText(""+s[o],0,l),l+=a.lineHeight;else c.fillText(s,0,l);c.restore()}}},_drawTitle:function(){var e=this,t=e.ctx,o=e.options,i=o.scaleLabel;if(i.display){var n,r,a=io(i.fontColor,z.global.defaultFontColor),s=B.options._parseFont(i),l=B.options.toPadding(i.padding),c=s.lineHeight/2,u=o.position,d=0;if(e.isHorizontal())n=e.left+e.width/2,r="bottom"===u?e.bottom-c-l.bottom:e.top+c+l.top;else{var h="left"===u;n=h?e.left+c+l.top:e.right-c-l.top,r=e.top+e.height/2,d=h?-.5*Math.PI:.5*Math.PI}t.save(),t.translate(n,r),t.rotate(d),t.textAlign="center",t.textBaseline="middle",t.fillStyle=a,t.font=s.string,t.fillText(i.labelString,0,0),t.restore()}},draw:function(e){this._isVisible()&&(this._drawGrid(e),this._drawTitle(),this._drawLabels())},_layers:function(){var e=this,t=e.options,o=t.ticks&&t.ticks.z||0,i=t.gridLines&&t.gridLines.z||0;return e._isVisible()&&o!==i&&e.draw===e._draw?[{z:i,draw:function(){e._drawGrid.apply(e,arguments),e._drawTitle.apply(e,arguments)}},{z:o,draw:function(){e._drawLabels.apply(e,arguments)}}]:[{z:o,draw:function(){e.draw.apply(e,arguments)}}]},_getMatchingVisibleMetas:function(e){var t=this,o=t.isHorizontal();return t.chart._getSortedVisibleDatasetMetas().filter((function(i){return(!e||i.type===e)&&(o?i.xAxisID===t.id:i.yAxisID===t.id)}))}});fo.prototype._draw=fo.prototype.draw;var mo=fo,go=B.isNullOrUndef,vo=mo.extend({determineDataLimits:function(){var e,t=this,o=t._getLabels(),i=t.options.ticks,n=i.min,r=i.max,a=0,s=o.length-1;void 0!==n&&(e=o.indexOf(n))>=0&&(a=e),void 0!==r&&(e=o.indexOf(r))>=0&&(s=e),t.minIndex=a,t.maxIndex=s,t.min=o[a],t.max=o[s]},buildTicks:function(){var e=this._getLabels(),t=this.minIndex,o=this.maxIndex;this.ticks=0===t&&o===e.length-1?e:e.slice(t,o+1)},getLabelForIndex:function(e,t){var o=this.chart;return o.getDatasetMeta(t).controller._getValueScaleId()===this.id?this.getRightValue(o.data.datasets[t].data[e]):this._getLabels()[e]},_configure:function(){var e=this,t=e.options.offset,o=e.ticks;mo.prototype._configure.call(e),e.isHorizontal()||(e._reversePixels=!e._reversePixels),o&&(e._startValue=e.minIndex-(t?.5:0),e._valueRange=Math.max(o.length-(t?0:1),1))},getPixelForValue:function(e,t,o){var i,n,r,a=this;return go(t)||go(o)||(e=a.chart.data.datasets[o].data[t]),go(e)||(i=a.isHorizontal()?e.x:e.y),(void 0!==i||void 0!==e&&isNaN(t))&&(n=a._getLabels(),e=B.valueOrDefault(i,e),t=-1!==(r=n.indexOf(e))?r:t,isNaN(t)&&(t=e)),a.getPixelForDecimal((t-a._startValue)/a._valueRange)},getPixelForTick:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e],e+this.minIndex)},getValueForPixel:function(e){var t=Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange);return Math.min(Math.max(t,0),this.ticks.length-1)},getBasePixel:function(){return this.bottom}}),bo={position:"bottom"};vo._defaults=bo;var yo=B.noop,wo=B.isNullOrUndef,xo=mo.extend({getRightValue:function(e){return"string"==typeof e?+e:mo.prototype.getRightValue.call(this,e)},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;if(t.beginAtZero){var o=B.sign(e.min),i=B.sign(e.max);o<0&&i<0?e.max=0:o>0&&i>0&&(e.min=0)}var n=void 0!==t.min||void 0!==t.suggestedMin,r=void 0!==t.max||void 0!==t.suggestedMax;void 0!==t.min?e.min=t.min:void 0!==t.suggestedMin&&(null===e.min?e.min=t.suggestedMin:e.min=Math.min(e.min,t.suggestedMin)),void 0!==t.max?e.max=t.max:void 0!==t.suggestedMax&&(null===e.max?e.max=t.suggestedMax:e.max=Math.max(e.max,t.suggestedMax)),n!==r&&e.min>=e.max&&(n?e.max=e.min+1:e.min=e.max-1),e.min===e.max&&(e.max++,t.beginAtZero||e.min--)},getTickLimit:function(){var e,t=this.options.ticks,o=t.stepSize,i=t.maxTicksLimit;return o?e=Math.ceil(this.max/o)-Math.floor(this.min/o)+1:(e=this._computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:yo,buildTicks:function(){var e=this,t=e.options.ticks,o=e.getTickLimit(),i={maxTicks:o=Math.max(2,o),min:t.min,max:t.max,precision:t.precision,stepSize:B.valueOrDefault(t.fixedStepSize,t.stepSize)},n=e.ticks=function(e,t){var o,i,n,r,a=[],s=e.stepSize,l=s||1,c=e.maxTicks-1,u=e.min,d=e.max,h=e.precision,p=t.min,f=t.max,m=B.niceNum((f-p)/c/l)*l;if(m<1e-14&&wo(u)&&wo(d))return[p,f];(r=Math.ceil(f/m)-Math.floor(p/m))>c&&(m=B.niceNum(r*m/c/l)*l),s||wo(h)?o=Math.pow(10,B._decimalPlaces(m)):(o=Math.pow(10,h),m=Math.ceil(m*o)/o),i=Math.floor(p/m)*m,n=Math.ceil(f/m)*m,s&&(!wo(u)&&B.almostWhole(u/m,m/1e3)&&(i=u),!wo(d)&&B.almostWhole(d/m,m/1e3)&&(n=d)),r=(n-i)/m,r=B.almostEquals(r,Math.round(r),m/1e3)?Math.round(r):Math.ceil(r),i=Math.round(i*o)/o,n=Math.round(n*o)/o,a.push(wo(u)?i:u);for(var g=1;g<r;++g)a.push(Math.round((i+g*m)*o)/o);return a.push(wo(d)?n:d),a}(i,e);e.handleDirectionalChanges(),e.max=B.max(n),e.min=B.min(n),t.reverse?(n.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){var e=this;e.ticksAsNumbers=e.ticks.slice(),e.zeroLineIndex=e.ticks.indexOf(0),mo.prototype.convertTicksToLabels.call(e)},_configure:function(){var e,t=this,o=t.getTicks(),i=t.min,n=t.max;mo.prototype._configure.call(t),t.options.offset&&o.length&&(i-=e=(n-i)/Math.max(o.length-1,1)/2,n+=e),t._startValue=i,t._endValue=n,t._valueRange=n-i}}),Co={position:"left",ticks:{callback:eo.formatters.linear}};function Eo(e,t,o,i){var n,r,a=e.options,s=function(e,t,o){var i=[o.type,void 0===t&&void 0===o.stack?o.index:"",o.stack].join(".");return void 0===e[i]&&(e[i]={pos:[],neg:[]}),e[i]}(t,a.stacked,o),l=s.pos,c=s.neg,u=i.length;for(n=0;n<u;++n)r=e._parseValue(i[n]),isNaN(r.min)||isNaN(r.max)||o.data[n].hidden||(l[n]=l[n]||0,c[n]=c[n]||0,a.relativePoints?l[n]=100:r.min<0||r.max<0?c[n]+=r.min:l[n]+=r.max)}function ko(e,t,o){var i,n,r=o.length;for(i=0;i<r;++i)n=e._parseValue(o[i]),isNaN(n.min)||isNaN(n.max)||t.data[i].hidden||(e.min=Math.min(e.min,n.min),e.max=Math.max(e.max,n.max))}var Mo=xo.extend({determineDataLimits:function(){var e,t,o,i,n=this,r=n.options,a=n.chart.data.datasets,s=n._getMatchingVisibleMetas(),l=r.stacked,c={},u=s.length;if(n.min=Number.POSITIVE_INFINITY,n.max=Number.NEGATIVE_INFINITY,void 0===l)for(e=0;!l&&e<u;++e)l=void 0!==(t=s[e]).stack;for(e=0;e<u;++e)o=a[(t=s[e]).index].data,l?Eo(n,c,t,o):ko(n,t,o);B.each(c,(function(e){i=e.pos.concat(e.neg),n.min=Math.min(n.min,B.min(i)),n.max=Math.max(n.max,B.max(i))})),n.min=B.isFinite(n.min)&&!isNaN(n.min)?n.min:0,n.max=B.isFinite(n.max)&&!isNaN(n.max)?n.max:1,n.handleTickRangeOptions()},_computeTickLimit:function(){var e;return this.isHorizontal()?Math.ceil(this.width/40):(e=B.options._parseFont(this.options.ticks),Math.ceil(this.height/e.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForValue:function(e){return this.getPixelForDecimal((+this.getRightValue(e)-this._startValue)/this._valueRange)},getValueForPixel:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange},getPixelForTick:function(e){var t=this.ticksAsNumbers;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])}}),_o=Co;Mo._defaults=_o;var Do=B.valueOrDefault,So=B.math.log10,Ro={position:"left",ticks:{callback:eo.formatters.logarithmic}};function To(e,t){return B.isFinite(e)&&e>=0?e:t}var Lo=mo.extend({determineDataLimits:function(){var e,t,o,i,n,r,a=this,s=a.options,l=a.chart,c=l.data.datasets,u=a.isHorizontal();function d(e){return u?e.xAxisID===a.id:e.yAxisID===a.id}a.min=Number.POSITIVE_INFINITY,a.max=Number.NEGATIVE_INFINITY,a.minNotZero=Number.POSITIVE_INFINITY;var h=s.stacked;if(void 0===h)for(e=0;e<c.length;e++)if(t=l.getDatasetMeta(e),l.isDatasetVisible(e)&&d(t)&&void 0!==t.stack){h=!0;break}if(s.stacked||h){var p={};for(e=0;e<c.length;e++){var f=[(t=l.getDatasetMeta(e)).type,void 0===s.stacked&&void 0===t.stack?e:"",t.stack].join(".");if(l.isDatasetVisible(e)&&d(t))for(void 0===p[f]&&(p[f]=[]),n=0,r=(i=c[e].data).length;n<r;n++){var m=p[f];o=a._parseValue(i[n]),isNaN(o.min)||isNaN(o.max)||t.data[n].hidden||o.min<0||o.max<0||(m[n]=m[n]||0,m[n]+=o.max)}}B.each(p,(function(e){if(e.length>0){var t=B.min(e),o=B.max(e);a.min=Math.min(a.min,t),a.max=Math.max(a.max,o)}}))}else for(e=0;e<c.length;e++)if(t=l.getDatasetMeta(e),l.isDatasetVisible(e)&&d(t))for(n=0,r=(i=c[e].data).length;n<r;n++)o=a._parseValue(i[n]),isNaN(o.min)||isNaN(o.max)||t.data[n].hidden||o.min<0||o.max<0||(a.min=Math.min(o.min,a.min),a.max=Math.max(o.max,a.max),0!==o.min&&(a.minNotZero=Math.min(o.min,a.minNotZero)));a.min=B.isFinite(a.min)?a.min:null,a.max=B.isFinite(a.max)?a.max:null,a.minNotZero=B.isFinite(a.minNotZero)?a.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;e.min=To(t.min,e.min),e.max=To(t.max,e.max),e.min===e.max&&(0!==e.min&&null!==e.min?(e.min=Math.pow(10,Math.floor(So(e.min))-1),e.max=Math.pow(10,Math.floor(So(e.max))+1)):(e.min=1,e.max=10)),null===e.min&&(e.min=Math.pow(10,Math.floor(So(e.max))-1)),null===e.max&&(e.max=0!==e.min?Math.pow(10,Math.floor(So(e.min))+1):10),null===e.minNotZero&&(e.min>0?e.minNotZero=e.min:e.max<1?e.minNotZero=Math.pow(10,Math.floor(So(e.max))):e.minNotZero=1)},buildTicks:function(){var e=this,t=e.options.ticks,o=!e.isHorizontal(),i={min:To(t.min),max:To(t.max)},n=e.ticks=function(e,t){var o,i,n=[],r=Do(e.min,Math.pow(10,Math.floor(So(t.min)))),a=Math.floor(So(t.max)),s=Math.ceil(t.max/Math.pow(10,a));0===r?(o=Math.floor(So(t.minNotZero)),i=Math.floor(t.minNotZero/Math.pow(10,o)),n.push(r),r=i*Math.pow(10,o)):(o=Math.floor(So(r)),i=Math.floor(r/Math.pow(10,o)));var l=o<0?Math.pow(10,Math.abs(o)):1;do{n.push(r),10==++i&&(i=1,l=++o>=0?1:l),r=Math.round(i*Math.pow(10,o)*l)/l}while(o<a||o===a&&i<s);var c=Do(e.max,r);return n.push(c),n}(i,e);e.max=B.max(n),e.min=B.min(n),t.reverse?(o=!o,e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),o&&n.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),mo.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e){var t=this.tickValues;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])},_getFirstTickValue:function(e){var t=Math.floor(So(e));return Math.floor(e/Math.pow(10,t))*Math.pow(10,t)},_configure:function(){var e=this,t=e.min,o=0;mo.prototype._configure.call(e),0===t&&(t=e._getFirstTickValue(e.minNotZero),o=Do(e.options.ticks.fontSize,z.global.defaultFontSize)/e._length),e._startValue=So(t),e._valueOffset=o,e._valueRange=(So(e.max)-So(t))/(1-o)},getPixelForValue:function(e){var t=this,o=0;return(e=+t.getRightValue(e))>t.min&&e>0&&(o=(So(e)-t._startValue)/t._valueRange+t._valueOffset),t.getPixelForDecimal(o)},getValueForPixel:function(e){var t=this,o=t.getDecimalForPixel(e);return 0===o&&0===t.min?0:Math.pow(10,t._startValue+(o-t._valueOffset)*t._valueRange)}}),Po=Ro;Lo._defaults=Po;var Ao=B.valueOrDefault,Fo=B.valueAtIndexOrDefault,Oo=B.options.resolve,zo={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:eo.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(e){return e}}};function Io(e){var t=e.ticks;return t.display&&e.display?Ao(t.fontSize,z.global.defaultFontSize)+2*t.backdropPaddingY:0}function jo(e,t,o,i,n){return e===i||e===n?{start:t-o/2,end:t+o/2}:e<i||e>n?{start:t-o,end:t}:{start:t,end:t+o}}function No(e){return 0===e||180===e?"center":e<180?"left":"right"}function Ho(e,t,o,i){var n,r,a=o.y+i/2;if(B.isArray(t))for(n=0,r=t.length;n<r;++n)e.fillText(t[n],o.x,a),a+=i;else e.fillText(t,o.x,a)}function Bo(e,t,o){90===e||270===e?o.y-=t.h/2:(e>270||e<90)&&(o.y-=t.h)}function Vo(e){return B.isNumber(e)?e:0}var Wo=xo.extend({setDimensions:function(){var e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=Io(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2},determineDataLimits:function(){var e=this,t=e.chart,o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;B.each(t.data.datasets,(function(n,r){if(t.isDatasetVisible(r)){var a=t.getDatasetMeta(r);B.each(n.data,(function(t,n){var r=+e.getRightValue(t);isNaN(r)||a.data[n].hidden||(o=Math.min(r,o),i=Math.max(r,i))}))}})),e.min=o===Number.POSITIVE_INFINITY?0:o,e.max=i===Number.NEGATIVE_INFINITY?0:i,e.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Io(this.options))},convertTicksToLabels:function(){var e=this;xo.prototype.convertTicksToLabels.call(e),e.pointLabels=e.chart.data.labels.map((function(){var t=B.callback(e.options.pointLabels.callback,arguments,e);return t||0===t?t:""}))},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){var e=this.options;e.display&&e.pointLabels.display?function(e){var t,o,i,n=B.options._parseFont(e.options.pointLabels),r={l:0,r:e.width,t:0,b:e.height-e.paddingTop},a={};e.ctx.font=n.string,e._pointLabelSizes=[];var s,l,c,u=e.chart.data.labels.length;for(t=0;t<u;t++){i=e.getPointPosition(t,e.drawingArea+5),s=e.ctx,l=n.lineHeight,c=e.pointLabels[t],o=B.isArray(c)?{w:B.longestText(s,s.font,c),h:c.length*l}:{w:s.measureText(c).width,h:l},e._pointLabelSizes[t]=o;var d=e.getIndexAngle(t),h=B.toDegrees(d)%360,p=jo(h,i.x,o.w,0,180),f=jo(h,i.y,o.h,90,270);p.start<r.l&&(r.l=p.start,a.l=d),p.end>r.r&&(r.r=p.end,a.r=d),f.start<r.t&&(r.t=f.start,a.t=d),f.end>r.b&&(r.b=f.end,a.b=d)}e.setReductions(e.drawingArea,r,a)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(e,t,o){var i=this,n=t.l/Math.sin(o.l),r=Math.max(t.r-i.width,0)/Math.sin(o.r),a=-t.t/Math.cos(o.t),s=-Math.max(t.b-(i.height-i.paddingTop),0)/Math.cos(o.b);n=Vo(n),r=Vo(r),a=Vo(a),s=Vo(s),i.drawingArea=Math.min(Math.floor(e-(n+r)/2),Math.floor(e-(a+s)/2)),i.setCenterPoint(n,r,a,s)},setCenterPoint:function(e,t,o,i){var n=this,r=n.width-t-n.drawingArea,a=e+n.drawingArea,s=o+n.drawingArea,l=n.height-n.paddingTop-i-n.drawingArea;n.xCenter=Math.floor((a+r)/2+n.left),n.yCenter=Math.floor((s+l)/2+n.top+n.paddingTop)},getIndexAngle:function(e){var t=this.chart,o=(e*(360/t.data.labels.length)+((t.options||{}).startAngle||0))%360;return(o<0?o+360:o)*Math.PI*2/360},getDistanceFromCenterForValue:function(e){var t=this;if(B.isNullOrUndef(e))return NaN;var o=t.drawingArea/(t.max-t.min);return t.options.ticks.reverse?(t.max-e)*o:(e-t.min)*o},getPointPosition:function(e,t){var o=this.getIndexAngle(e)-Math.PI/2;return{x:Math.cos(o)*t+this.xCenter,y:Math.sin(o)*t+this.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(e){var t=this.min,o=this.max;return this.getPointPositionForValue(e||0,this.beginAtZero?0:t<0&&o<0?o:t>0&&o>0?t:0)},_drawGrid:function(){var e,t,o,i=this,n=i.ctx,r=i.options,a=r.gridLines,s=r.angleLines,l=Ao(s.lineWidth,a.lineWidth),c=Ao(s.color,a.color);if(r.pointLabels.display&&function(e){var t=e.ctx,o=e.options,i=o.pointLabels,n=Io(o),r=e.getDistanceFromCenterForValue(o.ticks.reverse?e.min:e.max),a=B.options._parseFont(i);t.save(),t.font=a.string,t.textBaseline="middle";for(var s=e.chart.data.labels.length-1;s>=0;s--){var l=0===s?n/2:0,c=e.getPointPosition(s,r+l+5),u=Fo(i.fontColor,s,z.global.defaultFontColor);t.fillStyle=u;var d=e.getIndexAngle(s),h=B.toDegrees(d);t.textAlign=No(h),Bo(h,e._pointLabelSizes[s],c),Ho(t,e.pointLabels[s],c,a.lineHeight)}t.restore()}(i),a.display&&B.each(i.ticks,(function(e,o){0!==o&&(t=i.getDistanceFromCenterForValue(i.ticksAsNumbers[o]),function(e,t,o,i){var n,r=e.ctx,a=t.circular,s=e.chart.data.labels.length,l=Fo(t.color,i-1),c=Fo(t.lineWidth,i-1);if((a||s)&&l&&c){if(r.save(),r.strokeStyle=l,r.lineWidth=c,r.setLineDash&&(r.setLineDash(t.borderDash||[]),r.lineDashOffset=t.borderDashOffset||0),r.beginPath(),a)r.arc(e.xCenter,e.yCenter,o,0,2*Math.PI);else{n=e.getPointPosition(0,o),r.moveTo(n.x,n.y);for(var u=1;u<s;u++)n=e.getPointPosition(u,o),r.lineTo(n.x,n.y)}r.closePath(),r.stroke(),r.restore()}}(i,a,t,o))})),s.display&&l&&c){for(n.save(),n.lineWidth=l,n.strokeStyle=c,n.setLineDash&&(n.setLineDash(Oo([s.borderDash,a.borderDash,[]])),n.lineDashOffset=Oo([s.borderDashOffset,a.borderDashOffset,0])),e=i.chart.data.labels.length-1;e>=0;e--)t=i.getDistanceFromCenterForValue(r.ticks.reverse?i.min:i.max),o=i.getPointPosition(e,t),n.beginPath(),n.moveTo(i.xCenter,i.yCenter),n.lineTo(o.x,o.y),n.stroke();n.restore()}},_drawLabels:function(){var e=this,t=e.ctx,o=e.options.ticks;if(o.display){var i,n,r=e.getIndexAngle(0),a=B.options._parseFont(o),s=Ao(o.fontColor,z.global.defaultFontColor);t.save(),t.font=a.string,t.translate(e.xCenter,e.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",B.each(e.ticks,(function(r,l){(0!==l||o.reverse)&&(i=e.getDistanceFromCenterForValue(e.ticksAsNumbers[l]),o.showLabelBackdrop&&(n=t.measureText(r).width,t.fillStyle=o.backdropColor,t.fillRect(-n/2-o.backdropPaddingX,-i-a.size/2-o.backdropPaddingY,n+2*o.backdropPaddingX,a.size+2*o.backdropPaddingY)),t.fillStyle=s,t.fillText(r,0,-i))})),t.restore()}},_drawTitle:B.noop}),$o=zo;Wo._defaults=$o;var Go=B._deprecated,qo=B.options.resolve,Yo=B.valueOrDefault,Uo=Number.MIN_SAFE_INTEGER||-9007199254740991,Xo=Number.MAX_SAFE_INTEGER||9007199254740991,Jo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ko=Object.keys(Jo);function Zo(e,t){return e-t}function Qo(e){return B.valueOrDefault(e.time.min,e.ticks.min)}function ei(e){return B.valueOrDefault(e.time.max,e.ticks.max)}function ti(e,t,o,i){var n=function(e,t,o){for(var i,n,r,a=0,s=e.length-1;a>=0&&a<=s;){if(n=e[(i=a+s>>1)-1]||null,r=e[i],!n)return{lo:null,hi:r};if(r[t]<o)a=i+1;else{if(!(n[t]>o))return{lo:n,hi:r};s=i-1}}return{lo:r,hi:null}}(e,t,o),r=n.lo?n.hi?n.lo:e[e.length-2]:e[0],a=n.lo?n.hi?n.hi:e[e.length-1]:e[1],s=a[t]-r[t],l=s?(o-r[t])/s:0,c=(a[i]-r[i])*l;return r[i]+c}function oi(e,t){var o=e._adapter,i=e.options.time,n=i.parser,r=n||i.format,a=t;return"function"==typeof n&&(a=n(a)),B.isFinite(a)||(a="string"==typeof r?o.parse(a,r):o.parse(a)),null!==a?+a:(n||"function"!=typeof r||(a=r(t),B.isFinite(a)||(a=o.parse(a))),a)}function ii(e,t){if(B.isNullOrUndef(t))return null;var o=e.options.time,i=oi(e,e.getRightValue(t));return null===i||o.round&&(i=+e._adapter.startOf(i,o.round)),i}function ni(e,t,o,i){var n,r,a,s=Ko.length;for(n=Ko.indexOf(e);n<s-1;++n)if(a=(r=Jo[Ko[n]]).steps?r.steps:Xo,r.common&&Math.ceil((o-t)/(a*r.size))<=i)return Ko[n];return Ko[s-1]}function ri(e,t,o){var i,n,r=[],a={},s=t.length;for(i=0;i<s;++i)a[n=t[i]]=i,r.push({value:n,major:!1});return 0!==s&&o?function(e,t,o,i){var n,r,a=e._adapter,s=+a.startOf(t[0].value,i),l=t[t.length-1].value;for(n=s;n<=l;n=+a.add(n,1,i))(r=o[n])>=0&&(t[r].major=!0);return t}(e,r,a,o):r}var ai=mo.extend({initialize:function(){this.mergeTicksOptions(),mo.prototype.initialize.call(this)},update:function(){var e=this,t=e.options,o=t.time||(t.time={}),i=e._adapter=new Qt._date(t.adapters.date);return Go("time scale",o.format,"time.format","time.parser"),Go("time scale",o.min,"time.min","ticks.min"),Go("time scale",o.max,"time.max","ticks.max"),B.mergeIf(o.displayFormats,i.formats()),mo.prototype.update.apply(e,arguments)},getRightValue:function(e){return e&&void 0!==e.t&&(e=e.t),mo.prototype.getRightValue.call(this,e)},determineDataLimits:function(){var e,t,o,i,n,r,a,s=this,l=s.chart,c=s._adapter,u=s.options,d=u.time.unit||"day",h=Xo,p=Uo,f=[],m=[],g=[],v=s._getLabels();for(e=0,o=v.length;e<o;++e)g.push(ii(s,v[e]));for(e=0,o=(l.data.datasets||[]).length;e<o;++e)if(l.isDatasetVisible(e))if(n=l.data.datasets[e].data,B.isObject(n[0]))for(m[e]=[],t=0,i=n.length;t<i;++t)r=ii(s,n[t]),f.push(r),m[e][t]=r;else m[e]=g.slice(0),a||(f=f.concat(g),a=!0);else m[e]=[];g.length&&(h=Math.min(h,g[0]),p=Math.max(p,g[g.length-1])),f.length&&(f=o>1?function(e){var t,o,i,n={},r=[];for(t=0,o=e.length;t<o;++t)n[i=e[t]]||(n[i]=!0,r.push(i));return r}(f).sort(Zo):f.sort(Zo),h=Math.min(h,f[0]),p=Math.max(p,f[f.length-1])),h=ii(s,Qo(u))||h,p=ii(s,ei(u))||p,h=h===Xo?+c.startOf(Date.now(),d):h,p=p===Uo?+c.endOf(Date.now(),d)+1:p,s.min=Math.min(h,p),s.max=Math.max(h+1,p),s._table=[],s._timestamps={data:f,datasets:m,labels:g}},buildTicks:function(){var e,t,o,i=this,n=i.min,r=i.max,a=i.options,s=a.ticks,l=a.time,c=i._timestamps,u=[],d=i.getLabelCapacity(n),h=s.source,p=a.distribution;for(c="data"===h||"auto"===h&&"series"===p?c.data:"labels"===h?c.labels:function(e,t,o,i){var n,r=e._adapter,a=e.options,s=a.time,l=s.unit||ni(s.minUnit,t,o,i),c=qo([s.stepSize,s.unitStepSize,1]),u="week"===l&&s.isoWeekday,d=t,h=[];if(u&&(d=+r.startOf(d,"isoWeek",u)),d=+r.startOf(d,u?"day":l),r.diff(o,t,l)>1e5*c)throw t+" and "+o+" are too far apart with stepSize of "+c+" "+l;for(n=d;n<o;n=+r.add(n,c,l))h.push(n);return n!==o&&"ticks"!==a.bounds||h.push(n),h}(i,n,r,d),"ticks"===a.bounds&&c.length&&(n=c[0],r=c[c.length-1]),n=ii(i,Qo(a))||n,r=ii(i,ei(a))||r,e=0,t=c.length;e<t;++e)(o=c[e])>=n&&o<=r&&u.push(o);return i.min=n,i.max=r,i._unit=l.unit||(s.autoSkip?ni(l.minUnit,i.min,i.max,d):function(e,t,o,i,n){var r,a;for(r=Ko.length-1;r>=Ko.indexOf(o);r--)if(a=Ko[r],Jo[a].common&&e._adapter.diff(n,i,a)>=t-1)return a;return Ko[o?Ko.indexOf(o):0]}(i,u.length,l.minUnit,i.min,i.max)),i._majorUnit=s.major.enabled&&"year"!==i._unit?function(e){for(var t=Ko.indexOf(e)+1,o=Ko.length;t<o;++t)if(Jo[Ko[t]].common)return Ko[t]}(i._unit):void 0,i._table=function(e,t,o,i){if("linear"===i||!e.length)return[{time:t,pos:0},{time:o,pos:1}];var n,r,a,s,l,c=[],u=[t];for(n=0,r=e.length;n<r;++n)(s=e[n])>t&&s<o&&u.push(s);for(u.push(o),n=0,r=u.length;n<r;++n)l=u[n+1],a=u[n-1],s=u[n],void 0!==a&&void 0!==l&&Math.round((l+a)/2)===s||c.push({time:s,pos:n/(r-1)});return c}(i._timestamps.data,n,r,p),i._offsets=function(e,t,o,i,n){var r,a,s=0,l=0;return n.offset&&t.length&&(r=ti(e,"time",t[0],"pos"),s=1===t.length?1-r:(ti(e,"time",t[1],"pos")-r)/2,a=ti(e,"time",t[t.length-1],"pos"),l=1===t.length?a:(a-ti(e,"time",t[t.length-2],"pos"))/2),{start:s,end:l,factor:1/(s+1+l)}}(i._table,u,0,0,a),s.reverse&&u.reverse(),ri(i,u,i._majorUnit)},getLabelForIndex:function(e,t){var o=this,i=o._adapter,n=o.chart.data,r=o.options.time,a=n.labels&&e<n.labels.length?n.labels[e]:"",s=n.datasets[t].data[e];return B.isObject(s)&&(a=o.getRightValue(s)),r.tooltipFormat?i.format(oi(o,a),r.tooltipFormat):"string"==typeof a?a:i.format(oi(o,a),r.displayFormats.datetime)},tickFormatFunction:function(e,t,o,i){var n=this._adapter,r=this.options,a=r.time.displayFormats,s=a[this._unit],l=this._majorUnit,c=a[l],u=o[t],d=r.ticks,h=l&&c&&u&&u.major,p=n.format(e,i||(h?c:s)),f=h?d.major:d.minor,m=qo([f.callback,f.userCallback,d.callback,d.userCallback]);return m?m(p,t,o):p},convertTicksToLabels:function(e){var t,o,i=[];for(t=0,o=e.length;t<o;++t)i.push(this.tickFormatFunction(e[t].value,t,e));return i},getPixelForOffset:function(e){var t=this._offsets,o=ti(this._table,"time",e,"pos");return this.getPixelForDecimal((t.start+o)*t.factor)},getPixelForValue:function(e,t,o){var i=null;if(void 0!==t&&void 0!==o&&(i=this._timestamps.datasets[o][t]),null===i&&(i=ii(this,e)),null!==i)return this.getPixelForOffset(i)},getPixelForTick:function(e){var t=this.getTicks();return e>=0&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function(e){var t=this._offsets,o=this.getDecimalForPixel(e)/t.factor-t.end,i=ti(this._table,"pos",o,"time");return this._adapter._create(i)},_getLabelSize:function(e){var t=this.options.ticks,o=this.ctx.measureText(e).width,i=B.toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),n=Math.cos(i),r=Math.sin(i),a=Yo(t.fontSize,z.global.defaultFontSize);return{w:o*n+a*r,h:o*r+a*n}},getLabelWidth:function(e){return this._getLabelSize(e).w},getLabelCapacity:function(e){var t=this,o=t.options.time,i=o.displayFormats,n=i[o.unit]||i.millisecond,r=t.tickFormatFunction(e,0,ri(t,[e],t._majorUnit),n),a=t._getLabelSize(r),s=Math.floor(t.isHorizontal()?t.width/a.w:t.height/a.h);return t.options.offset&&s--,s>0?s:1}}),si={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};ai._defaults=si;var li={category:vo,linear:Mo,logarithmic:Lo,radialLinear:Wo,time:ai},ci={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};Qt._date.override("function"==typeof e?{_id:"moment",formats:function(){return ci},parse:function(t,o){return"string"==typeof t&&"string"==typeof o?t=e(t,o):t instanceof e||(t=e(t)),t.isValid()?t.valueOf():null},format:function(t,o){return e(t).format(o)},add:function(t,o,i){return e(t).add(o,i).valueOf()},diff:function(t,o,i){return e(t).diff(e(o),i)},startOf:function(t,o,i){return t=e(t),"isoWeek"===o?t.isoWeekday(i).valueOf():t.startOf(o).valueOf()},endOf:function(t,o){return e(t).endOf(o).valueOf()},_create:function(t){return e(t)}}:{}),z._set("global",{plugins:{filler:{propagate:!0}}});var ui={dataset:function(e){var t=e.fill,o=e.chart,i=o.getDatasetMeta(t),n=i&&o.isDatasetVisible(t)&&i.dataset._children||[],r=n.length||0;return r?function(e,t){return t<r&&n[t]._view||null}:null},boundary:function(e){var t=e.boundary,o=t?t.x:null,i=t?t.y:null;return B.isArray(t)?function(e,o){return t[o]}:function(e){return{x:null===o?e.x:o,y:null===i?e.y:i}}}};function di(e,t,o){var i,n=e._model||{},r=n.fill;if(void 0===r&&(r=!!n.backgroundColor),!1===r||null===r)return!1;if(!0===r)return"origin";if(i=parseFloat(r,10),isFinite(i)&&Math.floor(i)===i)return"-"!==r[0]&&"+"!==r[0]||(i=t+i),!(i===t||i<0||i>=o)&&i;switch(r){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return r;default:return!1}}function hi(e){return(e.el._scale||{}).getPointPositionForValue?function(e){var t,o,i,n,r,a=e.el._scale,s=a.options,l=a.chart.data.labels.length,c=e.fill,u=[];if(!l)return null;for(t=s.ticks.reverse?a.max:a.min,o=s.ticks.reverse?a.min:a.max,i=a.getPointPositionForValue(0,t),n=0;n<l;++n)r="start"===c||"end"===c?a.getPointPositionForValue(n,"start"===c?t:o):a.getBasePosition(n),s.gridLines.circular&&(r.cx=i.x,r.cy=i.y,r.angle=a.getIndexAngle(n)-Math.PI/2),u.push(r);return u}(e):function(e){var t,o=e.el._model||{},i=e.el._scale||{},n=e.fill,r=null;if(isFinite(n))return null;if("start"===n?r=void 0===o.scaleBottom?i.bottom:o.scaleBottom:"end"===n?r=void 0===o.scaleTop?i.top:o.scaleTop:void 0!==o.scaleZero?r=o.scaleZero:i.getBasePixel&&(r=i.getBasePixel()),null!=r){if(void 0!==r.x&&void 0!==r.y)return r;if(B.isFinite(r))return{x:(t=i.isHorizontal())?r:null,y:t?null:r}}return null}(e)}function pi(e,t,o){var i,n=e[t].fill,r=[t];if(!o)return n;for(;!1!==n&&-1===r.indexOf(n);){if(!isFinite(n))return n;if(!(i=e[n]))return!1;if(i.visible)return n;r.push(n),n=i.fill}return!1}function fi(e){var t=e.fill,o="dataset";return!1===t?null:(isFinite(t)||(o="boundary"),ui[o](e))}function mi(e){return e&&!e.skip}function gi(e,t,o,i,n){var r,a,s,l;if(i&&n){for(e.moveTo(t[0].x,t[0].y),r=1;r<i;++r)B.canvas.lineTo(e,t[r-1],t[r]);if(void 0===o[0].angle)for(e.lineTo(o[n-1].x,o[n-1].y),r=n-1;r>0;--r)B.canvas.lineTo(e,o[r],o[r-1],!0);else for(a=o[0].cx,s=o[0].cy,l=Math.sqrt(Math.pow(o[0].x-a,2)+Math.pow(o[0].y-s,2)),r=n-1;r>0;--r)e.arc(a,s,l,o[r].angle,o[r-1].angle,!0)}}function vi(e,t,o,i,n,r){var a,s,l,c,u,d,h,p,f=t.length,m=i.spanGaps,g=[],v=[],b=0,y=0;for(e.beginPath(),a=0,s=f;a<s;++a)u=o(c=t[l=a%f]._view,l,i),d=mi(c),h=mi(u),r&&void 0===p&&d&&(s=f+(p=a+1)),d&&h?(b=g.push(c),y=v.push(u)):b&&y&&(m?(d&&g.push(c),h&&v.push(u)):(gi(e,g,v,b,y),b=y=0,g=[],v=[]));gi(e,g,v,b,y),e.closePath(),e.fillStyle=n,e.fill()}var bi={id:"filler",afterDatasetsUpdate:function(e,t){var o,i,n,r,a=(e.data.datasets||[]).length,s=t.propagate,l=[];for(i=0;i<a;++i)r=null,(n=(o=e.getDatasetMeta(i)).dataset)&&n._model&&n instanceof xe.Line&&(r={visible:e.isDatasetVisible(i),fill:di(n,i,a),chart:e,el:n}),o.$filler=r,l.push(r);for(i=0;i<a;++i)(r=l[i])&&(r.fill=pi(l,i,s),r.boundary=hi(r),r.mapper=fi(r))},beforeDatasetsDraw:function(e){var t,o,i,n,r,a,s,l=e._getSortedVisibleDatasetMetas(),c=e.ctx;for(o=l.length-1;o>=0;--o)(t=l[o].$filler)&&t.visible&&(n=(i=t.el)._view,r=i._children||[],a=t.mapper,s=n.backgroundColor||z.global.defaultColor,a&&s&&r.length&&(B.canvas.clipArea(c,e.chartArea),vi(c,r,a,n,s,i._loop),B.canvas.unclipArea(c)))}},yi=B.rtl.getRtlAdapter,wi=B.noop,xi=B.valueOrDefault;function Ci(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}z._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,t){var o=t.datasetIndex,i=this.chart,n=i.getDatasetMeta(o);n.hidden=null===n.hidden?!i.data.datasets[o].hidden:null,i.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(e){var t=e.data.datasets,o=e.options.legend||{},i=o.labels&&o.labels.usePointStyle;return e._getSortedDatasetMetas().map((function(o){var n=o.controller.getStyle(i?0:void 0);return{text:t[o.index].label,fillStyle:n.backgroundColor,hidden:!e.isDatasetVisible(o.index),lineCap:n.borderCapStyle,lineDash:n.borderDash,lineDashOffset:n.borderDashOffset,lineJoin:n.borderJoinStyle,lineWidth:n.borderWidth,strokeStyle:n.borderColor,pointStyle:n.pointStyle,rotation:n.rotation,datasetIndex:o.index}}),this)}}},legendCallback:function(e){var t,o,i,n=document.createElement("ul"),r=e.data.datasets;for(n.setAttribute("class",e.id+"-legend"),t=0,o=r.length;t<o;t++)(i=n.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=r[t].backgroundColor,r[t].label&&i.appendChild(document.createTextNode(r[t].label));return n.outerHTML}});var Ei=U.extend({initialize:function(e){B.extend(this,e),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:wi,update:function(e,t,o){var i=this;return i.beforeUpdate(),i.maxWidth=e,i.maxHeight=t,i.margins=o,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:wi,beforeSetDimensions:wi,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:wi,beforeBuildLabels:wi,buildLabels:function(){var e=this,t=e.options.labels||{},o=B.callback(t.generateLabels,[e.chart],e)||[];t.filter&&(o=o.filter((function(o){return t.filter(o,e.chart.data)}))),e.options.reverse&&o.reverse(),e.legendItems=o},afterBuildLabels:wi,beforeFit:wi,fit:function(){var e=this,t=e.options,o=t.labels,i=t.display,n=e.ctx,r=B.options._parseFont(o),a=r.size,s=e.legendHitBoxes=[],l=e.minSize,c=e.isHorizontal();if(c?(l.width=e.maxWidth,l.height=i?10:0):(l.width=i?10:0,l.height=e.maxHeight),i){if(n.font=r.string,c){var u=e.lineWidths=[0],d=0;n.textAlign="left",n.textBaseline="middle",B.each(e.legendItems,(function(e,t){var i=Ci(o,a)+a/2+n.measureText(e.text).width;(0===t||u[u.length-1]+i+2*o.padding>l.width)&&(d+=a+o.padding,u[u.length-(t>0?0:1)]=0),s[t]={left:0,top:0,width:i,height:a},u[u.length-1]+=i+o.padding})),l.height+=d}else{var h=o.padding,p=e.columnWidths=[],f=e.columnHeights=[],m=o.padding,g=0,v=0;B.each(e.legendItems,(function(e,t){var i=Ci(o,a)+a/2+n.measureText(e.text).width;t>0&&v+a+2*h>l.height&&(m+=g+o.padding,p.push(g),f.push(v),g=0,v=0),g=Math.max(g,i),v+=a+h,s[t]={left:0,top:0,width:i,height:a}})),m+=g,p.push(g),f.push(v),l.width+=m}e.width=l.width,e.height=l.height}else e.width=l.width=e.height=l.height=0},afterFit:wi,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var e=this,t=e.options,o=t.labels,i=z.global,n=i.defaultColor,r=i.elements.line,a=e.height,s=e.columnHeights,l=e.width,c=e.lineWidths;if(t.display){var u,d=yi(t.rtl,e.left,e.minSize.width),h=e.ctx,p=xi(o.fontColor,i.defaultFontColor),f=B.options._parseFont(o),m=f.size;h.textAlign=d.textAlign("left"),h.textBaseline="middle",h.lineWidth=.5,h.strokeStyle=p,h.fillStyle=p,h.font=f.string;var g=Ci(o,m),v=e.legendHitBoxes,b=function(e,i){switch(t.align){case"start":return o.padding;case"end":return e-i;default:return(e-i+o.padding)/2}},y=e.isHorizontal();u=y?{x:e.left+b(l,c[0]),y:e.top+o.padding,line:0}:{x:e.left+o.padding,y:e.top+b(a,s[0]),line:0},B.rtl.overrideTextDirection(e.ctx,t.textDirection);var w=m+o.padding;B.each(e.legendItems,(function(t,i){var p=h.measureText(t.text).width,f=g+m/2+p,x=u.x,C=u.y;d.setWidth(e.minSize.width),y?i>0&&x+f+o.padding>e.left+e.minSize.width&&(C=u.y+=w,u.line++,x=u.x=e.left+b(l,c[u.line])):i>0&&C+w>e.top+e.minSize.height&&(x=u.x=x+e.columnWidths[u.line]+o.padding,u.line++,C=u.y=e.top+b(a,s[u.line]));var E=d.x(x);!function(e,t,i){if(!(isNaN(g)||g<=0)){h.save();var a=xi(i.lineWidth,r.borderWidth);if(h.fillStyle=xi(i.fillStyle,n),h.lineCap=xi(i.lineCap,r.borderCapStyle),h.lineDashOffset=xi(i.lineDashOffset,r.borderDashOffset),h.lineJoin=xi(i.lineJoin,r.borderJoinStyle),h.lineWidth=a,h.strokeStyle=xi(i.strokeStyle,n),h.setLineDash&&h.setLineDash(xi(i.lineDash,r.borderDash)),o&&o.usePointStyle){var s=g*Math.SQRT2/2,l=d.xPlus(e,g/2),c=t+m/2;B.canvas.drawPoint(h,i.pointStyle,s,l,c,i.rotation)}else h.fillRect(d.leftForLtr(e,g),t,g,m),0!==a&&h.strokeRect(d.leftForLtr(e,g),t,g,m);h.restore()}}(E,C,t),v[i].left=d.leftForLtr(E,v[i].width),v[i].top=C,function(e,t,o,i){var n=m/2,r=d.xPlus(e,g+n),a=t+n;h.fillText(o.text,r,a),o.hidden&&(h.beginPath(),h.lineWidth=2,h.moveTo(r,a),h.lineTo(d.xPlus(r,i),a),h.stroke())}(E,C,t,p),y?u.x+=f+o.padding:u.y+=w})),B.rtl.restoreTextDirection(e.ctx,t.textDirection)}},_getLegendItemAt:function(e,t){var o,i,n,r=this;if(e>=r.left&&e<=r.right&&t>=r.top&&t<=r.bottom)for(n=r.legendHitBoxes,o=0;o<n.length;++o)if(e>=(i=n[o]).left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height)return r.legendItems[o];return null},handleEvent:function(e){var t,o=this,i=o.options,n="mouseup"===e.type?"click":e.type;if("mousemove"===n){if(!i.onHover&&!i.onLeave)return}else{if("click"!==n)return;if(!i.onClick)return}t=o._getLegendItemAt(e.x,e.y),"click"===n?t&&i.onClick&&i.onClick.call(o,e.native,t):(i.onLeave&&t!==o._hoveredItem&&(o._hoveredItem&&i.onLeave.call(o,e.native,o._hoveredItem),o._hoveredItem=t),i.onHover&&t&&i.onHover.call(o,e.native,t))}});function ki(e,t){var o=new Ei({ctx:e.ctx,options:t,chart:e});ft.configure(e,o,t),ft.addBox(e,o),e.legend=o}var Mi={id:"legend",_element:Ei,beforeInit:function(e){var t=e.options.legend;t&&ki(e,t)},beforeUpdate:function(e){var t=e.options.legend,o=e.legend;t?(B.mergeIf(t,z.global.legend),o?(ft.configure(e,o,t),o.options=t):ki(e,t)):o&&(ft.removeBox(e,o),delete e.legend)},afterEvent:function(e,t){var o=e.legend;o&&o.handleEvent(t)}},_i=B.noop;z._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var Di=U.extend({initialize:function(e){B.extend(this,e),this.legendHitBoxes=[]},beforeUpdate:_i,update:function(e,t,o){var i=this;return i.beforeUpdate(),i.maxWidth=e,i.maxHeight=t,i.margins=o,i.beforeSetDimensions(),i.setDimensions(),i.afterSetDimensions(),i.beforeBuildLabels(),i.buildLabels(),i.afterBuildLabels(),i.beforeFit(),i.fit(),i.afterFit(),i.afterUpdate(),i.minSize},afterUpdate:_i,beforeSetDimensions:_i,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:_i,beforeBuildLabels:_i,buildLabels:_i,afterBuildLabels:_i,beforeFit:_i,fit:function(){var e,t=this,o=t.options,i=t.minSize={},n=t.isHorizontal();o.display?(e=(B.isArray(o.text)?o.text.length:1)*B.options._parseFont(o).lineHeight+2*o.padding,t.width=i.width=n?t.maxWidth:e,t.height=i.height=n?e:t.maxHeight):t.width=i.width=t.height=i.height=0},afterFit:_i,isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function(){var e=this,t=e.ctx,o=e.options;if(o.display){var i,n,r,a=B.options._parseFont(o),s=a.lineHeight,l=s/2+o.padding,c=0,u=e.top,d=e.left,h=e.bottom,p=e.right;t.fillStyle=B.valueOrDefault(o.fontColor,z.global.defaultFontColor),t.font=a.string,e.isHorizontal()?(n=d+(p-d)/2,r=u+l,i=p-d):(n="left"===o.position?d+l:p-l,r=u+(h-u)/2,i=h-u,c=Math.PI*("left"===o.position?-.5:.5)),t.save(),t.translate(n,r),t.rotate(c),t.textAlign="center",t.textBaseline="middle";var f=o.text;if(B.isArray(f))for(var m=0,g=0;g<f.length;++g)t.fillText(f[g],0,m,i),m+=s;else t.fillText(f,0,0,i);t.restore()}}});function Si(e,t){var o=new Di({ctx:e.ctx,options:t,chart:e});ft.configure(e,o,t),ft.addBox(e,o),e.titleBlock=o}var Ri={},Ti=bi,Li=Mi,Pi={id:"title",_element:Di,beforeInit:function(e){var t=e.options.title;t&&Si(e,t)},beforeUpdate:function(e){var t=e.options.title,o=e.titleBlock;t?(B.mergeIf(t,z.global.title),o?(ft.configure(e,o,t),o.options=t):Si(e,t)):o&&(ft.removeBox(e,o),delete e.titleBlock)}};for(var Ai in Ri.filler=Ti,Ri.legend=Li,Ri.title=Pi,Jt.helpers=B,function(){function e(e,t,o){var i;return"string"==typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[o])):i=e,i}function t(e){return null!=e&&"none"!==e}function o(o,i,n){var r=document.defaultView,a=B._getParentNode(o),s=r.getComputedStyle(o)[i],l=r.getComputedStyle(a)[i],c=t(s),u=t(l),d=Number.POSITIVE_INFINITY;return c||u?Math.min(c?e(s,o,n):d,u?e(l,a,n):d):"none"}B.where=function(e,t){if(B.isArray(e)&&Array.prototype.filter)return e.filter(t);var o=[];return B.each(e,(function(e){t(e)&&o.push(e)})),o},B.findIndex=Array.prototype.findIndex?function(e,t,o){return e.findIndex(t,o)}:function(e,t,o){o=void 0===o?e:o;for(var i=0,n=e.length;i<n;++i)if(t.call(o,e[i],i,e))return i;return-1},B.findNextWhere=function(e,t,o){B.isNullOrUndef(o)&&(o=-1);for(var i=o+1;i<e.length;i++){var n=e[i];if(t(n))return n}},B.findPreviousWhere=function(e,t,o){B.isNullOrUndef(o)&&(o=e.length);for(var i=o-1;i>=0;i--){var n=e[i];if(t(n))return n}},B.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},B.almostEquals=function(e,t,o){return Math.abs(e-t)<o},B.almostWhole=function(e,t){var o=Math.round(e);return o-t<=e&&o+t>=e},B.max=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.max(e,t)}),Number.NEGATIVE_INFINITY)},B.min=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.min(e,t)}),Number.POSITIVE_INFINITY)},B.sign=Math.sign?function(e){return Math.sign(e)}:function(e){return 0==(e=+e)||isNaN(e)?e:e>0?1:-1},B.toRadians=function(e){return e*(Math.PI/180)},B.toDegrees=function(e){return e*(180/Math.PI)},B._decimalPlaces=function(e){if(B.isFinite(e)){for(var t=1,o=0;Math.round(e*t)/t!==e;)t*=10,o++;return o}},B.getAngleFromPoint=function(e,t){var o=t.x-e.x,i=t.y-e.y,n=Math.sqrt(o*o+i*i),r=Math.atan2(i,o);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:n}},B.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},B.aliasPixel=function(e){return e%2==0?0:.5},B._alignPixel=function(e,t,o){var i=e.currentDevicePixelRatio,n=o/2;return Math.round((t-n)*i)/i+n},B.splineCurve=function(e,t,o,i){var n=e.skip?t:e,r=t,a=o.skip?t:o,s=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2)),l=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),c=s/(s+l),u=l/(s+l),d=i*(c=isNaN(c)?0:c),h=i*(u=isNaN(u)?0:u);return{previous:{x:r.x-d*(a.x-n.x),y:r.y-d*(a.y-n.y)},next:{x:r.x+h*(a.x-n.x),y:r.y+h*(a.y-n.y)}}},B.EPSILON=Number.EPSILON||1e-14,B.splineCurveMonotone=function(e){var t,o,i,n,r,a,s,l,c,u=(e||[]).map((function(e){return{model:e._model,deltaK:0,mK:0}})),d=u.length;for(t=0;t<d;++t)if(!(i=u[t]).model.skip){if(o=t>0?u[t-1]:null,(n=t<d-1?u[t+1]:null)&&!n.model.skip){var h=n.model.x-i.model.x;i.deltaK=0!==h?(n.model.y-i.model.y)/h:0}!o||o.model.skip?i.mK=i.deltaK:!n||n.model.skip?i.mK=o.deltaK:this.sign(o.deltaK)!==this.sign(i.deltaK)?i.mK=0:i.mK=(o.deltaK+i.deltaK)/2}for(t=0;t<d-1;++t)i=u[t],n=u[t+1],i.model.skip||n.model.skip||(B.almostEquals(i.deltaK,0,this.EPSILON)?i.mK=n.mK=0:(r=i.mK/i.deltaK,a=n.mK/i.deltaK,(l=Math.pow(r,2)+Math.pow(a,2))<=9||(s=3/Math.sqrt(l),i.mK=r*s*i.deltaK,n.mK=a*s*i.deltaK)));for(t=0;t<d;++t)(i=u[t]).model.skip||(o=t>0?u[t-1]:null,n=t<d-1?u[t+1]:null,o&&!o.model.skip&&(c=(i.model.x-o.model.x)/3,i.model.controlPointPreviousX=i.model.x-c,i.model.controlPointPreviousY=i.model.y-c*i.mK),n&&!n.model.skip&&(c=(n.model.x-i.model.x)/3,i.model.controlPointNextX=i.model.x+c,i.model.controlPointNextY=i.model.y+c*i.mK))},B.nextItem=function(e,t,o){return o?t>=e.length-1?e[0]:e[t+1]:t>=e.length-1?e[e.length-1]:e[t+1]},B.previousItem=function(e,t,o){return o?t<=0?e[e.length-1]:e[t-1]:t<=0?e[0]:e[t-1]},B.niceNum=function(e,t){var o=Math.floor(B.log10(e)),i=e/Math.pow(10,o);return(t?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10)*Math.pow(10,o)},B.requestAnimFrame="undefined"==typeof window?function(e){e()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},B.getRelativePosition=function(e,t){var o,i,n=e.originalEvent||e,r=e.target||e.srcElement,a=r.getBoundingClientRect(),s=n.touches;s&&s.length>0?(o=s[0].clientX,i=s[0].clientY):(o=n.clientX,i=n.clientY);var l=parseFloat(B.getStyle(r,"padding-left")),c=parseFloat(B.getStyle(r,"padding-top")),u=parseFloat(B.getStyle(r,"padding-right")),d=parseFloat(B.getStyle(r,"padding-bottom")),h=a.right-a.left-l-u,p=a.bottom-a.top-c-d;return{x:o=Math.round((o-a.left-l)/h*r.width/t.currentDevicePixelRatio),y:i=Math.round((i-a.top-c)/p*r.height/t.currentDevicePixelRatio)}},B.getConstraintWidth=function(e){return o(e,"max-width","clientWidth")},B.getConstraintHeight=function(e){return o(e,"max-height","clientHeight")},B._calculatePadding=function(e,t,o){return(t=B.getStyle(e,t)).indexOf("%")>-1?o*parseInt(t,10)/100:parseInt(t,10)},B._getParentNode=function(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t},B.getMaximumWidth=function(e){var t=B._getParentNode(e);if(!t)return e.clientWidth;var o=t.clientWidth,i=o-B._calculatePadding(t,"padding-left",o)-B._calculatePadding(t,"padding-right",o),n=B.getConstraintWidth(e);return isNaN(n)?i:Math.min(i,n)},B.getMaximumHeight=function(e){var t=B._getParentNode(e);if(!t)return e.clientHeight;var o=t.clientHeight,i=o-B._calculatePadding(t,"padding-top",o)-B._calculatePadding(t,"padding-bottom",o),n=B.getConstraintHeight(e);return isNaN(n)?i:Math.min(i,n)},B.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},B.retinaScale=function(e,t){var o=e.currentDevicePixelRatio=t||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==o){var i=e.canvas,n=e.height,r=e.width;i.height=n*o,i.width=r*o,e.ctx.scale(o,o),i.style.height||i.style.width||(i.style.height=n+"px",i.style.width=r+"px")}},B.fontString=function(e,t,o){return t+" "+e+"px "+o},B.longestText=function(e,t,o,i){var n=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(n=i.data={},r=i.garbageCollect=[],i.font=t),e.font=t;var a,s,l,c,u,d=0,h=o.length;for(a=0;a<h;a++)if(null!=(c=o[a])&&!0!==B.isArray(c))d=B.measureText(e,n,r,d,c);else if(B.isArray(c))for(s=0,l=c.length;s<l;s++)null==(u=c[s])||B.isArray(u)||(d=B.measureText(e,n,r,d,u));var p=r.length/2;if(p>o.length){for(a=0;a<p;a++)delete n[r[a]];r.splice(0,p)}return d},B.measureText=function(e,t,o,i,n){var r=t[n];return r||(r=t[n]=e.measureText(n).width,o.push(n)),r>i&&(i=r),i},B.numberOfLabelLines=function(e){var t=1;return B.each(e,(function(e){B.isArray(e)&&e.length>t&&(t=e.length)})),t},B.color=C?function(e){return e instanceof CanvasGradient&&(e=z.global.defaultColor),C(e)}:function(e){return console.error("Color.js not found!"),e},B.getHoverColor=function(e){return e instanceof CanvasPattern||e instanceof CanvasGradient?e:B.color(e).saturate(.5).darken(.1).rgbString()}}(),Jt._adapters=Qt,Jt.Animation=J,Jt.animationService=K,Jt.controllers=Ke,Jt.DatasetController=oe,Jt.defaults=z,Jt.Element=U,Jt.elements=xe,Jt.Interaction=nt,Jt.layouts=ft,Jt.platform=St,Jt.plugins=Rt,Jt.Scale=mo,Jt.scaleService=Tt,Jt.Ticks=eo,Jt.Tooltip=Bt,Jt.helpers.each(li,(function(e,t){Jt.scaleService.registerScaleType(t,e,e._defaults)})),Ri)Ri.hasOwnProperty(Ai)&&Jt.plugins.register(Ri[Ai]);Jt.platform.initialize();var Fi=Jt;return"undefined"!=typeof window&&(window.Chart=Jt),Jt.Chart=Jt,Jt.Legend=Ri.legend._element,Jt.Title=Ri.title._element,Jt.pluginService=Jt.plugins,Jt.PluginBase=Jt.Element.extend({}),Jt.canvasHelpers=Jt.helpers.canvas,Jt.layoutService=Jt.layouts,Jt.LinearScaleBase=xo,Jt.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],(function(e){Jt[e]=function(t,o){return new Jt(t,Jt.helpers.merge(o||{},{type:e.charAt(0).toLowerCase()+e.slice(1)}))}})),Fi}(function(){try{return o(2470)}catch(e){}}())},9523:function(e,t,o){e.exports=function(e){"use strict";var t=(e=e&&e.hasOwnProperty("default")?e.default:e).helpers,o=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),i={toTextLines:function(e){var o,i=[];for(e=[].concat(e);e.length;)"string"==typeof(o=e.pop())?i.unshift.apply(i,o.split("\n")):Array.isArray(o)?e.push.apply(e,o):t.isNullOrUndef(e)||i.unshift(""+o);return i},toFontString:function(e){return!e||t.isNullOrUndef(e.size)||t.isNullOrUndef(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family},textSize:function(e,t,o){var i,n=[].concat(t),r=n.length,a=e.font,s=0;for(e.font=o.string,i=0;i<r;++i)s=Math.max(e.measureText(n[i]).width,s);return e.font=a,{height:r*o.lineHeight,width:s}},parseFont:function(o){var n=e.defaults.global,r=t.valueOrDefault(o.size,n.defaultFontSize),a={family:t.valueOrDefault(o.family,n.defaultFontFamily),lineHeight:t.options.toLineHeight(o.lineHeight,r),size:r,style:t.valueOrDefault(o.style,n.defaultFontStyle),weight:t.valueOrDefault(o.weight,null),string:""};return a.string=i.toFontString(a),a},bound:function(e,t,o){return Math.max(e,Math.min(t,o))},arrayDiff:function(e,t){var o,i,n,r,a=e.slice(),s=[];for(o=0,n=t.length;o<n;++o)r=t[o],-1===(i=a.indexOf(r))?s.push([r,1]):a.splice(i,1);for(o=0,n=a.length;o<n;++o)s.push([a[o],-1]);return s},rasterize:function(e){return Math.round(e*o)/o}};function n(e,t){var o=t.x,i=t.y;if(null===o)return{x:0,y:-1};if(null===i)return{x:1,y:0};var n=e.x-o,r=e.y-i,a=Math.sqrt(n*n+r*r);return{x:a?n/a:0,y:a?r/a:-1}}function r(e,t,o){var i=0;return e<o.left?i|=1:e>o.right&&(i|=2),t<o.top?i|=8:t>o.bottom&&(i|=4),i}function a(e,t){var o,i,n=t.anchor,a=e;return t.clamp&&(a=function(e,t){for(var o,i,n,a=e.x0,s=e.y0,l=e.x1,c=e.y1,u=r(a,s,t),d=r(l,c,t);u|d&&!(u&d);)8&(o=u||d)?(i=a+(l-a)*(t.top-s)/(c-s),n=t.top):4&o?(i=a+(l-a)*(t.bottom-s)/(c-s),n=t.bottom):2&o?(n=s+(c-s)*(t.right-a)/(l-a),i=t.right):1&o&&(n=s+(c-s)*(t.left-a)/(l-a),i=t.left),o===u?u=r(a=i,s=n,t):d=r(l=i,c=n,t);return{x0:a,x1:l,y0:s,y1:c}}(a,t.area)),"start"===n?(o=a.x0,i=a.y0):"end"===n?(o=a.x1,i=a.y1):(o=(a.x0+a.x1)/2,i=(a.y0+a.y1)/2),function(e,t,o,i,n){switch(n){case"center":o=i=0;break;case"bottom":o=0,i=1;break;case"right":o=1,i=0;break;case"left":o=-1,i=0;break;case"top":o=0,i=-1;break;case"start":o=-o,i=-i;break;case"end":break;default:n*=Math.PI/180,o=Math.cos(n),i=Math.sin(n)}return{x:e,y:t,vx:o,vy:i}}(o,i,e.vx,e.vy,t.align)}var s=function(e,t){var o=(e.startAngle+e.endAngle)/2,i=Math.cos(o),n=Math.sin(o),r=e.innerRadius,s=e.outerRadius;return a({x0:e.x+i*r,y0:e.y+n*r,x1:e.x+i*s,y1:e.y+n*s,vx:i,vy:n},t)},l=function(e,t){var o=n(e,t.origin),i=o.x*e.radius,r=o.y*e.radius;return a({x0:e.x-i,y0:e.y-r,x1:e.x+i,y1:e.y+r,vx:o.x,vy:o.y},t)},c=function(e,t){var o=n(e,t.origin),i=e.x,r=e.y,s=0,l=0;return e.horizontal?(i=Math.min(e.x,e.base),s=Math.abs(e.base-e.x)):(r=Math.min(e.y,e.base),l=Math.abs(e.base-e.y)),a({x0:i,y0:r+l,x1:i+s,y1:r,vx:o.x,vy:o.y},t)},u=function(e,t){var o=n(e,t.origin);return a({x0:e.x,y0:e.y,x1:e.x,y1:e.y,vx:o.x,vy:o.y},t)},d=e.helpers,h=i.rasterize;function p(e){var t=e._model.horizontal,o=e._scale||t&&e._xScale||e._yScale;if(!o)return null;if(void 0!==o.xCenter&&void 0!==o.yCenter)return{x:o.xCenter,y:o.yCenter};var i=o.getBasePixel();return t?{x:i,y:null}:{x:null,y:i}}function f(e,t,o){var i=e.shadowBlur,n=o.stroked,r=h(o.x),a=h(o.y),s=h(o.w);n&&e.strokeText(t,r,a,s),o.filled&&(i&&n&&(e.shadowBlur=0),e.fillText(t,r,a,s),i&&n&&(e.shadowBlur=i))}var m=function(e,t,o,i){var n=this;n._config=e,n._index=i,n._model=null,n._rects=null,n._ctx=t,n._el=o};d.extend(m.prototype,{_modelize:function(t,o,n,r){var a,h=this._index,f=d.options.resolve,m=i.parseFont(f([n.font,{}],r,h)),g=f([n.color,e.defaults.global.defaultFontColor],r,h);return{align:f([n.align,"center"],r,h),anchor:f([n.anchor,"center"],r,h),area:r.chart.chartArea,backgroundColor:f([n.backgroundColor,null],r,h),borderColor:f([n.borderColor,null],r,h),borderRadius:f([n.borderRadius,0],r,h),borderWidth:f([n.borderWidth,0],r,h),clamp:f([n.clamp,!1],r,h),clip:f([n.clip,!1],r,h),color:g,display:t,font:m,lines:o,offset:f([n.offset,0],r,h),opacity:f([n.opacity,1],r,h),origin:p(this._el),padding:d.options.toPadding(f([n.padding,0],r,h)),positioner:(a=this._el,a instanceof e.elements.Arc?s:a instanceof e.elements.Point?l:a instanceof e.elements.Rectangle?c:u),rotation:f([n.rotation,0],r,h)*(Math.PI/180),size:i.textSize(this._ctx,o,m),textAlign:f([n.textAlign,"start"],r,h),textShadowBlur:f([n.textShadowBlur,0],r,h),textShadowColor:f([n.textShadowColor,g],r,h),textStrokeColor:f([n.textStrokeColor,g],r,h),textStrokeWidth:f([n.textStrokeWidth,0],r,h)}},update:function(e){var t,o,n,r=this,a=null,s=null,l=r._index,c=r._config,u=d.options.resolve([c.display,!0],e,l);u&&(t=e.dataset.data[l],o=d.valueOrDefault(d.callback(c.formatter,[t,e]),t),(n=d.isNullOrUndef(o)?[]:i.toTextLines(o)).length&&(s=function(e){var t=e.borderWidth||0,o=e.padding,i=e.size.height,n=e.size.width,r=-n/2,a=-i/2;return{frame:{x:r-o.left-t,y:a-o.top-t,w:n+o.width+2*t,h:i+o.height+2*t},text:{x:r,y:a,w:n,h:i}}}(a=r._modelize(u,n,c,e)))),r._model=a,r._rects=s},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var o,n=e.ctx,r=this._model,a=this._rects;this.visible()&&(n.save(),r.clip&&(o=r.area,n.beginPath(),n.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),n.clip()),n.globalAlpha=i.bound(0,r.opacity,1),n.translate(h(t.x),h(t.y)),n.rotate(r.rotation),function(e,t,o){var i=o.backgroundColor,n=o.borderColor,r=o.borderWidth;(i||n&&r)&&(e.beginPath(),d.canvas.roundedRect(e,h(t.x)+r/2,h(t.y)+r/2,h(t.w)-r,h(t.h)-r,o.borderRadius),e.closePath(),i&&(e.fillStyle=i,e.fill()),n&&r&&(e.strokeStyle=n,e.lineWidth=r,e.lineJoin="miter",e.stroke()))}(n,a.frame,r),function(e,t,o,i){var n,r=i.textAlign,a=i.color,s=!!a,l=i.font,c=t.length,u=i.textStrokeColor,d=i.textStrokeWidth,h=u&&d;if(c&&(s||h))for(o=function(e,t,o){var i=o.lineHeight,n=e.w,r=e.x;return"center"===t?r+=n/2:"end"!==t&&"right"!==t||(r+=n),{h:i,w:n,x:r,y:e.y+i/2}}(o,r,l),e.font=l.string,e.textAlign=r,e.textBaseline="middle",e.shadowBlur=i.textShadowBlur,e.shadowColor=i.textShadowColor,s&&(e.fillStyle=a),h&&(e.lineJoin="round",e.lineWidth=d,e.strokeStyle=u),n=0,c=t.length;n<c;++n)f(e,t[n],{stroked:h,filled:s,w:o.w,x:o.x,y:o.y+o.h*n})}(n,r.lines,a.text,r),n.restore())}});var g=e.helpers,v=Number.MIN_SAFE_INTEGER||-9007199254740991,b=Number.MAX_SAFE_INTEGER||9007199254740991;function y(e,t,o){var i=Math.cos(o),n=Math.sin(o),r=t.x,a=t.y;return{x:r+i*(e.x-r)-n*(e.y-a),y:a+n*(e.x-r)+i*(e.y-a)}}function w(e,t){var o,i,n,r,a,s=b,l=v,c=t.origin;for(o=0;o<e.length;++o)n=(i=e[o]).x-c.x,r=i.y-c.y,a=t.vx*n+t.vy*r,s=Math.min(s,a),l=Math.max(l,a);return{min:s,max:l}}function x(e,t){var o=t.x-e.x,i=t.y-e.y,n=Math.sqrt(o*o+i*i);return{vx:(t.x-e.x)/n,vy:(t.y-e.y)/n,origin:e,ln:n}}var C=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function E(e,t,o){var i=t.positioner(e,t),n=i.vx,r=i.vy;if(!n&&!r)return{x:i.x,y:i.y};var a=o.w,s=o.h,l=t.rotation,c=Math.abs(a/2*Math.cos(l))+Math.abs(s/2*Math.sin(l)),u=Math.abs(a/2*Math.sin(l))+Math.abs(s/2*Math.cos(l)),d=1/Math.max(Math.abs(n),Math.abs(r));return c*=n*d,u*=r*d,c+=t.offset*n,u+=t.offset*r,{x:i.x+c,y:i.y+u}}g.extend(C.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,o){this._rotation=o,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this._rect;return!((e=y(e,this.center(),-this._rotation)).x<t.x-1||e.y<t.y-1||e.x>t.x+t.w+2||e.y>t.y+t.h+2)},intersects:function(e){var t,o,i,n=this._points(),r=e._points(),a=[x(n[0],n[1]),x(n[0],n[3])];for(this._rotation!==e._rotation&&a.push(x(r[0],r[1]),x(r[0],r[3])),t=0;t<a.length;++t)if(o=w(n,a[t]),i=w(r,a[t]),o.max<i.min||i.max<o.min)return!1;return!0},_points:function(){var e=this._rect,t=this._rotation,o=this.center();return[y({x:e.x,y:e.y},o,t),y({x:e.x+e.w,y:e.y},o,t),y({x:e.x+e.w,y:e.y+e.h},o,t),y({x:e.x,y:e.y+e.h},o,t)]}});var k={prepare:function(e){var t,o,i,n,r,a=[];for(t=0,i=e.length;t<i;++t)for(o=0,n=e[t].length;o<n;++o)r=e[t][o],a.push(r),r.$layout={_box:new C,_hidable:!1,_visible:!0,_set:t,_idx:o};return a.sort((function(e,t){var o=e.$layout,i=t.$layout;return o._idx===i._idx?i._set-o._set:i._idx-o._idx})),this.update(a),a},update:function(e){var t,o,i,n,r,a=!1;for(t=0,o=e.length;t<o;++t)n=(i=e[t]).model(),(r=i.$layout)._hidable=n&&"auto"===n.display,r._visible=i.visible(),a|=r._hidable;a&&function(e){var t,o,i,n,r,a;for(t=0,o=e.length;t<o;++t)(n=(i=e[t]).$layout)._visible&&(r=i.geometry(),a=E(i._el._model,i.model(),r),n._box.update(a,r,i.rotation()));!function(e,t){var o,i,n,r;for(o=e.length-1;o>=0;--o)for(n=e[o].$layout,i=o-1;i>=0&&n._visible;--i)(r=e[i].$layout)._visible&&n._box.intersects(r._box)&&t(n,r)}(e,(function(e,t){var o=e._hidable,i=t._hidable;o&&i||i?t._visible=!1:o&&(e._visible=!1)}))}(e)},lookup:function(e,t){var o,i;for(o=e.length-1;o>=0;--o)if((i=e[o].$layout)&&i._visible&&i._box.contains(t))return e[o];return null},draw:function(e,t){var o,i,n,r,a,s;for(o=0,i=t.length;o<i;++o)(r=(n=t[o]).$layout)._visible&&(a=n.geometry(),s=E(n._el._view,n.model(),a),r._box.update(s,a,n.rotation()),n.draw(e,s))}},M=e.helpers,_={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(e){if(M.isNullOrUndef(e))return null;var t,o,i,n=e;if(M.isObject(e))if(M.isNullOrUndef(e.label))if(M.isNullOrUndef(e.r))for(n="",i=0,o=(t=Object.keys(e)).length;i<o;++i)n+=(0!==i?", ":"")+t[i]+": "+e[t[i]];else n=e.r;else n=e.label;return""+n},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},D=e.helpers,S="$datalabels";function R(e,t,o){if(t){var i,n=o.$context,r=o.$groups;t[r._set]&&(i=t[r._set][r._key])&&!0===D.callback(i,[n])&&(e[S]._dirty=!0,o.update(n))}}function T(e,t){var o,i,n=e[S],r=n._listeners;if(r.enter||r.leave){if("mousemove"===t.type)i=k.lookup(n._labels,t);else if("mouseout"!==t.type)return;o=n._hovered,n._hovered=i,function(e,t,o,i){var n,r;(o||i)&&(o?i?o!==i&&(r=n=!0):r=!0:n=!0,r&&R(e,t.leave,o),n&&R(e,t.enter,i))}(e,r,o,i)}}e.defaults.global.plugins.datalabels=_;var L={id:"datalabels",beforeInit:function(e){e[S]={_actives:[]}},beforeUpdate:function(e){var t=e[S];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,o){var i,n,r,a,s,l,c,u,d=t.index,h=e[S],p=h._datasets[d]=[],f=e.isDatasetVisible(d),g=e.data.datasets[d],v=function(e,t){var o,i,n,r=e.datalabels,a=[];return!1===r?null:(!0===r&&(r={}),t=D.merge({},[t,r]),i=t.labels||{},n=Object.keys(i),delete t.labels,n.length?n.forEach((function(e){i[e]&&a.push(D.merge({},[t,i[e],{_key:e}]))})):a.push(t),o=a.reduce((function(e,t){return D.each(t.listeners||{},(function(o,i){e[i]=e[i]||{},e[i][t._key||"$default"]=o})),delete t.listeners,e}),{}),{labels:a,listeners:o})}(g,o),b=t.meta.data||[],y=e.ctx;for(y.save(),i=0,r=b.length;i<r;++i)if((c=b[i])[S]=[],f&&c&&!c.hidden&&!c._model.skip)for(n=0,a=v.labels.length;n<a;++n)l=(s=v.labels[n])._key,(u=new m(s,y,c,i)).$groups={_set:d,_key:l||"$default"},u.$context={active:!1,chart:e,dataIndex:i,dataset:g,datasetIndex:d},u.update(u.$context),c[S].push(u),p.push(u);y.restore(),D.merge(h._listeners,v.listeners,{merger:function(e,o,i){o[e]=o[e]||{},o[e][t.index]=i[e],h._listened=!0}})},afterUpdate:function(e,t){e[S]._labels=k.prepare(e[S]._datasets,t)},afterDatasetsDraw:function(e){k.draw(e,e[S]._labels)},beforeEvent:function(e,t){if(e[S]._listened)switch(t.type){case"mousemove":case"mouseout":T(e,t);break;case"click":!function(e,t){var o=e[S],i=o._listeners.click,n=i&&k.lookup(o._labels,t);n&&R(e,i,n)}(e,t)}},afterEvent:function(t){var o,n,r,a,s,l,c,u=t[S],d=u._actives,h=u._actives=t.lastActive||[],p=i.arrayDiff(d,h);for(o=0,n=p.length;o<n;++o)if((s=p[o])[1])for(r=0,a=(c=s[0][S]||[]).length;r<a;++r)(l=c[r]).$context.active=1===s[1],l.update(l.$context);(u._dirty||p.length)&&(k.update(u._labels),function(t){if(!t.animating){for(var o=e.animationService.animations,i=0,n=o.length;i<n;++i)if(o[i].chart===t)return;t.render({duration:1,lazy:!0})}}(t)),delete u._dirty}};return e.plugins.register(L),L}(o(7757))},5792:function(e){e.exports=function(){"use strict";for(var e=function(e,t,o){return void 0===t&&(t=0),void 0===o&&(o=1),e<t?t:e>o?o:e},t={},o=0,i=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];o<i.length;o+=1){var n=i[o];t["[object "+n+"]"]=n.toLowerCase()}var r=function(e){return t[Object.prototype.toString.call(e)]||"object"},a=Math.PI,s={clip_rgb:function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var o=0;o<=3;o++)o<3?((t[o]<0||t[o]>255)&&(t._clipped=!0),t[o]=e(t[o],0,255)):3===o&&(t[o]=e(t[o],0,1));return t},limit:e,type:r,unpack:function(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==r(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]},last:function(e){if(e.length<2)return null;var t=e.length-1;return"string"==r(e[t])?e[t].toLowerCase():null},PI:a,TWOPI:2*a,PITHIRD:a/3,DEG2RAD:a/180,RAD2DEG:180/a},l={format:{},autodetect:[]},c=s.last,u=s.clip_rgb,d=s.type,h=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=this;if("object"===d(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var i=c(e),n=!1;if(!i){n=!0,l.sorted||(l.autodetect=l.autodetect.sort((function(e,t){return t.p-e.p})),l.sorted=!0);for(var r=0,a=l.autodetect;r<a.length;r+=1){var s=a[r];if(i=s.test.apply(s,e))break}}if(!l.format[i])throw new Error("unknown format: "+e);var h=l.format[i].apply(null,n?e:e.slice(0,-1));o._rgb=u(h),3===o._rgb.length&&o._rgb.push(1)};h.prototype.toString=function(){return"function"==d(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var p=h,f=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(f.Color,[null].concat(e)))};f.Color=p,f.version="2.1.0";var m=f,g=s.unpack,v=Math.max,b=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=g(e,"rgb"),i=o[0],n=o[1],r=o[2],a=1-v(i/=255,v(n/=255,r/=255)),s=a<1?1/(1-a):0,l=(1-i-a)*s,c=(1-n-a)*s,u=(1-r-a)*s;return[l,c,u,a]},y=s.unpack,w=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=(e=y(e,"cmyk"))[0],i=e[1],n=e[2],r=e[3],a=e.length>4?e[4]:1;return 1===r?[0,0,0,a]:[o>=1?0:255*(1-o)*(1-r),i>=1?0:255*(1-i)*(1-r),n>=1?0:255*(1-n)*(1-r),a]},x=s.unpack,C=s.type;p.prototype.cmyk=function(){return b(this._rgb)},m.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["cmyk"])))},l.format.cmyk=w,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=x(e,"cmyk"),"array"===C(e)&&4===e.length)return"cmyk"}});var E=s.unpack,k=s.last,M=function(e){return Math.round(100*e)/100},_=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=E(e,"hsla"),i=k(e)||"lsa";return o[0]=M(o[0]||0),o[1]=M(100*o[1])+"%",o[2]=M(100*o[2])+"%","hsla"===i||o.length>3&&o[3]<1?(o[3]=o.length>3?o[3]:1,i="hsla"):o.length=3,i+"("+o.join(",")+")"},D=s.unpack,S=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=(e=D(e,"rgba"))[0],i=e[1],n=e[2];o/=255,i/=255,n/=255;var r,a,s=Math.min(o,i,n),l=Math.max(o,i,n),c=(l+s)/2;return l===s?(r=0,a=Number.NaN):r=c<.5?(l-s)/(l+s):(l-s)/(2-l-s),o==l?a=(i-n)/(l-s):i==l?a=2+(n-o)/(l-s):n==l&&(a=4+(o-i)/(l-s)),(a*=60)<0&&(a+=360),e.length>3&&void 0!==e[3]?[a,r,c,e[3]]:[a,r,c]},R=s.unpack,T=s.last,L=Math.round,P=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=R(e,"rgba"),i=T(e)||"rgb";return"hsl"==i.substr(0,3)?_(S(o),i):(o[0]=L(o[0]),o[1]=L(o[1]),o[2]=L(o[2]),("rgba"===i||o.length>3&&o[3]<1)&&(o[3]=o.length>3?o[3]:1,i="rgba"),i+"("+o.slice(0,"rgb"===i?3:4).join(",")+")")},A=s.unpack,F=Math.round,O=function(){for(var e,t=[],o=arguments.length;o--;)t[o]=arguments[o];var i,n,r,a=(t=A(t,"hsl"))[0],s=t[1],l=t[2];if(0===s)i=n=r=255*l;else{var c=[0,0,0],u=[0,0,0],d=l<.5?l*(1+s):l+s-l*s,h=2*l-d,p=a/360;c[0]=p+1/3,c[1]=p,c[2]=p-1/3;for(var f=0;f<3;f++)c[f]<0&&(c[f]+=1),c[f]>1&&(c[f]-=1),6*c[f]<1?u[f]=h+6*(d-h)*c[f]:2*c[f]<1?u[f]=d:3*c[f]<2?u[f]=h+(d-h)*(2/3-c[f])*6:u[f]=h;i=(e=[F(255*u[0]),F(255*u[1]),F(255*u[2])])[0],n=e[1],r=e[2]}return t.length>3?[i,n,r,t[3]]:[i,n,r,1]},z=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,I=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,j=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,N=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,H=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,B=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,V=Math.round,W=function(e){var t;if(e=e.toLowerCase().trim(),l.format.named)try{return l.format.named(e)}catch(e){}if(t=e.match(z)){for(var o=t.slice(1,4),i=0;i<3;i++)o[i]=+o[i];return o[3]=1,o}if(t=e.match(I)){for(var n=t.slice(1,5),r=0;r<4;r++)n[r]=+n[r];return n}if(t=e.match(j)){for(var a=t.slice(1,4),s=0;s<3;s++)a[s]=V(2.55*a[s]);return a[3]=1,a}if(t=e.match(N)){for(var c=t.slice(1,5),u=0;u<3;u++)c[u]=V(2.55*c[u]);return c[3]=+c[3],c}if(t=e.match(H)){var d=t.slice(1,4);d[1]*=.01,d[2]*=.01;var h=O(d);return h[3]=1,h}if(t=e.match(B)){var p=t.slice(1,4);p[1]*=.01,p[2]*=.01;var f=O(p);return f[3]=+t[4],f}};W.test=function(e){return z.test(e)||I.test(e)||j.test(e)||N.test(e)||H.test(e)||B.test(e)};var $=W,G=s.type;p.prototype.css=function(e){return P(this._rgb,e)},m.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["css"])))},l.format.css=$,l.autodetect.push({p:5,test:function(e){for(var t=[],o=arguments.length-1;o-- >0;)t[o]=arguments[o+1];if(!t.length&&"string"===G(e)&&$.test(e))return"css"}});var q=s.unpack;l.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=q(e,"rgba");return o[0]*=255,o[1]*=255,o[2]*=255,o},m.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["gl"])))},p.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var Y=s.unpack,U=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o,i=Y(e,"rgb"),n=i[0],r=i[1],a=i[2],s=Math.min(n,r,a),l=Math.max(n,r,a),c=l-s,u=100*c/255,d=s/(255-c)*100;return 0===c?o=Number.NaN:(n===l&&(o=(r-a)/c),r===l&&(o=2+(a-n)/c),a===l&&(o=4+(n-r)/c),(o*=60)<0&&(o+=360)),[o,u,d]},X=s.unpack,J=Math.floor,K=function(){for(var e,t,o,i,n,r,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,c,u,d=(a=X(a,"hcg"))[0],h=a[1],p=a[2];p*=255;var f=255*h;if(0===h)l=c=u=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var m=J(d/=60),g=d-m,v=p*(1-h),b=v+f*(1-g),y=v+f*g,w=v+f;switch(m){case 0:l=(e=[w,y,v])[0],c=e[1],u=e[2];break;case 1:l=(t=[b,w,v])[0],c=t[1],u=t[2];break;case 2:l=(o=[v,w,y])[0],c=o[1],u=o[2];break;case 3:l=(i=[v,b,w])[0],c=i[1],u=i[2];break;case 4:l=(n=[y,v,w])[0],c=n[1],u=n[2];break;case 5:l=(r=[w,v,b])[0],c=r[1],u=r[2]}}return[l,c,u,a.length>3?a[3]:1]},Z=s.unpack,Q=s.type;p.prototype.hcg=function(){return U(this._rgb)},m.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hcg"])))},l.format.hcg=K,l.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Z(e,"hcg"),"array"===Q(e)&&3===e.length)return"hcg"}});var ee=s.unpack,te=s.last,oe=Math.round,ie=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=ee(e,"rgba"),i=o[0],n=o[1],r=o[2],a=o[3],s=te(e)||"auto";void 0===a&&(a=1),"auto"===s&&(s=a<1?"rgba":"rgb");var l=(i=oe(i))<<16|(n=oe(n))<<8|(r=oe(r)),c="000000"+l.toString(16);c=c.substr(c.length-6);var u="0"+oe(255*a).toString(16);switch(u=u.substr(u.length-2),s.toLowerCase()){case"rgba":return"#"+c+u;case"argb":return"#"+u+c;default:return"#"+c}},ne=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,re=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,ae=function(e){if(e.match(ne)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(re)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var o=parseInt(e,16);return[o>>24&255,o>>16&255,o>>8&255,Math.round((255&o)/255*100)/100]}throw new Error("unknown hex color: "+e)},se=s.type;p.prototype.hex=function(e){return ie(this._rgb,e)},m.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hex"])))},l.format.hex=ae,l.autodetect.push({p:4,test:function(e){for(var t=[],o=arguments.length-1;o-- >0;)t[o]=arguments[o+1];if(!t.length&&"string"===se(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var le=s.unpack,ce=s.TWOPI,ue=Math.min,de=Math.sqrt,he=Math.acos,pe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o,i=le(e,"rgb"),n=i[0],r=i[1],a=i[2],s=ue(n/=255,r/=255,a/=255),l=(n+r+a)/3,c=l>0?1-s/l:0;return 0===c?o=NaN:(o=(n-r+(n-a))/2,o/=de((n-r)*(n-r)+(n-a)*(r-a)),o=he(o),a>r&&(o=ce-o),o/=ce),[360*o,c,l]},fe=s.unpack,me=s.limit,ge=s.TWOPI,ve=s.PITHIRD,be=Math.cos,ye=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o,i,n,r=(e=fe(e,"hsi"))[0],a=e[1],s=e[2];return isNaN(r)&&(r=0),isNaN(a)&&(a=0),r>360&&(r-=360),r<0&&(r+=360),(r/=360)<1/3?i=1-((n=(1-a)/3)+(o=(1+a*be(ge*r)/be(ve-ge*r))/3)):r<2/3?n=1-((o=(1-a)/3)+(i=(1+a*be(ge*(r-=1/3))/be(ve-ge*r))/3)):o=1-((i=(1-a)/3)+(n=(1+a*be(ge*(r-=2/3))/be(ve-ge*r))/3)),[255*(o=me(s*o*3)),255*(i=me(s*i*3)),255*(n=me(s*n*3)),e.length>3?e[3]:1]},we=s.unpack,xe=s.type;p.prototype.hsi=function(){return pe(this._rgb)},m.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsi"])))},l.format.hsi=ye,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=we(e,"hsi"),"array"===xe(e)&&3===e.length)return"hsi"}});var Ce=s.unpack,Ee=s.type;p.prototype.hsl=function(){return S(this._rgb)},m.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsl"])))},l.format.hsl=O,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Ce(e,"hsl"),"array"===Ee(e)&&3===e.length)return"hsl"}});var ke=s.unpack,Me=Math.min,_e=Math.max,De=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o,i,n,r=(e=ke(e,"rgb"))[0],a=e[1],s=e[2],l=Me(r,a,s),c=_e(r,a,s),u=c-l;return n=c/255,0===c?(o=Number.NaN,i=0):(i=u/c,r===c&&(o=(a-s)/u),a===c&&(o=2+(s-r)/u),s===c&&(o=4+(r-a)/u),(o*=60)<0&&(o+=360)),[o,i,n]},Se=s.unpack,Re=Math.floor,Te=function(){for(var e,t,o,i,n,r,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,c,u,d=(a=Se(a,"hsv"))[0],h=a[1],p=a[2];if(p*=255,0===h)l=c=u=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var f=Re(d/=60),m=d-f,g=p*(1-h),v=p*(1-h*m),b=p*(1-h*(1-m));switch(f){case 0:l=(e=[p,b,g])[0],c=e[1],u=e[2];break;case 1:l=(t=[v,p,g])[0],c=t[1],u=t[2];break;case 2:l=(o=[g,p,b])[0],c=o[1],u=o[2];break;case 3:l=(i=[g,v,p])[0],c=i[1],u=i[2];break;case 4:l=(n=[b,g,p])[0],c=n[1],u=n[2];break;case 5:l=(r=[p,g,v])[0],c=r[1],u=r[2]}}return[l,c,u,a.length>3?a[3]:1]},Le=s.unpack,Pe=s.type;p.prototype.hsv=function(){return De(this._rgb)},m.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsv"])))},l.format.hsv=Te,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Le(e,"hsv"),"array"===Pe(e)&&3===e.length)return"hsv"}});var Ae=18,Fe=.95047,Oe=1,ze=1.08883,Ie=.137931034,je=.206896552,Ne=.12841855,He=.008856452,Be=s.unpack,Ve=Math.pow,We=function(e){return(e/=255)<=.04045?e/12.92:Ve((e+.055)/1.055,2.4)},$e=function(e){return e>He?Ve(e,1/3):e/Ne+Ie},Ge=function(e,t,o){return e=We(e),t=We(t),o=We(o),[$e((.4124564*e+.3575761*t+.1804375*o)/Fe),$e((.2126729*e+.7151522*t+.072175*o)/Oe),$e((.0193339*e+.119192*t+.9503041*o)/ze)]},qe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=Be(e,"rgb"),i=o[0],n=o[1],r=o[2],a=Ge(i,n,r),s=a[0],l=a[1],c=a[2],u=116*l-16;return[u<0?0:u,500*(s-l),200*(l-c)]},Ye=s.unpack,Ue=Math.pow,Xe=function(e){return 255*(e<=.00304?12.92*e:1.055*Ue(e,1/2.4)-.055)},Je=function(e){return e>je?e*e*e:Ne*(e-Ie)},Ke=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o,i,n,r=(e=Ye(e,"lab"))[0],a=e[1],s=e[2];return i=(r+16)/116,o=isNaN(a)?i:i+a/500,n=isNaN(s)?i:i-s/200,i=Oe*Je(i),o=Fe*Je(o),n=ze*Je(n),[Xe(3.2404542*o-1.5371385*i-.4985314*n),Xe(-.969266*o+1.8760108*i+.041556*n),Xe(.0556434*o-.2040259*i+1.0572252*n),e.length>3?e[3]:1]},Ze=s.unpack,Qe=s.type;p.prototype.lab=function(){return qe(this._rgb)},m.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["lab"])))},l.format.lab=Ke,l.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Ze(e,"lab"),"array"===Qe(e)&&3===e.length)return"lab"}});var et=s.unpack,tt=s.RAD2DEG,ot=Math.sqrt,it=Math.atan2,nt=Math.round,rt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=et(e,"lab"),i=o[0],n=o[1],r=o[2],a=ot(n*n+r*r),s=(it(r,n)*tt+360)%360;return 0===nt(1e4*a)&&(s=Number.NaN),[i,a,s]},at=s.unpack,st=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=at(e,"rgb"),i=o[0],n=o[1],r=o[2],a=qe(i,n,r),s=a[0],l=a[1],c=a[2];return rt(s,l,c)},lt=s.unpack,ct=s.DEG2RAD,ut=Math.sin,dt=Math.cos,ht=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=lt(e,"lch"),i=o[0],n=o[1],r=o[2];return isNaN(r)&&(r=0),[i,dt(r*=ct)*n,ut(r)*n]},pt=s.unpack,ft=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=(e=pt(e,"lch"))[0],i=e[1],n=e[2],r=ht(o,i,n),a=r[0],s=r[1],l=r[2],c=Ke(a,s,l),u=c[0],d=c[1],h=c[2];return[u,d,h,e.length>3?e[3]:1]},mt=s.unpack,gt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=mt(e,"hcl").reverse();return ft.apply(void 0,o)},vt=s.unpack,bt=s.type;p.prototype.lch=function(){return st(this._rgb)},p.prototype.hcl=function(){return st(this._rgb).reverse()},m.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["lch"])))},m.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hcl"])))},l.format.lch=ft,l.format.hcl=gt,["lch","hcl"].forEach((function(e){return l.autodetect.push({p:2,test:function(){for(var t=[],o=arguments.length;o--;)t[o]=arguments[o];if(t=vt(t,e),"array"===bt(t)&&3===t.length)return e}})}));var yt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},wt=s.type;p.prototype.name=function(){for(var e=ie(this._rgb,"rgb"),t=0,o=Object.keys(yt);t<o.length;t+=1){var i=o[t];if(yt[i]===e)return i.toLowerCase()}return e},l.format.named=function(e){if(e=e.toLowerCase(),yt[e])return ae(yt[e]);throw new Error("unknown color name: "+e)},l.autodetect.push({p:5,test:function(e){for(var t=[],o=arguments.length-1;o-- >0;)t[o]=arguments[o+1];if(!t.length&&"string"===wt(e)&&yt[e.toLowerCase()])return"named"}});var xt=s.unpack,Ct=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=xt(e,"rgb"),i=o[0],n=o[1],r=o[2];return(i<<16)+(n<<8)+r},Et=s.type,kt=function(e){if("number"==Et(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},Mt=s.type;p.prototype.num=function(){return Ct(this._rgb)},m.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["num"])))},l.format.num=kt,l.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===Mt(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var _t=s.unpack,Dt=s.type,St=Math.round;p.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(St)},p.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,o){return o<3?!1===e?t:St(t):t}))},m.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["rgb"])))},l.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var o=_t(e,"rgba");return void 0===o[3]&&(o[3]=1),o},l.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=_t(e,"rgba"),"array"===Dt(e)&&(3===e.length||4===e.length&&"number"==Dt(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var Rt=Math.log,Tt=function(e){var t,o,i,n=e/100;return n<66?(t=255,o=-155.25485562709179-.44596950469579133*(o=n-2)+104.49216199393888*Rt(o),i=n<20?0:.8274096064007395*(i=n-10)-254.76935184120902+115.67994401066147*Rt(i)):(t=351.97690566805693+.114206453784165*(t=n-55)-40.25366309332127*Rt(t),o=325.4494125711974+.07943456536662342*(o=n-50)-28.0852963507957*Rt(o),i=255),[t,o,i,1]},Lt=s.unpack,Pt=Math.round,At=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var o,i=Lt(e,"rgb"),n=i[0],r=i[2],a=1e3,s=4e4,l=.4;s-a>l;){var c=Tt(o=.5*(s+a));c[2]/c[0]>=r/n?s=o:a=o}return Pt(o)};p.prototype.temp=p.prototype.kelvin=p.prototype.temperature=function(){return At(this._rgb)},m.temp=m.kelvin=m.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["temp"])))},l.format.temp=l.format.kelvin=l.format.temperature=Tt;var Ft=s.type;p.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===Ft(e)?t?(this._rgb[3]=e,this):new p([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},p.prototype.clipped=function(){return this._rgb._clipped||!1},p.prototype.darken=function(e){void 0===e&&(e=1);var t=this.lab();return t[0]-=Ae*e,new p(t,"lab").alpha(this.alpha(),!0)},p.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},p.prototype.darker=p.prototype.darken,p.prototype.brighter=p.prototype.brighten,p.prototype.get=function(e){var t=e.split("."),o=t[0],i=t[1],n=this[o]();if(i){var r=o.indexOf(i);if(r>-1)return n[r];throw new Error("unknown channel "+i+" in mode "+o)}return n};var Ot=s.type,zt=Math.pow;p.prototype.luminance=function(e){if(void 0!==e&&"number"===Ot(e)){if(0===e)return new p([0,0,0,this._rgb[3]],"rgb");if(1===e)return new p([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),o=20,i=function(t,n){var r=t.interpolate(n,.5,"rgb"),a=r.luminance();return Math.abs(e-a)<1e-7||!o--?r:a>e?i(t,r):i(r,n)},n=(t>e?i(new p([0,0,0]),this):i(this,new p([255,255,255]))).rgb();return new p(n.concat([this._rgb[3]]))}return It.apply(void 0,this._rgb.slice(0,3))};var It=function(e,t,o){return.2126*(e=jt(e))+.7152*(t=jt(t))+.0722*(o=jt(o))},jt=function(e){return(e/=255)<=.03928?e/12.92:zt((e+.055)/1.055,2.4)},Nt={},Ht=s.type,Bt=function(e,t,o){void 0===o&&(o=.5);for(var i=[],n=arguments.length-3;n-- >0;)i[n]=arguments[n+3];var r=i[0]||"lrgb";if(Nt[r]||i.length||(r=Object.keys(Nt)[0]),!Nt[r])throw new Error("interpolation mode "+r+" is not defined");return"object"!==Ht(e)&&(e=new p(e)),"object"!==Ht(t)&&(t=new p(t)),Nt[r](e,t,o).alpha(e.alpha()+o*(t.alpha()-e.alpha()))};p.prototype.mix=p.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var o=[],i=arguments.length-2;i-- >0;)o[i]=arguments[i+2];return Bt.apply(void 0,[this,e,t].concat(o))},p.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,o=t[3];return e?(this._rgb=[t[0]*o,t[1]*o,t[2]*o,o],this):new p([t[0]*o,t[1]*o,t[2]*o,o],"rgb")},p.prototype.saturate=function(e){void 0===e&&(e=1);var t=this.lch();return t[1]+=Ae*e,t[1]<0&&(t[1]=0),new p(t,"lch").alpha(this.alpha(),!0)},p.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var Vt=s.type;p.prototype.set=function(e,t,o){void 0===o&&(o=!1);var i=e.split("."),n=i[0],r=i[1],a=this[n]();if(r){var s=n.indexOf(r);if(s>-1){if("string"==Vt(t))switch(t.charAt(0)){case"+":case"-":a[s]+=+t;break;case"*":a[s]*=+t.substr(1);break;case"/":a[s]/=+t.substr(1);break;default:a[s]=+t}else{if("number"!==Vt(t))throw new Error("unsupported value for Color.set");a[s]=t}var l=new p(a,n);return o?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+r+" in mode "+n)}return a},Nt.rgb=function(e,t,o){var i=e._rgb,n=t._rgb;return new p(i[0]+o*(n[0]-i[0]),i[1]+o*(n[1]-i[1]),i[2]+o*(n[2]-i[2]),"rgb")};var Wt=Math.sqrt,$t=Math.pow;Nt.lrgb=function(e,t,o){var i=e._rgb,n=i[0],r=i[1],a=i[2],s=t._rgb,l=s[0],c=s[1],u=s[2];return new p(Wt($t(n,2)*(1-o)+$t(l,2)*o),Wt($t(r,2)*(1-o)+$t(c,2)*o),Wt($t(a,2)*(1-o)+$t(u,2)*o),"rgb")},Nt.lab=function(e,t,o){var i=e.lab(),n=t.lab();return new p(i[0]+o*(n[0]-i[0]),i[1]+o*(n[1]-i[1]),i[2]+o*(n[2]-i[2]),"lab")};var Gt=function(e,t,o,i){var n,r,a,s,l,c,u,d,h,f,m,g;return"hsl"===i?(a=e.hsl(),s=t.hsl()):"hsv"===i?(a=e.hsv(),s=t.hsv()):"hcg"===i?(a=e.hcg(),s=t.hcg()):"hsi"===i?(a=e.hsi(),s=t.hsi()):"lch"!==i&&"hcl"!==i||(i="hcl",a=e.hcl(),s=t.hcl()),"h"===i.substr(0,1)&&(l=(n=a)[0],u=n[1],h=n[2],c=(r=s)[0],d=r[1],f=r[2]),isNaN(l)||isNaN(c)?isNaN(l)?isNaN(c)?g=Number.NaN:(g=c,1!=h&&0!=h||"hsv"==i||(m=d)):(g=l,1!=f&&0!=f||"hsv"==i||(m=u)):g=l+o*(c>l&&c-l>180?c-(l+360):c<l&&l-c>180?c+360-l:c-l),void 0===m&&(m=u+o*(d-u)),new p([g,m,h+o*(f-h)],i)},qt=function(e,t,o){return Gt(e,t,o,"lch")};Nt.lch=qt,Nt.hcl=qt,Nt.num=function(e,t,o){var i=e.num(),n=t.num();return new p(i+o*(n-i),"num")},Nt.hcg=function(e,t,o){return Gt(e,t,o,"hcg")},Nt.hsi=function(e,t,o){return Gt(e,t,o,"hsi")},Nt.hsl=function(e,t,o){return Gt(e,t,o,"hsl")},Nt.hsv=function(e,t,o){return Gt(e,t,o,"hsv")};var Yt=s.clip_rgb,Ut=Math.pow,Xt=Math.sqrt,Jt=Math.PI,Kt=Math.cos,Zt=Math.sin,Qt=Math.atan2,eo=function(e,t){for(var o=e.length,i=[0,0,0,0],n=0;n<e.length;n++){var r=e[n],a=t[n]/o,s=r._rgb;i[0]+=Ut(s[0],2)*a,i[1]+=Ut(s[1],2)*a,i[2]+=Ut(s[2],2)*a,i[3]+=s[3]*a}return i[0]=Xt(i[0]),i[1]=Xt(i[1]),i[2]=Xt(i[2]),i[3]>.9999999&&(i[3]=1),new p(Yt(i))},to=s.type,oo=Math.pow,io=function(e){var t="rgb",o=m("#ccc"),i=0,n=[0,1],r=[],a=[0,0],s=!1,l=[],c=!1,u=0,d=1,h=!1,p={},f=!0,g=1,v=function(e){if((e=e||["#fff","#000"])&&"string"===to(e)&&m.brewer&&m.brewer[e.toLowerCase()]&&(e=m.brewer[e.toLowerCase()]),"array"===to(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=m(e[t]);r.length=0;for(var o=0;o<e.length;o++)r.push(o/(e.length-1))}return x(),l=e},b=function(e){return e},y=function(e){return e},w=function(e,i){var n,c;if(null==i&&(i=!1),isNaN(e)||null===e)return o;c=i?e:s&&s.length>2?function(e){if(null!=s){for(var t=s.length-1,o=0;o<t&&e>=s[o];)o++;return o-1}return 0}(e)/(s.length-2):d!==u?(e-u)/(d-u):1,c=y(c),i||(c=b(c)),1!==g&&(c=oo(c,g)),c=a[0]+c*(1-a[0]-a[1]),c=Math.min(1,Math.max(0,c));var h=Math.floor(1e4*c);if(f&&p[h])n=p[h];else{if("array"===to(l))for(var v=0;v<r.length;v++){var w=r[v];if(c<=w){n=l[v];break}if(c>=w&&v===r.length-1){n=l[v];break}if(c>w&&c<r[v+1]){c=(c-w)/(r[v+1]-w),n=m.interpolate(l[v],l[v+1],c,t);break}}else"function"===to(l)&&(n=l(c));f&&(p[h]=n)}return n},x=function(){return p={}};v(e);var C=function(e){var t=m(w(e));return c&&t[c]?t[c]():t};return C.classes=function(e){if(null!=e){if("array"===to(e))s=e,n=[e[0],e[e.length-1]];else{var t=m.analyze(n);s=0===e?[t.min,t.max]:m.limits(t,"e",e)}return C}return s},C.domain=function(e){if(!arguments.length)return n;u=e[0],d=e[e.length-1],r=[];var t=l.length;if(e.length===t&&u!==d)for(var o=0,i=Array.from(e);o<i.length;o+=1){var a=i[o];r.push((a-u)/(d-u))}else{for(var s=0;s<t;s++)r.push(s/(t-1));if(e.length>2){var c=e.map((function(t,o){return o/(e.length-1)})),h=e.map((function(e){return(e-u)/(d-u)}));h.every((function(e,t){return c[t]===e}))||(y=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=h[t+1];)t++;var o=(e-h[t])/(h[t+1]-h[t]);return c[t]+o*(c[t+1]-c[t])})}}return n=[u,d],C},C.mode=function(e){return arguments.length?(t=e,x(),C):t},C.range=function(e,t){return v(e),C},C.out=function(e){return c=e,C},C.spread=function(e){return arguments.length?(i=e,C):i},C.correctLightness=function(e){return null==e&&(e=!0),h=e,x(),b=h?function(e){for(var t=w(0,!0).lab()[0],o=w(1,!0).lab()[0],i=t>o,n=w(e,!0).lab()[0],r=t+(o-t)*e,a=n-r,s=0,l=1,c=20;Math.abs(a)>.01&&c-- >0;)i&&(a*=-1),a<0?(s=e,e+=.5*(l-e)):(l=e,e+=.5*(s-e)),n=w(e,!0).lab()[0],a=n-r;return e}:function(e){return e},C},C.padding=function(e){return null!=e?("number"===to(e)&&(e=[e,e]),a=e,C):a},C.colors=function(t,o){arguments.length<2&&(o="hex");var i=[];if(0===arguments.length)i=l.slice(0);else if(1===t)i=[C(.5)];else if(t>1){var r=n[0],a=n[1]-r;i=no(0,t,!1).map((function(e){return C(r+e/(t-1)*a)}))}else{e=[];var c=[];if(s&&s.length>2)for(var u=1,d=s.length,h=1<=d;h?u<d:u>d;h?u++:u--)c.push(.5*(s[u-1]+s[u]));else c=n;i=c.map((function(e){return C(e)}))}return m[o]&&(i=i.map((function(e){return e[o]()}))),i},C.cache=function(e){return null!=e?(f=e,C):f},C.gamma=function(e){return null!=e?(g=e,C):g},C.nodata=function(e){return null!=e?(o=m(e),C):o},C};function no(e,t,o){for(var i=[],n=e<t,r=o?n?t+1:t-1:t,a=e;n?a<r:a>r;n?a++:a--)i.push(a);return i}var ro=function(e){var t,o,i,n,r,a,s;if(2===(e=e.map((function(e){return new p(e)}))).length)t=e.map((function(e){return e.lab()})),r=t[0],a=t[1],n=function(e){var t=[0,1,2].map((function(t){return r[t]+e*(a[t]-r[t])}));return new p(t,"lab")};else if(3===e.length)o=e.map((function(e){return e.lab()})),r=o[0],a=o[1],s=o[2],n=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*r[t]+2*(1-e)*e*a[t]+e*e*s[t]}));return new p(t,"lab")};else if(4===e.length){var l;i=e.map((function(e){return e.lab()})),r=i[0],a=i[1],s=i[2],l=i[3],n=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*r[t]+3*(1-e)*(1-e)*e*a[t]+3*(1-e)*e*e*s[t]+e*e*e*l[t]}));return new p(t,"lab")}}else if(5===e.length){var c=ro(e.slice(0,3)),u=ro(e.slice(2,5));n=function(e){return e<.5?c(2*e):u(2*(e-.5))}}return n},ao=function(e,t,o){if(!ao[o])throw new Error("unknown blend mode "+o);return ao[o](e,t)},so=function(e){return function(t,o){var i=m(o).rgb(),n=m(t).rgb();return m.rgb(e(i,n))}},lo=function(e){return function(t,o){var i=[];return i[0]=e(t[0],o[0]),i[1]=e(t[1],o[1]),i[2]=e(t[2],o[2]),i}};ao.normal=so(lo((function(e){return e}))),ao.multiply=so(lo((function(e,t){return e*t/255}))),ao.screen=so(lo((function(e,t){return 255*(1-(1-e/255)*(1-t/255))}))),ao.overlay=so(lo((function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))}))),ao.darken=so(lo((function(e,t){return e>t?t:e}))),ao.lighten=so(lo((function(e,t){return e>t?e:t}))),ao.dodge=so(lo((function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e}))),ao.burn=so(lo((function(e,t){return 255*(1-(1-t/255)/(e/255))})));for(var co=ao,uo=s.type,ho=s.clip_rgb,po=s.TWOPI,fo=Math.pow,mo=Math.sin,go=Math.cos,vo=Math.floor,bo=Math.random,yo=Math.log,wo=Math.pow,xo=Math.floor,Co=Math.abs,Eo=function(e,t){void 0===t&&(t=null);var o={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===r(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===r(e)&&(e=e[t]),null==e||isNaN(e)||(o.values.push(e),o.sum+=e,e<o.min&&(o.min=e),e>o.max&&(o.max=e),o.count+=1)})),o.domain=[o.min,o.max],o.limits=function(e,t){return ko(o,e,t)},o},ko=function(e,t,o){void 0===t&&(t="equal"),void 0===o&&(o=7),"array"==r(e)&&(e=Eo(e));var i=e.min,n=e.max,a=e.values.sort((function(e,t){return e-t}));if(1===o)return[i,n];var s=[];if("c"===t.substr(0,1)&&(s.push(i),s.push(n)),"e"===t.substr(0,1)){s.push(i);for(var l=1;l<o;l++)s.push(i+l/o*(n-i));s.push(n)}else if("l"===t.substr(0,1)){if(i<=0)throw new Error("Logarithmic scales are only possible for values > 0");var c=Math.LOG10E*yo(i),u=Math.LOG10E*yo(n);s.push(i);for(var d=1;d<o;d++)s.push(wo(10,c+d/o*(u-c)));s.push(n)}else if("q"===t.substr(0,1)){s.push(i);for(var h=1;h<o;h++){var p=(a.length-1)*h/o,f=xo(p);if(f===p)s.push(a[f]);else{var m=p-f;s.push(a[f]*(1-m)+a[f+1]*m)}}s.push(n)}else if("k"===t.substr(0,1)){var g,v=a.length,b=new Array(v),y=new Array(o),w=!0,x=0,C=null;(C=[]).push(i);for(var E=1;E<o;E++)C.push(i+E/o*(n-i));for(C.push(n);w;){for(var k=0;k<o;k++)y[k]=0;for(var M=0;M<v;M++)for(var _=a[M],D=Number.MAX_VALUE,S=void 0,R=0;R<o;R++){var T=Co(C[R]-_);T<D&&(D=T,S=R),y[S]++,b[M]=S}for(var L=new Array(o),P=0;P<o;P++)L[P]=null;for(var A=0;A<v;A++)null===L[g=b[A]]?L[g]=a[A]:L[g]+=a[A];for(var F=0;F<o;F++)L[F]*=1/y[F];w=!1;for(var O=0;O<o;O++)if(L[O]!==C[O]){w=!0;break}C=L,++x>200&&(w=!1)}for(var z={},I=0;I<o;I++)z[I]=[];for(var j=0;j<v;j++)z[g=b[j]].push(a[j]);for(var N=[],H=0;H<o;H++)N.push(z[H][0]),N.push(z[H][z[H].length-1]);N=N.sort((function(e,t){return e-t})),s.push(N[0]);for(var B=1;B<N.length;B+=2){var V=N[B];isNaN(V)||-1!==s.indexOf(V)||s.push(V)}}return s},Mo={analyze:Eo,limits:ko},_o=Math.sqrt,Do=Math.atan2,So=Math.abs,Ro=Math.cos,To=Math.PI,Lo={cool:function(){return io([m.hsl(180,1,.9),m.hsl(250,.7,.4)])},hot:function(){return io(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Po={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Ao=0,Fo=Object.keys(Po);Ao<Fo.length;Ao+=1){var Oo=Fo[Ao];Po[Oo.toLowerCase()]=Po[Oo]}var zo=Po;return m.average=function(e,t,o){void 0===t&&(t="lrgb"),void 0===o&&(o=null);var i=e.length;o||(o=Array.from(new Array(i)).map((function(){return 1})));var n=i/o.reduce((function(e,t){return e+t}));if(o.forEach((function(e,t){o[t]*=n})),e=e.map((function(e){return new p(e)})),"lrgb"===t)return eo(e,o);for(var r=e.shift(),a=r.get(t),s=[],l=0,c=0,u=0;u<a.length;u++)if(a[u]=(a[u]||0)*o[0],s.push(isNaN(a[u])?0:o[0]),"h"===t.charAt(u)&&!isNaN(a[u])){var d=a[u]/180*Jt;l+=Kt(d)*o[0],c+=Zt(d)*o[0]}var h=r.alpha()*o[0];e.forEach((function(e,i){var n=e.get(t);h+=e.alpha()*o[i+1];for(var r=0;r<a.length;r++)if(!isNaN(n[r]))if(s[r]+=o[i+1],"h"===t.charAt(r)){var u=n[r]/180*Jt;l+=Kt(u)*o[i+1],c+=Zt(u)*o[i+1]}else a[r]+=n[r]*o[i+1]}));for(var f=0;f<a.length;f++)if("h"===t.charAt(f)){for(var m=Qt(c/s[f],l/s[f])/Jt*180;m<0;)m+=360;for(;m>=360;)m-=360;a[f]=m}else a[f]=a[f]/s[f];return h/=i,new p(a,t).alpha(h>.99999?1:h,!0)},m.bezier=function(e){var t=ro(e);return t.scale=function(){return io(t)},t},m.blend=co,m.cubehelix=function(e,t,o,i,n){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===o&&(o=1),void 0===i&&(i=1),void 0===n&&(n=[0,1]);var r,a=0;"array"===uo(n)?r=n[1]-n[0]:(r=0,n=[n,n]);var s=function(s){var l=po*((e+120)/360+t*s),c=fo(n[0]+r*s,i),u=(0!==a?o[0]+s*a:o)*c*(1-c)/2,d=go(l),h=mo(l);return m(ho([255*(c+u*(-.14861*d+1.78277*h)),255*(c+u*(-.29227*d-.90649*h)),255*(c+u*(1.97294*d)),1]))};return s.start=function(t){return null==t?e:(e=t,s)},s.rotations=function(e){return null==e?t:(t=e,s)},s.gamma=function(e){return null==e?i:(i=e,s)},s.hue=function(e){return null==e?o:("array"===uo(o=e)?0==(a=o[1]-o[0])&&(o=o[1]):a=0,s)},s.lightness=function(e){return null==e?n:("array"===uo(e)?(n=e,r=e[1]-e[0]):(n=[e,e],r=0),s)},s.scale=function(){return m.scale(s)},s.hue(o),s},m.mix=m.interpolate=Bt,m.random=function(){for(var e="#",t=0;t<6;t++)e+="0123456789abcdef".charAt(vo(16*bo()));return new p(e,"hex")},m.scale=io,m.analyze=Mo.analyze,m.contrast=function(e,t){e=new p(e),t=new p(t);var o=e.luminance(),i=t.luminance();return o>i?(o+.05)/(i+.05):(i+.05)/(o+.05)},m.deltaE=function(e,t,o,i){void 0===o&&(o=1),void 0===i&&(i=1),e=new p(e),t=new p(t);for(var n=Array.from(e.lab()),r=n[0],a=n[1],s=n[2],l=Array.from(t.lab()),c=l[0],u=l[1],d=l[2],h=_o(a*a+s*s),f=_o(u*u+d*d),m=r<16?.511:.040975*r/(1+.01765*r),g=.0638*h/(1+.0131*h)+.638,v=h<1e-6?0:180*Do(s,a)/To;v<0;)v+=360;for(;v>=360;)v-=360;var b=v>=164&&v<=345?.56+So(.2*Ro(To*(v+168)/180)):.36+So(.4*Ro(To*(v+35)/180)),y=h*h*h*h,w=_o(y/(y+1900)),x=g*(w*b+1-w),C=h-f,E=a-u,k=s-d,M=(r-c)/(o*m),_=C/(i*g);return _o(M*M+_*_+(E*E+k*k-C*C)/(x*x))},m.distance=function(e,t,o){void 0===o&&(o="lab"),e=new p(e),t=new p(t);var i=e.get(o),n=t.get(o),r=0;for(var a in i){var s=(i[a]||0)-(n[a]||0);r+=s*s}return Math.sqrt(r)},m.limits=Mo.limits,m.valid=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(p,[null].concat(e))),!0}catch(e){return!1}},m.scales=Lo,m.colors=yt,m.brewer=zo,m}()},4953:function(e){e.exports=function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},t=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],o={_disable:[],_enable:[],allowInput:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enable:[],enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var o=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-o.getTime())/864e5-3+(o.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},i={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},n=function(e){return("0"+e).slice(-2)},r=function(e){return!0===e?1:0};function a(e,t,o){var i;return void 0===o&&(o=!1),function(){var n=this,r=arguments;null!==i&&clearTimeout(i),i=window.setTimeout((function(){i=null,o||e.apply(n,r)}),t),o&&!i&&e.apply(n,r)}}var s=function(e){return e instanceof Array?e:[e]};function l(e,t,o){if(!0===o)return e.classList.add(t);e.classList.remove(t)}function c(e,t,o){var i=window.document.createElement(e);return t=t||"",o=o||"",i.className=t,void 0!==o&&(i.textContent=o),i}function u(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function d(e,t){var o=c("div","numInputWrapper"),i=c("input","numInput "+e),n=c("span","arrowUp"),r=c("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?i.type="number":(i.type="text",i.pattern="\\d*"),void 0!==t)for(var a in t)i.setAttribute(a,t[a]);return o.appendChild(i),o.appendChild(n),o.appendChild(r),o}var h=function(){},p=function(e,t,o){return o.months[t?"shorthand":"longhand"][e]},f={D:h,F:function(e,t,o){e.setMonth(o.months.longhand.indexOf(t))},G:function(e,t){e.setHours(parseFloat(t))},H:function(e,t){e.setHours(parseFloat(t))},J:function(e,t){e.setDate(parseFloat(t))},K:function(e,t,o){e.setHours(e.getHours()%12+12*r(new RegExp(o.amPM[1],"i").test(t)))},M:function(e,t,o){e.setMonth(o.months.shorthand.indexOf(t))},S:function(e,t){e.setSeconds(parseFloat(t))},U:function(e,t){return new Date(1e3*parseFloat(t))},W:function(e,t,o){var i=parseInt(t),n=new Date(e.getFullYear(),0,2+7*(i-1),0,0,0,0);return n.setDate(n.getDate()-n.getDay()+o.firstDayOfWeek),n},Y:function(e,t){e.setFullYear(parseFloat(t))},Z:function(e,t){return new Date(t)},d:function(e,t){e.setDate(parseFloat(t))},h:function(e,t){e.setHours(parseFloat(t))},i:function(e,t){e.setMinutes(parseFloat(t))},j:function(e,t){e.setDate(parseFloat(t))},l:h,m:function(e,t){e.setMonth(parseFloat(t)-1)},n:function(e,t){e.setMonth(parseFloat(t)-1)},s:function(e,t){e.setSeconds(parseFloat(t))},u:function(e,t){return new Date(parseFloat(t))},w:h,y:function(e,t){e.setFullYear(2e3+parseFloat(t))}},m={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},g={Z:function(e){return e.toISOString()},D:function(e,t,o){return t.weekdays.shorthand[g.w(e,t,o)]},F:function(e,t,o){return p(g.n(e,t,o)-1,!1,t)},G:function(e,t,o){return n(g.h(e,t,o))},H:function(e){return n(e.getHours())},J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:function(e,t){return t.amPM[r(e.getHours()>11)]},M:function(e,t){return p(e.getMonth(),!0,t)},S:function(e){return n(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,t,o){return o.getWeek(e)},Y:function(e){return e.getFullYear()},d:function(e){return n(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return n(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:function(e){return n(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},v=function(e){var t=e.config,n=void 0===t?o:t,r=e.l10n,a=void 0===r?i:r;return function(e,t,o){var i=o||a;return void 0!==n.formatDate?n.formatDate(e,t,i):t.split("").map((function(t,o,r){return g[t]&&"\\"!==r[o-1]?g[t](e,i,n):"\\"!==t?t:""})).join("")}},b=function(e){var t=e.config,n=void 0===t?o:t,r=e.l10n,a=void 0===r?i:r;return function(e,t,i,r){if(0===e||e){var s,l=r||a,c=e;if(e instanceof Date)s=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)s=new Date(e);else if("string"==typeof e){var u=t||(n||o).dateFormat,d=String(e).trim();if("today"===d)s=new Date,i=!0;else if(/Z$/.test(d)||/GMT$/.test(d))s=new Date(e);else if(n&&n.parseDate)s=n.parseDate(e,u);else{s=n&&n.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);for(var h=void 0,p=[],g=0,v=0,b="";g<u.length;g++){var y=u[g],w="\\"===y,x="\\"===u[g-1]||w;if(m[y]&&!x){b+=m[y];var C=new RegExp(b).exec(e);C&&(h=!0)&&p["Y"!==y?"push":"unshift"]({fn:f[y],val:C[++v]})}else w||(b+=".");p.forEach((function(e){var t=e.fn,o=e.val;return s=t(s,o,l)||s}))}s=h?s:void 0}}if(s instanceof Date&&!isNaN(s.getTime()))return!0===i&&s.setHours(0,0,0,0),s;n.errorHandler(new Error("Invalid date provided: "+c))}}};function y(e,t,o){return void 0===o&&(o=!0),!1!==o?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}var w=864e5;function x(h,f){var g={config:e({},o,E.defaultConfig),l10n:i};function x(e){return e.bind(g)}function C(){var e=g.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==g.calendarContainer&&(g.calendarContainer.style.visibility="hidden",g.calendarContainer.style.display="block"),void 0!==g.daysContainer){var t=(g.days.offsetWidth+1)*e.showMonths;g.daysContainer.style.width=t+"px",g.calendarContainer.style.width=t+(void 0!==g.weekWrapper?g.weekWrapper.offsetWidth:0)+"px",g.calendarContainer.style.removeProperty("visibility"),g.calendarContainer.style.removeProperty("display")}}))}function k(e){0===g.selectedDates.length&&oe(),void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();var t="keydown"===e.type,o=e.target;void 0!==g.amPM&&e.target===g.amPM&&(g.amPM.textContent=g.l10n.amPM[r(g.amPM.textContent===g.l10n.amPM[0])]);var i=parseFloat(o.getAttribute("min")),a=parseFloat(o.getAttribute("max")),s=parseFloat(o.getAttribute("step")),l=parseInt(o.value,10),c=e.delta||(t?38===e.which?1:-1:0),u=l+s*c;if(void 0!==o.value&&2===o.value.length){var d=o===g.hourElement,h=o===g.minuteElement;u<i?(u=a+u+r(!d)+(r(d)&&r(!g.amPM)),h&&O(void 0,-1,g.hourElement)):u>a&&(u=o===g.hourElement?u-a-r(!g.amPM):i,h&&O(void 0,1,g.hourElement)),g.amPM&&d&&(1===s?u+l===23:Math.abs(u-l)>s)&&(g.amPM.textContent=g.l10n.amPM[r(g.amPM.textContent===g.l10n.amPM[0])]),o.value=n(u)}}(e);var t=g._input.value;M(),ve(),g._input.value!==t&&g._debouncedChange()}function M(){if(void 0!==g.hourElement&&void 0!==g.minuteElement){var e,t,o=(parseInt(g.hourElement.value.slice(-2),10)||0)%24,i=(parseInt(g.minuteElement.value,10)||0)%60,n=void 0!==g.secondElement?(parseInt(g.secondElement.value,10)||0)%60:0;void 0!==g.amPM&&(e=o,t=g.amPM.textContent,o=e%12+12*r(t===g.l10n.amPM[1]));var a=void 0!==g.config.minTime||g.config.minDate&&g.minDateHasTime&&g.latestSelectedDateObj&&0===y(g.latestSelectedDateObj,g.config.minDate,!0);if(void 0!==g.config.maxTime||g.config.maxDate&&g.maxDateHasTime&&g.latestSelectedDateObj&&0===y(g.latestSelectedDateObj,g.config.maxDate,!0)){var s=void 0!==g.config.maxTime?g.config.maxTime:g.config.maxDate;(o=Math.min(o,s.getHours()))===s.getHours()&&(i=Math.min(i,s.getMinutes())),i===s.getMinutes()&&(n=Math.min(n,s.getSeconds()))}if(a){var l=void 0!==g.config.minTime?g.config.minTime:g.config.minDate;(o=Math.max(o,l.getHours()))===l.getHours()&&(i=Math.max(i,l.getMinutes())),i===l.getMinutes()&&(n=Math.max(n,l.getSeconds()))}S(o,i,n)}}function _(e){var t=e||g.latestSelectedDateObj;t&&S(t.getHours(),t.getMinutes(),t.getSeconds())}function D(){var e=g.config.defaultHour,t=g.config.defaultMinute,o=g.config.defaultSeconds;if(void 0!==g.config.minDate){var i=g.config.minDate.getHours(),n=g.config.minDate.getMinutes();(e=Math.max(e,i))===i&&(t=Math.max(n,t)),e===i&&t===n&&(o=g.config.minDate.getSeconds())}if(void 0!==g.config.maxDate){var r=g.config.maxDate.getHours(),a=g.config.maxDate.getMinutes();(e=Math.min(e,r))===r&&(t=Math.min(a,t)),e===r&&t===a&&(o=g.config.maxDate.getSeconds())}S(e,t,o)}function S(e,t,o){void 0!==g.latestSelectedDateObj&&g.latestSelectedDateObj.setHours(e%24,t,o||0,0),g.hourElement&&g.minuteElement&&!g.isMobile&&(g.hourElement.value=n(g.config.time_24hr?e:(12+e)%12+12*r(e%12==0)),g.minuteElement.value=n(t),void 0!==g.amPM&&(g.amPM.textContent=g.l10n.amPM[r(e>=12)]),void 0!==g.secondElement&&(g.secondElement.value=n(o)))}function R(e){var t=parseInt(e.target.value)+(e.delta||0);(t/1e3>1||"Enter"===e.key&&!/[^\d]/.test(t.toString()))&&J(t)}function T(e,t,o,i){return t instanceof Array?t.forEach((function(t){return T(e,t,o,i)})):e instanceof Array?e.forEach((function(e){return T(e,t,o,i)})):(e.addEventListener(t,o,i),void g._handlers.push({element:e,event:t,handler:o,options:i}))}function L(e){return function(t){1===t.which&&e(t)}}function P(){he("onChange")}function A(e,t){var o=void 0!==e?g.parseDate(e):g.latestSelectedDateObj||(g.config.minDate&&g.config.minDate>g.now?g.config.minDate:g.config.maxDate&&g.config.maxDate<g.now?g.config.maxDate:g.now),i=g.currentYear,n=g.currentMonth;try{void 0!==o&&(g.currentYear=o.getFullYear(),g.currentMonth=o.getMonth())}catch(e){e.message="Invalid date supplied: "+o,g.config.errorHandler(e)}t&&g.currentYear!==i&&(he("onYearChange"),V()),!t||g.currentYear===i&&g.currentMonth===n||he("onMonthChange"),g.redraw()}function F(e){~e.target.className.indexOf("arrow")&&O(e,e.target.classList.contains("arrowUp")?1:-1)}function O(e,t,o){var i=e&&e.target,n=o||i&&i.parentNode&&i.parentNode.firstChild,r=pe("increment");r.delta=t,n&&n.dispatchEvent(r)}function z(e,t,o,i){var n=K(t,!0),r=c("span","flatpickr-day "+e,t.getDate().toString());return r.dateObj=t,r.$i=i,r.setAttribute("aria-label",g.formatDate(t,g.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===y(t,g.now)&&(g.todayDateElem=r,r.classList.add("today"),r.setAttribute("aria-current","date")),n?(r.tabIndex=-1,fe(t)&&(r.classList.add("selected"),g.selectedDateElem=r,"range"===g.config.mode&&(l(r,"startRange",g.selectedDates[0]&&0===y(t,g.selectedDates[0],!0)),l(r,"endRange",g.selectedDates[1]&&0===y(t,g.selectedDates[1],!0)),"nextMonthDay"===e&&r.classList.add("inRange")))):r.classList.add("flatpickr-disabled"),"range"===g.config.mode&&function(e){return!("range"!==g.config.mode||g.selectedDates.length<2)&&y(e,g.selectedDates[0])>=0&&y(e,g.selectedDates[1])<=0}(t)&&!fe(t)&&r.classList.add("inRange"),g.weekNumbers&&1===g.config.showMonths&&"prevMonthDay"!==e&&o%7==1&&g.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+g.config.getWeek(t)+"</span>"),he("onDayCreate",r),r}function I(e){e.focus(),"range"===g.config.mode&&ee(e)}function j(e){for(var t=e>0?0:g.config.showMonths-1,o=e>0?g.config.showMonths:-1,i=t;i!=o;i+=e)for(var n=g.daysContainer.children[i],r=e>0?0:n.children.length-1,a=e>0?n.children.length:-1,s=r;s!=a;s+=e){var l=n.children[s];if(-1===l.className.indexOf("hidden")&&K(l.dateObj))return l}}function N(e,t){var o=Z(document.activeElement||document.body),i=void 0!==e?e:o?document.activeElement:void 0!==g.selectedDateElem&&Z(g.selectedDateElem)?g.selectedDateElem:void 0!==g.todayDateElem&&Z(g.todayDateElem)?g.todayDateElem:j(t>0?1:-1);return void 0===i?g._input.focus():o?void function(e,t){for(var o=-1===e.className.indexOf("Month")?e.dateObj.getMonth():g.currentMonth,i=t>0?g.config.showMonths:-1,n=t>0?1:-1,r=o-g.currentMonth;r!=i;r+=n)for(var a=g.daysContainer.children[r],s=o-g.currentMonth===r?e.$i+t:t<0?a.children.length-1:0,l=a.children.length,c=s;c>=0&&c<l&&c!=(t>0?l:-1);c+=n){var u=a.children[c];if(-1===u.className.indexOf("hidden")&&K(u.dateObj)&&Math.abs(e.$i-c)>=Math.abs(t))return I(u)}g.changeMonth(n),N(j(n),0)}(i,t):I(i)}function H(e,t){for(var o=(new Date(e,t,1).getDay()-g.l10n.firstDayOfWeek+7)%7,i=g.utils.getDaysInMonth((t-1+12)%12),n=g.utils.getDaysInMonth(t),r=window.document.createDocumentFragment(),a=g.config.showMonths>1,s=a?"prevMonthDay hidden":"prevMonthDay",l=a?"nextMonthDay hidden":"nextMonthDay",u=i+1-o,d=0;u<=i;u++,d++)r.appendChild(z(s,new Date(e,t-1,u),u,d));for(u=1;u<=n;u++,d++)r.appendChild(z("",new Date(e,t,u),u,d));for(var h=n+1;h<=42-o&&(1===g.config.showMonths||d%7!=0);h++,d++)r.appendChild(z(l,new Date(e,t+1,h%n),h,d));var p=c("div","dayContainer");return p.appendChild(r),p}function B(){if(void 0!==g.daysContainer){u(g.daysContainer),g.weekNumbers&&u(g.weekNumbers);for(var e=document.createDocumentFragment(),t=0;t<g.config.showMonths;t++){var o=new Date(g.currentYear,g.currentMonth,1);o.setMonth(g.currentMonth+t),e.appendChild(H(o.getFullYear(),o.getMonth()))}g.daysContainer.appendChild(e),g.days=g.daysContainer.firstChild,"range"===g.config.mode&&1===g.selectedDates.length&&ee()}}function V(){if(!(g.config.showMonths>1||"dropdown"!==g.config.monthSelectorType)){var e=function(e){return!(void 0!==g.config.minDate&&g.currentYear===g.config.minDate.getFullYear()&&e<g.config.minDate.getMonth()||void 0!==g.config.maxDate&&g.currentYear===g.config.maxDate.getFullYear()&&e>g.config.maxDate.getMonth())};g.monthsDropdownContainer.tabIndex=-1,g.monthsDropdownContainer.innerHTML="";for(var t=0;t<12;t++)if(e(t)){var o=c("option","flatpickr-monthDropdown-month");o.value=new Date(g.currentYear,t).getMonth().toString(),o.textContent=p(t,g.config.shorthandCurrentMonth,g.l10n),o.tabIndex=-1,g.currentMonth===t&&(o.selected=!0),g.monthsDropdownContainer.appendChild(o)}}}function W(){var e,t=c("div","flatpickr-month"),o=window.document.createDocumentFragment();g.config.showMonths>1||"static"===g.config.monthSelectorType?e=c("span","cur-month"):(g.monthsDropdownContainer=c("select","flatpickr-monthDropdown-months"),T(g.monthsDropdownContainer,"change",(function(e){var t=e.target,o=parseInt(t.value,10);g.changeMonth(o-g.currentMonth),he("onMonthChange")})),V(),e=g.monthsDropdownContainer);var i=d("cur-year",{tabindex:"-1"}),n=i.getElementsByTagName("input")[0];n.setAttribute("aria-label",g.l10n.yearAriaLabel),g.config.minDate&&n.setAttribute("min",g.config.minDate.getFullYear().toString()),g.config.maxDate&&(n.setAttribute("max",g.config.maxDate.getFullYear().toString()),n.disabled=!!g.config.minDate&&g.config.minDate.getFullYear()===g.config.maxDate.getFullYear());var r=c("div","flatpickr-current-month");return r.appendChild(e),r.appendChild(i),o.appendChild(r),t.appendChild(o),{container:t,yearElement:n,monthElement:e}}function $(){u(g.monthNav),g.monthNav.appendChild(g.prevMonthNav),g.config.showMonths&&(g.yearElements=[],g.monthElements=[]);for(var e=g.config.showMonths;e--;){var t=W();g.yearElements.push(t.yearElement),g.monthElements.push(t.monthElement),g.monthNav.appendChild(t.container)}g.monthNav.appendChild(g.nextMonthNav)}function G(){g.weekdayContainer?u(g.weekdayContainer):g.weekdayContainer=c("div","flatpickr-weekdays");for(var e=g.config.showMonths;e--;){var t=c("div","flatpickr-weekdaycontainer");g.weekdayContainer.appendChild(t)}return q(),g.weekdayContainer}function q(){if(g.weekdayContainer){var e=g.l10n.firstDayOfWeek,t=g.l10n.weekdays.shorthand.slice();e>0&&e<t.length&&(t=t.splice(e,t.length).concat(t.splice(0,e)));for(var o=g.config.showMonths;o--;)g.weekdayContainer.children[o].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+t.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function Y(e,t){void 0===t&&(t=!0);var o=t?e:e-g.currentMonth;o<0&&!0===g._hidePrevMonthArrow||o>0&&!0===g._hideNextMonthArrow||(g.currentMonth+=o,(g.currentMonth<0||g.currentMonth>11)&&(g.currentYear+=g.currentMonth>11?1:-1,g.currentMonth=(g.currentMonth+12)%12,he("onYearChange"),V()),B(),he("onMonthChange"),me())}function U(e){return!(!g.config.appendTo||!g.config.appendTo.contains(e))||g.calendarContainer.contains(e)}function X(e){if(g.isOpen&&!g.config.inline){var t="function"==typeof(a=e).composedPath?a.composedPath()[0]:a.target,o=U(t),i=t===g.input||t===g.altInput||g.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(g.input)||~e.path.indexOf(g.altInput)),n="blur"===e.type?i&&e.relatedTarget&&!U(e.relatedTarget):!i&&!o&&!U(e.relatedTarget),r=!g.config.ignoredFocusElements.some((function(e){return e.contains(t)}));n&&r&&(void 0!==g.timeContainer&&void 0!==g.minuteElement&&void 0!==g.hourElement&&k(),g.close(),"range"===g.config.mode&&1===g.selectedDates.length&&(g.clear(!1),g.redraw()))}var a}function J(e){if(!(!e||g.config.minDate&&e<g.config.minDate.getFullYear()||g.config.maxDate&&e>g.config.maxDate.getFullYear())){var t=e,o=g.currentYear!==t;g.currentYear=t||g.currentYear,g.config.maxDate&&g.currentYear===g.config.maxDate.getFullYear()?g.currentMonth=Math.min(g.config.maxDate.getMonth(),g.currentMonth):g.config.minDate&&g.currentYear===g.config.minDate.getFullYear()&&(g.currentMonth=Math.max(g.config.minDate.getMonth(),g.currentMonth)),o&&(g.redraw(),he("onYearChange"),V())}}function K(e,t){void 0===t&&(t=!0);var o=g.parseDate(e,void 0,t);if(g.config.minDate&&o&&y(o,g.config.minDate,void 0!==t?t:!g.minDateHasTime)<0||g.config.maxDate&&o&&y(o,g.config.maxDate,void 0!==t?t:!g.maxDateHasTime)>0)return!1;if(0===g.config.enable.length&&0===g.config.disable.length)return!0;if(void 0===o)return!1;for(var i=g.config.enable.length>0,n=i?g.config.enable:g.config.disable,r=0,a=void 0;r<n.length;r++){if("function"==typeof(a=n[r])&&a(o))return i;if(a instanceof Date&&void 0!==o&&a.getTime()===o.getTime())return i;if("string"==typeof a&&void 0!==o){var s=g.parseDate(a,void 0,!0);return s&&s.getTime()===o.getTime()?i:!i}if("object"==typeof a&&void 0!==o&&a.from&&a.to&&o.getTime()>=a.from.getTime()&&o.getTime()<=a.to.getTime())return i}return!i}function Z(e){return void 0!==g.daysContainer&&-1===e.className.indexOf("hidden")&&g.daysContainer.contains(e)}function Q(e){var t=e.target===g._input,o=g.config.allowInput,i=g.isOpen&&(!o||!t),n=g.config.inline&&t&&!o;if(13===e.keyCode&&t){if(o)return g.setDate(g._input.value,!0,e.target===g.altInput?g.config.altFormat:g.config.dateFormat),e.target.blur();g.open()}else if(U(e.target)||i||n){var r=!!g.timeContainer&&g.timeContainer.contains(e.target);switch(e.keyCode){case 13:r?(e.preventDefault(),k(),se()):le(e);break;case 27:e.preventDefault(),se();break;case 8:case 46:t&&!g.config.allowInput&&(e.preventDefault(),g.clear());break;case 37:case 39:if(r||t)g.hourElement&&g.hourElement.focus();else if(e.preventDefault(),void 0!==g.daysContainer&&(!1===o||document.activeElement&&Z(document.activeElement))){var a=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),Y(a),N(j(1),0)):N(void 0,a)}break;case 38:case 40:e.preventDefault();var s=40===e.keyCode?1:-1;g.daysContainer&&void 0!==e.target.$i||e.target===g.input||e.target===g.altInput?e.ctrlKey?(e.stopPropagation(),J(g.currentYear-s),N(j(1),0)):r||N(void 0,7*s):e.target===g.currentYearElement?J(g.currentYear-s):g.config.enableTime&&(!r&&g.hourElement&&g.hourElement.focus(),k(e),g._debouncedChange());break;case 9:if(r){var l=[g.hourElement,g.minuteElement,g.secondElement,g.amPM].concat(g.pluginElements).filter((function(e){return e})),c=l.indexOf(e.target);if(-1!==c){var u=l[c+(e.shiftKey?-1:1)];e.preventDefault(),(u||g._input).focus()}}else!g.config.noCalendar&&g.daysContainer&&g.daysContainer.contains(e.target)&&e.shiftKey&&(e.preventDefault(),g._input.focus())}}if(void 0!==g.amPM&&e.target===g.amPM)switch(e.key){case g.l10n.amPM[0].charAt(0):case g.l10n.amPM[0].charAt(0).toLowerCase():g.amPM.textContent=g.l10n.amPM[0],M(),ve();break;case g.l10n.amPM[1].charAt(0):case g.l10n.amPM[1].charAt(0).toLowerCase():g.amPM.textContent=g.l10n.amPM[1],M(),ve()}(t||U(e.target))&&he("onKeyDown",e)}function ee(e){if(1===g.selectedDates.length&&(!e||e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled"))){for(var t=e?e.dateObj.getTime():g.days.firstElementChild.dateObj.getTime(),o=g.parseDate(g.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,g.selectedDates[0].getTime()),n=Math.max(t,g.selectedDates[0].getTime()),r=!1,a=0,s=0,l=i;l<n;l+=w)K(new Date(l),!0)||(r=r||l>i&&l<n,l<o&&(!a||l>a)?a=l:l>o&&(!s||l<s)&&(s=l));for(var c=0;c<g.config.showMonths;c++)for(var u=g.daysContainer.children[c],d=function(i,n){var l,c,d,h=u.children[i],p=h.dateObj.getTime(),f=a>0&&p<a||s>0&&p>s;return f?(h.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((function(e){h.classList.remove(e)})),"continue"):r&&!f?"continue":(["startRange","inRange","endRange","notAllowed"].forEach((function(e){h.classList.remove(e)})),void(void 0!==e&&(e.classList.add(t<=g.selectedDates[0].getTime()?"startRange":"endRange"),o<t&&p===o?h.classList.add("startRange"):o>t&&p===o&&h.classList.add("endRange"),p>=a&&(0===s||p<=s)&&(c=o,d=t,(l=p)>Math.min(c,d)&&l<Math.max(c,d))&&h.classList.add("inRange"))))},h=0,p=u.children.length;h<p;h++)d(h)}}function te(){!g.isOpen||g.config.static||g.config.inline||re()}function oe(){g.setDate(void 0!==g.config.minDate?new Date(g.config.minDate.getTime()):new Date,!0),D(),ve()}function ie(e){return function(t){var o=g.config["_"+e+"Date"]=g.parseDate(t,g.config.dateFormat),i=g.config["_"+("min"===e?"max":"min")+"Date"];void 0!==o&&(g["min"===e?"minDateHasTime":"maxDateHasTime"]=o.getHours()>0||o.getMinutes()>0||o.getSeconds()>0),g.selectedDates&&(g.selectedDates=g.selectedDates.filter((function(e){return K(e)})),g.selectedDates.length||"min"!==e||_(o),ve()),g.daysContainer&&(ae(),void 0!==o?g.currentYearElement[e]=o.getFullYear().toString():g.currentYearElement.removeAttribute(e),g.currentYearElement.disabled=!!i&&void 0!==o&&i.getFullYear()===o.getFullYear())}}function ne(){"object"!=typeof g.config.locale&&void 0===E.l10ns[g.config.locale]&&g.config.errorHandler(new Error("flatpickr: invalid locale "+g.config.locale)),g.l10n=e({},E.l10ns.default,"object"==typeof g.config.locale?g.config.locale:"default"!==g.config.locale?E.l10ns[g.config.locale]:void 0),m.K="("+g.l10n.amPM[0]+"|"+g.l10n.amPM[1]+"|"+g.l10n.amPM[0].toLowerCase()+"|"+g.l10n.amPM[1].toLowerCase()+")",void 0===e({},f,JSON.parse(JSON.stringify(h.dataset||{}))).time_24hr&&void 0===E.defaultConfig.time_24hr&&(g.config.time_24hr=g.l10n.time_24hr),g.formatDate=v(g),g.parseDate=b({config:g.config,l10n:g.l10n})}function re(e){if(void 0!==g.calendarContainer){he("onPreCalendarPosition");var t=e||g._positionElement,o=Array.prototype.reduce.call(g.calendarContainer.children,(function(e,t){return e+t.offsetHeight}),0),i=g.calendarContainer.offsetWidth,n=g.config.position.split(" "),r=n[0],a=n.length>1?n[1]:null,s=t.getBoundingClientRect(),c=window.innerHeight-s.bottom,u="above"===r||"below"!==r&&c<o&&s.top>o,d=window.pageYOffset+s.top+(u?-o-2:t.offsetHeight+2);if(l(g.calendarContainer,"arrowTop",!u),l(g.calendarContainer,"arrowBottom",u),!g.config.inline){var h=window.pageXOffset+s.left-(null!=a&&"center"===a?(i-s.width)/2:0),p=window.document.body.offsetWidth-(window.pageXOffset+s.right),f=h+i>window.document.body.offsetWidth,m=p+i>window.document.body.offsetWidth;if(l(g.calendarContainer,"rightMost",f),!g.config.static)if(g.calendarContainer.style.top=d+"px",f)if(m){var v=document.styleSheets[0];if(void 0===v)return;var b=window.document.body.offsetWidth,y=Math.max(0,b/2-i/2),w=v.cssRules.length,x="{left:"+s.left+"px;right:auto;}";l(g.calendarContainer,"rightMost",!1),l(g.calendarContainer,"centerMost",!0),v.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+x,w),g.calendarContainer.style.left=y+"px",g.calendarContainer.style.right="auto"}else g.calendarContainer.style.left="auto",g.calendarContainer.style.right=p+"px";else g.calendarContainer.style.left=h+"px",g.calendarContainer.style.right="auto"}}}function ae(){g.config.noCalendar||g.isMobile||(me(),B())}function se(){g._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(g.close,0):g.close()}function le(e){e.preventDefault(),e.stopPropagation();var t=function e(t,o){return o(t)?t:t.parentNode?e(t.parentNode,o):void 0}(e.target,(function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")}));if(void 0!==t){var o=t,i=g.latestSelectedDateObj=new Date(o.dateObj.getTime()),n=(i.getMonth()<g.currentMonth||i.getMonth()>g.currentMonth+g.config.showMonths-1)&&"range"!==g.config.mode;if(g.selectedDateElem=o,"single"===g.config.mode)g.selectedDates=[i];else if("multiple"===g.config.mode){var r=fe(i);r?g.selectedDates.splice(parseInt(r),1):g.selectedDates.push(i)}else"range"===g.config.mode&&(2===g.selectedDates.length&&g.clear(!1,!1),g.latestSelectedDateObj=i,g.selectedDates.push(i),0!==y(i,g.selectedDates[0],!0)&&g.selectedDates.sort((function(e,t){return e.getTime()-t.getTime()})));if(M(),n){var a=g.currentYear!==i.getFullYear();g.currentYear=i.getFullYear(),g.currentMonth=i.getMonth(),a&&(he("onYearChange"),V()),he("onMonthChange")}if(me(),B(),ve(),g.config.enableTime&&setTimeout((function(){return g.showTimeInput=!0}),50),n||"range"===g.config.mode||1!==g.config.showMonths?void 0!==g.selectedDateElem&&void 0===g.hourElement&&g.selectedDateElem&&g.selectedDateElem.focus():I(o),void 0!==g.hourElement&&void 0!==g.hourElement&&g.hourElement.focus(),g.config.closeOnSelect){var s="single"===g.config.mode&&!g.config.enableTime,l="range"===g.config.mode&&2===g.selectedDates.length&&!g.config.enableTime;(s||l)&&se()}P()}}g.parseDate=b({config:g.config,l10n:g.l10n}),g._handlers=[],g.pluginElements=[],g.loadedPlugins=[],g._bind=T,g._setHoursFromDate=_,g._positionCalendar=re,g.changeMonth=Y,g.changeYear=J,g.clear=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),g.input.value="",void 0!==g.altInput&&(g.altInput.value=""),void 0!==g.mobileInput&&(g.mobileInput.value=""),g.selectedDates=[],g.latestSelectedDateObj=void 0,!0===t&&(g.currentYear=g._initialDate.getFullYear(),g.currentMonth=g._initialDate.getMonth()),g.showTimeInput=!1,!0===g.config.enableTime&&D(),g.redraw(),e&&he("onChange")},g.close=function(){g.isOpen=!1,g.isMobile||(void 0!==g.calendarContainer&&g.calendarContainer.classList.remove("open"),void 0!==g._input&&g._input.classList.remove("active")),he("onClose")},g._createElement=c,g.destroy=function(){void 0!==g.config&&he("onDestroy");for(var e=g._handlers.length;e--;){var t=g._handlers[e];t.element.removeEventListener(t.event,t.handler,t.options)}if(g._handlers=[],g.mobileInput)g.mobileInput.parentNode&&g.mobileInput.parentNode.removeChild(g.mobileInput),g.mobileInput=void 0;else if(g.calendarContainer&&g.calendarContainer.parentNode)if(g.config.static&&g.calendarContainer.parentNode){var o=g.calendarContainer.parentNode;if(o.lastChild&&o.removeChild(o.lastChild),o.parentNode){for(;o.firstChild;)o.parentNode.insertBefore(o.firstChild,o);o.parentNode.removeChild(o)}}else g.calendarContainer.parentNode.removeChild(g.calendarContainer);g.altInput&&(g.input.type="text",g.altInput.parentNode&&g.altInput.parentNode.removeChild(g.altInput),delete g.altInput),g.input&&(g.input.type=g.input._type,g.input.classList.remove("flatpickr-input"),g.input.removeAttribute("readonly"),g.input.value=""),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(e){try{delete g[e]}catch(e){}}))},g.isEnabled=K,g.jumpToDate=A,g.open=function(e,t){if(void 0===t&&(t=g._positionElement),!0===g.isMobile)return e&&(e.preventDefault(),e.target&&e.target.blur()),void 0!==g.mobileInput&&(g.mobileInput.focus(),g.mobileInput.click()),void he("onOpen");if(!g._input.disabled&&!g.config.inline){var o=g.isOpen;g.isOpen=!0,o||(g.calendarContainer.classList.add("open"),g._input.classList.add("active"),he("onOpen"),re(t)),!0===g.config.enableTime&&!0===g.config.noCalendar&&(0===g.selectedDates.length&&oe(),!1!==g.config.allowInput||void 0!==e&&g.timeContainer.contains(e.relatedTarget)||setTimeout((function(){return g.hourElement.select()}),50))}},g.redraw=ae,g.set=function(e,o){if(null!==e&&"object"==typeof e)for(var i in Object.assign(g.config,e),e)void 0!==ce[i]&&ce[i].forEach((function(e){return e()}));else g.config[e]=o,void 0!==ce[e]?ce[e].forEach((function(e){return e()})):t.indexOf(e)>-1&&(g.config[e]=s(o));g.redraw(),ve(!1)},g.setDate=function(e,t,o){if(void 0===t&&(t=!1),void 0===o&&(o=g.config.dateFormat),0!==e&&!e||e instanceof Array&&0===e.length)return g.clear(t);ue(e,o),g.showTimeInput=g.selectedDates.length>0,g.latestSelectedDateObj=g.selectedDates[g.selectedDates.length-1],g.redraw(),A(),_(),0===g.selectedDates.length&&g.clear(!1),ve(t),t&&he("onChange")},g.toggle=function(e){if(!0===g.isOpen)return g.close();g.open(e)};var ce={locale:[ne,q],showMonths:[$,C,G],minDate:[A],maxDate:[A]};function ue(e,t){var o=[];if(e instanceof Array)o=e.map((function(e){return g.parseDate(e,t)}));else if(e instanceof Date||"number"==typeof e)o=[g.parseDate(e,t)];else if("string"==typeof e)switch(g.config.mode){case"single":case"time":o=[g.parseDate(e,t)];break;case"multiple":o=e.split(g.config.conjunction).map((function(e){return g.parseDate(e,t)}));break;case"range":o=e.split(g.l10n.rangeSeparator).map((function(e){return g.parseDate(e,t)}))}else g.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));g.selectedDates=o.filter((function(e){return e instanceof Date&&K(e,!1)})),"range"===g.config.mode&&g.selectedDates.sort((function(e,t){return e.getTime()-t.getTime()}))}function de(e){return e.slice().map((function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?g.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:g.parseDate(e.from,void 0),to:g.parseDate(e.to,void 0)}:e})).filter((function(e){return e}))}function he(e,t){if(void 0!==g.config){var o=g.config[e];if(void 0!==o&&o.length>0)for(var i=0;o[i]&&i<o.length;i++)o[i](g.selectedDates,g.input.value,g,t);"onChange"===e&&(g.input.dispatchEvent(pe("change")),g.input.dispatchEvent(pe("input")))}}function pe(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function fe(e){for(var t=0;t<g.selectedDates.length;t++)if(0===y(g.selectedDates[t],e))return""+t;return!1}function me(){g.config.noCalendar||g.isMobile||!g.monthNav||(g.yearElements.forEach((function(e,t){var o=new Date(g.currentYear,g.currentMonth,1);o.setMonth(g.currentMonth+t),g.config.showMonths>1||"static"===g.config.monthSelectorType?g.monthElements[t].textContent=p(o.getMonth(),g.config.shorthandCurrentMonth,g.l10n)+" ":g.monthsDropdownContainer.value=o.getMonth().toString(),e.value=o.getFullYear().toString()})),g._hidePrevMonthArrow=void 0!==g.config.minDate&&(g.currentYear===g.config.minDate.getFullYear()?g.currentMonth<=g.config.minDate.getMonth():g.currentYear<g.config.minDate.getFullYear()),g._hideNextMonthArrow=void 0!==g.config.maxDate&&(g.currentYear===g.config.maxDate.getFullYear()?g.currentMonth+1>g.config.maxDate.getMonth():g.currentYear>g.config.maxDate.getFullYear()))}function ge(e){return g.selectedDates.map((function(t){return g.formatDate(t,e)})).filter((function(e,t,o){return"range"!==g.config.mode||g.config.enableTime||o.indexOf(e)===t})).join("range"!==g.config.mode?g.config.conjunction:g.l10n.rangeSeparator)}function ve(e){void 0===e&&(e=!0),void 0!==g.mobileInput&&g.mobileFormatStr&&(g.mobileInput.value=void 0!==g.latestSelectedDateObj?g.formatDate(g.latestSelectedDateObj,g.mobileFormatStr):""),g.input.value=ge(g.config.dateFormat),void 0!==g.altInput&&(g.altInput.value=ge(g.config.altFormat)),!1!==e&&he("onValueUpdate")}function be(e){var t=g.prevMonthNav.contains(e.target),o=g.nextMonthNav.contains(e.target);t||o?Y(t?-1:1):g.yearElements.indexOf(e.target)>=0?e.target.select():e.target.classList.contains("arrowUp")?g.changeYear(g.currentYear+1):e.target.classList.contains("arrowDown")&&g.changeYear(g.currentYear-1)}return function(){g.element=g.input=h,g.isOpen=!1,function(){var i=["wrap","weekNumbers","allowInput","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],n=e({},f,JSON.parse(JSON.stringify(h.dataset||{}))),r={};g.config.parseDate=n.parseDate,g.config.formatDate=n.formatDate,Object.defineProperty(g.config,"enable",{get:function(){return g.config._enable},set:function(e){g.config._enable=de(e)}}),Object.defineProperty(g.config,"disable",{get:function(){return g.config._disable},set:function(e){g.config._disable=de(e)}});var a="time"===n.mode;if(!n.dateFormat&&(n.enableTime||a)){var l=E.defaultConfig.dateFormat||o.dateFormat;r.dateFormat=n.noCalendar||a?"H:i"+(n.enableSeconds?":S":""):l+" H:i"+(n.enableSeconds?":S":"")}if(n.altInput&&(n.enableTime||a)&&!n.altFormat){var c=E.defaultConfig.altFormat||o.altFormat;r.altFormat=n.noCalendar||a?"h:i"+(n.enableSeconds?":S K":" K"):c+" h:i"+(n.enableSeconds?":S":"")+" K"}n.altInputClass||(g.config.altInputClass=g.input.className+" "+g.config.altInputClass),Object.defineProperty(g.config,"minDate",{get:function(){return g.config._minDate},set:ie("min")}),Object.defineProperty(g.config,"maxDate",{get:function(){return g.config._maxDate},set:ie("max")});var u=function(e){return function(t){g.config["min"===e?"_minTime":"_maxTime"]=g.parseDate(t,"H:i:S")}};Object.defineProperty(g.config,"minTime",{get:function(){return g.config._minTime},set:u("min")}),Object.defineProperty(g.config,"maxTime",{get:function(){return g.config._maxTime},set:u("max")}),"time"===n.mode&&(g.config.noCalendar=!0,g.config.enableTime=!0),Object.assign(g.config,r,n);for(var d=0;d<i.length;d++)g.config[i[d]]=!0===g.config[i[d]]||"true"===g.config[i[d]];for(t.filter((function(e){return void 0!==g.config[e]})).forEach((function(e){g.config[e]=s(g.config[e]||[]).map(x)})),g.isMobile=!g.config.disableMobile&&!g.config.inline&&"single"===g.config.mode&&!g.config.disable.length&&!g.config.enable.length&&!g.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),d=0;d<g.config.plugins.length;d++){var p=g.config.plugins[d](g)||{};for(var m in p)t.indexOf(m)>-1?g.config[m]=s(p[m]).map(x).concat(g.config[m]):void 0===n[m]&&(g.config[m]=p[m])}he("onParseConfig")}(),ne(),g.input=g.config.wrap?h.querySelector("[data-input]"):h,g.input?(g.input._type=g.input.type,g.input.type="text",g.input.classList.add("flatpickr-input"),g._input=g.input,g.config.altInput&&(g.altInput=c(g.input.nodeName,g.config.altInputClass),g._input=g.altInput,g.altInput.placeholder=g.input.placeholder,g.altInput.disabled=g.input.disabled,g.altInput.required=g.input.required,g.altInput.tabIndex=g.input.tabIndex,g.altInput.type="text",g.input.setAttribute("type","hidden"),!g.config.static&&g.input.parentNode&&g.input.parentNode.insertBefore(g.altInput,g.input.nextSibling)),g.config.allowInput||g._input.setAttribute("readonly","readonly"),g._positionElement=g.config.positionElement||g._input):g.config.errorHandler(new Error("Invalid input element specified")),function(){g.selectedDates=[],g.now=g.parseDate(g.config.now)||new Date;var e=g.config.defaultDate||("INPUT"!==g.input.nodeName&&"TEXTAREA"!==g.input.nodeName||!g.input.placeholder||g.input.value!==g.input.placeholder?g.input.value:null);e&&ue(e,g.config.dateFormat),g._initialDate=g.selectedDates.length>0?g.selectedDates[0]:g.config.minDate&&g.config.minDate.getTime()>g.now.getTime()?g.config.minDate:g.config.maxDate&&g.config.maxDate.getTime()<g.now.getTime()?g.config.maxDate:g.now,g.currentYear=g._initialDate.getFullYear(),g.currentMonth=g._initialDate.getMonth(),g.selectedDates.length>0&&(g.latestSelectedDateObj=g.selectedDates[0]),void 0!==g.config.minTime&&(g.config.minTime=g.parseDate(g.config.minTime,"H:i")),void 0!==g.config.maxTime&&(g.config.maxTime=g.parseDate(g.config.maxTime,"H:i")),g.minDateHasTime=!!g.config.minDate&&(g.config.minDate.getHours()>0||g.config.minDate.getMinutes()>0||g.config.minDate.getSeconds()>0),g.maxDateHasTime=!!g.config.maxDate&&(g.config.maxDate.getHours()>0||g.config.maxDate.getMinutes()>0||g.config.maxDate.getSeconds()>0),Object.defineProperty(g,"showTimeInput",{get:function(){return g._showTimeInput},set:function(e){g._showTimeInput=e,g.calendarContainer&&l(g.calendarContainer,"showTimeInput",e),g.isOpen&&re()}})}(),g.utils={getDaysInMonth:function(e,t){return void 0===e&&(e=g.currentMonth),void 0===t&&(t=g.currentYear),1===e&&(t%4==0&&t%100!=0||t%400==0)?29:g.l10n.daysInMonth[e]}},g.isMobile||function(){var e=window.document.createDocumentFragment();if(g.calendarContainer=c("div","flatpickr-calendar"),g.calendarContainer.tabIndex=-1,!g.config.noCalendar){if(e.appendChild((g.monthNav=c("div","flatpickr-months"),g.yearElements=[],g.monthElements=[],g.prevMonthNav=c("span","flatpickr-prev-month"),g.prevMonthNav.innerHTML=g.config.prevArrow,g.nextMonthNav=c("span","flatpickr-next-month"),g.nextMonthNav.innerHTML=g.config.nextArrow,$(),Object.defineProperty(g,"_hidePrevMonthArrow",{get:function(){return g.__hidePrevMonthArrow},set:function(e){g.__hidePrevMonthArrow!==e&&(l(g.prevMonthNav,"flatpickr-disabled",e),g.__hidePrevMonthArrow=e)}}),Object.defineProperty(g,"_hideNextMonthArrow",{get:function(){return g.__hideNextMonthArrow},set:function(e){g.__hideNextMonthArrow!==e&&(l(g.nextMonthNav,"flatpickr-disabled",e),g.__hideNextMonthArrow=e)}}),g.currentYearElement=g.yearElements[0],me(),g.monthNav)),g.innerContainer=c("div","flatpickr-innerContainer"),g.config.weekNumbers){var t=function(){g.calendarContainer.classList.add("hasWeeks");var e=c("div","flatpickr-weekwrapper");e.appendChild(c("span","flatpickr-weekday",g.l10n.weekAbbreviation));var t=c("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}(),o=t.weekWrapper,i=t.weekNumbers;g.innerContainer.appendChild(o),g.weekNumbers=i,g.weekWrapper=o}g.rContainer=c("div","flatpickr-rContainer"),g.rContainer.appendChild(G()),g.daysContainer||(g.daysContainer=c("div","flatpickr-days"),g.daysContainer.tabIndex=-1),B(),g.rContainer.appendChild(g.daysContainer),g.innerContainer.appendChild(g.rContainer),e.appendChild(g.innerContainer)}g.config.enableTime&&e.appendChild(function(){g.calendarContainer.classList.add("hasTime"),g.config.noCalendar&&g.calendarContainer.classList.add("noCalendar"),g.timeContainer=c("div","flatpickr-time"),g.timeContainer.tabIndex=-1;var e=c("span","flatpickr-time-separator",":"),t=d("flatpickr-hour",{"aria-label":g.l10n.hourAriaLabel});g.hourElement=t.getElementsByTagName("input")[0];var o=d("flatpickr-minute",{"aria-label":g.l10n.minuteAriaLabel});if(g.minuteElement=o.getElementsByTagName("input")[0],g.hourElement.tabIndex=g.minuteElement.tabIndex=-1,g.hourElement.value=n(g.latestSelectedDateObj?g.latestSelectedDateObj.getHours():g.config.time_24hr?g.config.defaultHour:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(g.config.defaultHour)),g.minuteElement.value=n(g.latestSelectedDateObj?g.latestSelectedDateObj.getMinutes():g.config.defaultMinute),g.hourElement.setAttribute("step",g.config.hourIncrement.toString()),g.minuteElement.setAttribute("step",g.config.minuteIncrement.toString()),g.hourElement.setAttribute("min",g.config.time_24hr?"0":"1"),g.hourElement.setAttribute("max",g.config.time_24hr?"23":"12"),g.minuteElement.setAttribute("min","0"),g.minuteElement.setAttribute("max","59"),g.timeContainer.appendChild(t),g.timeContainer.appendChild(e),g.timeContainer.appendChild(o),g.config.time_24hr&&g.timeContainer.classList.add("time24hr"),g.config.enableSeconds){g.timeContainer.classList.add("hasSeconds");var i=d("flatpickr-second");g.secondElement=i.getElementsByTagName("input")[0],g.secondElement.value=n(g.latestSelectedDateObj?g.latestSelectedDateObj.getSeconds():g.config.defaultSeconds),g.secondElement.setAttribute("step",g.minuteElement.getAttribute("step")),g.secondElement.setAttribute("min","0"),g.secondElement.setAttribute("max","59"),g.timeContainer.appendChild(c("span","flatpickr-time-separator",":")),g.timeContainer.appendChild(i)}return g.config.time_24hr||(g.amPM=c("span","flatpickr-am-pm",g.l10n.amPM[r((g.latestSelectedDateObj?g.hourElement.value:g.config.defaultHour)>11)]),g.amPM.title=g.l10n.toggleTitle,g.amPM.tabIndex=-1,g.timeContainer.appendChild(g.amPM)),g.timeContainer}()),l(g.calendarContainer,"rangeMode","range"===g.config.mode),l(g.calendarContainer,"animate",!0===g.config.animate),l(g.calendarContainer,"multiMonth",g.config.showMonths>1),g.calendarContainer.appendChild(e);var a=void 0!==g.config.appendTo&&void 0!==g.config.appendTo.nodeType;if((g.config.inline||g.config.static)&&(g.calendarContainer.classList.add(g.config.inline?"inline":"static"),g.config.inline&&(!a&&g.element.parentNode?g.element.parentNode.insertBefore(g.calendarContainer,g._input.nextSibling):void 0!==g.config.appendTo&&g.config.appendTo.appendChild(g.calendarContainer)),g.config.static)){var s=c("div","flatpickr-wrapper");g.element.parentNode&&g.element.parentNode.insertBefore(s,g.element),s.appendChild(g.element),g.altInput&&s.appendChild(g.altInput),s.appendChild(g.calendarContainer)}g.config.static||g.config.inline||(void 0!==g.config.appendTo?g.config.appendTo:window.document.body).appendChild(g.calendarContainer)}(),function(){if(g.config.wrap&&["open","close","toggle","clear"].forEach((function(e){Array.prototype.forEach.call(g.element.querySelectorAll("[data-"+e+"]"),(function(t){return T(t,"click",g[e])}))})),g.isMobile)!function(){var e=g.config.enableTime?g.config.noCalendar?"time":"datetime-local":"date";g.mobileInput=c("input",g.input.className+" flatpickr-mobile"),g.mobileInput.step=g.input.getAttribute("step")||"any",g.mobileInput.tabIndex=1,g.mobileInput.type=e,g.mobileInput.disabled=g.input.disabled,g.mobileInput.required=g.input.required,g.mobileInput.placeholder=g.input.placeholder,g.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",g.selectedDates.length>0&&(g.mobileInput.defaultValue=g.mobileInput.value=g.formatDate(g.selectedDates[0],g.mobileFormatStr)),g.config.minDate&&(g.mobileInput.min=g.formatDate(g.config.minDate,"Y-m-d")),g.config.maxDate&&(g.mobileInput.max=g.formatDate(g.config.maxDate,"Y-m-d")),g.input.type="hidden",void 0!==g.altInput&&(g.altInput.type="hidden");try{g.input.parentNode&&g.input.parentNode.insertBefore(g.mobileInput,g.input.nextSibling)}catch(e){}T(g.mobileInput,"change",(function(e){g.setDate(e.target.value,!1,g.mobileFormatStr),he("onChange"),he("onClose")}))}();else{var e=a(te,50);g._debouncedChange=a(P,300),g.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&T(g.daysContainer,"mouseover",(function(e){"range"===g.config.mode&&ee(e.target)})),T(window.document.body,"keydown",Q),g.config.inline||g.config.static||T(window,"resize",e),void 0!==window.ontouchstart?T(window.document,"touchstart",X):T(window.document,"mousedown",L(X)),T(window.document,"focus",X,{capture:!0}),!0===g.config.clickOpens&&(T(g._input,"focus",g.open),T(g._input,"mousedown",L(g.open))),void 0!==g.daysContainer&&(T(g.monthNav,"mousedown",L(be)),T(g.monthNav,["keyup","increment"],R),T(g.daysContainer,"mousedown",L(le))),void 0!==g.timeContainer&&void 0!==g.minuteElement&&void 0!==g.hourElement&&(T(g.timeContainer,["increment"],k),T(g.timeContainer,"blur",k,{capture:!0}),T(g.timeContainer,"mousedown",L(F)),T([g.hourElement,g.minuteElement],["focus","click"],(function(e){return e.target.select()})),void 0!==g.secondElement&&T(g.secondElement,"focus",(function(){return g.secondElement&&g.secondElement.select()})),void 0!==g.amPM&&T(g.amPM,"mousedown",L((function(e){k(e),P()}))))}}(),(g.selectedDates.length||g.config.noCalendar)&&(g.config.enableTime&&_(g.config.noCalendar?g.latestSelectedDateObj||g.config.minDate:void 0),ve(!1)),C(),g.showTimeInput=g.selectedDates.length>0||g.config.noCalendar;var i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!g.isMobile&&i&&re(),he("onReady")}(),g}function C(e,t){for(var o=Array.prototype.slice.call(e).filter((function(e){return e instanceof HTMLElement})),i=[],n=0;n<o.length;n++){var r=o[n];try{if(null!==r.getAttribute("data-fp-omit"))continue;void 0!==r._flatpickr&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=x(r,t||{}),i.push(r._flatpickr)}catch(e){console.error(e)}}return 1===i.length?i[0]:i}"function"!=typeof Object.assign&&(Object.assign=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(!e)throw TypeError("Cannot convert undefined or null to object");for(var i=function(t){t&&Object.keys(t).forEach((function(o){return e[o]=t[o]}))},n=0,r=t;n<r.length;n++){var a=r[n];i(a)}return e}),"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return C(this,e)},HTMLElement.prototype.flatpickr=function(e){return C([this],e)});var E=function(e,t){return"string"==typeof e?C(window.document.querySelectorAll(e),t):e instanceof Node?C([e],t):C(e,t)};return E.defaultConfig={},E.l10ns={en:e({},i),default:e({},i)},E.localize=function(t){E.l10ns.default=e({},E.l10ns.default,t)},E.setDefaults=function(t){E.defaultConfig=e({},E.defaultConfig,t)},E.parseDate=b({}),E.formatDate=v({}),E.compareDates=y,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return C(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=E),E}()},1168:e=>{function t(e){this.message=e}t.prototype=new Error,t.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var o=String(e).replace(/=+$/,"");if(o.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,n,r=0,a=0,s="";n=o.charAt(a++);~n&&(i=r%4?64*i+n:n,r++%4)?s+=String.fromCharCode(255&i>>(-2*r&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s}},4491:(e,t,o)=>{var i=o(1168);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(i(e).replace(/(.)/g,(function(e,t){var o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o})))}(t)}catch(e){return i(t)}}},6489:(e,t,o)=>{"use strict";var i=o(4491);function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new n("Invalid token specified");var o=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[o]))}catch(e){throw new n("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=n},8552:(e,t,o)=>{var i=o(852)(o(5639),"DataView");e.exports=i},1989:(e,t,o)=>{var i=o(1789),n=o(401),r=o(7667),a=o(1327),s=o(1866);function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=n,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},8407:(e,t,o)=>{var i=o(7040),n=o(4125),r=o(2117),a=o(7518),s=o(4705);function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=n,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},7071:(e,t,o)=>{var i=o(852)(o(5639),"Map");e.exports=i},3369:(e,t,o)=>{var i=o(4785),n=o(1285),r=o(6e3),a=o(9916),s=o(5265);function l(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=n,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,e.exports=l},3818:(e,t,o)=>{var i=o(852)(o(5639),"Promise");e.exports=i},8525:(e,t,o)=>{var i=o(852)(o(5639),"Set");e.exports=i},6384:(e,t,o)=>{var i=o(8407),n=o(7465),r=o(3779),a=o(7599),s=o(4758),l=o(4309);function c(e){var t=this.__data__=new i(e);this.size=t.size}c.prototype.clear=n,c.prototype.delete=r,c.prototype.get=a,c.prototype.has=s,c.prototype.set=l,e.exports=c},2705:(e,t,o)=>{var i=o(5639).Symbol;e.exports=i},1149:(e,t,o)=>{var i=o(5639).Uint8Array;e.exports=i},577:(e,t,o)=>{var i=o(852)(o(5639),"WeakMap");e.exports=i},7412:e=>{e.exports=function(e,t){for(var o=-1,i=null==e?0:e.length;++o<i&&!1!==t(e[o],o,e););return e}},4963:e=>{e.exports=function(e,t){for(var o=-1,i=null==e?0:e.length,n=0,r=[];++o<i;){var a=e[o];t(a,o,e)&&(r[n++]=a)}return r}},4636:(e,t,o)=>{var i=o(2545),n=o(5694),r=o(1469),a=o(4144),s=o(5776),l=o(6719),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var o=r(e),u=!o&&n(e),d=!o&&!u&&a(e),h=!o&&!u&&!d&&l(e),p=o||u||d||h,f=p?i(e.length,String):[],m=f.length;for(var g in e)!t&&!c.call(e,g)||p&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||f.push(g);return f}},2488:e=>{e.exports=function(e,t){for(var o=-1,i=t.length,n=e.length;++o<i;)e[n+o]=t[o];return e}},4865:(e,t,o)=>{var i=o(9465),n=o(7813),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,o){var a=e[t];r.call(e,t)&&n(a,o)&&(void 0!==o||t in e)||i(e,t,o)}},8470:(e,t,o)=>{var i=o(7813);e.exports=function(e,t){for(var o=e.length;o--;)if(i(e[o][0],t))return o;return-1}},4037:(e,t,o)=>{var i=o(8363),n=o(3674);e.exports=function(e,t){return e&&i(t,n(t),e)}},3886:(e,t,o)=>{var i=o(8363),n=o(1704);e.exports=function(e,t){return e&&i(t,n(t),e)}},9465:(e,t,o)=>{var i=o(8777);e.exports=function(e,t,o){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},5990:(e,t,o)=>{var i=o(6384),n=o(7412),r=o(4865),a=o(4037),s=o(3886),l=o(4626),c=o(278),u=o(8805),d=o(1911),h=o(8234),p=o(6904),f=o(4160),m=o(3824),g=o(9148),v=o(8517),b=o(1469),y=o(4144),w=o(6688),x=o(3218),C=o(2928),E=o(3674),k={};k["[object Arguments]"]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k["[object Object]"]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k["[object Function]"]=k["[object WeakMap]"]=!1,e.exports=function e(t,o,M,_,D,S){var R,T=1&o,L=2&o,P=4&o;if(M&&(R=D?M(t,_,D,S):M(t)),void 0!==R)return R;if(!x(t))return t;var A=b(t);if(A){if(R=m(t),!T)return c(t,R)}else{var F=f(t),O="[object Function]"==F||"[object GeneratorFunction]"==F;if(y(t))return l(t,T);if("[object Object]"==F||"[object Arguments]"==F||O&&!D){if(R=L||O?{}:v(t),!T)return L?d(t,s(R,t)):u(t,a(R,t))}else{if(!k[F])return D?t:{};R=g(t,F,T)}}S||(S=new i);var z=S.get(t);if(z)return z;S.set(t,R),C(t)?t.forEach((function(i){R.add(e(i,o,M,i,t,S))})):w(t)&&t.forEach((function(i,n){R.set(n,e(i,o,M,n,t,S))}));var I=P?L?p:h:L?keysIn:E,j=A?void 0:I(t);return n(j||t,(function(i,n){j&&(i=t[n=i]),r(R,n,e(i,o,M,n,t,S))})),R}},3118:(e,t,o)=>{var i=o(3218),n=Object.create,r=function(){function e(){}return function(t){if(!i(t))return{};if(n)return n(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();e.exports=r},8866:(e,t,o)=>{var i=o(2488),n=o(1469);e.exports=function(e,t,o){var r=t(e);return n(e)?r:i(r,o(e))}},4239:(e,t,o)=>{var i=o(2705),n=o(9607),r=o(2333),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?n(e):r(e)}},9454:(e,t,o)=>{var i=o(4239),n=o(7005);e.exports=function(e){return n(e)&&"[object Arguments]"==i(e)}},5588:(e,t,o)=>{var i=o(4160),n=o(7005);e.exports=function(e){return n(e)&&"[object Map]"==i(e)}},8458:(e,t,o)=>{var i=o(3560),n=o(5346),r=o(3218),a=o(346),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!r(e)||n(e))&&(i(e)?h:s).test(a(e))}},9221:(e,t,o)=>{var i=o(4160),n=o(7005);e.exports=function(e){return n(e)&&"[object Set]"==i(e)}},8749:(e,t,o)=>{var i=o(4239),n=o(1780),r=o(7005),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return r(e)&&n(e.length)&&!!a[i(e)]}},280:(e,t,o)=>{var i=o(5726),n=o(6916),r=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return n(e);var t=[];for(var o in Object(e))r.call(e,o)&&"constructor"!=o&&t.push(o);return t}},313:(e,t,o)=>{var i=o(3218),n=o(5726),r=o(3498),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return r(e);var t=n(e),o=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&o.push(s);return o}},2545:e=>{e.exports=function(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}},1717:e=>{e.exports=function(e){return function(t){return e(t)}}},4318:(e,t,o)=>{var i=o(1149);e.exports=function(e){var t=new e.constructor(e.byteLength);return new i(t).set(new i(e)),t}},4626:(e,t,o)=>{e=o.nmd(e);var i=o(5639),n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,a=r&&r.exports===n?i.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,i=s?s(o):new e.constructor(o);return e.copy(i),i}},7157:(e,t,o)=>{var i=o(4318);e.exports=function(e,t){var o=t?i(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}},3147:e=>{var t=/\w*$/;e.exports=function(e){var o=new e.constructor(e.source,t.exec(e));return o.lastIndex=e.lastIndex,o}},419:(e,t,o)=>{var i=o(2705),n=i?i.prototype:void 0,r=n?n.valueOf:void 0;e.exports=function(e){return r?Object(r.call(e)):{}}},7133:(e,t,o)=>{var i=o(4318);e.exports=function(e,t){var o=t?i(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}},278:e=>{e.exports=function(e,t){var o=-1,i=e.length;for(t||(t=Array(i));++o<i;)t[o]=e[o];return t}},8363:(e,t,o)=>{var i=o(4865),n=o(9465);e.exports=function(e,t,o,r){var a=!o;o||(o={});for(var s=-1,l=t.length;++s<l;){var c=t[s],u=r?r(o[c],e[c],c,o,e):void 0;void 0===u&&(u=e[c]),a?n(o,c,u):i(o,c,u)}return o}},8805:(e,t,o)=>{var i=o(8363),n=o(9551);e.exports=function(e,t){return i(e,n(e),t)}},1911:(e,t,o)=>{var i=o(8363),n=o(1442);e.exports=function(e,t){return i(e,n(e),t)}},4429:(e,t,o)=>{var i=o(5639)["__core-js_shared__"];e.exports=i},8777:(e,t,o)=>{var i=o(852),n=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=n},1957:(e,t,o)=>{var i="object"==typeof o.g&&o.g&&o.g.Object===Object&&o.g;e.exports=i},8234:(e,t,o)=>{var i=o(8866),n=o(9551),r=o(3674);e.exports=function(e){return i(e,r,n)}},6904:(e,t,o)=>{var i=o(8866),n=o(1442),r=o(1704);e.exports=function(e){return i(e,r,n)}},5050:(e,t,o)=>{var i=o(7019);e.exports=function(e,t){var o=e.__data__;return i(t)?o["string"==typeof t?"string":"hash"]:o.map}},852:(e,t,o)=>{var i=o(8458),n=o(7801);e.exports=function(e,t){var o=n(e,t);return i(o)?o:void 0}},5924:(e,t,o)=>{var i=o(5569)(Object.getPrototypeOf,Object);e.exports=i},9607:(e,t,o)=>{var i=o(2705),n=Object.prototype,r=n.hasOwnProperty,a=n.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=r.call(e,s),o=e[s];try{e[s]=void 0;var i=!0}catch(e){}var n=a.call(e);return i&&(t?e[s]=o:delete e[s]),n}},9551:(e,t,o)=>{var i=o(4963),n=o(479),r=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),i(a(e),(function(t){return r.call(e,t)})))}:n;e.exports=s},1442:(e,t,o)=>{var i=o(2488),n=o(5924),r=o(9551),a=o(479),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)i(t,r(e)),e=n(e);return t}:a;e.exports=s},4160:(e,t,o)=>{var i=o(8552),n=o(7071),r=o(3818),a=o(8525),s=o(577),l=o(4239),c=o(346),u=c(i),d=c(n),h=c(r),p=c(a),f=c(s),m=l;(i&&"[object DataView]"!=m(new i(new ArrayBuffer(1)))||n&&"[object Map]"!=m(new n)||r&&"[object Promise]"!=m(r.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(e){var t=l(e),o="[object Object]"==t?e.constructor:void 0,i=o?c(o):"";if(i)switch(i){case u:return"[object DataView]";case d:return"[object Map]";case h:return"[object Promise]";case p:return"[object Set]";case f:return"[object WeakMap]"}return t}),e.exports=m},7801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},1789:(e,t,o)=>{var i=o(4536);e.exports=function(){this.__data__=i?i(null):{},this.size=0}},401:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},7667:(e,t,o)=>{var i=o(4536),n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(i){var o=t[e];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(t,e)?t[e]:void 0}},1327:(e,t,o)=>{var i=o(4536),n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:n.call(t,e)}},1866:(e,t,o)=>{var i=o(4536);e.exports=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},3824:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var o=e.length,i=new e.constructor(o);return o&&"string"==typeof e[0]&&t.call(e,"index")&&(i.index=e.index,i.input=e.input),i}},9148:(e,t,o)=>{var i=o(4318),n=o(7157),r=o(3147),a=o(419),s=o(7133);e.exports=function(e,t,o){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return i(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return n(e,o);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,o);case"[object Map]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return r(e);case"[object Set]":return new l;case"[object Symbol]":return a(e)}}},8517:(e,t,o)=>{var i=o(3118),n=o(5924),r=o(5726);e.exports=function(e){return"function"!=typeof e.constructor||r(e)?{}:i(n(e))}},5776:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,o){var i=typeof e;return!!(o=null==o?9007199254740991:o)&&("number"==i||"symbol"!=i&&t.test(e))&&e>-1&&e%1==0&&e<o}},7019:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5346:(e,t,o)=>{var i,n=o(4429),r=(i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(e){return!!r&&r in e}},5726:e=>{var t=Object.prototype;e.exports=function(e){var o=e&&e.constructor;return e===("function"==typeof o&&o.prototype||t)}},7040:e=>{e.exports=function(){this.__data__=[],this.size=0}},4125:(e,t,o)=>{var i=o(8470),n=Array.prototype.splice;e.exports=function(e){var t=this.__data__,o=i(t,e);return!(o<0)&&(o==t.length-1?t.pop():n.call(t,o,1),--this.size,!0)}},2117:(e,t,o)=>{var i=o(8470);e.exports=function(e){var t=this.__data__,o=i(t,e);return o<0?void 0:t[o][1]}},7518:(e,t,o)=>{var i=o(8470);e.exports=function(e){return i(this.__data__,e)>-1}},4705:(e,t,o)=>{var i=o(8470);e.exports=function(e,t){var o=this.__data__,n=i(o,e);return n<0?(++this.size,o.push([e,t])):o[n][1]=t,this}},4785:(e,t,o)=>{var i=o(1989),n=o(8407),r=o(7071);e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(r||n),string:new i}}},1285:(e,t,o)=>{var i=o(5050);e.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},6e3:(e,t,o)=>{var i=o(5050);e.exports=function(e){return i(this,e).get(e)}},9916:(e,t,o)=>{var i=o(5050);e.exports=function(e){return i(this,e).has(e)}},5265:(e,t,o)=>{var i=o(5050);e.exports=function(e,t){var o=i(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this}},4536:(e,t,o)=>{var i=o(852)(Object,"create");e.exports=i},6916:(e,t,o)=>{var i=o(5569)(Object.keys,Object);e.exports=i},3498:e=>{e.exports=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}},1167:(e,t,o)=>{e=o.nmd(e);var i=o(1957),n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,a=r&&r.exports===n&&i.process,s=function(){try{var e=r&&r.require&&r.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:e=>{e.exports=function(e,t){return function(o){return e(t(o))}}},5639:(e,t,o)=>{var i=o(1957),n="object"==typeof self&&self&&self.Object===Object&&self,r=i||n||Function("return this")();e.exports=r},7465:(e,t,o)=>{var i=o(8407);e.exports=function(){this.__data__=new i,this.size=0}},3779:e=>{e.exports=function(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}},7599:e=>{e.exports=function(e){return this.__data__.get(e)}},4758:e=>{e.exports=function(e){return this.__data__.has(e)}},4309:(e,t,o)=>{var i=o(8407),n=o(7071),r=o(3369);e.exports=function(e,t){var o=this.__data__;if(o instanceof i){var a=o.__data__;if(!n||a.length<199)return a.push([e,t]),this.size=++o.size,this;o=this.__data__=new r(a)}return o.set(e,t),this.size=o.size,this}},346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},361:(e,t,o)=>{var i=o(5990);e.exports=function(e){return i(e,5)}},7813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5694:(e,t,o)=>{var i=o(9454),n=o(7005),r=Object.prototype,a=r.hasOwnProperty,s=r.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(e){return n(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},1469:e=>{var t=Array.isArray;e.exports=t},8612:(e,t,o)=>{var i=o(3560),n=o(1780);e.exports=function(e){return null!=e&&n(e.length)&&!i(e)}},4144:(e,t,o)=>{e=o.nmd(e);var i=o(5639),n=o(5062),r=t&&!t.nodeType&&t,a=r&&e&&!e.nodeType&&e,s=a&&a.exports===r?i.Buffer:void 0,l=(s?s.isBuffer:void 0)||n;e.exports=l},3560:(e,t,o)=>{var i=o(4239),n=o(3218);e.exports=function(e){if(!n(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1780:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},6688:(e,t,o)=>{var i=o(5588),n=o(1717),r=o(1167),a=r&&r.isMap,s=a?n(a):i;e.exports=s},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},2928:(e,t,o)=>{var i=o(9221),n=o(1717),r=o(1167),a=r&&r.isSet,s=a?n(a):i;e.exports=s},6719:(e,t,o)=>{var i=o(8749),n=o(1717),r=o(1167),a=r&&r.isTypedArray,s=a?n(a):i;e.exports=s},3674:(e,t,o)=>{var i=o(4636),n=o(280),r=o(8612);e.exports=function(e){return r(e)?i(e):n(e)}},1704:(e,t,o)=>{var i=o(4636),n=o(313),r=o(8612);e.exports=function(e){return r(e)?i(e,!0):n(e)}},479:e=>{e.exports=function(){return[]}},5062:e=>{e.exports=function(){return!1}},8508:function(t,o,i){var n,r,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a=function(){"use strict";Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],n=0;n<o;){var r=t[n];if(e.call(i,r,n,t))return n;n++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var i=arguments[1],n=0;n<o;){var r=t[n];if(e.call(i,r,n,t))return r;n++}}});var t=function(e){this.table=e,this.blockHozScrollEvent=!1,this.headersElement=this.createHeadersElement(),this.element=this.createHeaderElement(),this.rowManager=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.element.insertBefore(this.headersElement,this.element.firstChild)};t.prototype.createHeadersElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e},t.prototype.createHeaderElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-header"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e},t.prototype.initialize=function(){},t.prototype.setRowManager=function(e){this.rowManager=e},t.prototype.getElement=function(){return this.element},t.prototype.getHeadersElement=function(){return this.headersElement},t.prototype.scrollHorizontal=function(e){var t=0,o=this.element.scrollWidth-this.table.element.clientWidth;this.element.scrollLeft=e,e>o?(t=e-o,this.element.style.marginLeft=-t+"px"):this.element.style.marginLeft=0,this.scrollLeft=e,this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.scrollHorizontal()},t.prototype.generateColumnsFromRowData=function(e){var t,o,i=[];if(e&&e.length){for(var n in t=e[0]){var r={field:n,title:n},a=t[n];switch(void 0===a?"undefined":s(a)){case"undefined":o="string";break;case"boolean":o="boolean";break;case"object":o=Array.isArray(a)?"array":"string";break;default:o=isNaN(a)||""===a?a.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?"alphanum":"string":"number"}r.sorter=o,i.push(r)}this.table.options.columns=i,this.setColumns(this.table.options.columns)}},t.prototype.setColumns=function(e,t){for(var o=this;o.headersElement.firstChild;)o.headersElement.removeChild(o.headersElement.firstChild);o.columns=[],o.columnsByIndex=[],o.columnsByField={},o.table.modExists("frozenColumns")&&o.table.modules.frozenColumns.reset(),e.forEach((function(e,t){o._addColumn(e)})),o._reIndexColumns(),o.table.options.responsiveLayout&&o.table.modExists("responsiveLayout",!0)&&o.table.modules.responsiveLayout.initialize(),o.redraw(!0)},t.prototype._addColumn=function(e,t,o){var n=new i(e,this),r=n.getElement(),a=o?this.findColumnIndex(o):o;if(o&&a>-1){var s=this.columns.indexOf(o.getTopColumn()),l=o.getElement();t?(this.columns.splice(s,0,n),l.parentNode.insertBefore(r,l)):(this.columns.splice(s+1,0,n),l.parentNode.insertBefore(r,l.nextSibling))}else t?(this.columns.unshift(n),this.headersElement.insertBefore(n.getElement(),this.headersElement.firstChild)):(this.columns.push(n),this.headersElement.appendChild(n.getElement())),n.columnRendered();return n},t.prototype.registerColumnField=function(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)},t.prototype.registerColumnPosition=function(e){this.columnsByIndex.push(e)},t.prototype._reIndexColumns=function(){this.columnsByIndex=[],this.columns.forEach((function(e){e.reRegisterPosition()}))},t.prototype._verticalAlignHeaders=function(){var e=this,t=0;e.columns.forEach((function(e){var o;e.clearVerticalAlign(),(o=e.getHeight())>t&&(t=o)})),e.columns.forEach((function(o){o.verticalAlign(e.table.options.columnHeaderVertAlign,t)})),e.rowManager.adjustTableSize()},t.prototype.findColumn=function(e){return"object"!=(void 0===e?"undefined":s(e))?this.columnsByField[e]||!1:e instanceof i?e:e instanceof o?e._getSelf()||!1:"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&this.columns.find((function(t){return t.element===e}))||!1},t.prototype.getColumnByField=function(e){return this.columnsByField[e]},t.prototype.getColumnsByFieldRoot=function(e){var t=this,o=[];return Object.keys(this.columnsByField).forEach((function(i){i.split(".")[0]===e&&o.push(t.columnsByField[i])})),o},t.prototype.getColumnByIndex=function(e){return this.columnsByIndex[e]},t.prototype.getFirstVisibileColumn=function(e){return(e=this.columnsByIndex.findIndex((function(e){return e.visible})))>-1&&this.columnsByIndex[e]},t.prototype.getColumns=function(){return this.columns},t.prototype.findColumnIndex=function(e){return this.columnsByIndex.findIndex((function(t){return e===t}))},t.prototype.getRealColumns=function(){return this.columnsByIndex},t.prototype.traverse=function(e){this.columnsByIndex.forEach((function(t,o){e(t,o)}))},t.prototype.getDefinitions=function(e){var t=[];return this.columnsByIndex.forEach((function(o){(!e||e&&o.visible)&&t.push(o.getDefinition())})),t},t.prototype.getDefinitionTree=function(){var e=[];return this.columns.forEach((function(t){e.push(t.getDefinition(!0))})),e},t.prototype.getComponents=function(e){var t=[];return(e?this.columns:this.columnsByIndex).forEach((function(e){t.push(e.getComponent())})),t},t.prototype.getWidth=function(){var e=0;return this.columnsByIndex.forEach((function(t){t.visible&&(e+=t.getWidth())})),e},t.prototype.moveColumn=function(e,t,o){this.moveColumnActual(e,t,o),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),t.element.parentNode.insertBefore(e.element,t.element),o&&t.element.parentNode.insertBefore(t.element,e.element),this._verticalAlignHeaders(),this.table.rowManager.reinitialize()},t.prototype.moveColumnActual=function(e,t,o){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,o):this._moveColumnInArray(this.columns,e,t,o),this._moveColumnInArray(this.columnsByIndex,e,t,o,!0),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.table.options.columnMoved&&this.table.options.columnMoved.call(this.table,e.getComponent(),this.table.columnManager.getComponents()),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns")},t.prototype._moveColumnInArray=function(e,t,o,i,n){var r,a=e.indexOf(t);a>-1&&(e.splice(a,1),(r=e.indexOf(o))>-1?i&&(r+=1):r=a,e.splice(r,0,t),n&&this.table.rowManager.rows.forEach((function(e){if(e.cells.length){var t=e.cells.splice(a,1)[0];e.cells.splice(r,0,t)}})))},t.prototype.scrollToColumn=function(e,t,o){var i=this,n=0,r=0,a=0,s=e.getElement();return new Promise((function(l,c){if(void 0===t&&(t=i.table.options.scrollToColumnPosition),void 0===o&&(o=i.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":a=-i.element.clientWidth/2;break;case"right":a=s.clientWidth-i.headersElement.clientWidth}if(!o&&(r=s.offsetLeft)>0&&r+s.offsetWidth<i.element.clientWidth)return!1;n=s.offsetLeft+i.element.scrollLeft+a,n=Math.max(Math.min(n,i.table.rowManager.element.scrollWidth-i.table.rowManager.element.clientWidth),0),i.table.rowManager.scrollHorizontal(n),i.scrollHorizontal(n),l()}else console.warn("Scroll Error - Column not visible"),c("Scroll Error - Column not visible")}))},t.prototype.generateCells=function(e){var t=[];return this.columnsByIndex.forEach((function(o){t.push(o.generateCell(e))})),t},t.prototype.getFlexBaseWidth=function(){var e=this,t=e.table.element.clientWidth,o=0;return e.rowManager.element.scrollHeight>e.rowManager.element.clientHeight&&(t-=e.rowManager.element.offsetWidth-e.rowManager.element.clientWidth),this.columnsByIndex.forEach((function(i){var n,r,a;i.visible&&(n=i.definition.width||0,r=void 0===i.minWidth?e.table.options.columnMinWidth:parseInt(i.minWidth),a="string"==typeof n?n.indexOf("%")>-1?t/100*parseInt(n):parseInt(n):n,o+=a>r?a:r)})),o},t.prototype.addColumn=function(e,t,o){var i=this;return new Promise((function(n,r){var a=i._addColumn(e,t,o);i._reIndexColumns(),i.table.options.responsiveLayout&&i.table.modExists("responsiveLayout",!0)&&i.table.modules.responsiveLayout.initialize(),i.table.modExists("columnCalcs")&&i.table.modules.columnCalcs.recalc(i.table.rowManager.activeRows),i.redraw(),"fitColumns"!=i.table.modules.layout.getMode()&&a.reinitializeWidth(),i._verticalAlignHeaders(),i.table.rowManager.reinitialize(),n(a)}))},t.prototype.deregisterColumn=function(e){var t,o=e.getField();o&&delete this.columnsByField[o],(t=this.columnsByIndex.indexOf(e))>-1&&this.columnsByIndex.splice(t,1),(t=this.columns.indexOf(e))>-1&&this.columns.splice(t,1),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.redraw()},t.prototype.redraw=function(e){e&&(d.prototype.helpers.elVisible(this.element)&&this._verticalAlignHeaders(),this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),["fitColumns","fitDataStretch"].indexOf(this.table.modules.layout.getMode())>-1||e?this.table.modules.layout.layout():this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout(),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),e&&(this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.redraw()),this.table.footerManager.redraw()};var o=function(e){this._column=e,this.type="ColumnComponent"};o.prototype.getElement=function(){return this._column.getElement()},o.prototype.getDefinition=function(){return this._column.getDefinition()},o.prototype.getField=function(){return this._column.getField()},o.prototype.getCells=function(){var e=[];return this._column.cells.forEach((function(t){e.push(t.getComponent())})),e},o.prototype.getVisibility=function(){return this._column.visible},o.prototype.show=function(){this._column.isGroup?this._column.columns.forEach((function(e){e.show()})):this._column.show()},o.prototype.hide=function(){this._column.isGroup?this._column.columns.forEach((function(e){e.hide()})):this._column.hide()},o.prototype.toggle=function(){this._column.visible?this.hide():this.show()},o.prototype.delete=function(){return this._column.delete()},o.prototype.getSubColumns=function(){var e=[];return this._column.columns.length&&this._column.columns.forEach((function(t){e.push(t.getComponent())})),e},o.prototype.getParentColumn=function(){return this._column.parent instanceof i&&this._column.parent.getComponent()},o.prototype._getSelf=function(){return this._column},o.prototype.scrollTo=function(){return this._column.table.columnManager.scrollToColumn(this._column)},o.prototype.getTable=function(){return this._column.table},o.prototype.headerFilterFocus=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.setHeaderFilterFocus(this._column)},o.prototype.reloadHeaderFilter=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.reloadHeaderFilter(this._column)},o.prototype.getHeaderFilterValue=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.getHeaderFilterValue(this._column)},o.prototype.setHeaderFilterValue=function(e){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.setHeaderFilterValue(this._column,e)},o.prototype.move=function(e,t){var o=this._column.table.columnManager.findColumn(e);o?this._column.table.columnManager.moveColumn(this._column,o,t):console.warn("Move Error - No matching column found:",o)},o.prototype.getNextColumn=function(){var e=this._column.nextColumn();return!!e&&e.getComponent()},o.prototype.getPrevColumn=function(){var e=this._column.prevColumn();return!!e&&e.getComponent()},o.prototype.updateDefinition=function(e){return this._column.updateDefinition(e)};var i=function e(t,o){var i=this;this.table=o.table,this.definition=t,this.parent=o,this.type="column",this.columns=[],this.cells=[],this.element=this.createElement(),this.contentElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.isGroup=!1,this.tooltip=!1,this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleFormatterRendered=!1,this.setField(this.definition.field),this.table.options.invalidOptionWarnings&&this.checkDefinition(),this.modules={},this.cellEvents={cellClick:!1,cellDblClick:!1,cellContext:!1,cellTap:!1,cellDblTap:!1,cellTapHold:!1,cellMouseEnter:!1,cellMouseLeave:!1,cellMouseOver:!1,cellMouseOut:!1,cellMouseMove:!1},this.width=null,this.widthStyled="",this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this._mapDepricatedFunctionality(),t.columns?(this.isGroup=!0,t.columns.forEach((function(t,o){var n=new e(t,i);i.attachColumn(n)})),i.checkColumnVisibility()):o.registerColumnField(this),t.rowHandle&&!1!==this.table.options.movableRows&&this.table.modExists("moveRow")&&this.table.modules.moveRow.setHandle(!0),this._buildHeader(),this.bindModuleColumns()};i.prototype.createElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),e},i.prototype.createGroupElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e},i.prototype.checkDefinition=function(){var e=this;Object.keys(this.definition).forEach((function(t){-1===e.defaultOptionList.indexOf(t)&&console.warn("Invalid column definition option in '"+(e.field||e.definition.title)+"' column:",t)}))},i.prototype.setField=function(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData},i.prototype.registerColumnPosition=function(e){this.parent.registerColumnPosition(e)},i.prototype.registerColumnField=function(e){this.parent.registerColumnField(e)},i.prototype.reRegisterPosition=function(){this.isGroup?this.columns.forEach((function(e){e.reRegisterPosition()})):this.registerColumnPosition(this)},i.prototype._mapDepricatedFunctionality=function(){void 0!==this.definition.hideInHtml&&(this.definition.htmlOutput=!this.definition.hideInHtml,console.warn("hideInHtml column definition property is deprecated, you should now use htmlOutput")),void 0!==this.definition.align&&(this.definition.hozAlign=this.definition.align,console.warn("align column definition property is deprecated, you should now use hozAlign"))},i.prototype.setTooltip=function(){var e=this,t=e.definition,o=t.headerTooltip||!1===t.tooltip?t.headerTooltip:e.table.options.tooltipsHeader;o?!0===o?t.field?e.table.modules.localize.bind("columns|"+t.field,(function(o){e.element.setAttribute("title",o||t.title)})):e.element.setAttribute("title",t.title):("function"==typeof o&&!1===(o=o(e.getComponent()))&&(o=""),e.element.setAttribute("title",o)):e.element.setAttribute("title","")},i.prototype._buildHeader=function(){for(var e=this,t=e.definition;e.element.firstChild;)e.element.removeChild(e.element.firstChild);t.headerVertical&&(e.element.classList.add("tabulator-col-vertical"),"flip"===t.headerVertical&&e.element.classList.add("tabulator-col-vertical-flip")),e.contentElement=e._bindEvents(),e.contentElement=e._buildColumnHeaderContent(),e.element.appendChild(e.contentElement),e.isGroup?e._buildGroupHeader():e._buildColumnHeader(),e.setTooltip(),e.table.options.resizableColumns&&e.table.modExists("resizeColumns")&&e.table.modules.resizeColumns.initializeColumn("header",e,e.element),t.headerFilter&&e.table.modExists("filter")&&e.table.modExists("edit")&&(void 0!==t.headerFilterPlaceholder&&t.field&&e.table.modules.localize.setHeaderFilterColumnPlaceholder(t.field,t.headerFilterPlaceholder),e.table.modules.filter.initializeColumn(e)),e.table.modExists("frozenColumns")&&e.table.modules.frozenColumns.initializeColumn(e),e.table.options.movableColumns&&!e.isGroup&&e.table.modExists("moveColumn")&&e.table.modules.moveColumn.initializeColumn(e),(t.topCalc||t.bottomCalc)&&e.table.modExists("columnCalcs")&&e.table.modules.columnCalcs.initializeColumn(e),e.table.modExists("persistence")&&e.table.modules.persistence.config.columns&&e.table.modules.persistence.initializeColumn(e),e.element.addEventListener("mouseenter",(function(t){e.setTooltip()}))},i.prototype._bindEvents=function(){var e,t,o,i=this,n=i.definition;"function"==typeof n.headerClick&&i.element.addEventListener("click",(function(e){n.headerClick(e,i.getComponent())})),"function"==typeof n.headerDblClick&&i.element.addEventListener("dblclick",(function(e){n.headerDblClick(e,i.getComponent())})),"function"==typeof n.headerContext&&i.element.addEventListener("contextmenu",(function(e){n.headerContext(e,i.getComponent())})),"function"==typeof n.headerTap&&(o=!1,i.element.addEventListener("touchstart",(function(e){o=!0}),{passive:!0}),i.element.addEventListener("touchend",(function(e){o&&n.headerTap(e,i.getComponent()),o=!1}))),"function"==typeof n.headerDblTap&&(e=null,i.element.addEventListener("touchend",(function(t){e?(clearTimeout(e),e=null,n.headerDblTap(t,i.getComponent())):e=setTimeout((function(){clearTimeout(e),e=null}),300)}))),"function"==typeof n.headerTapHold&&(t=null,i.element.addEventListener("touchstart",(function(e){clearTimeout(t),t=setTimeout((function(){clearTimeout(t),t=null,o=!1,n.headerTapHold(e,i.getComponent())}),1e3)}),{passive:!0}),i.element.addEventListener("touchend",(function(e){clearTimeout(t),t=null}))),"function"==typeof n.cellClick&&(i.cellEvents.cellClick=n.cellClick),"function"==typeof n.cellDblClick&&(i.cellEvents.cellDblClick=n.cellDblClick),"function"==typeof n.cellContext&&(i.cellEvents.cellContext=n.cellContext),"function"==typeof n.cellMouseEnter&&(i.cellEvents.cellMouseEnter=n.cellMouseEnter),"function"==typeof n.cellMouseLeave&&(i.cellEvents.cellMouseLeave=n.cellMouseLeave),"function"==typeof n.cellMouseOver&&(i.cellEvents.cellMouseOver=n.cellMouseOver),"function"==typeof n.cellMouseOut&&(i.cellEvents.cellMouseOut=n.cellMouseOut),"function"==typeof n.cellMouseMove&&(i.cellEvents.cellMouseMove=n.cellMouseMove),"function"==typeof n.cellTap&&(i.cellEvents.cellTap=n.cellTap),"function"==typeof n.cellDblTap&&(i.cellEvents.cellDblTap=n.cellDblTap),"function"==typeof n.cellTapHold&&(i.cellEvents.cellTapHold=n.cellTapHold),"function"==typeof n.cellEdited&&(i.cellEvents.cellEdited=n.cellEdited),"function"==typeof n.cellEditing&&(i.cellEvents.cellEditing=n.cellEditing),"function"==typeof n.cellEditCancelled&&(i.cellEvents.cellEditCancelled=n.cellEditCancelled)},i.prototype._buildColumnHeader=function(){var e=this,t=e.definition,o=e.table;o.modExists("sort")&&o.modules.sort.initializeColumn(e,e.contentElement),(t.headerContextMenu||t.headerMenu)&&o.modExists("menu")&&o.modules.menu.initializeColumnHeader(e),o.modExists("format")&&o.modules.format.initializeColumn(e),void 0!==t.editor&&o.modExists("edit")&&o.modules.edit.initializeColumn(e),void 0!==t.validator&&o.modExists("validate")&&o.modules.validate.initializeColumn(e),o.modExists("mutator")&&o.modules.mutator.initializeColumn(e),o.modExists("accessor")&&o.modules.accessor.initializeColumn(e),s(o.options.responsiveLayout)&&o.modExists("responsiveLayout")&&o.modules.responsiveLayout.initializeColumn(e),void 0!==t.visible&&(t.visible?e.show(!0):e.hide(!0)),t.cssClass&&t.cssClass.split(" ").forEach((function(t){e.element.classList.add(t)})),t.field&&this.element.setAttribute("tabulator-field",t.field),e.setMinWidth(void 0===t.minWidth?e.table.options.columnMinWidth:parseInt(t.minWidth)),e.reinitializeWidth(),e.tooltip=e.definition.tooltip||!1===e.definition.tooltip?e.definition.tooltip:e.table.options.tooltips,e.hozAlign=void 0===e.definition.hozAlign?e.table.options.cellHozAlign:e.definition.hozAlign,e.vertAlign=void 0===e.definition.vertAlign?e.table.options.cellVertAlign:e.definition.vertAlign},i.prototype._buildColumnHeaderContent=function(){self.definition,self.table;var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleElement=this._buildColumnHeaderTitle(),e.appendChild(this.titleElement),e},i.prototype._buildColumnHeaderTitle=function(){var e=this,t=e.definition,o=e.table,i=document.createElement("div");if(i.classList.add("tabulator-col-title"),t.editableTitle){var n=document.createElement("input");n.classList.add("tabulator-title-editor"),n.addEventListener("click",(function(e){e.stopPropagation(),n.focus()})),n.addEventListener("change",(function(){t.title=n.value,o.options.columnTitleChanged.call(e.table,e.getComponent())})),i.appendChild(n),t.field?o.modules.localize.bind("columns|"+t.field,(function(e){n.value=e||t.title||"&nbsp;"})):n.value=t.title||"&nbsp;"}else t.field?o.modules.localize.bind("columns|"+t.field,(function(o){e._formatColumnHeaderTitle(i,o||t.title||"&nbsp;")})):e._formatColumnHeaderTitle(i,t.title||"&nbsp;");return i},i.prototype._formatColumnHeaderTitle=function(e,t){var o,i,n,r,a,l=this;if(this.definition.titleFormatter&&this.table.modExists("format"))switch(o=this.table.modules.format.getFormatter(this.definition.titleFormatter),a=function(e){l.titleFormatterRendered=e},r={getValue:function(){return t},getElement:function(){return e}},n="function"==typeof(n=this.definition.titleFormatterParams||{})?n():n,void 0===(i=o.call(this.table.modules.format,r,n,a))?"undefined":s(i)){case"object":i instanceof Node?e.appendChild(i):(e.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",i));break;case"undefined":case"null":e.innerHTML="";break;default:e.innerHTML=i}else e.innerHTML=t},i.prototype._buildGroupHeader=function(){var e=this;this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass&&this.definition.cssClass.split(" ").forEach((function(t){e.element.classList.add(t)})),this.element.appendChild(this.groupElement)},i.prototype._getFlatData=function(e){return e[this.field]},i.prototype._getNestedData=function(e){for(var t,o=e,i=this.fieldStructure,n=i.length,r=0;r<n&&(t=o=o[i[r]],o);r++);return t},i.prototype._setFlatData=function(e,t){this.field&&(e[this.field]=t)},i.prototype._setNestedData=function(e,t){for(var o=e,i=this.fieldStructure,n=i.length,r=0;r<n;r++)if(r==n-1)o[i[r]]=t;else{if(!o[i[r]]){if(void 0===t)break;o[i[r]]={}}o=o[i[r]]}},i.prototype.attachColumn=function(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement())):console.warn("Column Warning - Column being attached to another column instead of column group")},i.prototype.verticalAlign=function(e,t){var o=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=o+"px",this.isGroup&&(this.groupElement.style.minHeight=o-this.contentElement.offsetHeight+"px"),this.isGroup||"top"===e||(this.element.style.paddingTop="bottom"===e?this.element.clientHeight-this.contentElement.offsetHeight+"px":(this.element.clientHeight-this.contentElement.offsetHeight)/2+"px"),this.columns.forEach((function(t){t.verticalAlign(e)}))},i.prototype.clearVerticalAlign=function(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach((function(e){e.clearVerticalAlign()}))},i.prototype.bindModuleColumns=function(){"rownum"==this.definition.formatter&&(this.table.rowManager.rowNumColumn=this)},i.prototype.getElement=function(){return this.element},i.prototype.getGroupElement=function(){return this.groupElement},i.prototype.getField=function(){return this.field},i.prototype.getFirstColumn=function(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this},i.prototype.getLastColumn=function(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this},i.prototype.getColumns=function(){return this.columns},i.prototype.getCells=function(){return this.cells},i.prototype.getTopColumn=function(){return this.parent.isGroup?this.parent.getTopColumn():this},i.prototype.getDefinition=function(e){var t=[];return this.isGroup&&e&&(this.columns.forEach((function(e){t.push(e.getDefinition(!0))})),this.definition.columns=t),this.definition},i.prototype.checkColumnVisibility=function(){var e=!1;this.columns.forEach((function(t){t.visible&&(e=!0)})),e?(this.show(),this.parent.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!1)):this.hide()},i.prototype.show=function(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(e){e.show()})),this.isGroup||null!==this.width||this.reinitializeWidth(),this.table.columnManager._verticalAlignHeaders(),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),!t&&this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.updateColumnVisibility(this,this.visible),e||this.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths())},i.prototype.hide=function(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager._verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(e){e.hide()})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),!t&&this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.updateColumnVisibility(this,this.visible),e||this.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths())},i.prototype.matchChildWidths=function(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach((function(t){t.visible&&(e+=t.getWidth())})),this.contentElement.style.maxWidth=e-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())},i.prototype.setWidth=function(e){this.widthFixed=!0,this.setWidthActual(e)},i.prototype.setWidthActual=function(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach((function(e){e.setWidth()})),this.parent.isGroup&&this.parent.matchChildWidths(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()},i.prototype.checkCellHeights=function(){var e=[];this.cells.forEach((function(t){t.row.heightInitialized&&(null!==t.row.getElement().offsetParent?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)})),e.forEach((function(e){e.calcHeight()})),e.forEach((function(e){e.setCellHeight()}))},i.prototype.getWidth=function(){var e=0;return this.isGroup?this.columns.forEach((function(t){t.visible&&(e+=t.getWidth())})):e=this.width,e},i.prototype.getHeight=function(){return this.element.offsetHeight},i.prototype.setMinWidth=function(e){this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach((function(e){e.setMinWidth()}))},i.prototype.delete=function(){var e=this;return new Promise((function(t,o){e.isGroup&&e.columns.forEach((function(e){e.delete()}));for(var i=e.cells.length,n=0;n<i;n++)e.cells[0].delete();e.element.parentNode.removeChild(e.element),e.table.columnManager.deregisterColumn(e),t()}))},i.prototype.columnRendered=function(){this.titleFormatterRendered&&this.titleFormatterRendered()},i.prototype.generateCell=function(e){var t=new c(this,e);return this.cells.push(t),t},i.prototype.nextColumn=function(){var e=this.table.columnManager.findColumnIndex(this);return e>-1&&this._nextVisibleColumn(e+1)},i.prototype._nextVisibleColumn=function(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)},i.prototype.prevColumn=function(){var e=this.table.columnManager.findColumnIndex(this);return e>-1&&this._prevVisibleColumn(e-1)},i.prototype._prevVisibleColumn=function(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)},i.prototype.reinitializeWidth=function(e){this.widthFixed=!1,void 0===this.definition.width||e||this.setWidth(this.definition.width),this.table.modExists("filter")&&this.table.modules.filter.hideHeaderFilterElements(),this.fitToData(),this.table.modExists("filter")&&this.table.modules.filter.showHeaderFilterElements()},i.prototype.fitToData=function(){this.widthFixed||(this.element.style.width="",this.cells.forEach((function(e){e.clearWidth()})));var e=this.element.offsetWidth;this.width&&this.widthFixed||(this.cells.forEach((function(t){var o=t.getWidth();o>e&&(e=o)})),e&&this.setWidthActual(e+1))},i.prototype.updateDefinition=function(e){var t=this;return new Promise((function(o,i){var n;t.isGroup?(console.warn("Column Update Error - The updateDefintion function is only available on columns, not column groups"),i("Column Update Error - The updateDefintion function is only available on columns, not column groups")):(n=Object.assign({},t.getDefinition()),n=Object.assign(n,e),t.table.columnManager.addColumn(n,!1,t).then((function(e){n.field==t.field&&(t.field=!1),t.delete().then((function(){o(e.getComponent())})).catch((function(e){i(e)}))})).catch((function(e){i(e)})))}))},i.prototype.deleteCell=function(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)},i.prototype.defaultOptionList=["title","field","columns","visible","align","hozAlign","vertAlign","width","minWidth","widthGrow","widthShrink","resizable","frozen","responsive","tooltip","cssClass","rowHandle","hideInHtml","print","htmlOutput","sorter","sorterParams","formatter","formatterParams","variableHeight","editable","editor","editorParams","validator","mutator","mutatorParams","mutatorData","mutatorDataParams","mutatorEdit","mutatorEditParams","mutatorClipboard","mutatorClipboardParams","accessor","accessorParams","accessorData","accessorDataParams","accessorDownload","accessorDownloadParams","accessorClipboard","accessorClipboardParams","accessorPrint","accessorPrintParams","accessorHtmlOutput","accessorHtmlOutputParams","clipboard","download","downloadTitle","topCalc","topCalcParams","topCalcFormatter","topCalcFormatterParams","bottomCalc","bottomCalcParams","bottomCalcFormatter","bottomCalcFormatterParams","cellClick","cellDblClick","cellContext","cellTap","cellDblTap","cellTapHold","cellMouseEnter","cellMouseLeave","cellMouseOver","cellMouseOut","cellMouseMove","cellEditing","cellEdited","cellEditCancelled","headerSort","headerSortStartingDir","headerSortTristate","headerClick","headerDblClick","headerContext","headerTap","headerDblTap","headerTapHold","headerTooltip","headerVertical","editableTitle","titleFormatter","titleFormatterParams","headerFilter","headerFilterPlaceholder","headerFilterParams","headerFilterEmptyCheck","headerFilterFunc","headerFilterFuncParams","headerFilterLiveFilter","print","headerContextMenu","headerMenu","contextMenu","formatterPrint","formatterPrintParams","formatterClipboard","formatterClipboardParams","formatterHtmlOutput","formatterHtmlOutputParams"],i.prototype.getComponent=function(){return new o(this)};var n=function(e){this.table=e,this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.columnManager=null,this.height=0,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[],this.rowNumColumn=!1,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRederInPosition=!1};n.prototype.createHolderElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-tableHolder"),e.setAttribute("tabindex",0),e},n.prototype.createTableElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e},n.prototype.getElement=function(){return this.element},n.prototype.getTableElement=function(){return this.tableElement},n.prototype.getRowPosition=function(e,t){return t?this.activeRows.indexOf(e):this.rows.indexOf(e)},n.prototype.setColumnManager=function(e){this.columnManager=e},n.prototype.initialize=function(){var e=this;e.setRenderMode(),e.element.appendChild(e.tableElement),e.firstRender=!0,e.element.addEventListener("scroll",(function(){var t=e.element.scrollLeft;e.scrollLeft!=t&&(e.columnManager.scrollHorizontal(t),e.table.options.groupBy&&e.table.modules.groupRows.scrollHeaders(t),e.table.modExists("columnCalcs")&&e.table.modules.columnCalcs.scrollHorizontal(t),e.table.options.scrollHorizontal(t)),e.scrollLeft=t})),"virtual"===this.renderMode&&e.element.addEventListener("scroll",(function(){var t=e.element.scrollTop,o=e.scrollTop>t;e.scrollTop!=t?(e.scrollTop=t,e.scrollVertical(o),"scroll"==e.table.options.ajaxProgressiveLoad&&e.table.modules.ajax.nextPage(e.element.scrollHeight-e.element.clientHeight-t),e.table.options.scrollVertical(t)):e.scrollTop=t}))},n.prototype.findRow=function(e){var t=this;return"object"!=(void 0===e?"undefined":s(e))?null!=e&&(t.rows.find((function(o){return o.data[t.table.options.index]==e}))||!1):e instanceof a?e:e instanceof r?e._getSelf()||!1:"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&t.rows.find((function(t){return t.element===e}))||!1},n.prototype.getRowFromDataObject=function(e){return this.rows.find((function(t){return t.data===e}))||!1},n.prototype.getRowFromPosition=function(e,t){return t?this.activeRows[e]:this.rows[e]},n.prototype.scrollToRow=function(e,t,o){var i,n=this,r=this.getDisplayRows().indexOf(e),a=e.getElement(),s=0;return new Promise((function(e,l){if(r>-1){if(void 0===t&&(t=n.table.options.scrollToRowPosition),void 0===o&&(o=n.table.options.scrollToRowIfVisible),"nearest"===t)switch(n.renderMode){case"classic":i=d.prototype.helpers.elOffset(a).top,t=Math.abs(n.element.scrollTop-i)>Math.abs(n.element.scrollTop+n.element.clientHeight-i)?"bottom":"top";break;case"virtual":t=Math.abs(n.vDomTop-r)>Math.abs(n.vDomBottom-r)?"bottom":"top"}if(!o&&d.prototype.helpers.elVisible(a)&&(s=d.prototype.helpers.elOffset(a).top-d.prototype.helpers.elOffset(n.element).top)>0&&s<n.element.clientHeight-a.offsetHeight)return!1;switch(n.renderMode){case"classic":n.element.scrollTop=d.prototype.helpers.elOffset(a).top-d.prototype.helpers.elOffset(n.element).top+n.element.scrollTop;break;case"virtual":n._virtualRenderFill(r,!0)}switch(t){case"middle":case"center":n.element.scrollHeight-n.element.scrollTop==n.element.clientHeight?n.element.scrollTop=n.element.scrollTop+(a.offsetTop-n.element.scrollTop)-(n.element.scrollHeight-a.offsetTop)/2:n.element.scrollTop=n.element.scrollTop-n.element.clientHeight/2;break;case"bottom":n.element.scrollHeight-n.element.scrollTop==n.element.clientHeight?n.element.scrollTop=n.element.scrollTop-(n.element.scrollHeight-a.offsetTop)+a.offsetHeight:n.element.scrollTop=n.element.scrollTop-n.element.clientHeight+a.offsetHeight}e()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")}))},n.prototype.setData=function(e,t,o){var i=this,n=this;return new Promise((function(r,a){t&&i.getDisplayRows().length?n.table.options.pagination?n._setDataActual(e,!0):i.reRenderInPosition((function(){n._setDataActual(e)})):(i.table.options.autoColumns&&o&&i.table.columnManager.generateColumnsFromRowData(e),i.resetScroll(),i._setDataActual(e)),r()}))},n.prototype._setDataActual=function(e,t){var o=this;o.table.options.dataLoading.call(this.table,e),this._wipeElements(),this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.clear(),Array.isArray(e)?(this.table.modExists("selectRow")&&this.table.modules.selectRow.clearSelectionData(),this.table.options.reactiveData&&this.table.modExists("reactiveData",!0)&&this.table.modules.reactiveData.watchData(e),e.forEach((function(e,t){if(e&&"object"===(void 0===e?"undefined":s(e))){var i=new a(e,o);o.rows.push(i)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",e)})),o.table.options.dataLoaded.call(this.table,e),o.refreshActiveData(!1,!1,t)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",void 0===e?"undefined":s(e),"\nData:     ",e)},n.prototype._wipeElements=function(){this.rows.forEach((function(e){e.wipe()})),this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.wipe(),this.rows=[]},n.prototype.deleteRow=function(e,t){var o=this.rows.indexOf(e),i=this.activeRows.indexOf(e);i>-1&&this.activeRows.splice(i,1),o>-1&&this.rows.splice(o,1),this.setActiveRows(this.activeRows),this.displayRowIterator((function(t){var o=t.indexOf(e);o>-1&&t.splice(o,1)})),t||this.reRenderInPosition(),this.regenerateRowNumbers(),this.table.options.rowDeleted.call(this.table,e.getComponent()),this.table.options.dataEdited.call(this.table,this.getData()),this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.updateGroupRows(!0):this.table.options.pagination&&this.table.modExists("page")?this.refreshActiveData(!1,!1,!0):this.table.options.pagination&&this.table.modExists("page")&&this.refreshActiveData("page")},n.prototype.addRow=function(e,t,o,i){var n=this.addRowActual(e,t,o,i);return this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("rowAdd",n,{data:e,pos:t,index:o}),n},n.prototype.addRows=function(e,t,o){var i=this,n=this,r=[];return new Promise((function(a,s){t=i.findAddRowPos(t),Array.isArray(e)||(e=[e]),e.length,(void 0===o&&t||void 0!==o&&!t)&&e.reverse(),e.forEach((function(e,i){var a=n.addRow(e,t,o,!0);r.push(a)})),i.table.options.groupBy&&i.table.modExists("groupRows")?i.table.modules.groupRows.updateGroupRows(!0):i.table.options.pagination&&i.table.modExists("page")?i.refreshActiveData(!1,!1,!0):i.reRenderInPosition(),i.table.modExists("columnCalcs")&&i.table.modules.columnCalcs.recalc(i.table.rowManager.activeRows),i.regenerateRowNumbers(),a(r)}))},n.prototype.findAddRowPos=function(e){return void 0===e&&(e=this.table.options.addRowPos),"pos"===e&&(e=!0),"bottom"===e&&(e=!1),e},n.prototype.addRowActual=function(e,t,o,i){var n,r,s=e instanceof a?e:new a(e||{},this),l=this.findAddRowPos(t),c=-1;if(!o&&this.table.options.pagination&&"page"==this.table.options.paginationAddRow&&(r=this.getDisplayRows(),l?r.length?o=r[0]:this.activeRows.length&&(o=this.activeRows[this.activeRows.length-1],l=!1):r.length&&(o=r[r.length-1],l=!(r.length<this.table.modules.page.getPageSize()))),void 0!==o&&(o=this.findRow(o)),this.table.options.groupBy&&this.table.modExists("groupRows")){this.table.modules.groupRows.assignRowToGroup(s);var u=s.getGroup().rows;u.length>1&&(!o||o&&-1==u.indexOf(o)?l?u[0]!==s&&(o=u[0],this._moveRowInArray(s.getGroup().rows,s,o,!l)):u[u.length-1]!==s&&(o=u[u.length-1],this._moveRowInArray(s.getGroup().rows,s,o,!l)):this._moveRowInArray(s.getGroup().rows,s,o,!l))}return o&&(c=this.rows.indexOf(o)),o&&c>-1?(n=this.activeRows.indexOf(o),this.displayRowIterator((function(e){var t=e.indexOf(o);t>-1&&e.splice(l?t:t+1,0,s)})),n>-1&&this.activeRows.splice(l?n:n+1,0,s),this.rows.splice(l?c:c+1,0,s)):l?(this.displayRowIterator((function(e){e.unshift(s)})),this.activeRows.unshift(s),this.rows.unshift(s)):(this.displayRowIterator((function(e){e.push(s)})),this.activeRows.push(s),this.rows.push(s)),this.setActiveRows(this.activeRows),this.table.options.rowAdded.call(this.table,s.getComponent()),this.table.options.dataEdited.call(this.table,this.getData()),i||this.reRenderInPosition(),s},n.prototype.moveRow=function(e,t,o){this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("rowMove",e,{posFrom:this.getRowPosition(e),posTo:this.getRowPosition(t),to:t,after:o}),this.moveRowActual(e,t,o),this.regenerateRowNumbers(),this.table.options.rowMoved.call(this.table,e.getComponent())},n.prototype.moveRowActual=function(e,t,o){var i=this;if(this._moveRowInArray(this.rows,e,t,o),this._moveRowInArray(this.activeRows,e,t,o),this.displayRowIterator((function(n){i._moveRowInArray(n,e,t,o)})),this.table.options.groupBy&&this.table.modExists("groupRows")){var n=t.getGroup(),r=e.getGroup();n===r?this._moveRowInArray(n.rows,e,t,o):(r&&r.removeRow(e),n.insertRow(e,t,o))}},n.prototype._moveRowInArray=function(e,t,o,i){var n,r,a;if(t!==o&&((n=e.indexOf(t))>-1&&(e.splice(n,1),(r=e.indexOf(o))>-1?i?e.splice(r+1,0,t):e.splice(r,0,t):e.splice(n,0,t)),e===this.getDisplayRows())){a=r>n?r:n+1;for(var s=n<r?n:r;s<=a;s++)e[s]&&this.styleRow(e[s],s)}},n.prototype.clearData=function(){this.setData([])},n.prototype.getRowIndex=function(e){return this.findRowIndex(e,this.rows)},n.prototype.getDisplayRowIndex=function(e){var t=this.getDisplayRows().indexOf(e);return t>-1&&t},n.prototype.nextDisplayRow=function(e,t){var o=this.getDisplayRowIndex(e),i=!1;return!1!==o&&o<this.displayRowsCount-1&&(i=this.getDisplayRows()[o+1]),!i||i instanceof a&&"row"==i.type?i:this.nextDisplayRow(i,t)},n.prototype.prevDisplayRow=function(e,t){var o=this.getDisplayRowIndex(e),i=!1;return o&&(i=this.getDisplayRows()[o-1]),!i||i instanceof a&&"row"==i.type?i:this.prevDisplayRow(i,t)},n.prototype.findRowIndex=function(e,t){var o;return!!((e=this.findRow(e))&&(o=t.indexOf(e))>-1)&&o},n.prototype.getData=function(e,t){var o=[];return this.getRows(e).forEach((function(e){"row"==e.type&&o.push(e.getData(t||"data"))})),o},n.prototype.getComponents=function(e){var t=[];return this.getRows(e).forEach((function(e){t.push(e.getComponent())})),t},n.prototype.getDataCount=function(e){return this.getRows(e).length},n.prototype._genRemoteRequest=function(){var e=this,t=this.table,o=t.options,i={};if(t.modExists("page")){if(o.ajaxSorting){var n=this.table.modules.sort.getSort();n.forEach((function(e){delete e.column})),i[this.table.modules.page.paginationDataSentNames.sorters]=n}if(o.ajaxFiltering){var r=this.table.modules.filter.getFilters(!0,!0);i[this.table.modules.page.paginationDataSentNames.filters]=r}this.table.modules.ajax.setParams(i,!0)}t.modules.ajax.sendRequest().then((function(t){e._setDataActual(t,!0)})).catch((function(e){}))},n.prototype.filterRefresh=function(){var e=this.table,t=e.options,o=this.scrollLeft;t.ajaxFiltering?"remote"==t.pagination&&e.modExists("page")?(e.modules.page.reset(!0),e.modules.page.setPage(1).then((function(){})).catch((function(){}))):t.ajaxProgressiveLoad?e.modules.ajax.loadData().then((function(){})).catch((function(){})):this._genRemoteRequest():this.refreshActiveData("filter"),this.scrollHorizontal(o)},n.prototype.sorterRefresh=function(e){var t=this.table,o=this.table.options,i=this.scrollLeft;o.ajaxSorting?("remote"==o.pagination||o.progressiveLoad)&&t.modExists("page")?(t.modules.page.reset(!0),t.modules.page.setPage(1).then((function(){})).catch((function(){}))):o.ajaxProgressiveLoad?t.modules.ajax.loadData().then((function(){})).catch((function(){})):this._genRemoteRequest():this.refreshActiveData(e?"filter":"sort"),this.scrollHorizontal(i)},n.prototype.scrollHorizontal=function(e){this.scrollLeft=e,this.element.scrollLeft=e,this.table.options.groupBy&&this.table.modules.groupRows.scrollHeaders(e),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.scrollHorizontal(e)},n.prototype.refreshActiveData=function(e,t,o){var i,n=this.table,r=["all","filter","sort","display","freeze","group","tree","page"];if(this.redrawBlock)(!this.redrawBlockRestoreConfig||r.indexOf(e)<r.indexOf(this.redrawBlockRestoreConfig.stage))&&(this.redrawBlockRestoreConfig={stage:e,skipStage:t,renderInPosition:o});else{switch(this.table.modExists("edit")&&this.table.modules.edit.cancelEdit(),e||(e="all"),n.options.selectable&&!n.options.selectablePersistence&&n.modExists("selectRow")&&n.modules.selectRow.deselectRows(),e){case"all":case"filter":t?t=!1:n.modExists("filter")?this.setActiveRows(n.modules.filter.filter(this.rows)):this.setActiveRows(this.rows.slice(0));case"sort":t?t=!1:n.modExists("sort")&&n.modules.sort.sort(this.activeRows),this.regenerateRowNumbers();case"display":this.resetDisplayRows();case"freeze":t?t=!1:this.table.modExists("frozenRows")&&n.modules.frozenRows.isFrozen()&&(n.modules.frozenRows.getDisplayIndex()||n.modules.frozenRows.setDisplayIndex(this.getNextDisplayIndex()),i=n.modules.frozenRows.getDisplayIndex(),!0!==(i=this.setDisplayRows(n.modules.frozenRows.getRows(this.getDisplayRows(i-1)),i))&&n.modules.frozenRows.setDisplayIndex(i));case"group":t?t=!1:n.options.groupBy&&n.modExists("groupRows")&&(n.modules.groupRows.getDisplayIndex()||n.modules.groupRows.setDisplayIndex(this.getNextDisplayIndex()),i=n.modules.groupRows.getDisplayIndex(),!0!==(i=this.setDisplayRows(n.modules.groupRows.getRows(this.getDisplayRows(i-1)),i))&&n.modules.groupRows.setDisplayIndex(i));case"tree":t?t=!1:n.options.dataTree&&n.modExists("dataTree")&&(n.modules.dataTree.getDisplayIndex()||n.modules.dataTree.setDisplayIndex(this.getNextDisplayIndex()),i=n.modules.dataTree.getDisplayIndex(),!0!==(i=this.setDisplayRows(n.modules.dataTree.getRows(this.getDisplayRows(i-1)),i))&&n.modules.dataTree.setDisplayIndex(i)),n.options.pagination&&n.modExists("page")&&!o&&"local"==n.modules.page.getMode()&&n.modules.page.reset();case"page":t?t=!1:n.options.pagination&&n.modExists("page")&&(n.modules.page.getDisplayIndex()||n.modules.page.setDisplayIndex(this.getNextDisplayIndex()),i=n.modules.page.getDisplayIndex(),"local"==n.modules.page.getMode()&&n.modules.page.setMaxRows(this.getDisplayRows(i-1).length),!0!==(i=this.setDisplayRows(n.modules.page.getRows(this.getDisplayRows(i-1)),i))&&n.modules.page.setDisplayIndex(i))}d.prototype.helpers.elVisible(this.element)&&(o?this.reRenderInPosition():(this.renderTable(),n.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0))),n.modExists("columnCalcs")&&n.modules.columnCalcs.recalc(this.activeRows)}},n.prototype.regenerateRowNumbers=function(){var e=this;this.rowNumColumn&&this.activeRows.forEach((function(t){var o=t.getCell(e.rowNumColumn);o&&o._generateContents()}))},n.prototype.setActiveRows=function(e){this.activeRows=e,this.activeRowsCount=this.activeRows.length},n.prototype.resetDisplayRows=function(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length,this.table.modExists("frozenRows")&&this.table.modules.frozenRows.setDisplayIndex(0),this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.setDisplayIndex(0),this.table.options.pagination&&this.table.modExists("page")&&this.table.modules.page.setDisplayIndex(0)},n.prototype.getNextDisplayIndex=function(){return this.displayRows.length},n.prototype.setDisplayRows=function(e,t){var o=!0;return t&&void 0!==this.displayRows[t]?(this.displayRows[t]=e,o=!0):(this.displayRows.push(e),o=t=this.displayRows.length-1),t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length),o},n.prototype.getDisplayRows=function(e){return void 0===e?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]},n.prototype.getVisibleRows=function(e){var t=this.element.scrollTop,o=this.element.clientHeight+t,i=!1,n=0,r=0,a=this.getDisplayRows();if(e){this.getDisplayRows();for(var s=this.vDomTop;s<=this.vDomBottom;s++)if(a[s])if(i){if(!(o-a[s].getElement().offsetTop>=0))break;r=s}else if(t-a[s].getElement().offsetTop>=0)n=s;else{if(i=!0,!(o-a[s].getElement().offsetTop>=0))break;r=s}}else n=this.vDomTop,r=this.vDomBottom;return a.slice(n,r+1)},n.prototype.displayRowIterator=function(e){this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length},n.prototype.getRows=function(e){var t;switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!0);break;default:t=this.rows}return t},n.prototype.reRenderInPosition=function(e){if("virtual"==this.getRenderMode())if(this.redrawBlock)e?e():this.redrawBlockRederInPosition=!0;else{for(var t=this.element.scrollTop,o=!1,i=!1,n=this.scrollLeft,r=this.getDisplayRows(),a=this.vDomTop;a<=this.vDomBottom;a++)if(r[a]){var s=t-r[a].getElement().offsetTop;if(!(!1===i||Math.abs(s)<i))break;i=s,o=a}e&&e(),this._virtualRenderFill(!1===o?this.displayRowsCount-1:o,!0,i||0),this.scrollHorizontal(n)}else this.renderTable(),e&&e()},n.prototype.setRenderMode=function(){this.table.options.virtualDom?(this.renderMode="virtual",this.table.element.clientHeight||this.table.options.height?this.fixedHeight=!0:this.fixedHeight=!1):this.renderMode="classic"},n.prototype.getRenderMode=function(){return this.renderMode},n.prototype.renderTable=function(){switch(this.table.options.renderStarted.call(this.table),this.element.scrollTop=0,this.renderMode){case"classic":this._simpleRender();break;case"virtual":this._virtualRenderFill()}this.firstRender&&(this.displayRowsCount?(this.firstRender=!1,this.table.modules.layout.layout()):this.renderEmptyScroll()),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout(),this.displayRowsCount||this.table.options.placeholder&&(this.table.options.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.table.options.placeholder),this.table.options.placeholder.style.width=this.table.columnManager.getWidth()+"px"),this.table.options.renderComplete.call(this.table)},n.prototype._simpleRender=function(){this._clearVirtualDom(),this.displayRowsCount?this.checkClassicModeGroupHeaderWidth():this.renderEmptyScroll()},n.prototype.checkClassicModeGroupHeaderWidth=function(){var e=this,t=this.tableElement,o=!0;e.getDisplayRows().forEach((function(i,n){e.styleRow(i,n),t.appendChild(i.getElement()),i.initialize(!0),"group"!==i.type&&(o=!1)})),t.style.minWidth=o?e.table.columnManager.getWidth()+"px":""},n.prototype.renderEmptyScroll=function(){this.table.options.placeholder?this.tableElement.style.display="none":(this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px",this.tableElement.style.minHeight="1px",this.tableElement.style.visibility="hidden")},n.prototype._clearVirtualDom=function(){var e=this.tableElement;for(this.table.options.placeholder&&this.table.options.placeholder.parentNode&&this.table.options.placeholder.parentNode.removeChild(this.table.options.placeholder);e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0},n.prototype.styleRow=function(e,t){var o=e.getElement();t%2?(o.classList.add("tabulator-row-even"),o.classList.remove("tabulator-row-odd")):(o.classList.add("tabulator-row-odd"),o.classList.remove("tabulator-row-even"))},n.prototype._virtualRenderFill=function(e,t,o){var i=this.tableElement,n=this.element,r=0,a=0,s=0,l=0,c=!0,u=this.getDisplayRows();if(o=o||0,e=e||0){for(;i.firstChild;)i.removeChild(i.firstChild);var h=(this.displayRowsCount-e+1)*this.vDomRowHeight;h<this.height&&(e-=Math.ceil((this.height-h)/this.vDomRowHeight))<0&&(e=0),e-=r=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e)}else this._clearVirtualDom();if(this.displayRowsCount&&d.prototype.helpers.elVisible(this.element)){for(this.vDomTop=e,this.vDomBottom=e-1;(a<=this.height+this.vDomWindowBuffer||l<this.vDomWindowMinTotalRows)&&this.vDomBottom<this.displayRowsCount-1;){var p,f=this.vDomBottom+1,m=u[f];this.styleRow(m,f),i.appendChild(m.getElement()),m.initialized?m.heightInitialized||m.normalizeHeight(!0):m.initialize(!0),p=m.getHeight(),l<r?s+=p:a+=p,p>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*p),"group"!==m.type&&(c=!1),this.vDomBottom++,l++}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+o:this.scrollTop-s,this.vDomBottomPad=this.vDomBottom==this.displayRowsCount-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-a-s,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((a+s)/l),this.vDomBottomPad=this.vDomRowHeight*(this.displayRowsCount-this.vDomBottom-1),this.vDomScrollHeight=s+a+this.vDomBottomPad-this.height),i.style.paddingTop=this.vDomTopPad+"px",i.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+s+o-(this.element.scrollWidth>this.element.clientWidth?this.element.offsetHeight-this.element.clientHeight:0)),this.scrollTop=Math.min(this.scrollTop,this.element.scrollHeight-this.height),this.element.scrollWidth>this.element.offsetWidth&&t&&(this.scrollTop+=this.element.offsetHeight-this.element.clientHeight),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,n.scrollTop=this.scrollTop,i.style.minWidth=c?this.table.columnManager.getWidth()+"px":"",this.table.options.groupBy&&"fitDataFill"!=this.table.modules.layout.getMode()&&this.displayRowsCount==this.table.modules.groupRows.countGroups()&&(this.tableElement.style.minWidth=this.table.columnManager.getWidth())}else this.renderEmptyScroll();this.fixedHeight||this.adjustTableSize()},n.prototype.scrollVertical=function(e){var t=this.scrollTop-this.vDomScrollPosTop,o=this.scrollTop-this.vDomScrollPosBottom,i=2*this.vDomWindowBuffer;if(-t>i||o>i){var n=this.scrollLeft;this._virtualRenderFill(Math.floor(this.element.scrollTop/this.element.scrollHeight*this.displayRowsCount)),this.scrollHorizontal(n)}else e?(t<0&&this._addTopRow(-t),o<0&&this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer&&this._removeBottomRow(-o)):(t>=0&&this.scrollTop>this.vDomWindowBuffer&&this._removeTopRow(t),o>=0&&this._addBottomRow(o))},n.prototype._addTopRow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.tableElement,i=this.getDisplayRows();if(this.vDomTop){var n=this.vDomTop-1,r=i[n],a=r.getHeight()||this.vDomRowHeight;e>=a&&(this.styleRow(r,n),o.insertBefore(r.getElement(),o.firstChild),r.initialized&&r.heightInitialized||(this.vDomTopNewRows.push(r),r.heightInitialized||r.clearCellHeight()),r.initialize(),this.vDomTopPad-=a,this.vDomTopPad<0&&(this.vDomTopPad=n*this.vDomRowHeight),n||(this.vDomTopPad=0),o.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=a,this.vDomTop--),e=-(this.scrollTop-this.vDomScrollPosTop),r.getHeight()>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*r.getHeight()),t<this.vDomMaxRenderChain&&this.vDomTop&&e>=(i[this.vDomTop-1].getHeight()||this.vDomRowHeight)?this._addTopRow(e,t+1):this._quickNormalizeRowHeight(this.vDomTopNewRows)}},n.prototype._removeTopRow=function(e){var t=this.tableElement,o=this.getDisplayRows()[this.vDomTop],i=o.getHeight()||this.vDomRowHeight;if(e>=i){var n=o.getElement();n.parentNode.removeChild(n),this.vDomTopPad+=i,t.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?i:i+this.vDomWindowBuffer,this.vDomTop++,e=this.scrollTop-this.vDomScrollPosTop,this._removeTopRow(e)}},n.prototype._addBottomRow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.tableElement,i=this.getDisplayRows();if(this.vDomBottom<this.displayRowsCount-1){var n=this.vDomBottom+1,r=i[n],a=r.getHeight()||this.vDomRowHeight;e>=a&&(this.styleRow(r,n),o.appendChild(r.getElement()),r.initialized&&r.heightInitialized||(this.vDomBottomNewRows.push(r),r.heightInitialized||r.clearCellHeight()),r.initialize(),this.vDomBottomPad-=a,(this.vDomBottomPad<0||n==this.displayRowsCount-1)&&(this.vDomBottomPad=0),o.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=a,this.vDomBottom++),e=this.scrollTop-this.vDomScrollPosBottom,r.getHeight()>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*r.getHeight()),t<this.vDomMaxRenderChain&&this.vDomBottom<this.displayRowsCount-1&&e>=(i[this.vDomBottom+1].getHeight()||this.vDomRowHeight)?this._addBottomRow(e,t+1):this._quickNormalizeRowHeight(this.vDomBottomNewRows)}},n.prototype._removeBottomRow=function(e){var t=this.tableElement,o=this.getDisplayRows()[this.vDomBottom],i=o.getHeight()||this.vDomRowHeight;if(e>=i){var n=o.getElement();n.parentNode&&n.parentNode.removeChild(n),this.vDomBottomPad+=i,this.vDomBottomPad<0&&(this.vDomBottomPad=0),t.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=i,this.vDomBottom--,e=-(this.scrollTop-this.vDomScrollPosBottom),this._removeBottomRow(e)}},n.prototype._quickNormalizeRowHeight=function(e){e.forEach((function(e){e.calcHeight()})),e.forEach((function(e){e.setCellHeight()})),e.length=0},n.prototype.normalizeHeight=function(){this.activeRows.forEach((function(e){e.normalizeHeight()}))},n.prototype.adjustTableSize=function(){var e,t=this.element.clientHeight;if("virtual"===this.renderMode){var o=this.columnManager.getElement().offsetHeight+(this.table.footerManager&&!this.table.footerManager.external?this.table.footerManager.getElement().offsetHeight:0);this.fixedHeight?(this.element.style.minHeight="calc(100% - "+o+"px)",this.element.style.height="calc(100% - "+o+"px)",this.element.style.maxHeight="calc(100% - "+o+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-o+"px",this.element.scrollTop=this.scrollTop),this.height=this.element.clientHeight,this.vDomWindowBuffer=this.table.options.virtualDomBuffer||this.height,this.fixedHeight||t==this.element.clientHeight||((e=this.table.modExists("resizeTable"))&&!this.table.modules.resizeTable.autoResize||!e)&&this.redraw()}},n.prototype.reinitialize=function(){this.rows.forEach((function(e){e.reinitialize()}))},n.prototype.blockRedraw=function(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1},n.prototype.restoreRedraw=function(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.stage,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRederInPosition&&this.reRenderInPosition(),this.redrawBlockRederInPosition=!1},n.prototype.redraw=function(e){var t=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():("classic"==this.renderMode?this.table.options.groupBy?this.refreshActiveData("group",!1,!1):this._simpleRender():(this.reRenderInPosition(),this.scrollHorizontal(t)),this.displayRowsCount||this.table.options.placeholder&&this.getElement().appendChild(this.table.options.placeholder))},n.prototype.resetScroll=function(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))};var r=function(e){this._row=e};r.prototype.getData=function(e){return this._row.getData(e)},r.prototype.getElement=function(){return this._row.getElement()},r.prototype.getCells=function(){var e=[];return this._row.getCells().forEach((function(t){e.push(t.getComponent())})),e},r.prototype.getCell=function(e){var t=this._row.getCell(e);return!!t&&t.getComponent()},r.prototype.getIndex=function(){return this._row.getData("data")[this._row.table.options.index]},r.prototype.getPosition=function(e){return this._row.table.rowManager.getRowPosition(this._row,e)},r.prototype.delete=function(){return this._row.delete()},r.prototype.scrollTo=function(){return this._row.table.rowManager.scrollToRow(this._row)},r.prototype.pageTo=function(){if(this._row.table.modExists("page",!0))return this._row.table.modules.page.setPageToRow(this._row)},r.prototype.move=function(e,t){this._row.moveToRow(e,t)},r.prototype.update=function(e){return this._row.updateData(e)},r.prototype.normalizeHeight=function(){this._row.normalizeHeight(!0)},r.prototype.select=function(){this._row.table.modules.selectRow.selectRows(this._row)},r.prototype.deselect=function(){this._row.table.modules.selectRow.deselectRows(this._row)},r.prototype.toggleSelect=function(){this._row.table.modules.selectRow.toggleRow(this._row)},r.prototype.isSelected=function(){return this._row.table.modules.selectRow.isRowSelected(this._row)},r.prototype._getSelf=function(){return this._row},r.prototype.freeze=function(){this._row.table.modExists("frozenRows",!0)&&this._row.table.modules.frozenRows.freezeRow(this._row)},r.prototype.unfreeze=function(){this._row.table.modExists("frozenRows",!0)&&this._row.table.modules.frozenRows.unfreezeRow(this._row)},r.prototype.treeCollapse=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.collapseRow(this._row)},r.prototype.treeExpand=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.expandRow(this._row)},r.prototype.treeToggle=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.toggleRow(this._row)},r.prototype.getTreeParent=function(){return!!this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.getTreeParent(this._row)},r.prototype.getTreeChildren=function(){return!!this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.getTreeChildren(this._row)},r.prototype.reformat=function(){return this._row.reinitialize()},r.prototype.getGroup=function(){return this._row.getGroup().getComponent()},r.prototype.getTable=function(){return this._row.table},r.prototype.getNextRow=function(){var e=this._row.nextRow();return e?e.getComponent():e},r.prototype.getPrevRow=function(){var e=this._row.prevRow();return e?e.getComponent():e};var a=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row";this.table=t.table,this.parent=t,this.data={},this.type=o,this.element=this.createElement(),this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.setData(e),this.generateElement()};a.prototype.createElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.setAttribute("role","row"),e},a.prototype.getElement=function(){return this.element},a.prototype.detachElement=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},a.prototype.generateElement=function(){var e,t,o,i=this;!1!==i.table.options.selectable&&i.table.modExists("selectRow")&&i.table.modules.selectRow.initializeRow(this),!1!==i.table.options.movableRows&&i.table.modExists("moveRow")&&i.table.modules.moveRow.initializeRow(this),!1!==i.table.options.dataTree&&i.table.modExists("dataTree")&&i.table.modules.dataTree.initializeRow(this),"collapse"===i.table.options.responsiveLayout&&i.table.modExists("responsiveLayout")&&i.table.modules.responsiveLayout.initializeRow(this),i.table.options.rowContextMenu&&this.table.modExists("menu")&&i.table.modules.menu.initializeRow(this),i.table.options.rowClick&&i.element.addEventListener("click",(function(e){i.table.options.rowClick(e,i.getComponent())})),i.table.options.rowDblClick&&i.element.addEventListener("dblclick",(function(e){i.table.options.rowDblClick(e,i.getComponent())})),i.table.options.rowContext&&i.element.addEventListener("contextmenu",(function(e){i.table.options.rowContext(e,i.getComponent())})),i.table.options.rowMouseEnter&&i.element.addEventListener("mouseenter",(function(e){i.table.options.rowMouseEnter(e,i.getComponent())})),i.table.options.rowMouseLeave&&i.element.addEventListener("mouseleave",(function(e){i.table.options.rowMouseLeave(e,i.getComponent())})),i.table.options.rowMouseOver&&i.element.addEventListener("mouseover",(function(e){i.table.options.rowMouseOver(e,i.getComponent())})),i.table.options.rowMouseOut&&i.element.addEventListener("mouseout",(function(e){i.table.options.rowMouseOut(e,i.getComponent())})),i.table.options.rowMouseMove&&i.element.addEventListener("mousemove",(function(e){i.table.options.rowMouseMove(e,i.getComponent())})),i.table.options.rowTap&&(o=!1,i.element.addEventListener("touchstart",(function(e){o=!0}),{passive:!0}),i.element.addEventListener("touchend",(function(e){o&&i.table.options.rowTap(e,i.getComponent()),o=!1}))),i.table.options.rowDblTap&&(e=null,i.element.addEventListener("touchend",(function(t){e?(clearTimeout(e),e=null,i.table.options.rowDblTap(t,i.getComponent())):e=setTimeout((function(){clearTimeout(e),e=null}),300)}))),i.table.options.rowTapHold&&(t=null,i.element.addEventListener("touchstart",(function(e){clearTimeout(t),t=setTimeout((function(){clearTimeout(t),t=null,o=!1,i.table.options.rowTapHold(e,i.getComponent())}),1e3)}),{passive:!0}),i.element.addEventListener("touchend",(function(e){clearTimeout(t),t=null})))},a.prototype.generateCells=function(){this.cells=this.table.columnManager.generateCells(this)},a.prototype.initialize=function(e){var t=this;if(!t.initialized||e){for(t.deleteCells();t.element.firstChild;)t.element.removeChild(t.element.firstChild);this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layoutRow(this),this.generateCells(),t.cells.forEach((function(e){t.element.appendChild(e.getElement()),e.cellRendered()})),e&&t.normalizeHeight(),t.table.options.dataTree&&t.table.modExists("dataTree")&&t.table.modules.dataTree.layoutRow(this),"collapse"===t.table.options.responsiveLayout&&t.table.modExists("responsiveLayout")&&t.table.modules.responsiveLayout.layoutRow(this),t.table.options.rowFormatter&&t.table.options.rowFormatter(t.getComponent()),t.table.options.resizableRows&&t.table.modExists("resizeRows")&&t.table.modules.resizeRows.initializeRow(t),t.initialized=!0}},a.prototype.reinitializeHeight=function(){this.heightInitialized=!1,null!==this.element.offsetParent&&this.normalizeHeight(!0)},a.prototype.reinitialize=function(){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),null!==this.element.offsetParent&&this.initialize(!0)},a.prototype.calcHeight=function(e){var t=0,o=this.table.options.resizableRows?this.element.clientHeight:0;this.cells.forEach((function(e){var o=e.getHeight();o>t&&(t=o)})),this.height=e?Math.max(t,o):this.manualHeight?this.height:Math.max(t,o),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight},a.prototype.setCellHeight=function(){this.cells.forEach((function(e){e.setHeight()})),this.heightInitialized=!0},a.prototype.clearCellHeight=function(){this.cells.forEach((function(e){e.clearHeight()}))},a.prototype.normalizeHeight=function(e){e&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()},a.prototype.setHeight=function(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)},a.prototype.getHeight=function(){return this.outerHeight},a.prototype.getWidth=function(){return this.element.offsetWidth},a.prototype.deleteCell=function(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)},a.prototype.setData=function(e){this.table.modExists("mutator")&&(e=this.table.modules.mutator.transformRow(e,"data")),this.data=e,this.table.options.reactiveData&&this.table.modExists("reactiveData",!0)&&this.table.modules.reactiveData.watchRow(this)},a.prototype.updateData=function(e){var t,o=this,i=d.prototype.helpers.elVisible(this.element),n={};return new Promise((function(r,a){for(var s in"string"==typeof e&&(e=JSON.parse(e)),o.table.options.reactiveData&&o.table.modExists("reactiveData",!0)&&o.table.modules.reactiveData.block(),o.table.modExists("mutator")?(n=Object.assign(n,o.data),n=Object.assign(n,e),t=o.table.modules.mutator.transformRow(n,"data",e)):t=e,t)o.data[s]=t[s];for(var s in o.table.options.reactiveData&&o.table.modExists("reactiveData",!0)&&o.table.modules.reactiveData.unblock(),e)o.table.columnManager.getColumnsByFieldRoot(s).forEach((function(e){var n=o.getCell(e.getField());if(n){var r=e.getFieldValue(t);n.getValue()!=r&&(n.setValueProcessData(r),i&&n.cellRendered())}}));i?(o.normalizeHeight(),o.table.options.rowFormatter&&o.table.options.rowFormatter(o.getComponent())):(o.initialized=!1,o.height=0,o.heightStyled=""),!1!==o.table.options.dataTree&&o.table.modExists("dataTree")&&o.table.modules.dataTree.redrawNeeded(e)&&(o.table.modules.dataTree.initializeRow(o),o.table.modules.dataTree.layoutRow(o),o.table.rowManager.refreshActiveData("tree",!1,!0)),o.table.options.rowUpdated.call(o.table,o.getComponent()),r()}))},a.prototype.getData=function(e){return e?this.table.modExists("accessor")?this.table.modules.accessor.transformRow(this.data,e):void 0:this.data},a.prototype.getCell=function(e){return e=this.table.columnManager.findColumn(e),this.cells.find((function(t){return t.column===e}))},a.prototype.getCellIndex=function(e){return this.cells.findIndex((function(t){return t===e}))},a.prototype.findNextEditableCell=function(e){var t=!1;if(e<this.cells.length-1)for(var o=e+1;o<this.cells.length;o++){var i=this.cells[o];if(i.column.modules.edit&&d.prototype.helpers.elVisible(i.getElement())){var n=!0;if("function"==typeof i.column.modules.edit.check&&(n=i.column.modules.edit.check(i.getComponent())),n){t=i;break}}}return t},a.prototype.findPrevEditableCell=function(e){var t=!1;if(e>0)for(var o=e-1;o>=0;o--){var i=this.cells[o],n=!0;if(i.column.modules.edit&&d.prototype.helpers.elVisible(i.getElement())&&("function"==typeof i.column.modules.edit.check&&(n=i.column.modules.edit.check(i.getComponent())),n)){t=i;break}}return t},a.prototype.getCells=function(){return this.cells},a.prototype.nextRow=function(){return this.table.rowManager.nextDisplayRow(this,!0)||!1},a.prototype.prevRow=function(){return this.table.rowManager.prevDisplayRow(this,!0)||!1},a.prototype.moveToRow=function(e,t){var o=this.table.rowManager.findRow(e);o?(this.table.rowManager.moveRowActual(this,o,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)},a.prototype.delete=function(){var e=this;return new Promise((function(t,o){var i,n;e.table.options.history&&e.table.modExists("history")&&(e.table.options.groupBy&&e.table.modExists("groupRows")?(i=(n=e.getGroup().rows).indexOf(e))&&(i=n[i-1]):(i=e.table.rowManager.getRowIndex(e))&&(i=e.table.rowManager.rows[i-1]),e.table.modules.history.action("rowDelete",e,{data:e.getData(),pos:!i,index:i})),e.deleteActual(),t()}))},a.prototype.deleteActual=function(e){this.table.rowManager.getRowIndex(this),this.table.modExists("selectRow")&&this.table.modules.selectRow._deselectRow(this,!0),this.table.options.reactiveData&&this.table.modExists("reactiveData",!0),this.modules.group&&this.modules.group.removeRow(this),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.table.modExists("columnCalcs")&&(this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.columnCalcs.recalcRowGroup(this):this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows))},a.prototype.deleteCells=function(){for(var e=this.cells.length,t=0;t<e;t++)this.cells[0].delete()},a.prototype.wipe=function(){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element=!1,this.modules={},this.element.parentNode&&this.element.parentNode.removeChild(this.element)},a.prototype.getGroup=function(){return this.modules.group||!1},a.prototype.getComponent=function(){return new r(this)};var l=function(e){this._cell=e};l.prototype.getValue=function(){return this._cell.getValue()},l.prototype.getOldValue=function(){return this._cell.getOldValue()},l.prototype.getElement=function(){return this._cell.getElement()},l.prototype.getRow=function(){return this._cell.row.getComponent()},l.prototype.getData=function(){return this._cell.row.getData()},l.prototype.getField=function(){return this._cell.column.getField()},l.prototype.getColumn=function(){return this._cell.column.getComponent()},l.prototype.setValue=function(e,t){void 0===t&&(t=!0),this._cell.setValue(e,t)},l.prototype.restoreOldValue=function(){this._cell.setValueActual(this._cell.getOldValue())},l.prototype.edit=function(e){return this._cell.edit(e)},l.prototype.cancelEdit=function(){this._cell.cancelEdit()},l.prototype.nav=function(){return this._cell.nav()},l.prototype.checkHeight=function(){this._cell.checkHeight()},l.prototype.getTable=function(){return this._cell.table},l.prototype._getSelf=function(){return this._cell};var c=function(e,t){this.table=e.table,this.column=e,this.row=t,this.element=null,this.value=null,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.build()};c.prototype.build=function(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data))},c.prototype.generateElement=function(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.element=this.element},c.prototype._configureCell=function(){var e=this,t=e.column.cellEvents,o=e.element,i=this.column.getField();o.style.textAlign=e.column.hozAlign,e.column.vertAlign&&(o.style.display="inline-flex",o.style.alignItems={top:"flex-start",bottom:"flex-end",middle:"center"}[e.column.vertAlign]||"",e.column.hozAlign&&(o.style.justifyContent={left:"flex-start",right:"flex-end",center:"center"}[e.column.hozAlign]||"")),i&&o.setAttribute("tabulator-field",i),e.column.definition.cssClass&&e.column.definition.cssClass.split(" ").forEach((function(e){o.classList.add(e)})),"hover"===this.table.options.tooltipGenerationMode&&o.addEventListener("mouseenter",(function(t){e._generateTooltip()})),e._bindClickEvents(t),e._bindTouchEvents(t),e._bindMouseEvents(t),e.column.modules.edit&&e.table.modules.edit.bindEditor(e),e.column.definition.rowHandle&&!1!==e.table.options.movableRows&&e.table.modExists("moveRow")&&e.table.modules.moveRow.initializeCell(e),e.column.visible||e.hide()},c.prototype._bindClickEvents=function(e){var t=this,o=t.element;(e.cellClick||t.table.options.cellClick)&&o.addEventListener("click",(function(o){var i=t.getComponent();e.cellClick&&e.cellClick.call(t.table,o,i),t.table.options.cellClick&&t.table.options.cellClick.call(t.table,o,i)})),(e.cellDblClick||this.table.options.cellDblClick)&&o.addEventListener("dblclick",(function(o){var i=t.getComponent();e.cellDblClick&&e.cellDblClick.call(t.table,o,i),t.table.options.cellDblClick&&t.table.options.cellDblClick.call(t.table,o,i)})),(e.cellContext||this.table.options.cellContext)&&o.addEventListener("contextmenu",(function(o){var i=t.getComponent();e.cellContext&&e.cellContext.call(t.table,o,i),t.table.options.cellContext&&t.table.options.cellContext.call(t.table,o,i)}))},c.prototype._bindMouseEvents=function(e){var t=this,o=t.element;(e.cellMouseEnter||t.table.options.cellMouseEnter)&&o.addEventListener("mouseenter",(function(o){var i=t.getComponent();e.cellMouseEnter&&e.cellMouseEnter.call(t.table,o,i),t.table.options.cellMouseEnter&&t.table.options.cellMouseEnter.call(t.table,o,i)})),(e.cellMouseLeave||t.table.options.cellMouseLeave)&&o.addEventListener("mouseleave",(function(o){var i=t.getComponent();e.cellMouseLeave&&e.cellMouseLeave.call(t.table,o,i),t.table.options.cellMouseLeave&&t.table.options.cellMouseLeave.call(t.table,o,i)})),(e.cellMouseOver||t.table.options.cellMouseOver)&&o.addEventListener("mouseover",(function(o){var i=t.getComponent();e.cellMouseOver&&e.cellMouseOver.call(t.table,o,i),t.table.options.cellMouseOver&&t.table.options.cellMouseOver.call(t.table,o,i)})),(e.cellMouseOut||t.table.options.cellMouseOut)&&o.addEventListener("mouseout",(function(o){var i=t.getComponent();e.cellMouseOut&&e.cellMouseOut.call(t.table,o,i),t.table.options.cellMouseOut&&t.table.options.cellMouseOut.call(t.table,o,i)})),(e.cellMouseMove||t.table.options.cellMouseMove)&&o.addEventListener("mousemove",(function(o){var i=t.getComponent();e.cellMouseMove&&e.cellMouseMove.call(t.table,o,i),t.table.options.cellMouseMove&&t.table.options.cellMouseMove.call(t.table,o,i)}))},c.prototype._bindTouchEvents=function(e){var t,o,i,n=this,r=n.element;(e.cellTap||this.table.options.cellTap)&&(i=!1,r.addEventListener("touchstart",(function(e){i=!0}),{passive:!0}),r.addEventListener("touchend",(function(t){if(i){var o=n.getComponent();e.cellTap&&e.cellTap.call(n.table,t,o),n.table.options.cellTap&&n.table.options.cellTap.call(n.table,t,o)}i=!1}))),(e.cellDblTap||this.table.options.cellDblTap)&&(t=null,r.addEventListener("touchend",(function(o){if(t){clearTimeout(t),t=null;var i=n.getComponent();e.cellDblTap&&e.cellDblTap.call(n.table,o,i),n.table.options.cellDblTap&&n.table.options.cellDblTap.call(n.table,o,i)}else t=setTimeout((function(){clearTimeout(t),t=null}),300)}))),(e.cellTapHold||this.table.options.cellTapHold)&&(o=null,r.addEventListener("touchstart",(function(t){clearTimeout(o),o=setTimeout((function(){clearTimeout(o),o=null,i=!1;var r=n.getComponent();e.cellTapHold&&e.cellTapHold.call(n.table,t,r),n.table.options.cellTapHold&&n.table.options.cellTapHold.call(n.table,t,r)}),1e3)}),{passive:!0}),r.addEventListener("touchend",(function(e){clearTimeout(o),o=null})))},c.prototype._generateContents=function(){var e;switch(void 0===(e=this.table.modExists("format")?this.table.modules.format.formatValue(this):this.element.innerHTML=this.value)?"undefined":s(e)){case"object":if(e instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(e)}else this.element.innerHTML="",null!=e&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",e);break;case"undefined":case"null":this.element.innerHTML="";break;default:this.element.innerHTML=e}},c.prototype.cellRendered=function(){this.table.modExists("format")&&this.table.modules.format.cellRendered&&this.table.modules.format.cellRendered(this)},c.prototype._generateTooltip=function(){var e=this.column.tooltip;e?(!0===e?e=this.value:"function"==typeof e&&!1===(e=e(this.getComponent()))&&(e=""),void 0===e&&(e=""),this.element.setAttribute("title",e)):this.element.setAttribute("title","")},c.prototype.getElement=function(){return this.element},c.prototype.getValue=function(){return this.value},c.prototype.getOldValue=function(){return this.oldValue},c.prototype.setValue=function(e,t){var o;this.setValueProcessData(e,t)&&(this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("cellEdit",this,{oldValue:this.oldValue,newValue:this.value}),o=this.getComponent(),this.column.cellEvents.cellEdited&&this.column.cellEvents.cellEdited.call(this.table,o),this.table.options.cellEdited.call(this.table,o),this.table.options.dataEdited.call(this.table,this.table.rowManager.getData()))},c.prototype.setValueProcessData=function(e,t){var o=!1;return this.value!=e&&(o=!0,t&&this.column.modules.mutate&&(e=this.table.modules.mutator.transformCell(this,e))),this.setValueActual(e),o&&this.table.modExists("columnCalcs")&&(this.column.definition.topCalc||this.column.definition.bottomCalc)&&(this.table.options.groupBy&&this.table.modExists("groupRows")?("table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs||this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),"table"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.recalcRowGroup(this.row)):this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows)),o},c.prototype.setValueActual=function(e){this.oldValue=this.value,this.value=e,this.table.options.reactiveData&&this.table.modExists("reactiveData")&&this.table.modules.reactiveData.block(),this.column.setFieldValue(this.row.data,e),this.table.options.reactiveData&&this.table.modExists("reactiveData")&&this.table.modules.reactiveData.unblock(),this._generateContents(),this._generateTooltip(),this.table.options.resizableColumns&&this.table.modExists("resizeColumns")&&this.table.modules.resizeColumns.initializeColumn("cell",this.column,this.element),this.column.definition.contextMenu&&this.table.modExists("menu")&&this.table.modules.menu.initializeCell(this),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layoutElement(this.element,this.column)},c.prototype.setWidth=function(){this.width=this.column.width,this.element.style.width=this.column.widthStyled},c.prototype.clearWidth=function(){this.width="",this.element.style.width=""},c.prototype.getWidth=function(){return this.width||this.element.offsetWidth},c.prototype.setMinWidth=function(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled},c.prototype.checkHeight=function(){this.row.reinitializeHeight()},c.prototype.clearHeight=function(){this.element.style.height="",this.height=null},c.prototype.setHeight=function(){this.height=this.row.height,this.element.style.height=this.row.heightStyled},c.prototype.getHeight=function(){return this.height||this.element.offsetHeight},c.prototype.show=function(){this.element.style.display=""},c.prototype.hide=function(){this.element.style.display="none"},c.prototype.edit=function(e){if(this.table.modExists("edit",!0))return this.table.modules.edit.editCell(this,e)},c.prototype.cancelEdit=function(){if(this.table.modExists("edit",!0)){var e=this.table.modules.edit.getCurrentCell();e&&e._getSelf()===this?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}},c.prototype.delete=function(){this.table.rowManager.redrawBlock||this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}},c.prototype.nav=function(){var e=this,t=!1,o=this.row.getCellIndex(this);return{next:function(){var t,o=this.right();return!!o||!(!(t=e.table.rowManager.nextDisplayRow(e.row,!0))||!(o=t.findNextEditableCell(-1)))&&(o.edit(),!0)},prev:function(){var t,o=this.left();return!!o||!(!(t=e.table.rowManager.prevDisplayRow(e.row,!0))||!(o=t.findPrevEditableCell(t.cells.length)))&&(o.edit(),!0)},left:function(){return!!(t=e.row.findPrevEditableCell(o))&&(t.edit(),!0)},right:function(){return!!(t=e.row.findNextEditableCell(o))&&(t.edit(),!0)},up:function(){var t=e.table.rowManager.prevDisplayRow(e.row,!0);t&&t.cells[o].edit()},down:function(){var t=e.table.rowManager.nextDisplayRow(e.row,!0);t&&t.cells[o].edit()}}},c.prototype.getIndex=function(){this.row.getCellIndex(this)},c.prototype.getComponent=function(){return new l(this)};var u=function(e){this.table=e,this.active=!1,this.element=this.createElement(),this.external=!1,this.links=[],this._initialize()};u.prototype.createElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e},u.prototype._initialize=function(e){if(this.table.options.footerElement)switch(s(this.table.options.footerElement)){case"string":"<"===this.table.options.footerElement[0]?this.element.innerHTML=this.table.options.footerElement:(this.external=!0,this.element=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement}},u.prototype.getElement=function(){return this.element},u.prototype.append=function(e,t){this.activate(t),this.element.appendChild(e),this.table.rowManager.adjustTableSize()},u.prototype.prepend=function(e,t){this.activate(t),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()},u.prototype.remove=function(e){e.parentNode.removeChild(e),this.deactivate()},u.prototype.deactivate=function(e){this.element.firstChild&&!e||(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)},u.prototype.activate=function(e){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display="")),e&&this.links.push(e)},u.prototype.redraw=function(){this.links.forEach((function(e){e.footerRedraw()}))};var d=function e(t,o){this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.modules={},this.initializeElement(t),this.initializeOptions(o||{}),this._create(),e.prototype.comms.register(this)};d.prototype.defaultOptions={height:!1,minHeight:!1,maxHeight:!1,layout:"fitData",layoutColumnsOnNewData:!1,columnMinWidth:40,columnHeaderVertAlign:"top",columnVertAlign:!1,resizableColumns:!0,resizableRows:!1,autoResize:!0,columns:[],cellHozAlign:"",cellVertAlign:"",data:[],autoColumns:!1,reactiveData:!1,nestedFieldSeparator:".",tooltips:!1,tooltipsHeader:!1,tooltipGenerationMode:"load",initialSort:!1,initialFilter:!1,initialHeaderFilter:!1,columnHeaderSortMulti:!0,sortOrderReverse:!1,headerSort:!0,headerSortTristate:!1,footerElement:!1,index:"id",keybindings:[],tabEndNewRow:!1,invalidOptionWarnings:!0,clipboard:!1,clipboardCopyStyled:!0,clipboardCopyConfig:!1,clipboardCopyFormatter:!1,clipboardCopyRowRange:"active",clipboardPasteParser:"table",clipboardPasteAction:"insert",clipboardCopied:function(){},clipboardPasted:function(){},clipboardPasteError:function(){},downloadDataFormatter:!1,downloadReady:function(e,t){return t},downloadComplete:!1,downloadConfig:!1,dataTree:!1,dataTreeElementColumn:!1,dataTreeBranchElement:!0,dataTreeChildIndent:9,dataTreeChildField:"_children",dataTreeCollapseElement:!1,dataTreeExpandElement:!1,dataTreeStartExpanded:!1,dataTreeRowExpanded:function(){},dataTreeRowCollapsed:function(){},dataTreeChildColumnCalcs:!1,dataTreeSelectPropagate:!1,printAsHtml:!1,printFormatter:!1,printHeader:!1,printFooter:!1,printCopyStyle:!0,printStyled:!0,printVisibleRows:!0,printRowRange:"visible",printConfig:{},addRowPos:"bottom",selectable:"highlight",selectableRangeMode:"drag",selectableRollingSelection:!0,selectablePersistence:!0,selectableCheck:function(e,t){return!0},headerFilterLiveFilterDelay:300,headerFilterPlaceholder:!1,headerVisible:!0,history:!1,locale:!1,langs:{},virtualDom:!0,virtualDomBuffer:0,persistentLayout:!1,persistentSort:!1,persistentFilter:!1,persistenceID:"",persistenceMode:!0,persistenceReaderFunc:!1,persistenceWriterFunc:!1,persistence:!1,responsiveLayout:!1,responsiveLayoutCollapseStartOpen:!0,responsiveLayoutCollapseUseFormatters:!0,responsiveLayoutCollapseFormatter:!1,pagination:!1,paginationSize:!1,paginationInitialPage:1,paginationButtonCount:5,paginationSizeSelector:!1,paginationElement:!1,paginationDataSent:{},paginationDataReceived:{},paginationAddRow:"page",ajaxURL:!1,ajaxURLGenerator:!1,ajaxParams:{},ajaxConfig:"get",ajaxContentType:"form",ajaxRequestFunc:!1,ajaxLoader:!0,ajaxLoaderLoading:!1,ajaxLoaderError:!1,ajaxFiltering:!1,ajaxSorting:!1,ajaxProgressiveLoad:!1,ajaxProgressiveLoadDelay:0,ajaxProgressiveLoadScrollMargin:0,groupBy:!1,groupStartOpen:!0,groupValues:!1,groupHeader:!1,htmlOutputConfig:!1,movableColumns:!1,movableRows:!1,movableRowsConnectedTables:!1,movableRowsSender:!1,movableRowsReceiver:"insert",movableRowsSendingStart:function(){},movableRowsSent:function(){},movableRowsSentFailed:function(){},movableRowsSendingStop:function(){},movableRowsReceivingStart:function(){},movableRowsReceived:function(){},movableRowsReceivedFailed:function(){},movableRowsReceivingStop:function(){},scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,placeholder:!1,tableBuilding:function(){},tableBuilt:function(){},renderStarted:function(){},renderComplete:function(){},rowClick:!1,rowDblClick:!1,rowContext:!1,rowTap:!1,rowDblTap:!1,rowTapHold:!1,rowMouseEnter:!1,rowMouseLeave:!1,rowMouseOver:!1,rowMouseOut:!1,rowMouseMove:!1,rowContextMenu:!1,rowAdded:function(){},rowDeleted:function(){},rowMoved:function(){},rowUpdated:function(){},rowSelectionChanged:function(){},rowSelected:function(){},rowDeselected:function(){},rowResized:function(){},cellClick:!1,cellDblClick:!1,cellContext:!1,cellTap:!1,cellDblTap:!1,cellTapHold:!1,cellMouseEnter:!1,cellMouseLeave:!1,cellMouseOver:!1,cellMouseOut:!1,cellMouseMove:!1,cellEditing:function(){},cellEdited:function(){},cellEditCancelled:function(){},columnMoved:!1,columnResized:function(){},columnTitleChanged:function(){},columnVisibilityChanged:function(){},htmlImporting:function(){},htmlImported:function(){},dataLoading:function(){},dataLoaded:function(){},dataEdited:function(){},ajaxRequesting:function(){},ajaxResponse:!1,ajaxError:function(){},dataFiltering:!1,dataFiltered:!1,dataSorting:function(){},dataSorted:function(){},groupToggleElement:"arrow",groupClosedShowCalcs:!1,dataGrouping:function(){},dataGrouped:!1,groupVisibilityChanged:function(){},groupClick:!1,groupDblClick:!1,groupContext:!1,groupTap:!1,groupDblTap:!1,groupTapHold:!1,columnCalcs:!0,pageLoaded:function(){},localized:function(){},validationFailed:function(){},historyUndo:function(){},historyRedo:function(){},scrollHorizontal:function(){},scrollVertical:function(){}},d.prototype.initializeOptions=function(e){if(!1!==e.invalidOptionWarnings)for(var t in e)void 0===this.defaultOptions[t]&&console.warn("Invalid table constructor option:",t);for(var t in this.defaultOptions)t in e?this.options[t]=e[t]:Array.isArray(this.defaultOptions[t])?this.options[t]=[]:"object"===s(this.defaultOptions[t])&&null!==this.defaultOptions[t]?this.options[t]={}:this.options[t]=this.defaultOptions[t]},d.prototype.initializeElement=function(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement?(this.element=e,!0):"string"==typeof e?(this.element=document.querySelector(e),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)},d.prototype._mapDepricatedFunctionality=function(){(this.options.persistentLayout||this.options.persistentSort||this.options.persistentFilter)&&(this.options.persistence||(this.options.persistence={})),void 0!==this.options.clipboardCopyHeader&&(this.options.columnHeaders=this.options.clipboardCopyHeader,console.warn("DEPRECATION WARNING - clipboardCopyHeader option has been deprecated, please use the columnHeaders property on the clipboardCopyConfig option")),!0!==this.options.printVisibleRows&&(console.warn("printVisibleRows option is deprecated, you should now use the printRowRange option"),this.options.persistence.printRowRange="active"),!0!==this.options.printCopyStyle&&(console.warn("printCopyStyle option is deprecated, you should now use the printStyled option"),this.options.persistence.printStyled=this.options.printCopyStyle),this.options.persistentLayout&&(console.warn("persistentLayout option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.columns&&(this.options.persistence.columns=!0)),this.options.persistentSort&&(console.warn("persistentSort option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.sort&&(this.options.persistence.sort=!0)),this.options.persistentFilter&&(console.warn("persistentFilter option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.filter&&(this.options.persistence.filter=!0)),this.options.columnVertAlign&&(console.warn("columnVertAlign option is deprecated, you should now use the columnHeaderVertAlign option"),this.options.columnHeaderVertAlign=this.options.columnVertAlign)},d.prototype._clearSelection=function(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")},d.prototype._create=function(){this._clearObjectPointers(),this._mapDepricatedFunctionality(),this.bindModules(),"TABLE"===this.element.tagName&&this.modExists("htmlTableImport",!0)&&this.modules.htmlTableImport.parseTable(),this.columnManager=new t(this),this.rowManager=new n(this),this.footerManager=new u(this),this.columnManager.setRowManager(this.rowManager),this.rowManager.setColumnManager(this.columnManager),this._buildElement(),this._loadInitialData()},d.prototype._clearObjectPointers=function(){this.options.columns=this.options.columns.slice(0),this.options.reactiveData||(this.options.data=this.options.data.slice(0))},d.prototype._buildElement=function(){var e=this,t=this.element,o=this.modules,i=this.options;for(i.tableBuilding.call(this),t.classList.add("tabulator"),t.setAttribute("role","grid");t.firstChild;)t.removeChild(t.firstChild);for(var n in i.height&&(i.height=isNaN(i.height)?i.height:i.height+"px",t.style.height=i.height),!1!==i.minHeight&&(i.minHeight=isNaN(i.minHeight)?i.minHeight:i.minHeight+"px",t.style.minHeight=i.minHeight),!1!==i.maxHeight&&(i.maxHeight=isNaN(i.maxHeight)?i.maxHeight:i.maxHeight+"px",t.style.maxHeight=i.maxHeight),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modExists("layout",!0)&&o.layout.initialize(i.layout),!1!==i.headerFilterPlaceholder&&o.localize.setHeaderFilterPlaceholder(i.headerFilterPlaceholder),i.langs)o.localize.installLang(n,i.langs[n]);if(o.localize.setLocale(i.locale),"string"==typeof i.placeholder){var r=document.createElement("div");r.classList.add("tabulator-placeholder");var a=document.createElement("span");a.innerHTML=i.placeholder,r.appendChild(a),i.placeholder=r}if(t.appendChild(this.columnManager.getElement()),t.appendChild(this.rowManager.getElement()),i.footerElement&&this.footerManager.activate(),i.persistence&&this.modExists("persistence",!0)&&o.persistence.initialize(),i.persistence&&this.modExists("persistence",!0)&&o.persistence.config.columns&&(i.columns=o.persistence.load("columns",i.columns)),i.movableRows&&this.modExists("moveRow")&&o.moveRow.initialize(),i.autoColumns&&this.options.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modExists("columnCalcs")&&o.columnCalcs.initialize(),this.columnManager.setColumns(i.columns),i.dataTree&&this.modExists("dataTree",!0)&&o.dataTree.initialize(),this.modExists("frozenRows")&&this.modules.frozenRows.initialize(),(i.persistence&&this.modExists("persistence",!0)&&o.persistence.config.sort||i.initialSort)&&this.modExists("sort",!0)){var s=[];i.persistence&&this.modExists("persistence",!0)&&o.persistence.config.sort?!1===(s=o.persistence.load("sort"))&&i.initialSort&&(s=i.initialSort):i.initialSort&&(s=i.initialSort),o.sort.setSort(s)}if((i.persistence&&this.modExists("persistence",!0)&&o.persistence.config.filter||i.initialFilter)&&this.modExists("filter",!0)){var l=[];i.persistence&&this.modExists("persistence",!0)&&o.persistence.config.filter?!1===(l=o.persistence.load("filter"))&&i.initialFilter&&(l=i.initialFilter):i.initialFilter&&(l=i.initialFilter),o.filter.setFilter(l)}i.initialHeaderFilter&&this.modExists("filter",!0)&&i.initialHeaderFilter.forEach((function(t){var i=e.columnManager.findColumn(t.field);if(!i)return console.warn("Column Filter Error - No matching column found:",t.field),!1;o.filter.setHeaderFilterValue(i,t.value)})),this.modExists("ajax")&&o.ajax.initialize(),i.pagination&&this.modExists("page",!0)&&o.page.initialize(),i.groupBy&&this.modExists("groupRows",!0)&&o.groupRows.initialize(),this.modExists("keybindings")&&o.keybindings.initialize(),this.modExists("selectRow")&&o.selectRow.clearSelectionData(!0),i.autoResize&&this.modExists("resizeTable")&&o.resizeTable.initialize(),this.modExists("clipboard")&&o.clipboard.initialize(),i.printAsHtml&&this.modExists("print")&&o.print.initialize(),i.tableBuilt.call(this)},d.prototype._loadInitialData=function(){var e=this;if(e.options.pagination&&e.modExists("page"))if(e.modules.page.reset(!0,!0),"local"==e.options.pagination){if(e.options.data.length)e.rowManager.setData(e.options.data,!1,!0);else{if((e.options.ajaxURL||e.options.ajaxURLGenerator)&&e.modExists("ajax"))return void e.modules.ajax.loadData(!1,!0).then((function(){})).catch((function(){e.options.paginationInitialPage&&e.modules.page.setPage(e.options.paginationInitialPage)}));e.rowManager.setData(e.options.data,!1,!0)}e.options.paginationInitialPage&&e.modules.page.setPage(e.options.paginationInitialPage)}else e.options.ajaxURL?e.modules.page.setPage(e.options.paginationInitialPage).then((function(){})).catch((function(){})):e.rowManager.setData([],!1,!0);else e.options.data.length?e.rowManager.setData(e.options.data):(e.options.ajaxURL||e.options.ajaxURLGenerator)&&e.modExists("ajax")?e.modules.ajax.loadData(!1,!0).then((function(){})).catch((function(){})):e.rowManager.setData(e.options.data,!1,!0)},d.prototype.destroy=function(){var e=this.element;for(d.prototype.comms.deregister(this),this.options.reactiveData&&this.modExists("reactiveData",!0)&&this.modules.reactiveData.unwatchData(),this.rowManager.rows.forEach((function(e){e.wipe()})),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[],this.options.autoResize&&this.modExists("resizeTable")&&this.modules.resizeTable.clearBindings(),this.modExists("keybindings")&&this.modules.keybindings.clearBindings();e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator")},d.prototype._detectBrowser=function(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},d.prototype.blockRedraw=function(){return this.rowManager.blockRedraw()},d.prototype.restoreRedraw=function(){return this.rowManager.restoreRedraw()},d.prototype.setDataFromLocalFile=function(e){var t=this;return new Promise((function(o,i){var n=document.createElement("input");n.type="file",n.accept=e||".json,application/json",n.addEventListener("change",(function(e){var r,a=n.files[0],s=new FileReader;s.readAsText(a),s.onload=function(e){try{r=JSON.parse(s.result)}catch(e){return console.warn("File Load Error - File contents is invalid JSON",e),void i(e)}t._setData(r).then((function(e){o(e)})).catch((function(e){o(e)}))},s.onerror=function(e){console.warn("File Load Error - Unable to read file"),i()}})),n.click()}))},d.prototype.setData=function(e,t,o){return this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this._setData(e,t,o,!1,!0)},d.prototype._setData=function(e,t,o,i,n){return"string"!=typeof e?e?this.rowManager.setData(e,i,n):this.modExists("ajax")&&(this.modules.ajax.getUrl||this.options.ajaxURLGenerator)?"remote"==this.options.pagination&&this.modExists("page",!0)?(this.modules.page.reset(!0,!0),this.modules.page.setPage(1)):this.modules.ajax.loadData(i,n):this.rowManager.setData([],i,n):0==e.indexOf("{")||0==e.indexOf("[")?this.rowManager.setData(JSON.parse(e),i,n):this.modExists("ajax",!0)?(t&&this.modules.ajax.setParams(t),o&&this.modules.ajax.setConfig(o),this.modules.ajax.setUrl(e),"remote"==this.options.pagination&&this.modExists("page",!0)?(this.modules.page.reset(!0,!0),this.modules.page.setPage(1)):this.modules.ajax.loadData(i,n)):void 0},d.prototype.clearData=function(){this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this.rowManager.clearData()},d.prototype.getData=function(e){return!0===e&&(console.warn("passing a boolean to the getData function is deprecated, you should now pass the string 'active'"),e="active"),this.rowManager.getData(e)},d.prototype.getDataCount=function(e){return!0===e&&(console.warn("passing a boolean to the getDataCount function is deprecated, you should now pass the string 'active'"),e="active"),this.rowManager.getDataCount(e)},d.prototype.searchRows=function(e,t,o){if(this.modExists("filter",!0))return this.modules.filter.search("rows",e,t,o)},d.prototype.searchData=function(e,t,o){if(this.modExists("filter",!0))return this.modules.filter.search("data",e,t,o)},d.prototype.getHtml=function(e,t,o){if(this.modExists("export",!0))return this.modules.export.getHtml(e,t,o)},d.prototype.print=function(e,t,o){if(this.modExists("print",!0))return this.modules.print.printFullscreen(e,t,o)},d.prototype.getAjaxUrl=function(){if(this.modExists("ajax",!0))return this.modules.ajax.getUrl()},d.prototype.replaceData=function(e,t,o){return this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this._setData(e,t,o,!0)},d.prototype.updateData=function(e){var t=this,o=this,i=0;return new Promise((function(n,r){t.modExists("ajax")&&t.modules.ajax.blockActiveRequest(),"string"==typeof e&&(e=JSON.parse(e)),e?e.forEach((function(e){var t=o.rowManager.findRow(e[o.options.index]);t&&(i++,t.updateData(e).then((function(){--i||n()})))})):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))}))},d.prototype.addData=function(e,t,o){var i=this;return new Promise((function(n,r){i.modExists("ajax")&&i.modules.ajax.blockActiveRequest(),"string"==typeof e&&(e=JSON.parse(e)),e?i.rowManager.addRows(e,t,o).then((function(e){var t=[];e.forEach((function(e){t.push(e.getComponent())})),n(t)})):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))}))},d.prototype.updateOrAddData=function(e){var t=this,o=this,i=[],n=0;return new Promise((function(r,a){t.modExists("ajax")&&t.modules.ajax.blockActiveRequest(),"string"==typeof e&&(e=JSON.parse(e)),e?e.forEach((function(e){var t=o.rowManager.findRow(e[o.options.index]);n++,t?t.updateData(e).then((function(){n--,i.push(t.getComponent()),n||r(i)})):o.rowManager.addRows(e).then((function(e){n--,i.push(e[0].getComponent()),n||r(i)}))})):(console.warn("Update Error - No data provided"),a("Update Error - No data provided"))}))},d.prototype.getRow=function(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)},d.prototype.getRowFromPosition=function(e,t){var o=this.rowManager.getRowFromPosition(e,t);return o?o.getComponent():(console.warn("Find Error - No matching row found:",e),!1)},d.prototype.deleteRow=function(e){var t=this;return new Promise((function(o,i){var n=t,r=0,a=0,s=[];function l(){++r==e.length&&a&&(n.rowManager.reRenderInPosition(),o())}Array.isArray(e)||(e=[e]),e.forEach((function(e){var o=t.rowManager.findRow(e,!0);o?s.push(o):(console.warn("Delete Error - No matching row found:",e),i("Delete Error - No matching row found"),l())})),s.sort((function(e,o){return t.rowManager.rows.indexOf(e)>t.rowManager.rows.indexOf(o)?1:-1})),s.forEach((function(e){e.delete().then((function(){a++,l()})).catch((function(e){l(),i(e)}))}))}))},d.prototype.addRow=function(e,t,o){var i=this;return new Promise((function(n,r){"string"==typeof e&&(e=JSON.parse(e)),i.rowManager.addRows(e,t,o).then((function(e){i.modExists("columnCalcs")&&i.modules.columnCalcs.recalc(i.rowManager.activeRows),n(e[0].getComponent())}))}))},d.prototype.updateOrAddRow=function(e,t){var o=this;return new Promise((function(i,n){var r=o.rowManager.findRow(e);"string"==typeof t&&(t=JSON.parse(t)),r?r.updateData(t).then((function(){o.modExists("columnCalcs")&&o.modules.columnCalcs.recalc(o.rowManager.activeRows),i(r.getComponent())})).catch((function(e){n(e)})):r=o.rowManager.addRows(t).then((function(e){o.modExists("columnCalcs")&&o.modules.columnCalcs.recalc(o.rowManager.activeRows),i(e[0].getComponent())})).catch((function(e){n(e)}))}))},d.prototype.updateRow=function(e,t){var o=this;return new Promise((function(i,n){var r=o.rowManager.findRow(e);"string"==typeof t&&(t=JSON.parse(t)),r?r.updateData(t).then((function(){i(r.getComponent())})).catch((function(e){n(e)})):(console.warn("Update Error - No matching row found:",e),n("Update Error - No matching row found"))}))},d.prototype.scrollToRow=function(e,t,o){var i=this;return new Promise((function(n,r){var a=i.rowManager.findRow(e);a?i.rowManager.scrollToRow(a,t,o).then((function(){n()})).catch((function(e){r(e)})):(console.warn("Scroll Error - No matching row found:",e),r("Scroll Error - No matching row found"))}))},d.prototype.moveRow=function(e,t,o){var i=this.rowManager.findRow(e);i?i.moveToRow(t,o):console.warn("Move Error - No matching row found:",e)},d.prototype.getRows=function(e){return!0===e&&(console.warn("passing a boolean to the getRows function is deprecated, you should now pass the string 'active'"),e="active"),this.rowManager.getComponents(e)},d.prototype.getRowPosition=function(e,t){var o=this.rowManager.findRow(e);return o?this.rowManager.getRowPosition(o,t):(console.warn("Position Error - No matching row found:",e),!1)},d.prototype.copyToClipboard=function(e){this.modExists("clipboard",!0)&&this.modules.clipboard.copy(e)},d.prototype.setColumns=function(e){this.columnManager.setColumns(e)},d.prototype.getColumns=function(e){return this.columnManager.getComponents(e)},d.prototype.getColumn=function(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)},d.prototype.getColumnDefinitions=function(){return this.columnManager.getDefinitionTree()},d.prototype.getColumnLayout=function(){if(this.modExists("persistence",!0))return this.modules.persistence.parseColumns(this.columnManager.getColumns())},d.prototype.setColumnLayout=function(e){return!!this.modExists("persistence",!0)&&(this.columnManager.setColumns(this.modules.persistence.mergeDefinition(this.options.columns,e)),!0)},d.prototype.showColumn=function(e){var t=this.columnManager.findColumn(e);if(!t)return console.warn("Column Show Error - No matching column found:",e),!1;t.show(),this.options.responsiveLayout&&this.modExists("responsiveLayout",!0)&&this.modules.responsiveLayout.update()},d.prototype.hideColumn=function(e){var t=this.columnManager.findColumn(e);if(!t)return console.warn("Column Hide Error - No matching column found:",e),!1;t.hide(),this.options.responsiveLayout&&this.modExists("responsiveLayout",!0)&&this.modules.responsiveLayout.update()},d.prototype.toggleColumn=function(e){var t=this.columnManager.findColumn(e);if(!t)return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1;t.visible?t.hide():t.show()},d.prototype.addColumn=function(e,t,o){var i=this;return new Promise((function(n,r){var a=i.columnManager.findColumn(o);i.columnManager.addColumn(e,t,a).then((function(e){n(e.getComponent())})).catch((function(e){r(e)}))}))},d.prototype.deleteColumn=function(e){var t=this;return new Promise((function(o,i){var n=t.columnManager.findColumn(e);n?n.delete().then((function(){o()})).catch((function(e){i(e)})):(console.warn("Column Delete Error - No matching column found:",e),i())}))},d.prototype.updateColumnDefinition=function(e,t){var o=this;return new Promise((function(i,n){var r=o.columnManager.findColumn(e);r?r.updateDefinition(t).then((function(e){i(e)})).catch((function(e){n(e)})):(console.warn("Column Update Error - No matching column found:",e),n())}))},d.prototype.moveColumn=function(e,t,o){var i=this.columnManager.findColumn(e),n=this.columnManager.findColumn(t);i?n?this.columnManager.moveColumn(i,n,o):console.warn("Move Error - No matching column found:",n):console.warn("Move Error - No matching column found:",e)},d.prototype.scrollToColumn=function(e,t,o){var i=this;return new Promise((function(n,r){var a=i.columnManager.findColumn(e);a?i.columnManager.scrollToColumn(a,t,o).then((function(){n()})).catch((function(e){r(e)})):(console.warn("Scroll Error - No matching column found:",e),r("Scroll Error - No matching column found"))}))},d.prototype.setLocale=function(e){this.modules.localize.setLocale(e)},d.prototype.getLocale=function(){return this.modules.localize.getLocale()},d.prototype.getLang=function(e){return this.modules.localize.getLang(e)},d.prototype.redraw=function(e){this.columnManager.redraw(e),this.rowManager.redraw(e)},d.prototype.setHeight=function(e){"classic"!==this.rowManager.renderMode?(this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.setRenderMode(),this.rowManager.redraw()):console.warn("setHeight function is not available in classic render mode")},d.prototype.setSort=function(e,t){this.modExists("sort",!0)&&(this.modules.sort.setSort(e,t),this.rowManager.sorterRefresh())},d.prototype.getSorters=function(){if(this.modExists("sort",!0))return this.modules.sort.getSort()},d.prototype.clearSort=function(){this.modExists("sort",!0)&&(this.modules.sort.clear(),this.rowManager.sorterRefresh())},d.prototype.setFilter=function(e,t,o){this.modExists("filter",!0)&&(this.modules.filter.setFilter(e,t,o),this.rowManager.filterRefresh())},d.prototype.addFilter=function(e,t,o){this.modExists("filter",!0)&&(this.modules.filter.addFilter(e,t,o),this.rowManager.filterRefresh())},d.prototype.getFilters=function(e){if(this.modExists("filter",!0))return this.modules.filter.getFilters(e)},d.prototype.setHeaderFilterFocus=function(e){if(this.modExists("filter",!0)){var t=this.columnManager.findColumn(e);if(!t)return console.warn("Column Filter Focus Error - No matching column found:",e),!1;this.modules.filter.setHeaderFilterFocus(t)}},d.prototype.getHeaderFilterValue=function(e){if(this.modExists("filter",!0)){var t=this.columnManager.findColumn(e);if(t)return this.modules.filter.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}},d.prototype.setHeaderFilterValue=function(e,t){if(this.modExists("filter",!0)){var o=this.columnManager.findColumn(e);if(!o)return console.warn("Column Filter Error - No matching column found:",e),!1;this.modules.filter.setHeaderFilterValue(o,t)}},d.prototype.getHeaderFilters=function(){if(this.modExists("filter",!0))return this.modules.filter.getHeaderFilters()},d.prototype.removeFilter=function(e,t,o){this.modExists("filter",!0)&&(this.modules.filter.removeFilter(e,t,o),this.rowManager.filterRefresh())},d.prototype.clearFilter=function(e){this.modExists("filter",!0)&&(this.modules.filter.clearFilter(e),this.rowManager.filterRefresh())},d.prototype.clearHeaderFilter=function(){this.modExists("filter",!0)&&(this.modules.filter.clearHeaderFilter(),this.rowManager.filterRefresh())},d.prototype.selectRow=function(e){this.modExists("selectRow",!0)&&(!0===e&&(console.warn("passing a boolean to the selectRowselectRow function is deprecated, you should now pass the string 'active'"),e="active"),this.modules.selectRow.selectRows(e))},d.prototype.deselectRow=function(e){this.modExists("selectRow",!0)&&this.modules.selectRow.deselectRows(e)},d.prototype.toggleSelectRow=function(e){this.modExists("selectRow",!0)&&this.modules.selectRow.toggleRow(e)},d.prototype.getSelectedRows=function(){if(this.modExists("selectRow",!0))return this.modules.selectRow.getSelectedRows()},d.prototype.getSelectedData=function(){if(this.modExists("selectRow",!0))return this.modules.selectRow.getSelectedData()},d.prototype.setMaxPage=function(e){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.setMaxPage(e)},d.prototype.setPage=function(e){return this.options.pagination&&this.modExists("page")?this.modules.page.setPage(e):new Promise((function(e,t){t()}))},d.prototype.setPageToRow=function(e){var t=this;return new Promise((function(o,i){t.options.pagination&&t.modExists("page")&&(e=t.rowManager.findRow(e))?t.modules.page.setPageToRow(e).then((function(){o()})).catch((function(){i()})):i()}))},d.prototype.setPageSize=function(e){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.setPageSize(e),this.modules.page.setPage(1).then((function(){})).catch((function(){}))},d.prototype.getPageSize=function(){if(this.options.pagination&&this.modExists("page",!0))return this.modules.page.getPageSize()},d.prototype.previousPage=function(){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.previousPage()},d.prototype.nextPage=function(){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.nextPage()},d.prototype.getPage=function(){return!(!this.options.pagination||!this.modExists("page"))&&this.modules.page.getPage()},d.prototype.getPageMax=function(){return!(!this.options.pagination||!this.modExists("page"))&&this.modules.page.getPageMax()},d.prototype.setGroupBy=function(e){if(!this.modExists("groupRows",!0))return!1;this.options.groupBy=e,this.modules.groupRows.initialize(),this.rowManager.refreshActiveData("display"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")},d.prototype.setGroupStartOpen=function(e){if(!this.modExists("groupRows",!0))return!1;this.options.groupStartOpen=e,this.modules.groupRows.initialize(),this.options.groupBy?(this.rowManager.refreshActiveData("group"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")):console.warn("Grouping Update - cant refresh view, no groups have been set")},d.prototype.setGroupHeader=function(e){if(!this.modExists("groupRows",!0))return!1;this.options.groupHeader=e,this.modules.groupRows.initialize(),this.options.groupBy?(this.rowManager.refreshActiveData("group"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")):console.warn("Grouping Update - cant refresh view, no groups have been set")},d.prototype.getGroups=function(e){return!!this.modExists("groupRows",!0)&&this.modules.groupRows.getGroups(!0)},d.prototype.getGroupedData=function(){if(this.modExists("groupRows",!0))return this.options.groupBy?this.modules.groupRows.getGroupedData():this.getData()},d.prototype.getCalcResults=function(){return!!this.modExists("columnCalcs",!0)&&this.modules.columnCalcs.getResults()},d.prototype.recalc=function(){this.modExists("columnCalcs",!0)&&this.modules.columnCalcs.recalcAll(this.rowManager.activeRows)},d.prototype.navigatePrev=function(){var e=!1;return!(!this.modExists("edit",!0)||!(e=this.modules.edit.currentCell))&&e.nav().prev()},d.prototype.navigateNext=function(){var e=!1;return!(!this.modExists("edit",!0)||!(e=this.modules.edit.currentCell))&&e.nav().next()},d.prototype.navigateLeft=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().left())},d.prototype.navigateRight=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().right())},d.prototype.navigateUp=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().up())},d.prototype.navigateDown=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().down())},d.prototype.undo=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.undo()},d.prototype.redo=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.redo()},d.prototype.getHistoryUndoSize=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.getHistoryUndoSize()},d.prototype.getHistoryRedoSize=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.getHistoryRedoSize()},d.prototype.download=function(e,t,o,i){this.modExists("download",!0)&&this.modules.download.download(e,t,o,i)},d.prototype.downloadToTab=function(e,t,o,i){this.modExists("download",!0)&&this.modules.download.download(e,t,o,i,!0)},d.prototype.tableComms=function(e,t,o,i){this.modules.comms.receive(e,t,o,i)},d.prototype.moduleBindings={},d.prototype.extendModule=function(e,t,o){if(d.prototype.moduleBindings[e]){var i=d.prototype.moduleBindings[e].prototype[t];if(i)if("object"==(void 0===o?"undefined":s(o)))for(var n in o)i[n]=o[n];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",t)}else console.warn("Module Error - module does not exist:",e)},d.prototype.registerModule=function(e,t){d.prototype.moduleBindings[e]=t},d.prototype.bindModules=function(){for(var e in this.modules={},d.prototype.moduleBindings)this.modules[e]=new d.prototype.moduleBindings[e](this)},d.prototype.modExists=function(e,t){return!!this.modules[e]||(t&&console.error("Tabulator Module Not Installed: "+e),!1)},d.prototype.helpers={elVisible:function(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)},elOffset:function(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}},deepClone:function(e){var t=Array.isArray(e)?[]:{};for(var o in e)null!=e[o]&&"object"===s(e[o])?e[o]instanceof Date?t[o]=new Date(e[o]):t[o]=this.deepClone(e[o]):t[o]=e[o];return t}},d.prototype.comms={tables:[],register:function(e){d.prototype.comms.tables.push(e)},deregister:function(e){var t=d.prototype.comms.tables.indexOf(e);t>-1&&d.prototype.comms.tables.splice(t,1)},lookupTable:function(e,t){var o,i,n=[];if("string"==typeof e){if((o=document.querySelectorAll(e)).length)for(var r=0;r<o.length;r++)(i=d.prototype.comms.matchElement(o[r]))&&n.push(i)}else"undefined"!=typeof HTMLElement&&e instanceof HTMLElement||e instanceof d?(i=d.prototype.comms.matchElement(e))&&n.push(i):Array.isArray(e)?e.forEach((function(e){n=n.concat(d.prototype.comms.lookupTable(e))})):t||console.warn("Table Connection Error - Invalid Selector",e);return n},matchElement:function(e){return d.prototype.comms.tables.find((function(t){return e instanceof d?t===e:t.element===e}))}},d.prototype.findTable=function(e){var t=d.prototype.comms.lookupTable(e,!0);return!(Array.isArray(t)&&!t.length)&&t};var h=function(e){this.table=e,this.mode=null};h.prototype.initialize=function(e){this.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)},h.prototype.getMode=function(){return this.mode},h.prototype.layout=function(){this.modes[this.mode].call(this,this.table.columnManager.columnsByIndex)},h.prototype.modes={fitData:function(e){e.forEach((function(e){e.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:function(e){e.forEach((function(e){e.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataStretch:function(e){var t=this,o=0,i=this.table.rowManager.element.clientWidth,n=0,r=!1;e.forEach((function(e,i){e.widthFixed||e.reinitializeWidth(),(t.table.options.responsiveLayout?e.modules.responsive.visible:e.visible)&&(r=e),e.visible&&(o+=e.getWidth())})),r?(n=i-o+r.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(r.setWidth(0),this.table.modules.responsiveLayout.update()),n>0?r.setWidth(n):r.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function(e){var t,o,i=this.table.element.clientWidth,n=0,r=0,a=0,s=[],l=[],c=0,u=0;function d(e){return"string"==typeof e?e.indexOf("%")>-1?i/100*parseInt(e):parseInt(e):e}function h(e,t,o,i){var n=[],r=0,a=0,s=0,l=0,c=0,u=[];function p(e){return o*(e.column.definition.widthGrow||1)}function f(e){return d(e.width)-o*(e.column.definition.widthShrink||0)}return e.forEach((function(e,t){var o=i?f(e):p(e);e.column.minWidth>=o?n.push(e):(u.push(e),c+=i?e.column.definition.widthShrink||1:e.column.definition.widthGrow||1)})),n.length?(n.forEach((function(e){r+=i?e.width-e.column.minWidth:e.column.minWidth,e.width=e.column.minWidth})),l=(a=t-r)-(s=c?Math.floor(a/c):a)*c,l+=h(u,a,s,i)):(l=c?t-Math.floor(t/c)*c:t,u.forEach((function(e){e.width=i?f(e):p(e)}))),l}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(i-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),e.forEach((function(e){var t,o,i;e.visible&&(t=e.definition.width,o=parseInt(e.minWidth),t?(i=d(t),n+=i>o?i:o,e.definition.widthShrink&&(l.push({column:e,width:i>o?i:o}),c+=e.definition.widthShrink)):(s.push({column:e,width:0}),a+=e.definition.widthGrow||1))})),r=i-n,t=Math.floor(r/a),u=h(s,r,t,!1),s.length&&u>0&&(s[s.length-1].width+=+u),s.forEach((function(e){r-=e.width})),(o=Math.abs(u)+r)>0&&c&&(u=h(l,o,Math.floor(o/c),!0)),l.length&&(l[l.length-1].width-=u),s.forEach((function(e){e.column.setWidth(e.width)})),l.forEach((function(e){e.column.setWidth(e.width)}))}},d.prototype.registerModule("layout",h);var p=function(e){this.table=e,this.locale="default",this.lang=!1,this.bindings={}};p.prototype.setHeaderFilterPlaceholder=function(e){this.langs.default.headerFilters.default=e},p.prototype.setHeaderFilterColumnPlaceholder=function(e,t){this.langs.default.headerFilters.columns[e]=t,this.lang&&!this.lang.headerFilters.columns[e]&&(this.lang.headerFilters.columns[e]=t)},p.prototype.installLang=function(e,t){this.langs[e]?this._setLangProp(this.langs[e],t):this.langs[e]=t},p.prototype._setLangProp=function(e,t){for(var o in t)e[o]&&"object"==s(e[o])?this._setLangProp(e[o],t[o]):e[o]=t[o]},p.prototype.setLocale=function(e){if(!0===(e=e||"default")&&navigator.language&&(e=navigator.language.toLowerCase()),e&&!this.langs[e]){var t=e.split("-")[0];this.langs[t]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",e,t),e=t):(console.warn("Localization Error - Matching locale not found, using default: ",e),e="default")}this.locale=e,this.lang=d.prototype.helpers.deepClone(this.langs.default||{}),"default"!=e&&function e(t,o){for(var i in t)"object"==s(t[i])?(o[i]||(o[i]={}),e(t[i],o[i])):o[i]=t[i]}(this.langs[e],this.lang),this.table.options.localized.call(this.table,this.locale,this.lang),this._executeBindings()},p.prototype.getLocale=function(e){return self.locale},p.prototype.getLang=function(e){return e?this.langs[e]:this.lang},p.prototype.getText=function(e,t){var o=(e=t?e+"|"+t:e).split("|");return this._getLangElement(o,this.locale)||""},p.prototype._getLangElement=function(e,t){var o=this.lang;return e.forEach((function(e){var t;o&&(t=o[e],o=void 0!==t&&t)})),o},p.prototype.bind=function(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)},p.prototype._executeBindings=function(){var e=this,t=function(t){e.bindings[t].forEach((function(o){o(e.getText(t),e.lang)}))};for(var o in e.bindings)t(o)},p.prototype.langs={default:{groups:{item:"item",items:"items"},columns:{},ajax:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page"},headerFilters:{default:"filter column...",columns:{}}}},d.prototype.registerModule("localize",p);var f=function(e){this.table=e};f.prototype.getConnections=function(e){var t=this,o=[];return d.prototype.comms.lookupTable(e).forEach((function(e){t.table!==e&&o.push(e)})),o},f.prototype.send=function(e,t,o,i){var n=this,r=this.getConnections(e);r.forEach((function(e){e.tableComms(n.table.element,t,o,i)})),!r.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)},f.prototype.receive=function(e,t,o,i){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,o,i);console.warn("Inter-table Comms Error - no such module:",t)},d.prototype.registerModule("comms",f);var m=function(e){this.table=e,this.allowedTypes=["","data","download","clipboard","print","htmlOutput"]};m.prototype.initializeColumn=function(e){var t=this,o=!1,i={};this.allowedTypes.forEach((function(n){var r,a="accessor"+(n.charAt(0).toUpperCase()+n.slice(1));e.definition[a]&&(r=t.lookupAccessor(e.definition[a]))&&(o=!0,i[a]={accessor:r,params:e.definition[a+"Params"]||{}})})),o&&(e.modules.accessor=i)},m.prototype.lookupAccessor=function(e){var t=!1;switch(void 0===e?"undefined":s(e)){case"string":this.accessors[e]?t=this.accessors[e]:console.warn("Accessor Error - No such accessor found, ignoring: ",e);break;case"function":t=e}return t},m.prototype.transformRow=function(e,t){var o="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),i=d.prototype.helpers.deepClone(e||{});return this.table.columnManager.traverse((function(e){var n,r,a,s;e.modules.accessor&&(r=e.modules.accessor[o]||e.modules.accessor.accessor||!1)&&"undefined"!=(n=e.getFieldValue(i))&&(s=e.getComponent(),a="function"==typeof r.params?r.params(n,i,t,s):r.params,e.setFieldValue(i,r.accessor(n,i,t,a,s)))})),i},m.prototype.accessors={},d.prototype.registerModule("accessor",m);var g=function(e){this.table=e,this.config=!1,this.url="",this.urlGenerator=!1,this.params=!1,this.loaderElement=this.createLoaderElement(),this.msgElement=this.createMsgElement(),this.loadingElement=!1,this.errorElement=!1,this.loaderPromise=!1,this.progressiveLoad=!1,this.loading=!1,this.requestOrder=0};g.prototype.initialize=function(){var e;this.loaderElement.appendChild(this.msgElement),this.table.options.ajaxLoaderLoading&&("string"==typeof this.table.options.ajaxLoaderLoading?((e=document.createElement("template")).innerHTML=this.table.options.ajaxLoaderLoading.trim(),this.loadingElement=e.content.firstChild):this.loadingElement=this.table.options.ajaxLoaderLoading),this.loaderPromise=this.table.options.ajaxRequestFunc||this.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||this.defaultURLGenerator,this.table.options.ajaxLoaderError&&("string"==typeof this.table.options.ajaxLoaderError?((e=document.createElement("template")).innerHTML=this.table.options.ajaxLoaderError.trim(),this.errorElement=e.content.firstChild):this.errorElement=this.table.options.ajaxLoaderError),this.table.options.ajaxParams&&this.setParams(this.table.options.ajaxParams),this.table.options.ajaxConfig&&this.setConfig(this.table.options.ajaxConfig),this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.table.options.ajaxProgressiveLoad&&(this.table.options.pagination?(this.progressiveLoad=!1,console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time")):this.table.modExists("page")?(this.progressiveLoad=this.table.options.ajaxProgressiveLoad,this.table.modules.page.initializeProgressive(this.progressiveLoad)):console.error("Pagination plugin is required for progressive ajax loading"))},g.prototype.createLoaderElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-loader"),e},g.prototype.createMsgElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-loader-msg"),e.setAttribute("role","alert"),e},g.prototype.setParams=function(e,t){if(t)for(var o in this.params=this.params||{},e)this.params[o]=e[o];else this.params=e},g.prototype.getParams=function(){return this.params||{}},g.prototype.setConfig=function(e){if(this._loadDefaultConfig(),"string"==typeof e)this.config.method=e;else for(var t in e)this.config[t]=e[t]},g.prototype._loadDefaultConfig=function(e){if(!this.config||e)for(var t in this.config={},this.defaultConfig)this.config[t]=this.defaultConfig[t]},g.prototype.setUrl=function(e){this.url=e},g.prototype.getUrl=function(){return this.url},g.prototype.loadData=function(e,t){return this.progressiveLoad?this._loadDataProgressive():this._loadDataStandard(e,t)},g.prototype.nextPage=function(e){this.loading||e<(this.table.options.ajaxProgressiveLoadScrollMargin||2*this.table.rowManager.getElement().clientHeight)&&this.table.modules.page.nextPage().then((function(){})).catch((function(){}))},g.prototype.blockActiveRequest=function(){this.requestOrder++},g.prototype._loadDataProgressive=function(){return this.table.rowManager.setData([]),this.table.modules.page.setPage(1)},g.prototype._loadDataStandard=function(e,t){var o=this;return new Promise((function(i,n){o.sendRequest(e).then((function(r){o.table.rowManager.setData(r,e,t).then((function(){i()})).catch((function(e){n(e)}))})).catch((function(e){n(e)}))}))},g.prototype.generateParamsList=function(e,t){var o=this,i=[];if(t=t||"",Array.isArray(e))e.forEach((function(e,n){i=i.concat(o.generateParamsList(e,t?t+"["+n+"]":n))}));else if("object"===(void 0===e?"undefined":s(e)))for(var n in e)i=i.concat(o.generateParamsList(e[n],t?t+"["+n+"]":n));else i.push({key:t,value:e});return i},g.prototype.serializeParams=function(e){var t=this.generateParamsList(e),o=[];return t.forEach((function(e){o.push(encodeURIComponent(e.key)+"="+encodeURIComponent(e.value))})),o.join("&")},g.prototype.sendRequest=function(e){var t,o=this,i=this,n=i.url;return i.requestOrder++,t=i.requestOrder,i._loadDefaultConfig(),new Promise((function(r,a){!1!==i.table.options.ajaxRequesting.call(o.table,i.url,i.params)?(i.loading=!0,e||i.showLoader(),o.loaderPromise(n,i.config,i.params).then((function(e){t===i.requestOrder?(i.table.options.ajaxResponse&&(e=i.table.options.ajaxResponse.call(i.table,i.url,i.params,e)),r(e),i.hideLoader(),i.loading=!1):console.warn("Ajax Response Blocked - An active ajax request was blocked by an attempt to change table data while the request was being made")})).catch((function(e){console.error("Ajax Load Error: ",e),i.table.options.ajaxError.call(i.table,e),i.showError(),setTimeout((function(){i.hideLoader()}),3e3),i.loading=!1,a()}))):a()}))},g.prototype.showLoader=function(){if("function"==typeof this.table.options.ajaxLoader?this.table.options.ajaxLoader():this.table.options.ajaxLoader){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-error"),this.msgElement.classList.add("tabulator-loading"),this.loadingElement?this.msgElement.appendChild(this.loadingElement):this.msgElement.innerHTML=this.table.modules.localize.getText("ajax|loading"),this.table.element.appendChild(this.loaderElement)}},g.prototype.showError=function(){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-loading"),this.msgElement.classList.add("tabulator-error"),this.errorElement?this.msgElement.appendChild(this.errorElement):this.msgElement.innerHTML=this.table.modules.localize.getText("ajax|error"),this.table.element.appendChild(this.loaderElement)},g.prototype.hideLoader=function(){this.loaderElement.parentNode&&this.loaderElement.parentNode.removeChild(this.loaderElement)},g.prototype.defaultConfig={method:"GET"},g.prototype.defaultURLGenerator=function(e,t,o){return e&&o&&Object.keys(o).length&&(t.method&&"get"!=t.method.toLowerCase()||(t.method="get",e+=(e.includes("?")?"&":"?")+this.serializeParams(o))),e},g.prototype.defaultLoaderPromise=function(e,t,o){var i,n=this;return new Promise((function(r,a){if(e=n.urlGenerator(e,t,o),"GET"!=t.method.toUpperCase())if(i="object"===s(n.table.options.ajaxContentType)?n.table.options.ajaxContentType:n.contentTypeFormatters[n.table.options.ajaxContentType]){for(var l in i.headers)t.headers||(t.headers={}),void 0===t.headers[l]&&(t.headers[l]=i.headers[l]);t.body=i.body.call(n,e,t,o)}else console.warn("Ajax Error - Invalid ajaxContentType value:",n.table.options.ajaxContentType);e?(void 0===t.headers&&(t.headers={}),void 0===t.headers.Accept&&(t.headers.Accept="application/json"),void 0===t.headers["X-Requested-With"]&&(t.headers["X-Requested-With"]="XMLHttpRequest"),void 0===t.mode&&(t.mode="cors"),"cors"==t.mode?(void 0===t.headers["Access-Control-Allow-Origin"]&&(t.headers["Access-Control-Allow-Origin"]=window.location.origin),void 0===t.credentials&&(t.credentials="same-origin")):void 0===t.credentials&&(t.credentials="include"),fetch(e,t).then((function(e){e.ok?e.json().then((function(e){r(e)})).catch((function(e){a(e),console.warn("Ajax Load Error - Invalid JSON returned",e)})):(console.error("Ajax Load Error - Connection Error: "+e.status,e.statusText),a(e))})).catch((function(e){console.error("Ajax Load Error - Connection Error: ",e),a(e)}))):(console.warn("Ajax Load Error - No URL Set"),r([]))}))},g.prototype.contentTypeFormatters={json:{headers:{"Content-Type":"application/json"},body:function(e,t,o){return JSON.stringify(o)}},form:{headers:{},body:function(e,t,o){var i=this.generateParamsList(o),n=new FormData;return i.forEach((function(e){n.append(e.key,e.value)})),n}}},d.prototype.registerModule("ajax",g);var v=function(e){this.table=e,this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.initialize()};v.prototype.createElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e},v.prototype.initialize=function(){this.genColumn=new i({field:"value"},this)},v.prototype.registerColumnField=function(){},v.prototype.initializeColumn=function(e){var t=e.definition,o={topCalcParams:t.topCalcParams||{},botCalcParams:t.bottomCalcParams||{}};if(t.topCalc){switch(s(t.topCalc)){case"string":this.calculations[t.topCalc]?o.topCalc=this.calculations[t.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.topCalc);break;case"function":o.topCalc=t.topCalc}o.topCalc&&(e.modules.columnCalcs=o,this.topCalcs.push(e),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(t.bottomCalc){switch(s(t.bottomCalc)){case"string":this.calculations[t.bottomCalc]?o.botCalc=this.calculations[t.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.bottomCalc);break;case"function":o.botCalc=t.bottomCalc}o.botCalc&&(e.modules.columnCalcs=o,this.botCalcs.push(e),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}},v.prototype.removeCalcs=function(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.table.footerManager.remove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()},v.prototype.initializeTopRow=function(){this.topInitialized||(this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)},v.prototype.initializeBottomRow=function(){this.botInitialized||(this.table.footerManager.prepend(this.botElement),this.botInitialized=!0)},v.prototype.scrollHorizontal=function(e){this.table.columnManager.getElement().scrollWidth,this.table.element.clientWidth,this.botInitialized&&(this.botRow.getElement().style.marginLeft=-e+"px")},v.prototype.recalc=function(e){var t;if(this.topInitialized||this.botInitialized){if(this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),t=this.generateRow("top",this.rowsToData(e)),this.topRow=t;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(t.getElement()),t.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),t=this.generateRow("bottom",this.rowsToData(e)),this.botRow=t;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(t.getElement()),t.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}},v.prototype.recalcRowGroup=function(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))},v.prototype.recalcAll=function(){var e=this;(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalc(this.table.rowManager.activeRows),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs&&table.modules.groupRows.getChildGroups().forEach((function(t){e.recalcGroup(t)})))},v.prototype.recalcGroup=function(e){var t,o;e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),o=this.generateRowData("bottom",t),e.calcs.bottom.updateData(o),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),o=this.generateRowData("top",t),e.calcs.top.updateData(o),e.calcs.top.reinitialize()))},v.prototype.generateTopRow=function(e){return this.generateRow("top",this.rowsToData(e))},v.prototype.generateBottomRow=function(e){return this.generateRow("bottom",this.rowsToData(e))},v.prototype.rowsToData=function(e){var t=this,o=[];return e.forEach((function(e){if(o.push(e.getData()),t.table.options.dataTree&&t.table.options.dataTreeChildColumnCalcs&&e.modules.dataTree.open){var i=t.rowsToData(t.table.modules.dataTree.getFilteredTreeChildren(e));o=o.concat(i)}})),o},v.prototype.generateRow=function(e,t){var o,i=this,n=this.generateRowData(e,t);return i.table.modExists("mutator")&&i.table.modules.mutator.disable(),o=new a(n,this,"calc"),i.table.modExists("mutator")&&i.table.modules.mutator.enable(),o.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),o.generateCells=function(){var t=[];i.table.columnManager.columnsByIndex.forEach((function(n){i.genColumn.setField(n.getField()),i.genColumn.hozAlign=n.hozAlign,n.definition[e+"CalcFormatter"]&&i.table.modExists("format")?i.genColumn.modules.format={formatter:i.table.modules.format.getFormatter(n.definition[e+"CalcFormatter"]),params:n.definition[e+"CalcFormatterParams"]}:i.genColumn.modules.format={formatter:i.table.modules.format.getFormatter("plaintext"),params:{}},i.genColumn.definition.cssClass=n.definition.cssClass;var r=new c(i.genColumn,o);r.column=n,r.setWidth(),n.cells.push(r),t.push(r),n.visible||r.hide()})),this.cells=t},o},v.prototype.generateRowData=function(e,t){var o,i,n={},r="top"==e?this.topCalcs:this.botCalcs,a="top"==e?"topCalc":"botCalc";return r.forEach((function(e){var r=[];e.modules.columnCalcs&&e.modules.columnCalcs[a]&&(t.forEach((function(t){r.push(e.getFieldValue(t))})),i=a+"Params",o="function"==typeof e.modules.columnCalcs[i]?e.modules.columnCalcs[i](r,t):e.modules.columnCalcs[i],e.setFieldValue(n,e.modules.columnCalcs[a](r,t,o)))})),n},v.prototype.hasTopCalcs=function(){return!!this.topCalcs.length},v.prototype.hasBottomCalcs=function(){return!!this.botCalcs.length},v.prototype.redraw=function(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)},v.prototype.getResults=function(){var e=this,t={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach((function(o){t[o.getKey()]=e.getGroupResults(o)})):t={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},t},v.prototype.getGroupResults=function(e){var t=this,o=e._getSelf(),i=e.getSubGroups(),n={};return i.forEach((function(e){n[e.getKey()]=t.getGroupResults(e)})),{top:o.calcs.top?o.calcs.top.getData():{},bottom:o.calcs.bottom?o.calcs.bottom.getData():{},groups:n}},v.prototype.calculations={avg:function(e,t,o){var i=0,n=void 0!==o.precision?o.precision:2;return e.length&&(i=e.reduce((function(e,t){return e+(t=Number(t))})),i/=e.length,i=!1!==n?i.toFixed(n):i),parseFloat(i).toString()},max:function(e,t,o){var i=null,n=void 0!==o.precision&&o.precision;return e.forEach((function(e){((e=Number(e))>i||null===i)&&(i=e)})),null!==i?!1!==n?i.toFixed(n):i:""},min:function(e,t,o){var i=null,n=void 0!==o.precision&&o.precision;return e.forEach((function(e){((e=Number(e))<i||null===i)&&(i=e)})),null!==i?!1!==n?i.toFixed(n):i:""},sum:function(e,t,o){var i=0,n=void 0!==o.precision&&o.precision;return e.length&&e.forEach((function(e){e=Number(e),i+=isNaN(e)?0:Number(e)})),!1!==n?i.toFixed(n):i},concat:function(e,t,o){var i=0;return e.length&&(i=e.reduce((function(e,t){return String(e)+String(t)}))),i},count:function(e,t,o){var i=0;return e.length&&e.forEach((function(e){e&&i++})),i}},d.prototype.registerModule("columnCalcs",v);var b=function(e){this.table=e,this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0};b.prototype.initialize=function(){var e=this;this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,!0!==this.mode&&"copy"!==this.mode||this.table.element.addEventListener("copy",(function(t){var o,i;e.blocked||(t.preventDefault(),e.customSelection?(o=e.customSelection,e.table.options.clipboardCopyFormatter&&(o=e.table.options.clipboardCopyFormatter("plain",o))):(o=(i=e.table.modules.export.getHtml(e.rowRange,e.table.options.clipboardCopyStyled,e.table.options.clipboardCopyConfig,"clipboard"))?e.generatePlainContent(i):"",e.table.options.clipboardCopyFormatter&&(o=e.table.options.clipboardCopyFormatter("plain",o),i=e.table.options.clipboardCopyFormatter("html",i))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",o):t.clipboardData&&t.clipboardData.setData?(t.clipboardData.setData("text/plain",o),i&&t.clipboardData.setData("text/html",i)):t.originalEvent&&t.originalEvent.clipboardData.setData&&(t.originalEvent.clipboardData.setData("text/plain",o),i&&t.originalEvent.clipboardData.setData("text/html",i)),e.table.options.clipboardCopied.call(e.table,o,i),e.reset())})),!0!==this.mode&&"paste"!==this.mode||this.table.element.addEventListener("paste",(function(t){e.paste(t)})),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction)},b.prototype.reset=function(){this.blocked=!1,this.originalSelectionText=""},b.prototype.generatePlainContent=function(e){var t=[],o=document.createElement("div");o.innerHTML=e;var i=o.getElementsByTagName("table")[0];return Array.prototype.slice.call(i.getElementsByTagName("tr")).forEach((function(e){var o=[],i=Array.prototype.slice.call(e.getElementsByTagName("th")),n=Array.prototype.slice.call(e.getElementsByTagName("td"));(n=n.concat(i)).forEach((function(e){var t=e.innerHTML;t="&nbsp;"==t?"":t,o.push(t)})),t.push(o.join("\t"))})),t.join("\n")},b.prototype.copy=function(e,t){var o,i;this.blocked=!1,this.customSelection=!1,!0!==this.mode&&"copy"!==this.mode||(this.rowRange=e||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((e=document.createRange()).selectNodeContents(this.table.element),(o=window.getSelection()).toString()&&t&&(this.customSelection=o.toString()),o.removeAllRanges(),o.addRange(e)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((i=document.body.createTextRange()).moveToElementText(this.table.element),i.select()),document.execCommand("copy"),o&&o.removeAllRanges())},b.prototype.setPasteAction=function(e){switch(void 0===e?"undefined":s(e)){case"string":this.pasteAction=this.pasteActions[e],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",e);break;case"function":this.pasteAction=e}},b.prototype.setPasteParser=function(e){switch(void 0===e?"undefined":s(e)){case"string":this.pasteParser=this.pasteParsers[e],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",e);break;case"function":this.pasteParser=e}},b.prototype.paste=function(e){var t,o,i;this.checkPaseOrigin(e)&&(t=this.getPasteData(e),(o=this.pasteParser.call(this,t))?(e.preventDefault(),this.table.modExists("mutator")&&(o=this.mutateData(o)),i=this.pasteAction.call(this,o),this.table.options.clipboardPasted.call(this.table,t,o,i)):this.table.options.clipboardPasteError.call(this.table,t))},b.prototype.mutateData=function(e){var t=this,o=[];return Array.isArray(e)?e.forEach((function(e){o.push(t.table.modules.mutator.transformRow(e,"clipboard"))})):o=e,o},b.prototype.checkPaseOrigin=function(e){var t=!0;return("DIV"!=e.target.tagName||this.table.modules.edit.currentCell)&&(t=!1),t},b.prototype.getPasteData=function(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t},b.prototype.pasteParsers={table:function(e){var t=[],o=!0,i=this.table.columnManager.columns,n=[],r=[];return(e=e.split("\n")).forEach((function(e){t.push(e.split("\t"))})),!(!t.length||1===t.length&&t[0].length<2)&&(t[0].forEach((function(e){var t=i.find((function(t){return e&&t.definition.title&&e.trim()&&t.definition.title.trim()===e.trim()}));t?n.push(t):o=!1})),o||(o=!0,n=[],t[0].forEach((function(e){var t=i.find((function(t){return e&&t.field&&e.trim()&&t.field.trim()===e.trim()}));t?n.push(t):o=!1})),o||(n=this.table.columnManager.columnsByIndex)),o&&t.shift(),t.forEach((function(e){var t={};e.forEach((function(e,o){n[o]&&(t[n[o].field]=e)})),r.push(t)})),r)}},b.prototype.pasteActions={replace:function(e){return this.table.setData(e)},update:function(e){return this.table.updateOrAddData(e)},insert:function(e){return this.table.addData(e)}},d.prototype.registerModule("clipboard",b);var y=function(e){this.table=e,this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.displayIndex=0};y.prototype.initialize=function(){var e=null,t=this.table.columnManager.getFirstVisibileColumn(),o=this.table.options;switch(this.field=o.dataTreeChildField,this.indent=o.dataTreeChildIndent,this.elementField=o.dataTreeElementColumn||!!t&&t.field,o.dataTreeBranchElement&&(!0===o.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof o.dataTreeBranchElement?((e=document.createElement("div")).innerHTML=o.dataTreeBranchElement,this.branchEl=e.firstChild):this.branchEl=o.dataTreeBranchElement),o.dataTreeCollapseElement?"string"==typeof o.dataTreeCollapseElement?((e=document.createElement("div")).innerHTML=o.dataTreeCollapseElement,this.collapseEl=e.firstChild):this.collapseEl=o.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),o.dataTreeExpandElement?"string"==typeof o.dataTreeExpandElement?((e=document.createElement("div")).innerHTML=o.dataTreeExpandElement,this.expandEl=e.firstChild):this.expandEl=o.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),s(o.dataTreeStartExpanded)){case"boolean":this.startOpen=function(e,t){return o.dataTreeStartExpanded};break;case"function":this.startOpen=o.dataTreeStartExpanded;break;default:this.startOpen=function(e,t){return o.dataTreeStartExpanded[t]}}},y.prototype.initializeRow=function(e){var t=e.getData()[this.field],o=Array.isArray(t),i=o||!o&&"object"===(void 0===t?"undefined":s(t))&&null!==t;!i&&e.modules.dataTree&&e.modules.dataTree.branchEl&&e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl),!i&&e.modules.dataTree&&e.modules.dataTree.controlEl&&e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl),e.modules.dataTree={index:0,open:!!i&&(e.modules.dataTree?e.modules.dataTree.open:this.startOpen(e.getComponent(),0)),controlEl:!(!e.modules.dataTree||!i)&&e.modules.dataTree.controlEl,branchEl:!(!e.modules.dataTree||!i)&&e.modules.dataTree.branchEl,parent:!1,children:i}},y.prototype.layoutRow=function(e){var t=(this.elementField?e.getCell(this.elementField):e.getCells()[0]).getElement(),o=e.modules.dataTree;o.branchEl&&(o.branchEl.parentNode.removeChild(o.branchEl),o.branchEl=!1),o.controlEl&&(o.controlEl.parentNode.removeChild(o.controlEl),o.controlEl=!1),this.generateControlElement(e,t),e.element.classList.add("tabulator-tree-level-"+o.index),o.index&&(this.branchEl?(o.branchEl=this.branchEl.cloneNode(!0),t.insertBefore(o.branchEl,t.firstChild),o.branchEl.style.marginLeft=(o.branchEl.offsetWidth+o.branchEl.style.marginRight)*(o.index-1)+o.index*this.indent+"px"):t.style.paddingLeft=parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-left"))+o.index*this.indent+"px")},y.prototype.generateControlElement=function(e,t){var o=this,i=e.modules.dataTree,n=(t=t||e.getCells()[0].getElement(),i.controlEl);!1!==i.children&&(i.open?(i.controlEl=this.collapseEl.cloneNode(!0),i.controlEl.addEventListener("click",(function(t){t.stopPropagation(),o.collapseRow(e)}))):(i.controlEl=this.expandEl.cloneNode(!0),i.controlEl.addEventListener("click",(function(t){t.stopPropagation(),o.expandRow(e)}))),i.controlEl.addEventListener("mousedown",(function(e){e.stopPropagation()})),n&&n.parentNode===t?n.parentNode.replaceChild(i.controlEl,n):t.insertBefore(i.controlEl,t.firstChild))},y.prototype.setDisplayIndex=function(e){this.displayIndex=e},y.prototype.getDisplayIndex=function(){return this.displayIndex},y.prototype.getRows=function(e){var t=this,o=[];return e.forEach((function(e,i){var n;o.push(e),e instanceof a&&((n=e.modules.dataTree.children).index||!1===n.children||t.getChildren(e).forEach((function(e){o.push(e)})))})),o},y.prototype.getChildren=function(e){var t=this,o=e.modules.dataTree,i=[],n=[];return!1!==o.children&&o.open&&(Array.isArray(o.children)||(o.children=this.generateChildren(e)),i=this.table.modExists("filter")?this.table.modules.filter.filter(o.children):o.children,this.table.modExists("sort")&&this.table.modules.sort.sort(i),i.forEach((function(e){n.push(e),t.getChildren(e).forEach((function(e){n.push(e)}))}))),n},y.prototype.generateChildren=function(e){var t=this,o=[],i=e.getData()[this.field];return Array.isArray(i)||(i=[i]),i.forEach((function(i){var n=new a(i||{},t.table.rowManager);n.modules.dataTree.index=e.modules.dataTree.index+1,n.modules.dataTree.parent=e,n.modules.dataTree.children&&(n.modules.dataTree.open=t.startOpen(n.getComponent(),n.modules.dataTree.index)),o.push(n)})),o},y.prototype.expandRow=function(e,t){var o=e.modules.dataTree;!1!==o.children&&(o.open=!0,e.reinitialize(),this.table.rowManager.refreshActiveData("tree",!1,!0),this.table.options.dataTreeRowExpanded(e.getComponent(),e.modules.dataTree.index))},y.prototype.collapseRow=function(e){var t=e.modules.dataTree;!1!==t.children&&(t.open=!1,e.reinitialize(),this.table.rowManager.refreshActiveData("tree",!1,!0),this.table.options.dataTreeRowCollapsed(e.getComponent(),e.modules.dataTree.index))},y.prototype.toggleRow=function(e){var t=e.modules.dataTree;!1!==t.children&&(t.open?this.collapseRow(e):this.expandRow(e))},y.prototype.getTreeParent=function(e){return!!e.modules.dataTree.parent&&e.modules.dataTree.parent.getComponent()},y.prototype.getFilteredTreeChildren=function(e){var t=e.modules.dataTree,o=[];return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),(this.table.modExists("filter")?this.table.modules.filter.filter(t.children):t.children).forEach((function(e){e instanceof a&&o.push(e)}))),o},y.prototype.getTreeChildren=function(e){var t=e.modules.dataTree,o=[];return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),t.children.forEach((function(e){e instanceof a&&o.push(e.getComponent())}))),o},y.prototype.checkForRestyle=function(e){e.row.cells.indexOf(e)||!1!==e.row.modules.dataTree.children&&e.row.reinitialize()},y.prototype.getChildField=function(){return this.field},y.prototype.redrawNeeded=function(e){return!!this.field&&void 0!==e[this.field]||!!this.elementField&&void 0!==e[this.elementField]},d.prototype.registerModule("dataTree",y);var w=function(e){this.table=e,this.fields={},this.columnsByIndex=[],this.columnsByField={},this.config={},this.active=!1};w.prototype.download=function(e,t,o,i,n){var r=this,a=!1;this.processConfig(),this.active=i,"function"==typeof e?a=e:r.downloaders[e]?a=r.downloaders[e]:console.warn("Download Error - No such download type found: ",e),this.processColumns(),a&&a.call(this,r.processDefinitions(),r.processData(i||"active"),o||{},(function(o,i){n?!0===n?r.triggerDownload(o,i,e,t,!0):n(o):r.triggerDownload(o,i,e,t)}),this.config)},w.prototype.processConfig=function(){var e={columnGroups:!0,rowGroups:!0,columnCalcs:!0,dataTree:!0};if(this.table.options.downloadConfig)for(var t in this.table.options.downloadConfig)e[t]=this.table.options.downloadConfig[t];this.config.rowGroups=e.rowGroups&&this.table.options.groupBy&&this.table.modExists("groupRows"),e.columnGroups&&this.table.columnManager.columns.length!=this.table.columnManager.columnsByIndex.length&&(this.config.columnGroups=!0),e.columnCalcs&&this.table.modExists("columnCalcs")&&(this.config.columnCalcs=!0),e.dataTree&&this.table.options.dataTree&&this.table.modExists("dataTree")&&(this.config.dataTree=!0)},w.prototype.processColumns=function(){var e=this;e.columnsByIndex=[],e.columnsByField={},e.table.columnManager.columnsByIndex.forEach((function(t){t.field&&!1!==t.definition.download&&(t.visible||!t.visible&&t.definition.download)&&(e.columnsByIndex.push(t),e.columnsByField[t.field]=t)}))},w.prototype.processDefinitions=function(){var e=this,t=[];return this.config.columnGroups?e.table.columnManager.columns.forEach((function(o){var i=e.processColumnGroup(o);i&&t.push(i)})):e.columnsByIndex.forEach((function(o){!1!==o.download&&t.push(e.processDefinition(o))})),t},w.prototype.processColumnGroup=function(e){var t=this,o=e.columns,i=0,n=this.processDefinition(e),r={type:"group",title:n.title,depth:1};if(o.length){if(r.subGroups=[],r.width=0,o.forEach((function(e){var o=t.processColumnGroup(e);o.depth>i&&(i=o.depth),o&&(r.width+=o.width,r.subGroups.push(o))})),r.depth+=i,!r.width)return!1}else{if(!e.field||!1===e.definition.download||!(e.visible||!e.visible&&e.definition.download))return!1;r.width=1,r.definition=n}return r},w.prototype.processDefinition=function(e){var t={};for(var o in e.definition)t[o]=e.definition[o];return void 0!==e.definition.downloadTitle&&(t.title=e.definition.downloadTitle),t},w.prototype.processData=function(e){var t=this,o=[],i=[],n=!1,r={};return this.config.rowGroups?("visible"==e?(n=this.table.rowManager.getRows(e)).forEach((function(e){if("row"==e.type){var t=e.getGroup();-1===i.indexOf(t)&&i.push(t)}})):i=this.table.modules.groupRows.getGroups(),i.forEach((function(e){o.push(t.processGroupData(e,n))}))):(this.config.dataTree&&(e=e="display"),o=this.table.rowManager.getData(e,"download")),this.config.columnCalcs&&(r=this.table.getCalcResults(),o={calcs:r,data:o}),"function"==typeof this.table.options.downloadDataFormatter&&(o=this.table.options.downloadDataFormatter(o)),o},w.prototype.processGroupData=function(e,t){var o=this,i=e.getSubGroups(),n={type:"group",key:e.key};return i.length?(n.subGroups=[],i.forEach((function(e){n.subGroups.push(o.processGroupData(e,t))}))):t?(n.rows=[],e.rows.forEach((function(e){t.indexOf(e)>-1&&n.rows.push(e.getData("download"))}))):n.rows=e.getData(!0,"download"),n},w.prototype.triggerDownload=function(e,t,o,i,n){var r=document.createElement("a"),a=new Blob([e],{type:t});i=i||"Tabulator."+("function"==typeof o?"txt":o),(a=this.table.options.downloadReady.call(this.table,e,a))&&(n?window.open(window.URL.createObjectURL(a)):navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(a,i):(r.setAttribute("href",window.URL.createObjectURL(a)),r.setAttribute("download",i),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)),this.table.options.downloadComplete&&this.table.options.downloadComplete())},w.prototype.getFieldValue=function(e,t){var o=this.columnsByField[e];return!!o&&o.getFieldValue(t)},w.prototype.commsReceived=function(e,t,o){switch(t){case"intercept":this.download(o.type,"",o.options,o.active,o.intercept)}},w.prototype.downloaders={csv:function(e,t,o,i,n){var r,a,l=this,c=[],u=[],d=o&&o.delimiter?o.delimiter:",";function h(e){e.forEach((function(e){var t=[];u.forEach((function(o){var i=l.getFieldValue(o,e);switch(void 0===i?"undefined":s(i)){case"object":i=JSON.stringify(i);break;case"undefined":case"null":i="";break;default:i=i}t.push('"'+String(i).split('"').join('""')+'"')})),r.push(t.join(d))}))}n.columnGroups?(console.warn("Download Warning - CSV downloader cannot process column groups"),e.forEach((function(e){!function e(t,o){t.subGroups?t.subGroups.forEach((function(t){e(t,o+1)})):(c.push('"'+String(t.title).split('"').join('""')+'"'),u.push(t.definition.field))}(e,0)}))):e.forEach((function(e){c.push('"'+String(e.title).split('"').join('""')+'"'),u.push(e.field)})),r=[c.join(d)],n.columnCalcs&&(console.warn("Download Warning - CSV downloader cannot process column calculations"),t=t.data),n.rowGroups?(console.warn("Download Warning - CSV downloader cannot process row groups"),t.forEach((function(e){!function e(t){t.subGroups?t.subGroups.forEach((function(t){e(t)})):h(t.rows)}(e)}))):h(t),a=r.join("\n"),o.bom&&(a="\ufeff"+a),i(a,"text/csv")},json:function(e,t,o,i,n){n.columnCalcs&&(console.warn("Download Warning - CSV downloader cannot process column calculations"),t=t.data),i(JSON.stringify(t,null,"\t"),"application/json")},pdf:function(e,t,o,i,n){var r=this,a=[],l=[],c=[],u={},d=1,h={},p=o.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},f=o.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},m=o.jsPDF||{},g=o&&o.title?o.title:"";if(n.columnCalcs&&(u=t.calcs,t=t.data),m.orientation||(m.orientation=o.orientation||"landscape"),m.unit||(m.unit="pt"),n.columnGroups){e.forEach((function(e){e.depth>d&&(d=e.depth)}));for(var v=0;v<d;v++)l.push([]);e.forEach((function(e){!function e(t,o){var i=t.width,n=1,r={content:t.title||""};if(t.subGroups?(t.subGroups.forEach((function(t){e(t,o+1)})),n=1):(a.push(t.definition.field),n=d-o),r.rowSpan=n,l[o].push(r),i--,n>1)for(var s=o+1;s<d;s++)l[s].push("");for(s=0;s<i;s++)l[o].push("")}(e,0)}))}else e.forEach((function(e){e.field&&(l.push(e.title||""),a.push(e.field))})),l=[l];function b(e){switch(void 0===e?"undefined":s(e)){case"object":e=JSON.stringify(e);break;case"undefined":case"null":e="";break;default:e=e}return e}function y(e){e.forEach((function(e){c.push(w(e))}))}function w(e,t){var o=[];return a.forEach((function(i){var n=r.getFieldValue(i,e);n=b(n),t?o.push({content:n,styles:t}):o.push(n)})),o}function x(e,t,o){var i=e[t];i&&(o&&(i=i[o]),Object.keys(i).length&&c.push(w(i,f)))}n.rowGroups?t.forEach((function(e){!function e(t,o){var i=[];i.push({content:b(t.key),colSpan:a.length,styles:p}),c.push(i),t.subGroups?t.subGroups.forEach((function(i){e(i,o[t.key]&&o[t.key].groups||{})})):(n.columnCalcs&&x(o,t.key,"top"),y(t.rows),n.columnCalcs&&x(o,t.key,"bottom"))}(e,u)})):(n.columnCalcs&&x(u,"top"),y(t),n.columnCalcs&&x(u,"bottom"));var C=new jsPDF(m);o&&o.autoTable&&(h="function"==typeof o.autoTable?o.autoTable(C)||{}:o.autoTable),g&&(h.addPageContent=function(e){C.text(g,40,30)}),h.head=l,h.body=c,C.autoTable(h),o&&o.documentProcessing&&o.documentProcessing(C),i(C.output("arraybuffer"),"application/pdf")},xlsx:function(e,t,o,i,n){var r=this,a=o.sheetName||"Sheet1",l=XLSX.utils.book_new(),c={},u=[],d=[],h=[];function p(){var o=[],i=[],a=[];function l(e,t){var n;void 0===o[t]&&(o[t]=[]),void 0===d[t]&&(d[t]=[]),e.width>1&&d[t].push({type:"hoz",start:o[t].length,end:o[t].length+e.width-1}),o[t].push(e.title),e.subGroups?e.subGroups.forEach((function(e){l(e,t+1)})):(i.push(e.definition.field),i.length,n=0,o.forEach((function(e){var t=e.length;t>n&&(n=t)})),o.forEach((function(e){var t=e.length;if(t<n)for(var o=t;o<n;o++)e.push("")})),d[t].push({type:"vert",start:i.length-1}))}function p(e){e.forEach((function(e){a.push(f(e))}))}function f(e){var t=[];return i.forEach((function(o){var i=r.getFieldValue(o,e);t.push(i instanceof Date||"object"!==(void 0===i?"undefined":s(i))?i:JSON.stringify(i))})),t}function m(e,t,o){var i=e[t];i&&(o&&(i=i[o]),Object.keys(i).length&&(h.push(a.length),a.push(f(i))))}return n.columnGroups?(e.forEach((function(e){l(e,0)})),o.forEach((function(e){a.push(e)}))):(e.forEach((function(e){o.push(e.title),i.push(e.field)})),a.push(o)),n.rowGroups?t.forEach((function(e){!function e(t,o){var i=[];i.push(t.key),u.push(a.length),a.push(i),t.subGroups?t.subGroups.forEach((function(i){e(i,o[t.key]&&o[t.key].groups||{})})):(n.columnCalcs&&m(o,t.key,"top"),p(t.rows),n.columnCalcs&&m(o,t.key,"bottom"))}(e,c)})):(n.columnCalcs&&m(c,"top"),p(t),n.columnCalcs&&m(c,"bottom")),function(){var e={},t={s:{c:0,r:0},e:{c:i.length,r:a.length}};XLSX.utils.sheet_add_aoa(e,a),e["!ref"]=XLSX.utils.encode_range(t);var n=function(){var e=[];return u.forEach((function(t){e.push({s:{r:t,c:0},e:{r:t,c:i.length-1}})})),d.forEach((function(t,i){t.forEach((function(t){"hoz"===t.type?e.push({s:{r:i,c:t.start},e:{r:i,c:t.end}}):i!=o.length-1&&e.push({s:{r:i,c:t.start},e:{r:o.length-1,c:t.start}})}))})),e}();return n.length&&(e["!merges"]=n),e}()}if(l.SheetNames=[],l.Sheets={},n.columnCalcs&&(c=t.calcs,t=t.data),o.sheetOnly)i(p());else{if(o.sheets)for(var f in o.sheets)!0===o.sheets[f]?(l.SheetNames.push(f),l.Sheets[f]=p()):(l.SheetNames.push(f),this.table.modules.comms.send(o.sheets[f],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:r.active,intercept:function(e){l.Sheets[f]=e}}));else l.SheetNames.push(a),l.Sheets[a]=p();o.documentProcessing&&(l=o.documentProcessing(l)),i(function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),i=0;i!=e.length;++i)o[i]=255&e.charCodeAt(i);return t}(XLSX.write(l,{bookType:"xlsx",bookSST:!0,type:"binary"})),"application/octet-stream")}},html:function(e,t,o,i,n){this.table.modExists("export",!0)&&i(this.table.modules.export.getHtml(!0,o.style,n),"text/html")}},d.prototype.registerModule("download",w);var x=function(e){this.table=e,this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1};x.prototype.initializeColumn=function(e){var t={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{}};switch(s(e.definition.editor)){case"string":"tick"===e.definition.editor&&(e.definition.editor="tickCross",console.warn("DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor")),this.editors[e.definition.editor]?t.editor=this.editors[e.definition.editor]:console.warn("Editor Error - No such editor found: ",e.definition.editor);break;case"function":t.editor=e.definition.editor;break;case"boolean":!0===e.definition.editor&&("function"!=typeof e.definition.formatter?("tick"===e.definition.formatter&&(e.definition.formatter="tickCross",console.warn("DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor")),this.editors[e.definition.formatter]?t.editor=this.editors[e.definition.formatter]:t.editor=this.editors.input):console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",e.definition.formatter))}t.editor&&(e.modules.edit=t)},x.prototype.getCurrentCell=function(){return!!this.currentCell&&this.currentCell.getComponent()},x.prototype.clearEditor=function(){var e,t=this.currentCell;if(this.invalidEdit=!1,t){for(this.currentCell=!1,(e=t.getElement()).classList.remove("tabulator-validation-fail"),e.classList.remove("tabulator-editing");e.firstChild;)e.removeChild(e.firstChild);t.row.getElement().classList.remove("tabulator-row-editing")}},x.prototype.cancelEdit=function(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(),e.setValueActual(e.getValue()),e.column.cellEvents.cellEditCancelled&&e.column.cellEvents.cellEditCancelled.call(this.table,t),this.table.options.cellEditCancelled.call(this.table,t)}},x.prototype.bindEditor=function(e){var t=this,o=e.getElement();o.setAttribute("tabindex",0),o.addEventListener("click",(function(e){o.classList.contains("tabulator-editing")||o.focus()})),o.addEventListener("mousedown",(function(e){t.mouseClick=!0})),o.addEventListener("focus",(function(o){t.recursionBlock||t.edit(e,o,!1)}))},x.prototype.focusCellNoEvent=function(e,t){this.recursionBlock=!0,t&&"ie"===this.table.browser||e.getElement().focus(),this.recursionBlock=!1},x.prototype.editCell=function(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)},x.prototype.edit=function(e,t,o){var i,n,r,a=this,l=!0,c=function(){},u=e.getElement();if(!this.currentCell){if(e.column.modules.edit.blocked)return this.mouseClick=!1,u.blur(),!1;switch(t&&t.stopPropagation(),s(e.column.modules.edit.check)){case"function":l=e.column.modules.edit.check(e.getComponent());break;case"boolean":l=e.column.modules.edit.check}if(l||o){if(a.cancelEdit(),a.currentCell=e,n=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.cellEvents.cellClick&&e.column.cellEvents.cellClick.call(this.table,t,n)),e.column.cellEvents.cellEditing&&e.column.cellEvents.cellEditing.call(this.table,n),a.table.options.cellEditing.call(this.table,n),r="function"==typeof e.column.modules.edit.params?e.column.modules.edit.params(n):e.column.modules.edit.params,!1===(i=e.column.modules.edit.editor.call(a,n,(function(e){c=e}),(function(t){if(a.currentCell===e){var o=!0;return e.column.modules.validate&&a.table.modExists("validate")&&(o=a.table.modules.validate.validate(e.column.modules.validate,e.getComponent(),t)),!0===o?(a.clearEditor(),e.setValue(t,!0),a.table.options.dataTree&&a.table.modExists("dataTree")&&a.table.modules.dataTree.checkForRestyle(e),!0):(a.invalidEdit=!0,u.classList.add("tabulator-validation-fail"),a.focusCellNoEvent(e,!0),c(),a.table.options.validationFailed.call(a.table,e.getComponent(),t,o),!1)}}),(function(){a.currentCell===e&&(a.cancelEdit(),a.table.options.dataTree&&a.table.modExists("dataTree")&&a.table.modules.dataTree.checkForRestyle(e))}),r)))return u.blur(),!1;if(!(i instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",i),u.blur(),!1;for(u.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-row-editing");u.firstChild;)u.removeChild(u.firstChild);u.appendChild(i),c();for(var d=u.children,h=0;h<d.length;h++)d[h].addEventListener("click",(function(e){e.stopPropagation()}));return!0}return this.mouseClick=!1,u.blur(),!1}this.invalidEdit||this.cancelEdit()},x.prototype.maskInput=function(e,t){var o=t.mask,i=void 0!==t.maskLetterChar?t.maskLetterChar:"A",n=void 0!==t.maskNumberChar?t.maskNumberChar:"9",r=void 0!==t.maskWildcardChar?t.maskWildcardChar:"*";function a(t){var s=o[t];void 0!==s&&s!==r&&s!==i&&s!==n&&(e.value=e.value+""+s,a(t+1))}e.addEventListener("keydown",(function(t){var a=e.value.length,s=t.key;if(t.keyCode>46){if(a>=o.length)return t.preventDefault(),t.stopPropagation(),!1;switch(o[a]){case i:if(s.toUpperCase()==s.toLowerCase())return t.preventDefault(),t.stopPropagation(),!1;break;case n:if(isNaN(s))return t.preventDefault(),t.stopPropagation(),!1;break;case r:break;default:if(s!==o[a])return t.preventDefault(),t.stopPropagation(),!1}}})),e.addEventListener("keyup",(function(o){o.keyCode>46&&t.maskAutoFill&&a(e.value.length)})),e.placeholder||(e.placeholder=o),t.maskAutoFill&&a(e.value.length)},x.prototype.editors={input:function(e,t,o,i,n){var r=e.getValue(),a=document.createElement("input");if(a.setAttribute("type",n.search?"search":"text"),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&"object"==s(n.elementAttributes))for(var l in n.elementAttributes)"+"==l.charAt(0)?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);function c(e){null==r&&""!==a.value||a.value!==r?o(a.value)&&(r=a.value):i()}return a.value=void 0!==r?r:"",t((function(){a.focus(),a.style.height="100%"})),a.addEventListener("change",c),a.addEventListener("blur",c),a.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:c();break;case 27:i()}})),n.mask&&this.table.modules.edit.maskInput(a,n),a},textarea:function(e,t,o,i,n){var r=e.getValue(),a=n.verticalNavigation||"hybrid",l=String(null!=r?r:""),c=((l.match(/(?:\r\n|\r|\n)/g)||[]).length,document.createElement("textarea")),u=0;if(c.style.display="block",c.style.padding="2px",c.style.height="100%",c.style.width="100%",c.style.boxSizing="border-box",c.style.whiteSpace="pre-wrap",c.style.resize="none",n.elementAttributes&&"object"==s(n.elementAttributes))for(var d in n.elementAttributes)"+"==d.charAt(0)?(d=d.slice(1),c.setAttribute(d,c.getAttribute(d)+n.elementAttributes["+"+d])):c.setAttribute(d,n.elementAttributes[d]);function h(t){null==r&&""!==c.value||c.value!==r?(o(c.value)&&(r=c.value),setTimeout((function(){e.getRow().normalizeHeight()}),300)):i()}return c.value=l,t((function(){c.focus(),c.style.height="100%"})),c.addEventListener("change",h),c.addEventListener("blur",h),c.addEventListener("keyup",(function(){c.style.height="";var t=c.scrollHeight;c.style.height=t+"px",t!=u&&(u=t,e.getRow().normalizeHeight())})),c.addEventListener("keydown",(function(e){switch(e.keyCode){case 27:i();break;case 38:("editor"==a||"hybrid"==a&&c.selectionStart)&&(e.stopImmediatePropagation(),e.stopPropagation());break;case 40:("editor"==a||"hybrid"==a&&c.selectionStart!==c.value.length)&&(e.stopImmediatePropagation(),e.stopPropagation())}})),n.mask&&this.table.modules.edit.maskInput(c,n),c},number:function(e,t,o,i,n){var r=e.getValue(),a=n.verticalNavigation||"editor",l=document.createElement("input");if(l.setAttribute("type","number"),void 0!==n.max&&l.setAttribute("max",n.max),void 0!==n.min&&l.setAttribute("min",n.min),void 0!==n.step&&l.setAttribute("step",n.step),l.style.padding="4px",l.style.width="100%",l.style.boxSizing="border-box",n.elementAttributes&&"object"==s(n.elementAttributes))for(var c in n.elementAttributes)"+"==c.charAt(0)?(c=c.slice(1),l.setAttribute(c,l.getAttribute(c)+n.elementAttributes["+"+c])):l.setAttribute(c,n.elementAttributes[c]);l.value=r;var u=function(e){d()};function d(){var e=l.value;isNaN(e)||""===e||(e=Number(e)),e!==r?o(e)&&(r=e):i()}return t((function(){l.removeEventListener("blur",u),l.focus(),l.style.height="100%",l.addEventListener("blur",u)})),l.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:d();break;case 27:i();break;case 38:case 40:"editor"==a&&(e.stopImmediatePropagation(),e.stopPropagation())}})),n.mask&&this.table.modules.edit.maskInput(l,n),l},range:function(e,t,o,i,n){var r=e.getValue(),a=document.createElement("input");if(a.setAttribute("type","range"),void 0!==n.max&&a.setAttribute("max",n.max),void 0!==n.min&&a.setAttribute("min",n.min),void 0!==n.step&&a.setAttribute("step",n.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",n.elementAttributes&&"object"==s(n.elementAttributes))for(var l in n.elementAttributes)"+"==l.charAt(0)?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+n.elementAttributes["+"+l])):a.setAttribute(l,n.elementAttributes[l]);function c(){var e=a.value;isNaN(e)||""===e||(e=Number(e)),e!=r?o(e)&&(r=e):i()}return a.value=r,t((function(){a.focus(),a.style.height="100%"})),a.addEventListener("blur",(function(e){c()})),a.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:case 9:c();break;case 27:i()}})),a},select:function(e,t,o,i,n){var r=this,a=e.getElement(),l=e.getValue(),c=n.verticalNavigation||"editor",u=void 0!==l||null===l?l:void 0!==n.defaultValue?n.defaultValue:"",h=document.createElement("input"),p=document.createElement("div"),f=[],m=[],g={},v=!0;function b(t){var o,i={},a=r.table.getData();return(o=t?r.table.columnManager.getColumnByField(t):e.getColumn()._getSelf())?(a.forEach((function(e){var t=o.getFieldValue(e);null!=t&&""!==t&&(i[t]=!0)})),i=n.sortValuesList?"asc"==n.sortValuesList?Object.keys(i).sort():Object.keys(i).sort().reverse():Object.keys(i)):console.warn("unable to find matching column to create select lookup list:",t),i}function y(t,o){var i=[],r=[];function a(e){return(e={label:n.listItemFormatter?n.listItemFormatter(e.value,e.label):e.label,value:e.value,element:!1}).value!==o&&(isNaN(parseFloat(e.value))||isNaN(parseFloat(e.value))||parseFloat(e.value)!==parseFloat(o))||w(e),i.push(e),r.push(e),e}if("function"==typeof t&&(t=t(e)),Array.isArray(t))t.forEach((function(e){var t;"object"===(void 0===e?"undefined":s(e))?e.options?(t={label:e.label,group:!0,element:!1},r.push(t),e.options.forEach((function(e){a(e)}))):a(e):((t={label:n.listItemFormatter?n.listItemFormatter(e,e):e,value:e,element:!1}).value!==o&&(isNaN(parseFloat(t.value))||isNaN(parseFloat(t.value))||parseFloat(t.value)!==parseFloat(o))||w(t),i.push(t),r.push(t))}));else for(var l in t){var c={label:n.listItemFormatter?n.listItemFormatter(l,t[l]):t[l],value:l,element:!1};c.value!==o&&(isNaN(parseFloat(c.value))||isNaN(parseFloat(c.value))||parseFloat(c.value)!==parseFloat(o))||w(c),i.push(c),r.push(c)}f=i,m=r,function(){for(;p.firstChild;)p.removeChild(p.firstChild);m.forEach((function(e){var t=e.element;t||(e.group?((t=document.createElement("div")).classList.add("tabulator-edit-select-list-group"),t.tabIndex=0,t.innerHTML=""===e.label?"&nbsp;":e.label):((t=document.createElement("div")).classList.add("tabulator-edit-select-list-item"),t.tabIndex=0,t.innerHTML=""===e.label?"&nbsp;":e.label,t.addEventListener("click",(function(){w(e),x()})),e===g&&t.classList.add("active")),t.addEventListener("mousedown",(function(){v=!1,setTimeout((function(){v=!0}),10)})),e.element=t),p.appendChild(t)}))}()}function w(e){g&&g.element&&g.element.classList.remove("active"),g=e,h.value="&nbsp;"===e.label?"":e.label,e.element&&e.element.classList.add("active")}function x(){E(),l!==g.value?(l=g.value,o(g.value)):i()}function C(){E(),i()}function E(){p.parentNode&&p.parentNode.removeChild(p),r.table.rowManager.element.removeEventListener("scroll",C)}if(this.table.rowManager.element.addEventListener("scroll",C),(Array.isArray(n)||!Array.isArray(n)&&"object"===(void 0===n?"undefined":s(n))&&!n.values)&&(console.warn("DEPRECATION WANRING - values for the select editor must now be passed into the values property of the editorParams object, not as the editorParams object"),n={values:n}),h.setAttribute("type","text"),h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",h.style.cursor="default",h.readOnly=0!=this.currentCell,n.elementAttributes&&"object"==s(n.elementAttributes))for(var k in n.elementAttributes)"+"==k.charAt(0)?(k=k.slice(1),h.setAttribute(k,h.getAttribute(k)+n.elementAttributes["+"+k])):h.setAttribute(k,n.elementAttributes[k]);return h.value=void 0!==l||null===l?l:"",h.addEventListener("keydown",(function(e){var t;switch(e.keyCode){case 38:t=f.indexOf(g),("editor"==c||"hybrid"==c&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&w(f[t-1]));break;case 40:t=f.indexOf(g),("editor"==c||"hybrid"==c&&t<f.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<f.length-1&&w(-1==t?f[0]:f[t+1]));break;case 37:case 39:e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault();break;case 13:x();break;case 27:C()}})),h.addEventListener("blur",(function(e){v&&C()})),h.addEventListener("focus",(function(e){!function(){if(!p.parentNode){!0===n.values?y(b(),u):"string"==typeof n.values?y(b(n.values),u):y(n.values||[],u);var e=d.prototype.helpers.elOffset(a);p.style.minWidth=a.offsetWidth+"px",p.style.top=e.top+a.offsetHeight+"px",p.style.left=e.left+"px",document.body.appendChild(p)}}()})),(p=document.createElement("div")).classList.add("tabulator-edit-select-list"),t((function(){h.style.height="100%",h.focus()})),h},autocomplete:function(e,t,o,i,n){var r=this,a=e.getElement(),l=e.getValue(),c=n.verticalNavigation||"editor",u=void 0!==l||null===l?l:void 0!==n.defaultValue?n.defaultValue:"",h=document.createElement("input"),p=document.createElement("div"),f=[],m=!1,g=!0;if(this.table.rowManager.element.addEventListener("scroll",D),h.setAttribute("type","search"),h.style.padding="4px",h.style.width="100%",h.style.boxSizing="border-box",n.elementAttributes&&"object"==s(n.elementAttributes))for(var v in n.elementAttributes)"+"==v.charAt(0)?(v=v.slice(1),h.setAttribute(v,h.getAttribute(v)+n.elementAttributes["+"+v])):h.setAttribute(v,n.elementAttributes[v]);function b(t){var o,i={},a=r.table.getData();return(o=t?r.table.columnManager.getColumnByField(t):e.getColumn()._getSelf())?(a.forEach((function(e){var t=o.getFieldValue(e);null!=t&&""!==t&&(i[t]=!0)})),i=n.sortValuesList?"asc"==n.sortValuesList?Object.keys(i).sort():Object.keys(i).sort().reverse():Object.keys(i)):console.warn("unable to find matching column to create autocomplete lookup list:",t),i}function y(e,t){var o,i,r=[];o=!0===n.values?b():"string"==typeof n.values?b(n.values):n.values||[],n.searchFunc?(r=n.searchFunc(e,o))instanceof Promise?(w(void 0!==n.searchingPlaceholder?n.searchingPlaceholder:"Searching..."),r.then((function(e){E(x(e),t)})).catch((function(e){console.err("error in autocomplete search promise:",e)}))):E(x(r),t):(i=x(o),""===e?n.showListOnEmpty&&(r=i):i.forEach((function(t){null===t.value&&void 0===t.value||(String(t.value).toLowerCase().indexOf(String(e).toLowerCase())>-1||String(t.title).toLowerCase().indexOf(String(e).toLowerCase())>-1)&&r.push(t)})),E(r,t))}function w(e){var t=document.createElement("div");C(),!1!==e&&(t.classList.add("tabulator-edit-select-list-notice"),t.tabIndex=0,e instanceof Node?t.appendChild(e):t.innerHTML=e,p.appendChild(t))}function x(e){var t=[];if(Array.isArray(e))e.forEach((function(e){var o={title:n.listItemFormatter?n.listItemFormatter(e,e):e,value:e};t.push(o)}));else for(var o in e){var i={title:n.listItemFormatter?n.listItemFormatter(o,e[o]):e[o],value:o};t.push(i)}return t}function C(){for(;p.firstChild;)p.removeChild(p.firstChild)}function E(e,t){e.length?function(e,t){var o=!1;C(),(f=e).forEach((function(e){var i=e.element;i||((i=document.createElement("div")).classList.add("tabulator-edit-select-list-item"),i.tabIndex=0,i.innerHTML=e.title,i.addEventListener("click",(function(){M(e),k()})),i.addEventListener("mousedown",(function(){g=!1,setTimeout((function(){g=!0}),10)})),e.element=i,t&&e.value==l&&(h.value=e.title,e.element.classList.add("active"),o=!0),e===m&&(e.element.classList.add("active"),o=!0)),p.appendChild(i)})),o||M(!1)}(e,t):n.emptyPlaceholder&&w(n.emptyPlaceholder)}function k(){_(),m?l!==m.value?(l=m.value,h.value=m.title,o(m.value)):i():n.freetext||n.allowEmpty&&""===h.value?(l=h.value,o(h.value)):i()}function M(e,t){m&&m.element&&m.element.classList.remove("active"),m=e,e&&e.element&&e.element.classList.add("active")}function _(){p.parentNode&&p.parentNode.removeChild(p),r.table.rowManager.element.removeEventListener("scroll",D)}function D(){_(),i()}return p.classList.add("tabulator-edit-select-list"),h.addEventListener("keydown",(function(e){var t;switch(e.keyCode){case 38:t=f.indexOf(m),("editor"==c||"hybrid"==c&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),M(t>0&&f[t-1]));break;case 40:t=f.indexOf(m),("editor"==c||"hybrid"==c&&t<f.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<f.length-1&&M(-1==t?f[0]:f[t+1]));break;case 37:case 39:e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault();break;case 13:k();break;case 27:D();break;case 36:case 35:e.stopImmediatePropagation()}})),h.addEventListener("keyup",(function(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:y(h.value)}})),h.addEventListener("search",(function(e){y(h.value)})),h.addEventListener("blur",(function(e){g&&k()})),h.addEventListener("focus",(function(e){var t=u;!function(){if(!p.parentNode){for(;p.firstChild;)p.removeChild(p.firstChild);var e=d.prototype.helpers.elOffset(a);p.style.minWidth=a.offsetWidth+"px",p.style.top=e.top+a.offsetHeight+"px",p.style.left=e.left+"px",document.body.appendChild(p)}}(),h.value=t,y(t,!0)})),t((function(){h.style.height="100%",h.focus()})),n.mask&&this.table.modules.edit.maskInput(h,n),h},star:function(e,t,o,i,n){var r=this,a=e.getElement(),l=e.getValue(),c=a.getElementsByTagName("svg").length||5,u=a.getElementsByTagName("svg")[0]?a.getElementsByTagName("svg")[0].getAttribute("width"):14,d=[],h=document.createElement("div"),p=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(e){d.forEach((function(t,o){o<e?("ie"==r.table.browser?t.setAttribute("class","tabulator-star-active"):t.classList.replace("tabulator-star-inactive","tabulator-star-active"),t.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==r.table.browser?t.setAttribute("class","tabulator-star-inactive"):t.classList.replace("tabulator-star-active","tabulator-star-inactive"),t.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')}))}function m(e){var t=document.createElement("span"),i=p.cloneNode(!0);d.push(i),t.addEventListener("mouseenter",(function(t){t.stopPropagation(),t.stopImmediatePropagation(),f(e)})),t.addEventListener("mousemove",(function(e){e.stopPropagation(),e.stopImmediatePropagation()})),t.addEventListener("click",(function(t){t.stopPropagation(),t.stopImmediatePropagation(),o(e)})),t.appendChild(i),h.appendChild(t)}function g(e){l=e,f(e)}if(a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",h.style.verticalAlign="middle",h.style.display="inline-block",h.style.padding="4px",p.setAttribute("width",u),p.setAttribute("height",u),p.setAttribute("viewBox","0 0 512 512"),p.setAttribute("xml:space","preserve"),p.style.padding="0 1px",n.elementAttributes&&"object"==s(n.elementAttributes))for(var v in n.elementAttributes)"+"==v.charAt(0)?(v=v.slice(1),h.setAttribute(v,h.getAttribute(v)+n.elementAttributes["+"+v])):h.setAttribute(v,n.elementAttributes[v]);for(var b=1;b<=c;b++)m(b);return f(l=Math.min(parseInt(l),c)),h.addEventListener("mousemove",(function(e){f(0)})),h.addEventListener("click",(function(e){o(0)})),a.addEventListener("blur",(function(e){i()})),a.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:g(l+1);break;case 37:g(l-1);break;case 13:o(l);break;case 27:i()}})),h},progress:function(e,t,o,i,n){var r,a,l=e.getElement(),c=void 0===n.max?l.getElementsByTagName("div")[0].getAttribute("max")||100:n.max,u=void 0===n.min?l.getElementsByTagName("div")[0].getAttribute("min")||0:n.min,d=(c-u)/100,h=e.getValue()||0,p=document.createElement("div"),f=document.createElement("div");function m(){var e=d*Math.round(f.offsetWidth/(l.clientWidth/100))+u;o(e),l.setAttribute("aria-valuenow",e),l.setAttribute("aria-label",h)}if(p.style.position="absolute",p.style.right="0",p.style.top="0",p.style.bottom="0",p.style.width="5px",p.classList.add("tabulator-progress-handle"),f.style.display="inline-block",f.style.position="relative",f.style.height="100%",f.style.backgroundColor="#488CE9",f.style.maxWidth="100%",f.style.minWidth="0%",n.elementAttributes&&"object"==s(n.elementAttributes))for(var g in n.elementAttributes)"+"==g.charAt(0)?(g=g.slice(1),f.setAttribute(g,f.getAttribute(g)+n.elementAttributes["+"+g])):f.setAttribute(g,n.elementAttributes[g]);return l.style.padding="4px 4px",h=Math.min(parseFloat(h),c),h=Math.max(parseFloat(h),u),h=Math.round((h-u)/d),f.style.width=h+"%",l.setAttribute("aria-valuemin",u),l.setAttribute("aria-valuemax",c),f.appendChild(p),p.addEventListener("mousedown",(function(e){r=e.screenX,a=f.offsetWidth})),p.addEventListener("mouseover",(function(){p.style.cursor="ew-resize"})),l.addEventListener("mousemove",(function(e){r&&(f.style.width=a+e.screenX-r+"px")})),l.addEventListener("mouseup",(function(e){r&&(e.stopPropagation(),e.stopImmediatePropagation(),r=!1,a=!1,m())})),l.addEventListener("keydown",(function(e){switch(e.keyCode){case 39:f.style.width=f.clientWidth+l.clientWidth/100+"px";break;case 37:f.style.width=f.clientWidth-l.clientWidth/100+"px";break;case 13:m();break;case 27:i()}})),l.addEventListener("blur",(function(){i()})),f},tickCross:function(e,t,o,i,n){var r=e.getValue(),a=document.createElement("input"),l=n.tristate,c=void 0===n.indeterminateValue?null:n.indeterminateValue,u=!1;if(a.setAttribute("type","checkbox"),a.style.marginTop="5px",a.style.boxSizing="border-box",n.elementAttributes&&"object"==s(n.elementAttributes))for(var d in n.elementAttributes)"+"==d.charAt(0)?(d=d.slice(1),a.setAttribute(d,a.getAttribute(d)+n.elementAttributes["+"+d])):a.setAttribute(d,n.elementAttributes[d]);function h(e){return l?e?u?c:a.checked:a.checked&&!u?(a.checked=!1,a.indeterminate=!0,u=!0,c):(u=!1,a.checked):a.checked}return a.value=r,!l||void 0!==r&&r!==c&&""!==r||(u=!0,a.indeterminate=!0),"firefox"!=this.table.browser&&t((function(){a.focus()})),a.checked=!0===r||"true"===r||"True"===r||1===r,a.addEventListener("change",(function(e){o(h())})),a.addEventListener("blur",(function(e){o(h(!0))})),a.addEventListener("keydown",(function(e){13==e.keyCode&&o(h()),27==e.keyCode&&i()})),a}},d.prototype.registerModule("edit",x);var C=function(e){this.table=e,this.config={},this.cloneTableStyle=!0,this.colVisProp=""};C.prototype.genereateTable=function(e,t,o,i){this.cloneTableStyle=t,this.config=e||{},this.colVisProp=i;var n=document.createElement("table");return n.classList.add("tabulator-print-table"),!1!==this.config.columnHeaders&&n.appendChild(this.generateHeaderElements()),n.appendChild(this.generateBodyElements(this.rowLookup(o))),this.mapElementStyles(this.table.element,n,["border-top","border-left","border-right","border-bottom"]),n},C.prototype.rowLookup=function(e){var t=this,o=[];if("function"==typeof e)e.call(this.table).forEach((function(e){(e=t.table.rowManager.findRow(e))&&o.push(e)}));else switch(e){case!0:case"visible":o=this.table.rowManager.getVisibleRows(!0);break;case"all":o=this.table.rowManager.rows;break;case"selected":o=this.modules.selectRow.selectedRows;break;case"active":default:o=this.table.rowManager.getDisplayRows()}return Object.assign([],o)},C.prototype.generateColumnGroupHeaders=function(){var e=this,t=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach((function(o){var i=e.processColumnGroup(o);i&&t.push(i)})),t},C.prototype.processColumnGroup=function(e){var t=this,o=e.columns,i=0,n={title:e.definition.title,column:e,depth:1};if(o.length){if(n.subGroups=[],n.width=0,o.forEach((function(e){var o=t.processColumnGroup(e);o&&(n.width+=o.width,n.subGroups.push(o),o.depth>i&&(i=o.depth))})),n.depth+=i,!n.width)return!1}else{if(!this.columnVisCheck(e))return!1;n.width=1}return n},C.prototype.groupHeadersToRows=function(e){var t=[],o=0;return e.forEach((function(e){e.depth>o&&(o=e.depth)})),e.forEach((function(e){!function e(i,n){var r=o-n;void 0===t[n]&&(t[n]=[]),i.height=i.subGroups?1:r-i.depth+1,t[n].push(i),i.subGroups&&i.subGroups.forEach((function(t){e(t,n+1)}))}(e,0)})),t},C.prototype.generateHeaderElements=function(){var e=this,t=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach((function(o){var i=document.createElement("tr");e.mapElementStyles(e.table.columnManager.getHeadersElement(),t,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),o.forEach((function(t){var o=document.createElement("th"),n=t.column.definition.cssClass?t.column.definition.cssClass.split(" "):[];o.colSpan=t.width,o.rowSpan=t.height,o.innerHTML=t.column.definition.title,e.cloneTableStyle&&(o.style.boxSizing="border-box"),n.forEach((function(e){o.classList.add(e)})),e.mapElementStyles(t.column.getElement(),o,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.mapElementStyles(t.column.contentElement,o,["padding-top","padding-left","padding-right","padding-bottom"]),t.column.visible?e.mapElementStyles(t.column.getElement(),o,["width"]):t.column.definition.width&&(o.style.width=t.column.definition.width+"px"),t.column.parent&&e.mapElementStyles(t.column.parent.groupElement,o,["border-top"]),i.appendChild(o)})),t.appendChild(i)})),t},C.prototype.generateBodyElements=function(e){},C.prototype.generateBodyElements=function(e){var t,o,i,n,r,a,l,c,u,d,h=this;d=null!==(d=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))])?d:this.table.options.rowFormatter,this.cloneTableStyle&&window.getComputedStyle&&(t=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),o=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),i=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),n=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),a=this.table.element.getElementsByClassName("tabulator-group")[0],n&&(l=n.getElementsByClassName("tabulator-cell"),r=l[0],l[l.length-1]));var p=document.createElement("tbody"),f=[];return!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),this.table.columnManager.columnsByIndex.forEach((function(e){h.columnVisCheck(e)&&f.push(e)})),this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(u=this.table.modules.dataTree.elementField),(e=e.filter((function(e){switch(e.type){case"group":return!1!==h.config.rowGroups;case"calc":return!1!==h.config.columnCalcs}return!0}))).length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach((function(e,n){var l=e.getData(h.colVisProp),m=document.createElement("tr");switch(m.classList.add("tabulator-print-table-row"),e.type){case"group":var g=document.createElement("td");g.colSpan=f.length,g.innerHTML=e.key,m.classList.add("tabulator-print-table-group"),h.mapElementStyles(a,m,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),h.mapElementStyles(a,g,["padding-top","padding-left","padding-right","padding-bottom"]),m.appendChild(g);break;case"calc":m.classList.add("tabulator-print-table-calcs");case"row":if(h.table.options.dataTree&&!1===h.config.dataTree&&e.modules.dataTree.parent)return;if(f.forEach((function(t,o){var i=document.createElement("td"),n=t.getFieldValue(l),a={modules:{},getValue:function(){return n},getField:function(){return t.definition.field},getElement:function(){return i},getColumn:function(){return t.getComponent()},getData:function(){return l},getRow:function(){return e.getComponent()},getComponent:function(){return a},column:t};if((t.definition.cssClass?t.definition.cssClass.split(" "):[]).forEach((function(e){i.classList.add(e)})),h.table.modExists("format")&&!1!==h.config.formatCells)n=h.table.modules.format.formatExportValue(a,h.colVisProp);else switch(void 0===n?"undefined":s(n)){case"object":n=JSON.stringify(n);break;case"undefined":case"null":n="";break;default:n=n}n instanceof Node?i.appendChild(n):i.innerHTML=n,r&&(h.mapElementStyles(r,i,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size"]),t.definition.align&&(i.style.textAlign=t.definition.align)),h.table.options.dataTree&&!1!==h.config.dataTree&&(u&&u==t.field||!u&&0==o)&&(e.modules.dataTree.controlEl&&i.insertBefore(e.modules.dataTree.controlEl.cloneNode(!0),i.firstChild),e.modules.dataTree.branchEl&&i.insertBefore(e.modules.dataTree.branchEl.cloneNode(!0),i.firstChild)),m.appendChild(i),a.modules.format&&a.modules.format.renderedCallback&&a.modules.format.renderedCallback()})),c="calc"==e.type?i:n%2&&o?o:t,h.mapElementStyles(c,m,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),d&&!1!==h.config.formatCells){var v=e.getComponent();v.getElement=function(){return m},d(v)}}p.appendChild(m)})),p},C.prototype.columnVisCheck=function(e){return!1!==e.definition[this.colVisProp]&&(e.visible||!e.visible&&e.definition[this.colVisProp])},C.prototype.getHtml=function(e,t,o,i){var n=document.createElement("div");return n.appendChild(this.genereateTable(o||this.table.options.htmlOutputConfig,t,e,i||"htmlOutput")),n.innerHTML},C.prototype.mapElementStyles=function(e,t,o){if(this.cloneTableStyle&&e&&t){var i={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var n=window.getComputedStyle(e);o.forEach((function(e){t.style[i[e]]=n.getPropertyValue(e)}))}}},d.prototype.registerModule("export",C);var E=function(e){this.table=e,this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1};E.prototype.initializeColumn=function(e,t){var o=this,i=e.getField();e.modules.filter={success:function(t){var n,r="input"==e.modules.filter.tagType&&"text"==e.modules.filter.attrType||"textarea"==e.modules.filter.tagType?"partial":"match",a="",l="";if(void 0===e.modules.filter.prevSuccess||e.modules.filter.prevSuccess!==t){if(e.modules.filter.prevSuccess=t,e.modules.filter.emptyFunc(t))delete o.headerFilters[i];else{switch(e.modules.filter.value=t,s(e.definition.headerFilterFunc)){case"string":o.filters[e.definition.headerFilterFunc]?(a=e.definition.headerFilterFunc,n=function(i){var n=e.definition.headerFilterFuncParams||{},r=e.getFieldValue(i);return n="function"==typeof n?n(t,r,i):n,o.filters[e.definition.headerFilterFunc](t,r,i,n)}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":a=n=function(o){var i=e.definition.headerFilterFuncParams||{},n=e.getFieldValue(o);return i="function"==typeof i?i(t,n,o):i,e.definition.headerFilterFunc(t,n,o,i)}}if(!n)switch(r){case"partial":n=function(o){var i=e.getFieldValue(o);return null!=i&&String(i).toLowerCase().indexOf(String(t).toLowerCase())>-1},a="like";break;default:n=function(o){return e.getFieldValue(o)==t},a="="}o.headerFilters[i]={value:t,func:n,type:a}}l=JSON.stringify(o.headerFilters),o.prevHeaderFilterChangeCheck!==l&&(o.prevHeaderFilterChangeCheck=l,o.changed=!0,o.table.rowManager.filterRefresh())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(e)},E.prototype.generateHeaderFilterElement=function(e,t,o){var i,n,r,a,l,c,u,d=this,h=this,p=e.modules.filter.success,f=e.getField();if(e.modules.filter.headerElement&&e.modules.filter.headerElement.parentNode&&e.contentElement.removeChild(e.modules.filter.headerElement.parentNode),f){switch(e.modules.filter.emptyFunc=e.definition.headerFilterEmptyCheck||function(e){return!e&&"0"!==e},(i=document.createElement("div")).classList.add("tabulator-header-filter"),s(e.definition.headerFilter)){case"string":h.table.modules.edit.editors[e.definition.headerFilter]?(n=h.table.modules.edit.editors[e.definition.headerFilter],"tick"!==e.definition.headerFilter&&"tickCross"!==e.definition.headerFilter||e.definition.headerFilterEmptyCheck||(e.modules.filter.emptyFunc=function(e){return!0!==e&&!1!==e})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":n=e.definition.headerFilter;break;case"boolean":e.modules.edit&&e.modules.edit.editor?n=e.modules.edit.editor:e.definition.formatter&&h.table.modules.edit.editors[e.definition.formatter]?(n=h.table.modules.edit.editors[e.definition.formatter],"tick"!==e.definition.formatter&&"tickCross"!==e.definition.formatter||e.definition.headerFilterEmptyCheck||(e.modules.filter.emptyFunc=function(e){return!0!==e&&!1!==e})):n=h.table.modules.edit.editors.input}if(n){if(a={getValue:function(){return void 0!==t?t:""},getField:function(){return e.definition.field},getElement:function(){return i},getColumn:function(){return e.getComponent()},getRow:function(){return{normalizeHeight:function(){}}}},u="function"==typeof(u=e.definition.headerFilterParams||{})?u.call(h.table):u,!(r=n.call(this.table.modules.edit,a,(function(){}),p,(function(){}),u)))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor returned a value of false");if(!(r instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor should return an instance of Node, the editor returned:",r);f?h.table.modules.localize.bind("headerFilters|columns|"+e.definition.field,(function(e){r.setAttribute("placeholder",void 0!==e&&e?e:h.table.modules.localize.getText("headerFilters|default"))})):h.table.modules.localize.bind("headerFilters|default",(function(e){r.setAttribute("placeholder",void 0!==h.column.definition.headerFilterPlaceholder&&h.column.definition.headerFilterPlaceholder?h.column.definition.headerFilterPlaceholder:e)})),r.addEventListener("click",(function(e){e.stopPropagation(),r.focus()})),r.addEventListener("focus",(function(e){var t=d.table.columnManager.element.scrollLeft;t!==d.table.rowManager.element.scrollLeft&&(d.table.rowManager.scrollHorizontal(t),d.table.columnManager.scrollHorizontal(t))})),l=!1,c=function(e){l&&clearTimeout(l),l=setTimeout((function(){p(r.value)}),h.table.options.headerFilterLiveFilterDelay)},e.modules.filter.headerElement=r,e.modules.filter.attrType=r.hasAttribute("type")?r.getAttribute("type").toLowerCase():"",e.modules.filter.tagType=r.tagName.toLowerCase(),!1!==e.definition.headerFilterLiveFilter&&("autocomplete"!==e.definition.headerFilter&&"tickCross"!==e.definition.headerFilter&&("autocomplete"!==e.definition.editor&&"tickCross"!==e.definition.editor||!0!==e.definition.headerFilter)&&(r.addEventListener("keyup",c),r.addEventListener("search",c),"number"==e.modules.filter.attrType&&r.addEventListener("change",(function(e){p(r.value)})),"text"==e.modules.filter.attrType&&"ie"!==this.table.browser&&r.setAttribute("type","search")),"input"!=e.modules.filter.tagType&&"select"!=e.modules.filter.tagType&&"textarea"!=e.modules.filter.tagType||r.addEventListener("mousedown",(function(e){e.stopPropagation()}))),i.appendChild(r),e.contentElement.appendChild(i),o||h.headerFilterColumns.push(e)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)},E.prototype.hideHeaderFilterElements=function(){this.headerFilterColumns.forEach((function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")}))},E.prototype.showHeaderFilterElements=function(){this.headerFilterColumns.forEach((function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")}))},E.prototype.setHeaderFilterFocus=function(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())},E.prototype.getHeaderFilterValue=function(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.headerElement.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())},E.prototype.setHeaderFilterValue=function(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))},E.prototype.reloadHeaderFilter=function(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))},E.prototype.hasChanged=function(){var e=this.changed;return this.changed=!1,e},E.prototype.setFilter=function(e,t,o){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:o}]),this.addFilter(e)},E.prototype.addFilter=function(e,t,o){var i=this;Array.isArray(e)||(e=[{field:e,type:t,value:o}]),e.forEach((function(e){(e=i.findFilter(e))&&(i.filterList.push(e),i.changed=!0)})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},E.prototype.findFilter=function(e){var t,o=this;if(Array.isArray(e))return this.findSubFilters(e);var i=!1;return"function"==typeof e.field?i=function(t){return e.field(t,e.type||{})}:o.filters[e.type]?i=(t=o.table.columnManager.getColumnByField(e.field))?function(i){return o.filters[e.type](e.value,t.getFieldValue(i))}:function(t){return o.filters[e.type](e.value,t[e.field])}:console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=i,!!e.func&&e},E.prototype.findSubFilters=function(e){var t=this,o=[];return e.forEach((function(e){(e=t.findFilter(e))&&o.push(e)})),!!o.length&&o},E.prototype.getFilters=function(e,t){var o=[];return e&&(o=this.getHeaderFilters()),t&&o.forEach((function(e){"function"==typeof e.type&&(e.type="function")})),o=o.concat(this.filtersToArray(this.filterList,t))},E.prototype.filtersToArray=function(e,t){var o=this,i=[];return e.forEach((function(e){var n;Array.isArray(e)?i.push(o.filtersToArray(e,t)):(n={field:e.field,type:e.type,value:e.value},t&&"function"==typeof n.type&&(n.type="function"),i.push(n))})),i},E.prototype.getHeaderFilters=function(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e},E.prototype.removeFilter=function(e,t,o){var i=this;Array.isArray(e)||(e=[{field:e,type:t,value:o}]),e.forEach((function(e){var t=-1;(t="object"==s(e.field)?i.filterList.findIndex((function(t){return e===t})):i.filterList.findIndex((function(t){return e.field===t.field&&e.type===t.type&&e.value===t.value})))>-1?(i.filterList.splice(t,1),i.changed=!0):console.warn("Filter Error - No matching filter type found, ignoring: ",e.type)})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},E.prototype.clearFilter=function(e){this.filterList=[],e&&this.clearHeaderFilter(),this.changed=!0,this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},E.prototype.clearHeaderFilter=function(){var e=this;this.headerFilters={},e.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach((function(t){t.modules.filter.value=null,t.modules.filter.prevSuccess=void 0,e.reloadHeaderFilter(t)})),this.changed=!0},E.prototype.search=function(e,t,o,i){var n=this,r=[],a=[];return Array.isArray(t)||(t=[{field:t,type:o,value:i}]),t.forEach((function(e){(e=n.findFilter(e))&&a.push(e)})),this.table.rowManager.rows.forEach((function(t){var o=!0;a.forEach((function(e){n.filterRecurse(e,t.getData())||(o=!1)})),o&&r.push("data"===e?t.getData("data"):t.getComponent())})),r},E.prototype.filter=function(e,t){var o=this,i=[],n=[];return o.table.options.dataFiltering&&o.table.options.dataFiltering.call(o.table,o.getFilters()),o.table.options.ajaxFiltering||!o.filterList.length&&!Object.keys(o.headerFilters).length?i=e.slice(0):e.forEach((function(e){o.filterRow(e)&&i.push(e)})),o.table.options.dataFiltered&&(i.forEach((function(e){n.push(e.getComponent())})),o.table.options.dataFiltered.call(o.table,o.getFilters(),n)),i},E.prototype.filterRow=function(e,t){var o=this,i=!0,n=e.getData();for(var r in o.filterList.forEach((function(e){o.filterRecurse(e,n)||(i=!1)})),o.headerFilters)o.headerFilters[r].func(n)||(i=!1);return i},E.prototype.filterRecurse=function(e,t){var o=this,i=!1;return Array.isArray(e)?e.forEach((function(e){o.filterRecurse(e,t)&&(i=!0)})):i=e.func(t),i},E.prototype.filters={"=":function(e,t,o,i){return t==e},"<":function(e,t,o,i){return t<e},"<=":function(e,t,o,i){return t<=e},">":function(e,t,o,i){return t>e},">=":function(e,t,o,i){return t>=e},"!=":function(e,t,o,i){return t!=e},regex:function(e,t,o,i){return"string"==typeof e&&(e=new RegExp(e)),e.test(t)},like:function(e,t,o,i){return null==e?t===e:null!=t&&String(t).toLowerCase().indexOf(e.toLowerCase())>-1},in:function(e,t,o,i){return Array.isArray(e)?e.indexOf(t)>-1:(console.warn("Filter Error - filter value is not an array:",e),!1)}},d.prototype.registerModule("filter",E);var k=function(e){this.table=e};k.prototype.initializeColumn=function(e){e.modules.format=this.lookupFormatter(e,""),void 0!==e.definition.formatterPrint&&(e.modules.format.print=this.lookupFormatter(e,"Print")),void 0!==e.definition.formatterClipboard&&(e.modules.format.clipboard=this.lookupFormatter(e,"Clipboard")),void 0!==e.definition.formatterHtmlOutput&&(e.modules.format.htmlOutput=this.lookupFormatter(e,"HtmlOutput"))},k.prototype.lookupFormatter=function(e,t){var o={params:e.definition["formatter"+t+"Params"]||{}},i=e.definition["formatter"+t];switch(void 0===i?"undefined":s(i)){case"string":"tick"===i&&(i="tickCross",void 0===o.params.crossElement&&(o.params.crossElement=!1),console.warn("DEPRECATION WARNING - the tick formatter has been deprecated, please use the tickCross formatter with the crossElement param set to false")),this.formatters[i]?o.formatter=this.formatters[i]:(console.warn("Formatter Error - No such formatter found: ",i),o.formatter=this.formatters.plaintext);break;case"function":o.formatter=i;break;default:o.formatter=this.formatters.plaintext}return o},k.prototype.cellRendered=function(e){e.modules.format&&e.modules.format.renderedCallback&&e.modules.format.renderedCallback()},k.prototype.formatValue=function(e){var t=e.getComponent(),o="function"==typeof e.column.modules.format.params?e.column.modules.format.params(t):e.column.modules.format.params;return e.column.modules.format.formatter.call(this,t,o,(function(t){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=t}))},k.prototype.formatExportValue=function(e,t){var o,i=e.column.modules.format[t];return i?(o="function"==typeof i.params?i.params(component):i.params,i.formatter.call(this,e.getComponent(),o,(function(t){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=t}))):this.formatValue(e)},k.prototype.sanitizeHTML=function(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=\/]/g,(function(e){return t[e]}))}return e},k.prototype.emptyToSpace=function(e){return null==e?"&nbsp;":e},k.prototype.getFormatter=function(e){switch(void 0===e?"undefined":s(e)){case"string":this.formatters[e]?e=this.formatters[e]:(console.warn("Formatter Error - No such formatter found: ",e),e=this.formatters.plaintext);break;case"function":e=e;break;default:e=this.formatters.plaintext}return e},k.prototype.formatters={plaintext:function(e,t,o){return this.emptyToSpace(this.sanitizeHTML(e.getValue()))},html:function(e,t,o){return e.getValue()},textarea:function(e,t,o){return e.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(e.getValue()))},money:function(e,t,o){var i,n,r,a,s=parseFloat(e.getValue()),l=t.decimal||".",c=t.thousand||",",u=t.symbol||"",d=!!t.symbolAfter,h=void 0!==t.precision?t.precision:2;if(isNaN(s))return this.emptyToSpace(this.sanitizeHTML(e.getValue()));for(i=!1!==h?s.toFixed(h):s,n=(i=String(i).split("."))[0],r=i.length>1?l+i[1]:"",a=/(\d+)(\d{3})/;a.test(n);)n=n.replace(a,"$1"+c+"$2");return d?n+r+u:u+n+r},link:function(e,t,o){var i=e.getValue(),n=t.urlPrefix||"",r=t.download,a=i,l=document.createElement("a");if(t.labelField&&(a=e.getData()[t.labelField]),t.label)switch(s(t.label)){case"string":a=t.label;break;case"function":a=t.label(e)}if(a){if(t.urlField&&(i=e.getData()[t.urlField]),t.url)switch(s(t.url)){case"string":i=t.url;break;case"function":i=t.url(e)}return l.setAttribute("href",n+i),t.target&&l.setAttribute("target",t.target),t.download&&(r="function"==typeof r?r(e):!0===r?"":r,l.setAttribute("download",r)),l.innerHTML=this.emptyToSpace(this.sanitizeHTML(a)),l}return"&nbsp;"},image:function(e,t,o){var i=document.createElement("img");switch(i.setAttribute("src",e.getValue()),s(t.height)){case"number":i.style.height=t.height+"px";break;case"string":i.style.height=t.height}switch(s(t.width)){case"number":i.style.width=t.width+"px";break;case"string":i.style.width=t.width}return i.addEventListener("load",(function(){e.getRow().normalizeHeight()})),i},tickCross:function(e,t,o){var i=e.getValue(),n=e.getElement(),r=t.allowEmpty,a=t.allowTruthy,s=void 0!==t.tickElement?t.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',l=void 0!==t.crossElement?t.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return a&&i||!0===i||"true"===i||"True"===i||1===i||"1"===i?(n.setAttribute("aria-checked",!0),s||""):!r||"null"!==i&&""!==i&&null!=i?(n.setAttribute("aria-checked",!1),l||""):(n.setAttribute("aria-checked","mixed"),"")},datetime:function(e,t,o){var i=t.inputFormat||"YYYY-MM-DD hh:mm:ss",n=t.outputFormat||"DD/MM/YYYY hh:mm:ss",r=void 0!==t.invalidPlaceholder?t.invalidPlaceholder:"",a=e.getValue(),s=moment(a,i);return s.isValid()?s.format(n):!0===r?a:"function"==typeof r?r(a):r},datetimediff:function(e,t,o){var i=t.inputFormat||"YYYY-MM-DD hh:mm:ss",n=void 0!==t.invalidPlaceholder?t.invalidPlaceholder:"",r=void 0!==t.suffix&&t.suffix,a=void 0!==t.unit?t.unit:void 0,s=void 0!==t.humanize&&t.humanize,l=void 0!==t.date?t.date:moment(),c=e.getValue(),u=moment(c,i);return u.isValid()?s?moment.duration(u.diff(l)).humanize(r):u.diff(l,a)+(r?" "+r:""):!0===n?c:"function"==typeof n?n(c):n},lookup:function(e,t,o){var i=e.getValue();return void 0===t[i]?(console.warn("Missing display value for "+i),i):t[i]},star:function(e,t,o){var i=e.getValue(),n=e.getElement(),r=t&&t.stars?t.stars:5,a=document.createElement("span"),s=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.verticalAlign="middle",s.setAttribute("width","14"),s.setAttribute("height","14"),s.setAttribute("viewBox","0 0 512 512"),s.setAttribute("xml:space","preserve"),s.style.padding="0 1px",i=i&&!isNaN(i)?parseInt(i):0,i=Math.max(0,Math.min(i,r));for(var l=1;l<=r;l++){var c=s.cloneNode(!0);c.innerHTML=l<=i?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',a.appendChild(c)}return n.style.whiteSpace="nowrap",n.style.overflow="hidden",n.style.textOverflow="ellipsis",n.setAttribute("aria-label",i),a},traffic:function(e,t,o){var i,n,r=this.sanitizeHTML(e.getValue())||0,a=document.createElement("span"),l=t&&t.max?t.max:100,c=t&&t.min?t.min:0,u=t&&void 0!==t.color?t.color:["red","orange","green"],d="#666666";if(!isNaN(r)&&void 0!==e.getValue()){switch(a.classList.add("tabulator-traffic-light"),n=parseFloat(r)<=l?parseFloat(r):l,n=parseFloat(n)>=c?parseFloat(n):c,i=(l-c)/100,n=Math.round((n-c)/i),void 0===u?"undefined":s(u)){case"string":d=u;break;case"function":d=u(r);break;case"object":if(Array.isArray(u)){var h=100/u.length,p=Math.floor(n/h);p=Math.min(p,u.length-1),d=u[p=Math.max(p,0)];break}}return a.style.backgroundColor=d,a}},progress:function(e,t,o){var i,n,r,a,c,u=this.sanitizeHTML(e.getValue())||0,d=e.getElement(),h=t&&t.max?t.max:100,p=t&&t.min?t.min:0,f=t&&t.legendAlign?t.legendAlign:"center";switch(n=parseFloat(u)<=h?parseFloat(u):h,n=parseFloat(n)>=p?parseFloat(n):p,i=(h-p)/100,n=Math.round((n-p)/i),s(t.color)){case"string":r=t.color;break;case"function":r=t.color(u);break;case"object":if(Array.isArray(t.color)){var m=100/t.color.length,g=Math.floor(n/m);g=Math.min(g,t.color.length-1),g=Math.max(g,0),r=t.color[g];break}default:r="#2DC214"}switch(s(t.legend)){case"string":a=t.legend;break;case"function":a=t.legend(u);break;case"boolean":a=u;break;default:a=!1}switch(s(t.legendColor)){case"string":c=t.legendColor;break;case"function":c=t.legendColor(u);break;case"object":Array.isArray(t.legendColor)&&(m=100/t.legendColor.length,g=Math.floor(n/m),g=Math.min(g,t.legendColor.length-1),g=Math.max(g,0),c=t.legendColor[g]);break;default:c="#000"}d.style.minWidth="30px",d.style.position="relative",d.setAttribute("aria-label",n);var v=document.createElement("div");if(v.style.display="inline-block",v.style.position="relative",v.style.width=n+"%",v.style.backgroundColor=r,v.style.height="100%",v.setAttribute("data-max",h),v.setAttribute("data-min",p),a){var b=document.createElement("div");b.style.position="absolute",b.style.top="4px",b.style.left=0,b.style.textAlign=f,b.style.width="100%",b.style.color=c,b.innerHTML=a}return o((function(){if(!(e instanceof l)){var t=document.createElement("div");t.style.position="absolute",t.style.top="4px",t.style.bottom="4px",t.style.left="4px",t.style.right="4px",d.appendChild(t),d=t}d.appendChild(v),a&&d.appendChild(b)})),""},color:function(e,t,o){return e.getElement().style.backgroundColor=this.sanitizeHTML(e.getValue()),""},buttonTick:function(e,t,o){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function(e,t,o){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function(e,t,o){return this.table.rowManager.activeRows.indexOf(e.getRow()._getSelf())+1},handle:function(e,t,o){return e.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function(e,t,o){var i=document.createElement("div"),n=e.getRow()._row.modules.responsiveLayout;function r(e){var t=n.element;n.open=e,t&&(n.open?(i.classList.add("open"),t.style.display=""):(i.classList.remove("open"),t.style.display="none"))}return i.classList.add("tabulator-responsive-collapse-toggle"),i.innerHTML="<span class='tabulator-responsive-collapse-toggle-open'>+</span><span class='tabulator-responsive-collapse-toggle-close'>-</span>",e.getElement().classList.add("tabulator-row-handle"),i.addEventListener("click",(function(e){e.stopImmediatePropagation(),r(!n.open)})),r(n.open),i},rowSelection:function(e){var t=this,o=document.createElement("input");if(o.type="checkbox",this.table.modExists("selectRow",!0))if(o.addEventListener("click",(function(e){e.stopPropagation()})),"function"==typeof e.getRow){var i=e.getRow();o.addEventListener("change",(function(e){i.toggleSelect()})),o.checked=i.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(i,o)}else o.addEventListener("change",(function(e){t.table.modules.selectRow.selectedRows.length?t.table.deselectRow():t.table.selectRow()})),this.table.modules.selectRow.registerHeaderSelectCheckbox(o);return o}},d.prototype.registerModule("format",k);var M=function(e){this.table=e,this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightPadding=0,this.initializationMode="left",this.active=!1,this.scrollEndTimer=!1};M.prototype.reset=function(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightMargin=0,this.active=!1,this.table.columnManager.headersElement.style.marginLeft=0,this.table.columnManager.element.style.paddingRight=0},M.prototype.initializeColumn=function(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")},M.prototype.frozenCheck=function(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen},M.prototype.scrollHorizontal=function(){var e,t=this;this.active&&(clearTimeout(this.scrollEndTimer),this.scrollEndTimer=setTimeout((function(){t.layout()}),100),e=this.table.rowManager.getVisibleRows(),this.calcMargins(),this.layoutColumnPosition(),this.layoutCalcRows(),e.forEach((function(e){"row"===e.type&&t.layoutRow(e)})),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)},M.prototype.calcMargins=function(){this.leftMargin=this._calcSpace(this.leftColumns,this.leftColumns.length)+"px",this.table.columnManager.headersElement.style.marginLeft=this.leftMargin,this.rightMargin=this._calcSpace(this.rightColumns,this.rightColumns.length)+"px",this.table.columnManager.element.style.paddingRight=this.rightMargin,this.rightPadding=this.table.rowManager.element.clientWidth+this.table.columnManager.scrollLeft},M.prototype.layoutCalcRows=function(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow))},M.prototype.layoutColumnPosition=function(e){var t=this,o=[];this.leftColumns.forEach((function(i,n){if(i.modules.frozen.margin=t._calcSpace(t.leftColumns,n)+t.table.columnManager.scrollLeft+"px",n==t.leftColumns.length-1?i.modules.frozen.edge=!0:i.modules.frozen.edge=!1,i.parent.isGroup){var r=t.getColGroupParentElement(i);o.includes(r)||(t.layoutElement(r,i),o.push(r)),i.modules.frozen.edge&&r.classList.add("tabulator-frozen-"+i.modules.frozen.position)}else t.layoutElement(i.getElement(),i);e&&i.cells.forEach((function(e){t.layoutElement(e.getElement(),i)}))})),this.rightColumns.forEach((function(o,i){o.modules.frozen.margin=t.rightPadding-t._calcSpace(t.rightColumns,i+1)+"px",i==t.rightColumns.length-1?o.modules.frozen.edge=!0:o.modules.frozen.edge=!1,o.parent.isGroup?t.layoutElement(t.getColGroupParentElement(o),o):t.layoutElement(o.getElement(),o),e&&o.cells.forEach((function(e){t.layoutElement(e.getElement(),o)}))}))},M.prototype.getColGroupParentElement=function(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()},M.prototype.layout=function(){var e=this;e.active&&(this.calcMargins(),e.table.rowManager.getDisplayRows().forEach((function(t){"row"===t.type&&e.layoutRow(t)})),this.layoutCalcRows(),this.layoutColumnPosition(!0),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)},M.prototype.layoutRow=function(e){var t=this;e.getElement().style.paddingLeft=this.leftMargin,this.leftColumns.forEach((function(o){var i=e.getCell(o);i&&t.layoutElement(i.getElement(),o)})),this.rightColumns.forEach((function(o){var i=e.getCell(o);i&&t.layoutElement(i.getElement(),o)}))},M.prototype.layoutElement=function(e,t){t.modules.frozen&&(e.style.position="absolute",e.style.left=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),t.modules.frozen.edge&&e.classList.add("tabulator-frozen-"+t.modules.frozen.position))},M.prototype._calcSpace=function(e,t){for(var o=0,i=0;i<t;i++)e[i].visible&&(o+=e[i].getWidth());return o},d.prototype.registerModule("frozenColumns",M);var _=function(e){this.table=e,this.topElement=document.createElement("div"),this.rows=[],this.displayIndex=0};_.prototype.initialize=function(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling)},_.prototype.setDisplayIndex=function(e){this.displayIndex=e},_.prototype.getDisplayIndex=function(){return this.displayIndex},_.prototype.isFrozen=function(){return!!this.rows.length},_.prototype.getRows=function(e){var t=e.slice(0);return this.rows.forEach((function(e){var o=t.indexOf(e);o>-1&&t.splice(o,1)})),t},_.prototype.freezeRow=function(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.table.rowManager.adjustTableSize(),this.rows.push(e),this.table.rowManager.refreshActiveData("display"),this.styleRows())},_.prototype.unfreezeRow=function(e){var t=this.rows.indexOf(e);if(e.modules.frozen){e.modules.frozen=!1;var o=e.getElement();o.parentNode.removeChild(o),this.table.rowManager.adjustTableSize(),this.rows.splice(t,1),this.table.rowManager.refreshActiveData("display"),this.rows.length&&this.styleRows()}else console.warn("Freeze Error - Row is already unfrozen")},_.prototype.styleRows=function(e){var t=this;this.rows.forEach((function(e,o){t.table.rowManager.styleRow(e,o)}))},d.prototype.registerModule("frozenRows",_);var D=function(e){this._group=e,this.type="GroupComponent"};D.prototype.getKey=function(){return this._group.key},D.prototype.getField=function(){return this._group.field},D.prototype.getElement=function(){return this._group.element},D.prototype.getRows=function(){return this._group.getRows(!0)},D.prototype.getSubGroups=function(){return this._group.getSubGroups(!0)},D.prototype.getParentGroup=function(){return!!this._group.parent&&this._group.parent.getComponent()},D.prototype.getVisibility=function(){return this._group.visible},D.prototype.show=function(){this._group.show()},D.prototype.hide=function(){this._group.hide()},D.prototype.toggle=function(){this._group.toggleVisibility()},D.prototype._getSelf=function(){return this._group},D.prototype.getTable=function(){return this._group.groupManager.table};var S=function(e,t,o,i,n,r,a){this.groupManager=e,this.parent=t,this.key=i,this.level=o,this.field=n,this.hasSubGroups=o<e.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=a,this.rows=[],this.groups=[],this.groupList=[],this.generator=r,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=a?a.visible:void 0!==e.startOpen[o]?e.startOpen[o]:e.startOpen[0],this.createElements(),this.addBindings(),this.createValueGroups()};S.prototype.wipe=function(){this.groupList.length?this.groupList.forEach((function(e){e.wipe()})):(this.element=!1,this.arrowElement=!1,this.elementContents=!1)},S.prototype.createElements=function(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)},S.prototype.createValueGroups=function(){var e=this,t=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]&&this.groupManager.allowedValues[t].forEach((function(o){e._createGroup(o,t)}))},S.prototype.addBindings=function(){var e,t,o,i=this;i.groupManager.table.options.groupClick&&i.element.addEventListener("click",(function(e){i.groupManager.table.options.groupClick.call(i.groupManager.table,e,i.getComponent())})),i.groupManager.table.options.groupDblClick&&i.element.addEventListener("dblclick",(function(e){i.groupManager.table.options.groupDblClick.call(i.groupManager.table,e,i.getComponent())})),i.groupManager.table.options.groupContext&&i.element.addEventListener("contextmenu",(function(e){i.groupManager.table.options.groupContext.call(i.groupManager.table,e,i.getComponent())})),i.groupManager.table.options.groupTap&&(o=!1,i.element.addEventListener("touchstart",(function(e){o=!0}),{passive:!0}),i.element.addEventListener("touchend",(function(e){o&&i.groupManager.table.options.groupTap(e,i.getComponent()),o=!1}))),i.groupManager.table.options.groupDblTap&&(e=null,i.element.addEventListener("touchend",(function(t){e?(clearTimeout(e),e=null,i.groupManager.table.options.groupDblTap(t,i.getComponent())):e=setTimeout((function(){clearTimeout(e),e=null}),300)}))),i.groupManager.table.options.groupTapHold&&(t=null,i.element.addEventListener("touchstart",(function(e){clearTimeout(t),t=setTimeout((function(){clearTimeout(t),t=null,o=!1,i.groupManager.table.options.groupTapHold(e,i.getComponent())}),1e3)}),{passive:!0}),i.element.addEventListener("touchend",(function(e){clearTimeout(t),t=null}))),i.groupManager.table.options.groupToggleElement&&("arrow"==i.groupManager.table.options.groupToggleElement?i.arrowElement:i.element).addEventListener("click",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),i.toggleVisibility()}))},S.prototype._createGroup=function(e,t){var o=t+"_"+e,i=new S(this.groupManager,this,t,e,this.groupManager.groupIDLookups[t].field,this.groupManager.headerGenerator[t]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[o]);this.groups[o]=i,this.groupList.push(i)},S.prototype._addRowToGroup=function(e){var t=this.level+1;if(this.hasSubGroups){var o=this.groupManager.groupIDLookups[t].func(e.getData()),i=t+"_"+o;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[i]&&this.groups[i].addRow(e):(this.groups[i]||this._createGroup(o,t),this.groups[i].addRow(e))}},S.prototype._addRow=function(e){this.rows.push(e),e.modules.group=this},S.prototype.insertRow=function(e,t,o){var i=this.conformRowData({});e.updateData(i);var n=this.rows.indexOf(t);n>-1?o?this.rows.splice(n+1,0,e):this.rows.splice(n,0,e):o?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)},S.prototype.scrollHeader=function(e){this.arrowElement.style.marginLeft=e,this.groupList.forEach((function(t){t.scrollHeader(e)}))},S.prototype.getRowIndex=function(e){},S.prototype.conformRowData=function(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e},S.prototype.removeRow=function(e){var t=this.rows.indexOf(e),o=e.getElement();t>-1&&this.rows.splice(t,1),this.groupManager.table.options.groupValues||this.rows.length?(o.parentNode&&o.parentNode.removeChild(o),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))},S.prototype.removeGroup=function(e){var t,o=e.level+"_"+e.key;this.groups[o]&&(delete this.groups[o],(t=this.groupList.indexOf(e))>-1&&this.groupList.splice(t,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))},S.prototype.getHeadersAndRows=function(e){var t=[];return t.push(this),this._visSet(),this.visible?this.groupList.length?this.groupList.forEach((function(o){t=t.concat(o.getHeadersAndRows(e))})):(!e&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top)),t=t.concat(this.rows),!e&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom))):this.groupList.length||"table"==this.groupManager.table.options.columnCalcs||this.groupManager.table.modExists("columnCalcs")&&(!e&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),t.push(this.calcs.top))),!e&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),t.push(this.calcs.bottom)))),t},S.prototype.getData=function(e,t){var o=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach((function(e){o.push(e.getData(t||"data"))})),o},S.prototype.getRowCount=function(){var e=0;return this.groupList.length?this.groupList.forEach((function(t){e+=t.getRowCount()})):e=this.rows.length,e},S.prototype.toggleVisibility=function(){this.visible?this.hide():this.show()},S.prototype.hide=function(){this.visible=!1,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination?this.groupManager.updateGroupRows(!0):(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach((function(e){e.getHeadersAndRows().forEach((function(e){e.detachElement()}))})):this.rows.forEach((function(e){var t=e.getElement();t.parentNode.removeChild(t)})),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()),this.groupManager.table.options.groupVisibilityChanged.call(this.table,this.getComponent(),!1)},S.prototype.show=function(){if(this.visible=!0,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var e=this.getElement();this.groupList.length?this.groupList.forEach((function(t){t.getHeadersAndRows().forEach((function(t){var o=t.getElement();e.parentNode.insertBefore(o,e.nextSibling),t.initialize(),e=o}))})):this.rows.forEach((function(t){var o=t.getElement();e.parentNode.insertBefore(o,e.nextSibling),t.initialize(),e=o})),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()}this.groupManager.table.options.groupVisibilityChanged.call(this.table,this.getComponent(),!0)},S.prototype._visSet=function(){var e=[];"function"==typeof this.visible&&(this.rows.forEach((function(t){e.push(t.getData())})),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))},S.prototype.getRowGroup=function(e){var t=!1;return this.groupList.length?this.groupList.forEach((function(o){var i=o.getRowGroup(e);i&&(t=i)})):this.rows.find((function(t){return t===e}))&&(t=this),t},S.prototype.getSubGroups=function(e){var t=[];return this.groupList.forEach((function(o){t.push(e?o.getComponent():o)})),t},S.prototype.getRows=function(e){var t=[];return this.rows.forEach((function(o){t.push(e?o.getComponent():o)})),t},S.prototype.generateGroupHeaderContents=function(){var e=[];for(this.rows.forEach((function(t){e.push(t.getData())})),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)},S.prototype.getElement=function(){this.addBindingsd=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element},S.prototype.detachElement=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},S.prototype.normalizeHeight=function(){this.setHeight(this.element.clientHeight)},S.prototype.initialize=function(e){this.initialized&&!e||(this.normalizeHeight(),this.initialized=!0)},S.prototype.reinitialize=function(){this.initialized=!1,this.height=0,d.prototype.helpers.elVisible(this.element)&&this.initialize(!0)},S.prototype.setHeight=function(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)},S.prototype.getHeight=function(){return this.outerHeight},S.prototype.getGroup=function(){return this},S.prototype.reinitializeHeight=function(){},S.prototype.calcHeight=function(){},S.prototype.setCellHeight=function(){},S.prototype.clearCellHeight=function(){},S.prototype.getComponent=function(){return new D(this)};var R=function(e){this.table=e,this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayIndex=0};R.prototype.initialize=function(){var e=this,t=e.table.options.groupBy,o=e.table.options.groupStartOpen,i=e.table.options.groupHeader;this.allowedValues=e.table.options.groupValues,Array.isArray(t)&&Array.isArray(i)&&t.length>i.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),e.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],e.table.modules.localize.bind("groups|item",(function(t,o){e.headerGenerator[0]=function(e,i,n){return(void 0===e?"":e)+"<span>("+i+" "+(1===i?t:o.groups.items)+")</span>"}})),this.groupIDLookups=[],Array.isArray(t)||t?this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs():this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs&&this.table.columnManager.getRealColumns().forEach((function(t){t.definition.topCalc&&e.table.modules.columnCalcs.initializeTopRow(),t.definition.bottomCalc&&e.table.modules.columnCalcs.initializeBottomRow()})),Array.isArray(t)||(t=[t]),t.forEach((function(t,o){var i,n;i="function"==typeof t?t:(n=e.table.columnManager.getColumnByField(t))?function(e){return n.getFieldValue(e)}:function(e){return e[t]},e.groupIDLookups.push({field:"function"!=typeof t&&t,func:i,values:!!e.allowedValues&&e.allowedValues[o]})})),o&&(Array.isArray(o)||(o=[o]),o.forEach((function(e){e="function"==typeof e?e:function(){return!0}})),e.startOpen=o),i&&(e.headerGenerator=Array.isArray(i)?i:[i]),this.initialized=!0},R.prototype.setDisplayIndex=function(e){this.displayIndex=e},R.prototype.getDisplayIndex=function(){return this.displayIndex},R.prototype.getRows=function(e){return this.groupIDLookups.length?(this.table.options.dataGrouping.call(this.table),this.generateGroups(e),this.table.options.dataGrouped&&this.table.options.dataGrouped.call(this.table,this.getGroups(!0)),this.updateGroupRows()):e.slice(0)},R.prototype.getGroups=function(e){var t=[];return this.groupList.forEach((function(o){t.push(e?o.getComponent():o)})),t},R.prototype.getChildGroups=function(e){var t=this,o=[];return e||(e=this),e.groupList.forEach((function(e){e.groupList.length?o=o.concat(t.getChildGroups(e)):o.push(e)})),o},R.prototype.wipe=function(){this.groupList.forEach((function(e){e.wipe()}))},R.prototype.pullGroupListData=function(e){var t=this,o=[];return e.forEach((function(e){var i={level:0,rowCount:0,headerContent:""},n=[];e.hasSubGroups?(n=t.pullGroupListData(e.groupList),i.level=e.level,i.rowCount=n.length-e.groupList.length,i.headerContent=e.generator(e.key,i.rowCount,e.rows,e),o.push(i),o=o.concat(n)):(i.level=e.level,i.headerContent=e.generator(e.key,e.rows.length,e.rows,e),i.rowCount=e.getRows().length,o.push(i),e.getRows().forEach((function(e){o.push(e.getData("data"))})))})),o},R.prototype.getGroupedData=function(){return this.pullGroupListData(this.groupList)},R.prototype.getRowGroup=function(e){var t=!1;return this.groupList.forEach((function(o){var i=o.getRowGroup(e);i&&(t=i)})),t},R.prototype.countGroups=function(){return this.groupList.length},R.prototype.generateGroups=function(e){var t=this,o=t.groups;t.groups={},t.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach((function(e){t.createGroup(e,0,o)})),e.forEach((function(e){t.assignRowToExistingGroup(e,o)}))):e.forEach((function(e){t.assignRowToGroup(e,o)}))},R.prototype.createGroup=function(e,t,o){var i,n=t+"_"+e;o=o||[],i=new S(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],o[n]),this.groups[n]=i,this.groupList.push(i)},R.prototype.assignRowToExistingGroup=function(e,t){var o="0_"+this.groupIDLookups[0].func(e.getData());this.groups[o]&&this.groups[o].addRow(e)},R.prototype.assignRowToGroup=function(e,t){var o=this.groupIDLookups[0].func(e.getData()),i=!this.groups["0_"+o];return i&&this.createGroup(o,0,t),this.groups["0_"+o].addRow(e),!i},R.prototype.updateGroupRows=function(e){var t=[];if(this.groupList.forEach((function(e){t=t.concat(e.getHeadersAndRows())})),e){var o=this.table.rowManager.setDisplayRows(t,this.getDisplayIndex());!0!==o&&this.setDisplayIndex(o),this.table.rowManager.refreshActiveData("group",!0,!0)}return t},R.prototype.scrollHeaders=function(e){e+="px",this.groupList.forEach((function(t){t.scrollHeader(e)}))},R.prototype.removeGroup=function(e){var t,o=e.level+"_"+e.key;this.groups[o]&&(delete this.groups[o],(t=this.groupList.indexOf(e))>-1&&this.groupList.splice(t,1))},d.prototype.registerModule("groupRows",R);var T=function(e){this.table=e,this.history=[],this.index=-1};T.prototype.clear=function(){this.history=[],this.index=-1},T.prototype.action=function(e,t,o){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:o}),this.index++},T.prototype.getHistoryUndoSize=function(){return this.index+1},T.prototype.getHistoryRedoSize=function(){return this.history.length-(this.index+1)},T.prototype.undo=function(){if(this.index>-1){var e=this.history[this.index];return this.undoers[e.type].call(this,e),this.index--,this.table.options.historyUndo.call(this.table,e.type,e.component.getComponent(),e.data),!0}return console.warn("History Undo Error - No more history to undo"),!1},T.prototype.redo=function(){if(this.history.length-1>this.index){this.index++;var e=this.history[this.index];return this.redoers[e.type].call(this,e),this.table.options.historyRedo.call(this.table,e.type,e.component.getComponent(),e.data),!0}return console.warn("History Redo Error - No more history to redo"),!1},T.prototype.undoers={cellEdit:function(e){e.component.setValueProcessData(e.data.oldValue)},rowAdd:function(e){e.component.deleteActual()},rowDelete:function(e){var t=this.table.rowManager.addRowActual(e.data.data,e.data.pos,e.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(e.component,t)},rowMove:function(e){this.table.rowManager.moveRowActual(e.component,this.table.rowManager.rows[e.data.posFrom],!e.data.after),this.table.rowManager.redraw()}},T.prototype.redoers={cellEdit:function(e){e.component.setValueProcessData(e.data.newValue)},rowAdd:function(e){var t=this.table.rowManager.addRowActual(e.data.data,e.data.pos,e.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(e.component,t)},rowDelete:function(e){e.component.deleteActual()},rowMove:function(e){this.table.rowManager.moveRowActual(e.component,this.table.rowManager.rows[e.data.posTo],e.data.after),this.table.rowManager.redraw()}},T.prototype._rebindRow=function(e,t){this.history.forEach((function(o){if(o.component instanceof a)o.component===e&&(o.component=t);else if(o.component instanceof c&&o.component.row===e){var i=o.component.column.getField();i&&(o.component=t.getCell(i))}}))},d.prototype.registerModule("history",T);var L=function(e){this.table=e,this.fieldIndex=[],this.hasIndex=!1};L.prototype.parseTable=function(){var e=this.table.element,t=this.table.options,o=(t.columns,e.getElementsByTagName("th")),i=e.getElementsByTagName("tbody")[0],n=[];this.hasIndex=!1,this.table.options.htmlImporting.call(this.table),i=i?i.getElementsByTagName("tr"):[],this._extractOptions(e,t),o.length?this._extractHeaders(o,i):this._generateBlankHeaders(o,i);for(var r=0;r<i.length;r++){var a=i[r].getElementsByTagName("td"),l={};this.hasIndex||(l[t.index]=r);for(var c=0;c<a.length;c++){var u=a[c];void 0!==this.fieldIndex[c]&&(l[this.fieldIndex[c]]=u.innerHTML)}n.push(l)}var d=document.createElement("div"),h=e.attributes;for(var c in h)"object"==s(h[c])&&d.setAttribute(h[c].name,h[c].value);e.parentNode.replaceChild(d,e),t.data=n,this.table.options.htmlImported.call(this.table),this.table.element=d},L.prototype._extractOptions=function(e,t,o){var i=e.attributes,n=o?Object.assign([],o):Object.keys(t),r={};for(var a in n.forEach((function(e){r[e.toLowerCase()]=e})),i){var l,c=i[a];c&&"object"==(void 0===c?"undefined":s(c))&&c.name&&0===c.name.indexOf("tabulator-")&&(l=c.name.replace("tabulator-",""),void 0!==r[l]&&(t[r[l]]=this._attribValue(c.value)))}},L.prototype._attribValue=function(e){return"true"===e||"false"!==e&&e},L.prototype._findCol=function(e){return this.table.options.columns.find((function(t){return t.title===e}))||!1},L.prototype._extractHeaders=function(e,t){for(var o=0;o<e.length;o++){var n,r=e[o],a=!1,s=this._findCol(r.textContent);s?a=!0:s={title:r.textContent.trim()},s.field||(s.field=r.textContent.trim().toLowerCase().replace(" ","_")),(n=r.getAttribute("width"))&&!s.width&&(s.width=n),r.attributes,this._extractOptions(r,s,i.prototype.defaultOptionList),this.fieldIndex[o]=s.field,s.field==this.table.options.index&&(this.hasIndex=!0),a||this.table.options.columns.push(s)}},L.prototype._generateBlankHeaders=function(e,t){for(var o=0;o<e.length;o++){var i=e[o],n={title:"",field:"col"+o};this.fieldIndex[o]=n.field;var r=i.getAttribute("width");r&&(n.width=r),this.table.options.columns.push(n)}},d.prototype.registerModule("htmlTableImport",L);var P=function(e){this.table=e,this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1};P.prototype.initialize=function(){var e=this.table.options.keybindings,t={};if(this.watchKeys={},this.pressedKeys=[],!1!==e){for(var o in this.bindings)t[o]=this.bindings[o];if(Object.keys(e).length)for(var i in e)t[i]=e[i];this.mapBindings(t),this.bindEvents()}},P.prototype.mapBindings=function(e){var t=this,o=this,i=function(i){t.actions[i]?e[i]&&("object"!==s(e[i])&&(e[i]=[e[i]]),e[i].forEach((function(e){o.mapBinding(i,e)}))):console.warn("Key Binding Error - no such action:",i)};for(var n in e)i(n)},P.prototype.mapBinding=function(e,t){var o=this,i={action:this.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1};t.toString().toLowerCase().split(" ").join("").split("+").forEach((function(e){switch(e){case"ctrl":i.ctrl=!0;break;case"shift":i.shift=!0;break;case"meta":i.meta=!0;break;default:e=parseInt(e),i.keys.push(e),o.watchKeys[e]||(o.watchKeys[e]=[]),o.watchKeys[e].push(i)}}))},P.prototype.bindEvents=function(){var e=this;this.keyupBinding=function(t){var o=t.keyCode,i=e.watchKeys[o];i&&(e.pressedKeys.push(o),i.forEach((function(o){e.checkBinding(t,o)})))},this.keydownBinding=function(t){var o=t.keyCode;if(e.watchKeys[o]){var i=e.pressedKeys.indexOf(o);i>-1&&e.pressedKeys.splice(i,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)},P.prototype.clearBindings=function(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)},P.prototype.checkBinding=function(e,t){var o=this,i=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta&&(t.keys.forEach((function(e){-1==o.pressedKeys.indexOf(e)&&(i=!1)})),i&&t.action.call(o,e),!0)},P.prototype.bindings={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:"ctrl + 90",redo:"ctrl + 89",copyToClipboard:"ctrl + 67"},P.prototype.actions={keyBlock:function(e){e.stopPropagation(),e.preventDefault()},scrollPageUp:function(e){var t=this.table.rowManager,o=t.scrollTop-t.height;t.element.scrollHeight,e.preventDefault(),t.displayRowsCount&&(o>=0?t.element.scrollTop=o:t.scrollToRow(t.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(e){var t=this.table.rowManager,o=t.scrollTop+t.height,i=t.element.scrollHeight;e.preventDefault(),t.displayRowsCount&&(o<=i?t.element.scrollTop=o:t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(e){var t=this.table.rowManager;e.preventDefault(),t.displayRowsCount&&t.scrollToRow(t.getDisplayRows()[t.displayRowsCount-1]),this.table.element.focus()},navPrev:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().prev())},navNext:function(e){var t,o=!1,i=this.table.options.tabEndNewRow;this.table.modExists("edit")&&(o=this.table.modules.edit.currentCell)&&(e.preventDefault(),(t=o.nav()).next()||i&&(o.getElement().firstChild.blur(),(i=!0===i?this.table.addRow({}):"function"==typeof i?this.table.addRow(i(o.row.getComponent())):this.table.addRow(i)).then((function(){setTimeout((function(){t.next()}))}))))},navLeft:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().left())},navRight:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().right())},navUp:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().up())},navDown:function(e){var t=!1;this.table.modExists("edit")&&(t=this.table.modules.edit.currentCell)&&(e.preventDefault(),t.nav().down())},undo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.undo()))},redo:function(e){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(e.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(e){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},d.prototype.registerModule("keybindings",P);var A=function(e){this.table=e,this.menuEl=!1,this.blurEvent=this.hideMenu.bind(this)};A.prototype.initializeColumnHeader=function(e){var t,o=this;e.definition.headerContextMenu&&e.getElement().addEventListener("contextmenu",(function(t){var i="function"==typeof e.definition.headerContextMenu?e.definition.headerContextMenu():e.definition.headerContextMenu;t.preventDefault(),o.loadMenu(t,e,i)})),e.definition.headerMenu&&((t=document.createElement("span")).classList.add("tabulator-header-menu-button"),t.innerHTML="&vellip;",t.addEventListener("click",(function(t){var i="function"==typeof e.definition.headerMenu?e.definition.headerMenu():e.definition.headerMenu;t.stopPropagation(),t.preventDefault(),o.loadMenu(t,e,i)})),e.titleElement.insertBefore(t,e.titleElement.firstChild))},A.prototype.initializeCell=function(e){var t=this;e.getElement().addEventListener("contextmenu",(function(o){var i="function"==typeof e.column.definition.contextMenu?e.column.definition.contextMenu():e.column.definition.contextMenu;o.preventDefault(),t.loadMenu(o,e,i)}))},A.prototype.initializeRow=function(e){var t=this;e.getElement().addEventListener("contextmenu",(function(o){var i="function"==typeof t.table.options.rowContextMenu?t.table.options.rowContextMenu():t.table.options.rowContextMenu;o.preventDefault(),t.loadMenu(o,e,i)}))},A.prototype.loadMenu=function(e,t,o){var i=this,n=document.body.offsetHeight;o&&o.length&&(this.hideMenu(),this.menuEl=document.createElement("div"),this.menuEl.classList.add("tabulator-menu"),o.forEach((function(e){var o=document.createElement("div"),n=e.label,r=e.disabled;e.separator?o.classList.add("tabulator-menu-separator"):(o.classList.add("tabulator-menu-item"),"function"==typeof n&&(n=n(t.getComponent())),n instanceof Node?o.appendChild(n):o.innerHTML=n,"function"==typeof r&&(r=r(t.getComponent())),r?(o.classList.add("tabulator-menu-item-disabled"),o.addEventListener("click",(function(e){e.stopPropagation()}))):o.addEventListener("click",(function(o){i.hideMenu(),e.action(o,t.getComponent())}))),i.menuEl.appendChild(o)})),this.menuEl.style.top=e.pageY+"px",this.menuEl.style.left=e.pageX+"px",document.body.addEventListener("click",this.blurEvent),this.table.rowManager.element.addEventListener("scroll",this.blurEvent),setTimeout((function(){document.body.addEventListener("contextmenu",i.blurEvent)}),100),document.body.appendChild(this.menuEl),e.pageX+this.menuEl.offsetWidth>=document.body.offsetWidth&&(this.menuEl.style.left="",this.menuEl.style.right=document.body.offsetWidth-e.pageX+"px"),e.pageY+this.menuEl.offsetHeight>=n&&(this.menuEl.style.top="",this.menuEl.style.bottom=n-e.pageY+"px"))},A.prototype.hideMenu=function(){this.menuEl.parentNode&&this.menuEl.parentNode.removeChild(this.menuEl),this.blurEvent&&(document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent))},A.prototype.menus={},d.prototype.registerModule("menu",A);var F=function(e){this.table=e,this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this)};F.prototype.createPlaceholderElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e},F.prototype.initializeColumn=function(e){var t,o=this,i={};e.modules.frozen||(t=e.getElement(),i.mousemove=function(i){e.parent===o.moving.parent&&((o.touchMove?i.touches[0].pageX:i.pageX)-d.prototype.helpers.elOffset(t).left+o.table.columnManager.element.scrollLeft>e.getWidth()/2?o.toCol===e&&o.toColAfter||(t.parentNode.insertBefore(o.placeholderElement,t.nextSibling),o.moveColumn(e,!0)):(o.toCol!==e||o.toColAfter)&&(t.parentNode.insertBefore(o.placeholderElement,t),o.moveColumn(e,!1)))}.bind(o),t.addEventListener("mousedown",(function(t){o.touchMove=!1,1===t.which&&(o.checkTimeout=setTimeout((function(){o.startMove(t,e)}),o.checkPeriod))})),t.addEventListener("mouseup",(function(e){1===e.which&&o.checkTimeout&&clearTimeout(o.checkTimeout)})),o.bindTouchEvents(e)),e.modules.moveColumn=i},F.prototype.bindTouchEvents=function(e){var t,o,i,n,r,a,s=this,l=e.getElement(),c=!1;l.addEventListener("touchstart",(function(l){s.checkTimeout=setTimeout((function(){s.touchMove=!0,t=e.nextColumn(),i=t?t.getWidth()/2:0,o=e.prevColumn(),n=o?o.getWidth()/2:0,r=0,a=0,c=!1,s.startMove(l,e)}),s.checkPeriod)}),{passive:!0}),l.addEventListener("touchmove",(function(l){var u,d;s.moving&&(s.moveHover(l),c||(c=l.touches[0].pageX),(u=l.touches[0].pageX-c)>0?t&&u-r>i&&(d=t)!==e&&(c=l.touches[0].pageX,d.getElement().parentNode.insertBefore(s.placeholderElement,d.getElement().nextSibling),s.moveColumn(d,!0)):o&&-u-a>n&&(d=o)!==e&&(c=l.touches[0].pageX,d.getElement().parentNode.insertBefore(s.placeholderElement,d.getElement()),s.moveColumn(d,!1)),d&&(t=d.nextColumn(),r=i,i=t?t.getWidth()/2:0,o=d.prevColumn(),a=n,n=o?o.getWidth()/2:0))}),{passive:!0}),l.addEventListener("touchend",(function(e){s.checkTimeout&&clearTimeout(s.checkTimeout),s.moving&&s.endMove(e)}))},F.prototype.startMove=function(e,t){var o=t.getElement();this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-d.prototype.helpers.elOffset(o).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",o.parentNode.insertBefore(this.placeholderElement,o),o.parentNode.removeChild(o),this.hoverElement=o.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.table.columnManager.getElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom="0",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e)},F.prototype._bindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach((function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)}))},F.prototype._unbindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach((function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)}))},F.prototype.moveColumn=function(e,t){var o=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach((function(e,t){var i=e.getElement();i.parentNode.insertBefore(o[t].getElement(),i.nextSibling)})):e.getCells().forEach((function(e,t){var i=e.getElement();i.parentNode.insertBefore(o[t].getElement(),i)}))},F.prototype.endMove=function(e){(1===e.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))},F.prototype.moveHover=function(e){var t,o=this,i=o.table.columnManager.getElement(),n=i.scrollLeft,r=(o.touchMove?e.touches[0].pageX:e.pageX)-d.prototype.helpers.elOffset(i).left+n;o.hoverElement.style.left=r-o.startX+"px",r-n<o.autoScrollMargin&&(o.autoScrollTimeout||(o.autoScrollTimeout=setTimeout((function(){t=Math.max(0,n-5),o.table.rowManager.getElement().scrollLeft=t,o.autoScrollTimeout=!1}),1))),n+i.clientWidth-r<o.autoScrollMargin&&(o.autoScrollTimeout||(o.autoScrollTimeout=setTimeout((function(){t=Math.min(i.clientWidth,n+5),o.table.rowManager.getElement().scrollLeft=t,o.autoScrollTimeout=!1}),1)))},d.prototype.registerModule("moveColumn",F);var O=function(e){this.table=e,this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connections=[],this.connectedTable=!1,this.connectedRow=!1};O.prototype.createPlaceholderElement=function(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e},O.prototype.initialize=function(e){this.connection=this.table.options.movableRowsConnectedTables},O.prototype.setHandle=function(e){this.hasHandle=e},O.prototype.initializeGroupHeader=function(e){var t=this,o={};o.mouseup=function(e){t.tableRowDrop(e,row)}.bind(t),o.mousemove=function(o){var i;o.pageY-d.prototype.helpers.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?t.toRow===e&&t.toRowAfter||((i=e.getElement()).parentNode.insertBefore(t.placeholderElement,i.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(i=e.getElement()).previousSibling&&(i.parentNode.insertBefore(t.placeholderElement,i),t.moveRow(e,!1))}.bind(t),e.modules.moveRow=o},O.prototype.initializeRow=function(e){var t,o=this,i={};i.mouseup=function(t){o.tableRowDrop(t,e)}.bind(o),i.mousemove=function(t){var i;t.pageY-d.prototype.helpers.elOffset(e.element).top+o.table.rowManager.element.scrollTop>e.getHeight()/2?o.toRow===e&&o.toRowAfter||((i=e.getElement()).parentNode.insertBefore(o.placeholderElement,i.nextSibling),o.moveRow(e,!0)):(o.toRow!==e||o.toRowAfter)&&((i=e.getElement()).parentNode.insertBefore(o.placeholderElement,i),o.moveRow(e,!1))}.bind(o),this.hasHandle||((t=e.getElement()).addEventListener("mousedown",(function(t){1===t.which&&(o.checkTimeout=setTimeout((function(){o.startMove(t,e)}),o.checkPeriod))})),t.addEventListener("mouseup",(function(e){1===e.which&&o.checkTimeout&&clearTimeout(o.checkTimeout)})),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=i},O.prototype.initializeCell=function(e){var t=this,o=e.getElement();o.addEventListener("mousedown",(function(o){1===o.which&&(t.checkTimeout=setTimeout((function(){t.startMove(o,e.row)}),t.checkPeriod))})),o.addEventListener("mouseup",(function(e){1===e.which&&t.checkTimeout&&clearTimeout(t.checkTimeout)})),this.bindTouchEvents(e.row,e.getElement())},O.prototype.bindTouchEvents=function(e,t){var o,i,n,r,a,s,l=this,c=!1;t.addEventListener("touchstart",(function(t){l.checkTimeout=setTimeout((function(){l.touchMove=!0,o=e.nextRow(),n=o?o.getHeight()/2:0,i=e.prevRow(),r=i?i.getHeight()/2:0,a=0,s=0,c=!1,l.startMove(t,e)}),l.checkPeriod)}),{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",(function(t){var u,d;l.moving&&(t.preventDefault(),l.moveHover(t),c||(c=t.touches[0].pageY),(u=t.touches[0].pageY-c)>0?o&&u-a>n&&(d=o)!==e&&(c=t.touches[0].pageY,d.getElement().parentNode.insertBefore(l.placeholderElement,d.getElement().nextSibling),l.moveRow(d,!0)):i&&-u-s>r&&(d=i)!==e&&(c=t.touches[0].pageY,d.getElement().parentNode.insertBefore(l.placeholderElement,d.getElement()),l.moveRow(d,!1)),d&&(o=d.nextRow(),a=n,n=o?o.getHeight()/2:0,i=d.prevRow(),s=r,r=i?i.getHeight()/2:0))})),t.addEventListener("touchend",(function(e){l.checkTimeout&&clearTimeout(l.checkTimeout),l.moving&&(l.endMove(e),l.touchMove=!1)}))},O.prototype._bindMouseMove=function(){this.table.rowManager.getDisplayRows().forEach((function(e){"row"!==e.type&&"group"!==e.type||!e.modules.moveRow.mousemove||e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)}))},O.prototype._unbindMouseMove=function(){this.table.rowManager.getDisplayRows().forEach((function(e){"row"!==e.type&&"group"!==e.type||!e.modules.moveRow.mousemove||e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)}))},O.prototype.startMove=function(e,t){var o=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(o.parentNode.insertBefore(this.placeholderElement,o),o.parentNode.removeChild(o)),this.hoverElement=o.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.moveHover(e)},O.prototype.setStartPosition=function(e,t){var o,i,n=this.touchMove?e.touches[0].pageX:e.pageX,r=this.touchMove?e.touches[0].pageY:e.pageY;o=t.getElement(),this.connection?(i=o.getBoundingClientRect(),this.startX=i.left-n+window.pageXOffset,this.startY=i.top-r+window.pageYOffset):this.startY=r-o.getBoundingClientRect().top},O.prototype.endMove=function(e){e&&1!==e.which&&!this.touchMove||(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow&&this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))},O.prototype.moveRow=function(e,t){this.toRow=e,this.toRowAfter=t},O.prototype.moveHover=function(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)},O.prototype.moveHoverTable=function(e){var t=this.table.rowManager.getElement(),o=t.scrollTop,i=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+o;this.hoverElement.style.top=i-this.startY+"px"},O.prototype.moveHoverConnections=function(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"},O.prototype.connectToTables=function(e){var t=this.table.modules.comms.getConnections(this.connection);this.table.options.movableRowsSendingStart.call(this.table,t),this.table.modules.comms.send(this.connection,"moveRow","connect",{row:e})},O.prototype.disconnectFromTables=function(){var e=this.table.modules.comms.getConnections(this.connection);this.table.options.movableRowsSendingStop.call(this.table,e),this.table.modules.comms.send(this.connection,"moveRow","disconnect")},O.prototype.connect=function(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(e){"row"===e.type&&e.modules.moveRow&&e.modules.moveRow.mouseup&&e.getElement().addEventListener("mouseup",e.modules.moveRow.mouseup)})),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.table.options.movableRowsReceivingStart.call(this.table,t,e),!0)},O.prototype.disconnect=function(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(e){"row"===e.type&&e.modules.moveRow&&e.modules.moveRow.mouseup&&e.getElement().removeEventListener("mouseup",e.modules.moveRow.mouseup)})),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.table.options.movableRowsReceivingStop.call(this.table,e)):console.warn("Move Row Error - trying to disconnect from non connected table")},O.prototype.dropComplete=function(e,t,o){var i=!1;if(o){switch(s(this.table.options.movableRowsSender)){case"string":i=this.senders[this.table.options.movableRowsSender];break;case"function":i=this.table.options.movableRowsSender}i?i.call(this,this.moving.getComponent(),t?t.getComponent():void 0,e):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.table.options.movableRowsSent.call(this.table,this.moving.getComponent(),t?t.getComponent():void 0,e)}else this.table.options.movableRowsSentFailed.call(this.table,this.moving.getComponent(),t?t.getComponent():void 0,e);this.endMove()},O.prototype.tableRowDrop=function(e,t){var o=!1,i=!1;switch(e.stopImmediatePropagation(),s(this.table.options.movableRowsReceiver)){case"string":o=this.receivers[this.table.options.movableRowsReceiver];break;case"function":o=this.table.options.movableRowsReceiver}o?i=o.call(this,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),i?this.table.options.movableRowsReceived.call(this.table,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):this.table.options.movableRowsReceivedFailed.call(this.table,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable),this.table.modules.comms.send(this.connectedTable,"moveRow","dropcomplete",{row:t,success:i})},O.prototype.receivers={insert:function(e,t,o){return this.table.addRow(e.getData(),void 0,t),!0},add:function(e,t,o){return this.table.addRow(e.getData()),!0},update:function(e,t,o){return!!t&&(t.update(e.getData()),!0)},replace:function(e,t,o){return!!t&&(this.table.addRow(e.getData(),void 0,t),t.delete(),!0)}},O.prototype.senders={delete:function(e,t,o){e.delete()}},O.prototype.commsReceived=function(e,t,o){switch(t){case"connect":return this.connect(e,o.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,o.row,o.success)}},d.prototype.registerModule("moveRow",O);var z=function(e){this.table=e,this.allowedTypes=["","data","edit","clipboard"],this.enabled=!0};z.prototype.initializeColumn=function(e){var t=this,o=!1,i={};this.allowedTypes.forEach((function(n){var r,a="mutator"+(n.charAt(0).toUpperCase()+n.slice(1));e.definition[a]&&(r=t.lookupMutator(e.definition[a]))&&(o=!0,i[a]={mutator:r,params:e.definition[a+"Params"]||{}})})),o&&(e.modules.mutate=i)},z.prototype.lookupMutator=function(e){var t=!1;switch(void 0===e?"undefined":s(e)){case"string":this.mutators[e]?t=this.mutators[e]:console.warn("Mutator Error - No such mutator found, ignoring: ",e);break;case"function":t=e}return t},z.prototype.transformRow=function(e,t,o){var i,n="mutator"+(t.charAt(0).toUpperCase()+t.slice(1));return this.enabled&&this.table.columnManager.traverse((function(r){var a,s,l;r.modules.mutate&&(a=r.modules.mutate[n]||r.modules.mutate.mutator||!1)&&(i=r.getFieldValue(void 0!==o?o:e),"data"!=t&&void 0===i||(l=r.getComponent(),s="function"==typeof a.params?a.params(i,e,t,l):a.params,r.setFieldValue(e,a.mutator(i,e,t,s,l))))})),e},z.prototype.transformCell=function(e,t){var o=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,i={};return o?(i=Object.assign(i,e.row.getData()),e.column.setFieldValue(i,t),o.mutator(t,i,"edit",o.params,e.getComponent())):t},z.prototype.enable=function(){this.enabled=!0},z.prototype.disable=function(){this.enabled=!1},z.prototype.mutators={},d.prototype.registerModule("mutator",z);var I=function(e){this.table=e,this.mode="local",this.progressiveLoad=!1,this.size=0,this.page=1,this.count=5,this.max=1,this.displayIndex=0,this.initialLoad=!0,this.pageSizes=[],this.createElements()};I.prototype.createElements=function(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(e=document.createElement("button")).classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))},I.prototype.generatePageSizeSelectList=function(){var e=this,t=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))t=this.table.options.paginationSizeSelector,this.pageSizes=t,-1==this.pageSizes.indexOf(this.size)&&t.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){t=[];for(var o=1;o<5;o++)t.push(this.size*o);this.pageSizes=t}else t=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);t.forEach((function(t){var o=document.createElement("option");o.value=t,o.innerHTML=t,e.pageSizeSelect.appendChild(o)})),this.pageSizeSelect.value=this.size}},I.prototype.initialize=function(e){var t,o=this;for(var i in o.table.options.paginationDataSent)o.paginationDataSentNames[i]=o.table.options.paginationDataSent[i];for(var n in o.table.options.paginationDataReceived)o.paginationDataReceivedNames[n]=o.table.options.paginationDataReceived[n];o.table.modules.localize.bind("pagination|first",(function(e){o.firstBut.innerHTML=e})),o.table.modules.localize.bind("pagination|first_title",(function(e){o.firstBut.setAttribute("aria-label",e),o.firstBut.setAttribute("title",e)})),o.table.modules.localize.bind("pagination|prev",(function(e){o.prevBut.innerHTML=e})),o.table.modules.localize.bind("pagination|prev_title",(function(e){o.prevBut.setAttribute("aria-label",e),o.prevBut.setAttribute("title",e)})),o.table.modules.localize.bind("pagination|next",(function(e){o.nextBut.innerHTML=e})),o.table.modules.localize.bind("pagination|next_title",(function(e){o.nextBut.setAttribute("aria-label",e),o.nextBut.setAttribute("title",e)})),o.table.modules.localize.bind("pagination|last",(function(e){o.lastBut.innerHTML=e})),o.table.modules.localize.bind("pagination|last_title",(function(e){o.lastBut.setAttribute("aria-label",e),o.lastBut.setAttribute("title",e)})),o.firstBut.addEventListener("click",(function(){o.setPage(1)})),o.prevBut.addEventListener("click",(function(){o.previousPage()})),o.nextBut.addEventListener("click",(function(){o.nextPage().then((function(){})).catch((function(){}))})),o.lastBut.addEventListener("click",(function(){o.setPage(o.max)})),o.table.options.paginationElement&&(o.element=o.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),o.table.modules.localize.bind("pagination|page_size",(function(e){o.pageSizeSelect.setAttribute("aria-label",e),o.pageSizeSelect.setAttribute("title",e),t.innerHTML=e})),o.element.appendChild(t),o.element.appendChild(o.pageSizeSelect),o.pageSizeSelect.addEventListener("change",(function(e){o.setPageSize(o.pageSizeSelect.value),o.setPage(1).then((function(){})).catch((function(){}))}))),o.element.appendChild(o.firstBut),o.element.appendChild(o.prevBut),o.element.appendChild(o.pagesElement),o.element.appendChild(o.nextBut),o.element.appendChild(o.lastBut),o.table.options.paginationElement||e||o.table.footerManager.append(o.element,o),o.mode=o.table.options.pagination,o.size=o.table.options.paginationSize||Math.floor(o.table.rowManager.getElement().clientHeight/24),o.count=o.table.options.paginationButtonCount,o.generatePageSizeSelectList()},I.prototype.initializeProgressive=function(e){this.initialize(!0),this.mode="progressive_"+e,this.progressiveLoad=!0},I.prototype.setDisplayIndex=function(e){this.displayIndex=e},I.prototype.getDisplayIndex=function(){return this.displayIndex},I.prototype.setMaxRows=function(e){this.max=e?Math.ceil(e/this.size):1,this.page>this.max&&(this.page=this.max)},I.prototype.reset=function(e,t){return("local"==this.mode||e)&&(this.page=1),t&&(this.initialLoad=!0),!0},I.prototype.setMaxPage=function(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())},I.prototype.setPage=function(e){var t=this,o=this;return new Promise((function(i,n){(e=parseInt(e))>0&&e<=t.max?(t.page=e,t.trigger().then((function(){i()})).catch((function(){n()})),o.table.options.persistence&&o.table.modExists("persistence",!0)&&o.table.modules.persistence.config.page&&o.table.modules.persistence.save("page")):(console.warn("Pagination Error - Requested page is out of range of 1 - "+t.max+":",e),n())}))},I.prototype.setPageToRow=function(e){var t=this;return new Promise((function(o,i){var n=t.table.rowManager.getDisplayRows(t.displayIndex-1).indexOf(e);if(n>-1){var r=Math.ceil((n+1)/t.size);t.setPage(r).then((function(){o()})).catch((function(){i()}))}else console.warn("Pagination Error - Requested row is not visible"),i()}))},I.prototype.setPageSize=function(e){(e=parseInt(e))>0&&(this.size=e),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.page&&this.table.modules.persistence.save("page")},I.prototype._setPageButtons=function(){for(var e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),o=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),i=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(var n=o;n<=i;n++)n>0&&n<=this.max&&this.pagesElement.appendChild(this._generatePageButton(n));this.footerRedraw()},I.prototype._generatePageButton=function(e){var t=this,o=document.createElement("button");return o.classList.add("tabulator-page"),e==t.page&&o.classList.add("active"),o.setAttribute("type","button"),o.setAttribute("role","button"),o.setAttribute("aria-label","Show Page "+e),o.setAttribute("title","Show Page "+e),o.setAttribute("data-page",e),o.textContent=e,o.addEventListener("click",(function(o){t.setPage(e)})),o},I.prototype.previousPage=function(){var e=this;return new Promise((function(t,o){e.page>1?(e.page--,e.trigger().then((function(){t()})).catch((function(){o()})),e.table.options.persistence&&e.table.modExists("persistence",!0)&&e.table.modules.persistence.config.page&&e.table.modules.persistence.save("page")):(console.warn("Pagination Error - Previous page would be less than page 1:",0),o())}))},I.prototype.nextPage=function(){var e=this;return new Promise((function(t,o){e.page<e.max?(e.page++,e.trigger().then((function(){t()})).catch((function(){o()})),e.table.options.persistence&&e.table.modExists("persistence",!0)&&e.table.modules.persistence.config.page&&e.table.modules.persistence.save("page")):(e.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+e.max+":",e.max+1),o())}))},I.prototype.getPage=function(){return this.page},I.prototype.getPageMax=function(){return this.max},I.prototype.getPageSize=function(e){return this.size},I.prototype.getMode=function(){return this.mode},I.prototype.getRows=function(e){var t,o,i;if("local"==this.mode){t=[],i=(o=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(var n=o;n<i;n++)e[n]&&t.push(e[n]);return t}return this._setPageButtons(),e.slice(0)},I.prototype.trigger=function(){var e,t=this;return new Promise((function(o,i){switch(t.mode){case"local":e=t.table.rowManager.scrollLeft,t.table.rowManager.refreshActiveData("page"),t.table.rowManager.scrollHorizontal(e),t.table.options.pageLoaded.call(t.table,t.getPage()),o();break;case"remote":case"progressive_load":case"progressive_scroll":t.table.modules.ajax.blockActiveRequest(),t._getRemotePage().then((function(){o()})).catch((function(){i()}));break;default:console.warn("Pagination Error - no such pagination mode:",t.mode),i()}}))},I.prototype._getRemotePage=function(){var e,t,o=this,i=this;return new Promise((function(n,r){if(i.table.modExists("ajax",!0)||r(),e=d.prototype.helpers.deepClone(i.table.modules.ajax.getParams()||{}),(t=i.table.modules.ajax.getParams())[o.paginationDataSentNames.page]=i.page,o.size&&(t[o.paginationDataSentNames.size]=o.size),o.table.options.ajaxSorting&&o.table.modExists("sort")){var a=i.table.modules.sort.getSort();a.forEach((function(e){delete e.column})),t[o.paginationDataSentNames.sorters]=a}if(o.table.options.ajaxFiltering&&o.table.modExists("filter")){var s=i.table.modules.filter.getFilters(!0,!0);t[o.paginationDataSentNames.filters]=s}i.table.modules.ajax.setParams(t),i.table.modules.ajax.sendRequest(o.progressiveLoad).then((function(e){i._parseRemoteData(e),n()})).catch((function(e){r()})),i.table.modules.ajax.setParams(e)}))},I.prototype._parseRemoteData=function(e){var t,o,i=this;if(void 0===e[this.paginationDataReceivedNames.last_page]&&console.warn("Remote Pagination Error - Server response missing '"+this.paginationDataReceivedNames.last_page+"' property"),e[this.paginationDataReceivedNames.data]){if(this.max=parseInt(e[this.paginationDataReceivedNames.last_page])||1,this.progressiveLoad)switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(e[this.paginationDataReceivedNames.data],!1,this.initialLoad&&1==this.page):this.table.rowManager.addRows(e[this.paginationDataReceivedNames.data]),this.page<this.max&&setTimeout((function(){i.nextPage().then((function(){})).catch((function(){}))}),i.table.options.ajaxProgressiveLoadDelay);break;case"progressive_scroll":e=this.table.rowManager.getData().concat(e[this.paginationDataReceivedNames.data]),this.table.rowManager.setData(e,!0,this.initialLoad&&1==this.page),o=this.table.options.ajaxProgressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight,i.table.rowManager.element.scrollHeight<=i.table.rowManager.element.clientHeight+o&&i.nextPage().then((function(){})).catch((function(){}))}else t=this.table.rowManager.scrollLeft,this.table.rowManager.setData(e[this.paginationDataReceivedNames.data],!1,this.initialLoad&&1==this.page),this.table.rowManager.scrollHorizontal(t),this.table.columnManager.scrollHorizontal(t),this.table.options.pageLoaded.call(this.table,this.getPage());this.initialLoad=!1}else console.warn("Remote Pagination Error - Server response missing '"+this.paginationDataReceivedNames.data+"' property")},I.prototype.footerRedraw=function(){var e=this.table.footerManager.element;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))},I.prototype.paginationDataSentNames={page:"page",size:"size",sorters:"sorters",filters:"filters"},I.prototype.paginationDataReceivedNames={current_page:"current_page",last_page:"last_page",data:"data"},d.prototype.registerModule("page",I);var j=function(e){this.table=e,this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1};j.prototype.localStorageTest=function(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}},j.prototype.initialize=function(){var e,t=this.table.options.persistenceMode,o=this.table.options.persistenceID;this.mode=!0!==t?t:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:this.readers[this.table.options.persistenceReaderFunc]?this.readFunc=this.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):this.readers[this.mode]?this.readFunc=this.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:this.readers[this.table.options.persistenceWriterFunc]?this.writeFunc=this.readers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):this.writers[this.mode]?this.writeFunc=this.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(o||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(e=this.retreiveData("page"))&&(void 0===e.paginationSize||!0!==this.config.page&&!this.config.page.size||(this.table.options.paginationSize=e.paginationSize),void 0===e.paginationInitialPage||!0!==this.config.page&&!this.config.page.page||(this.table.options.paginationInitialPage=e.paginationInitialPage)),this.config.group&&(e=this.retreiveData("group"))&&(void 0===e.groupBy||!0!==this.config.group&&!this.config.group.groupBy||(this.table.options.groupBy=e.groupBy),void 0===e.groupStartOpen||!0!==this.config.group&&!this.config.group.groupStartOpen||(this.table.options.groupStartOpen=e.groupStartOpen),void 0===e.groupHeader||!0!==this.config.group&&!this.config.group.groupHeader||(this.table.options.groupHeader=e.groupHeader))},j.prototype.initializeColumn=function(e){var t,o=this;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),(!0===this.config.columns?Object.keys(t):this.config.columns).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e),n=t[e];i&&Object.defineProperty(t,e,{set:function(e){n=e,o.defWatcherBlock||o.save("columns"),i.set&&i.set(e)},get:function(){return i.get&&i.get(),n}})})),this.defWatcherBlock=!1)},j.prototype.load=function(e,t){var o=this.retreiveData(e);return t&&(o=o?this.mergeDefinition(t,o):t),o},j.prototype.retreiveData=function(e){return!!this.readFunc&&this.readFunc(this.id,e)},j.prototype.mergeDefinition=function(e,t){var o=this,i=[];return(t=t||[]).forEach((function(t,n){var r,a=o._findColumn(e,t);a&&(!0===o.config.columns||null==o.config.columns?(r=Object.keys(a)).push("width"):r=o.config.columns,r.forEach((function(e){void 0!==t[e]&&(a[e]=t[e])})),a.columns&&(a.columns=o.mergeDefinition(a.columns,t.columns)),i.push(a))})),e.forEach((function(e,n){o._findColumn(t,e)||(i.length>n?i.splice(n,0,e):i.push(e))})),i},j.prototype._findColumn=function(e,t){var o=t.columns?"group":t.field?"field":"object";return e.find((function(e){switch(o){case"group":return e.title===t.title&&e.columns.length===t.columns.length;case"field":return e.field===t.field;case"object":return e===t}}))},j.prototype.save=function(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,e,t)},j.prototype.validateSorters=function(e){return e.forEach((function(e){e.column=e.field,delete e.field})),e},j.prototype.getGroupConfig=function(){return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(data.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(data.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(data.groupHeader=this.table.options.groupHeader)),data},j.prototype.getPageConfig=function(){var e={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e},j.prototype.parseColumns=function(e){var t=this,o=[];return e.forEach((function(e){var i,n={},r=e.getDefinition();e.isGroup?(n.title=r.title,n.columns=t.parseColumns(e.getColumns())):(n.field=e.getField(),!0===t.config.columns||null==t.config.columns?(i=Object.keys(r)).push("width"):i=t.config.columns,i.forEach((function(t){switch(t){case"width":n.width=e.getWidth();break;case"visible":n.visible=e.visible;break;default:n[t]=r[t]}}))),o.push(n)})),o},j.prototype.readers={local:function(e,t){var o=localStorage.getItem(e+"-"+t);return!!o&&JSON.parse(o)},cookie:function(e,t){var o,i,n=document.cookie,r=e+"-"+t,a=n.indexOf(r+"=");return a>-1&&(n=n.substr(a),(o=n.indexOf(";"))>-1&&(n=n.substr(0,o)),i=n.replace(r+"=","")),!!i&&JSON.parse(i)}},j.prototype.writers={local:function(e,t,o){localStorage.setItem(e+"-"+t,JSON.stringify(o))},cookie:function(e,t,o){var i=new Date;i.setDate(i.getDate()+1e4),document.cookie=e+"-"+t+"="+JSON.stringify(o)+"; expires="+i.toUTCString()}},d.prototype.registerModule("persistence",j);var N=function(e){this.table=e,this.element=!1,this.manualBlock=!1};N.prototype.initialize=function(){window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))},N.prototype.replaceTable=function(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.genereateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))},N.prototype.cleanup=function(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")},N.prototype.printFullscreen=function(e,t,o){var i,n,r=window.scrollX,a=window.scrollY,s=document.createElement("div"),l=document.createElement("div"),c=this.table.modules.export.genereateTable(void 0!==o?o:this.table.options.printConfig,void 0!==t?t:this.table.options.printStyled,e,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(s.classList.add("tabulator-print-header"),"string"==typeof(i="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?s.innerHTML=i:s.appendChild(i),this.element.appendChild(s)),this.element.appendChild(c),this.table.options.printFooter&&(l.classList.add("tabulator-print-footer"),"string"==typeof(n="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?l.innerHTML=n:l.appendChild(n),this.element.appendChild(l)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,c),window.print(),this.cleanup(),window.scrollTo(r,a),this.manualBlock=!1},d.prototype.registerModule("print",N);var H=function(e){this.table=e,this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0};H.prototype.watchData=function(e){var t,o=this;this.currentVersion++,t=this.currentVersion,o.unwatchData(),o.data=e,o.origFuncs.push=e.push,Object.defineProperty(o.data,"push",{enumerable:!1,configurable:!0,value:function(){var i=Array.from(arguments);return o.blocked||t!==o.currentVersion||i.forEach((function(e){o.table.rowManager.addRowActual(e,!1)})),o.origFuncs.push.apply(e,arguments)}}),o.origFuncs.unshift=e.unshift,Object.defineProperty(o.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var i=Array.from(arguments);return o.blocked||t!==o.currentVersion||i.forEach((function(e){o.table.rowManager.addRowActual(e,!0)})),o.origFuncs.unshift.apply(e,arguments)}}),o.origFuncs.shift=e.shift,Object.defineProperty(o.data,"shift",{enumerable:!1,configurable:!0,value:function(){var i;return o.blocked||t!==o.currentVersion||o.data.length&&(i=o.table.rowManager.getRowFromDataObject(o.data[0]))&&i.deleteActual(),o.origFuncs.shift.call(e)}}),o.origFuncs.pop=e.pop,Object.defineProperty(o.data,"pop",{enumerable:!1,configurable:!0,value:function(){var i;return o.blocked||t!==o.currentVersion||o.data.length&&(i=o.table.rowManager.getRowFromDataObject(o.data[o.data.length-1]))&&i.deleteActual(),o.origFuncs.pop.call(e)}}),o.origFuncs.splice=e.splice,Object.defineProperty(o.data,"splice",{enumerable:!1,configurable:!0,value:function(){var i,n=Array.from(arguments),r=n[0]<0?e.length+n[0]:n[0],a=n[1],s=!!n[2]&&n.slice(2);if(!o.blocked&&t===o.currentVersion){if(s&&((i=!!e[r]&&o.table.rowManager.getRowFromDataObject(e[r]))?s.forEach((function(e){o.table.rowManager.addRowActual(e,!0,i,!0)})):(s=s.slice().reverse()).forEach((function(e){o.table.rowManager.addRowActual(e,!0,!1,!0)}))),0!==a){var l=e.slice(r,void 0===n[1]?n[1]:r+a);l.forEach((function(e,t){var i=o.table.rowManager.getRowFromDataObject(e);i&&i.deleteActual(t!==l.length-1)}))}(s||0!==a)&&o.table.rowManager.reRenderInPosition()}return o.origFuncs.splice.apply(e,arguments)}})},H.prototype.unwatchData=function(){if(!1!==this.data)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})},H.prototype.watchRow=function(e){var t=e.getData();for(var o in this.blocked=!0,t)this.watchKey(e,t,o);this.blocked=!1},H.prototype.watchKey=function(e,t,o){var i=this,n=Object.getOwnPropertyDescriptor(t,o),r=t[o],a=this.currentVersion;Object.defineProperty(t,o,{set:function(t){if(r=t,!i.blocked&&a===i.currentVersion){var s={};s[o]=t,e.updateData(s)}n.set&&n.set(t)},get:function(){return n.get&&n.get(),r}})},H.prototype.unwatchRow=function(e){var t=e.getData();for(var o in t)Object.defineProperty(t,o,{value:t[o]})},H.prototype.block=function(){this.blocked=!0},H.prototype.unblock=function(){this.blocked=!1},d.prototype.registerModule("reactiveData",H);var B=function(e){this.table=e,this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.handle=null,this.prevHandle=null};B.prototype.initializeColumn=function(e,t,o){var i=this,n=!1,r=this.table.options.resizableColumns;if("header"===e&&(n="textarea"==t.definition.formatter||t.definition.variableHeight,t.modules.resize={variableHeight:n}),!0===r||r==e){var a=document.createElement("div");a.className="tabulator-col-resize-handle";var s=document.createElement("div");s.className="tabulator-col-resize-handle prev",a.addEventListener("click",(function(e){e.stopPropagation()}));var l=function(e){var o=t.getLastColumn();o&&i._checkResizability(o)&&(i.startColumn=t,i._mouseDown(e,o,a))};a.addEventListener("mousedown",l),a.addEventListener("touchstart",l,{passive:!0}),a.addEventListener("dblclick",(function(e){var o=t.getLastColumn();o&&i._checkResizability(o)&&(e.stopPropagation(),o.reinitializeWidth(!0))})),s.addEventListener("click",(function(e){e.stopPropagation()}));var c=function(e){var o,n,r;(o=t.getFirstColumn())&&(r=(n=i.table.columnManager.findColumnIndex(o))>0&&i.table.columnManager.getColumnByIndex(n-1))&&i._checkResizability(r)&&(i.startColumn=t,i._mouseDown(e,r,s))};s.addEventListener("mousedown",c),s.addEventListener("touchstart",c,{passive:!0}),s.addEventListener("dblclick",(function(e){var o,n,r;(o=t.getFirstColumn())&&(r=(n=i.table.columnManager.findColumnIndex(o))>0&&i.table.columnManager.getColumnByIndex(n-1))&&i._checkResizability(r)&&(e.stopPropagation(),r.reinitializeWidth(!0))})),o.appendChild(a),o.appendChild(s)}},B.prototype._checkResizability=function(e){return void 0!==e.definition.resizable?e.definition.resizable:this.table.options.resizableColumns},B.prototype._mouseDown=function(e,t,o){var i=this;function n(e){t.setWidth(i.startWidth+((void 0===e.screenX?e.touches[0].screenX:e.screenX)-i.startX)),!i.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}function r(e){i.startColumn.modules.edit&&(i.startColumn.modules.edit.blocked=!1),i.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",r),document.body.removeEventListener("mousemove",n),o.removeEventListener("touchmove",n),o.removeEventListener("touchend",r),i.table.element.classList.remove("tabulator-block-select"),i.table.options.persistence&&i.table.modExists("persistence",!0)&&i.table.modules.persistence.config.columns&&i.table.modules.persistence.save("columns"),i.table.options.columnResized.call(i.table,t.getComponent())}i.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),i.startColumn.modules.edit&&(i.startColumn.modules.edit.blocked=!0),i.startX=void 0===e.screenX?e.touches[0].screenX:e.screenX,i.startWidth=t.getWidth(),document.body.addEventListener("mousemove",n),document.body.addEventListener("mouseup",r),o.addEventListener("touchmove",n,{passive:!0}),o.addEventListener("touchend",r)},d.prototype.registerModule("resizeColumns",B);var V=function(e){this.table=e,this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null};V.prototype.initializeRow=function(e){var t=this,o=e.getElement(),i=document.createElement("div");i.className="tabulator-row-resize-handle";var n=document.createElement("div");n.className="tabulator-row-resize-handle prev",i.addEventListener("click",(function(e){e.stopPropagation()}));var r=function(o){t.startRow=e,t._mouseDown(o,e,i)};i.addEventListener("mousedown",r),i.addEventListener("touchstart",r,{passive:!0}),n.addEventListener("click",(function(e){e.stopPropagation()}));var a=function(o){var i=t.table.rowManager.prevDisplayRow(e);i&&(t.startRow=i,t._mouseDown(o,i,n))};n.addEventListener("mousedown",a),n.addEventListener("touchstart",a,{passive:!0}),o.appendChild(i),o.appendChild(n)},V.prototype._mouseDown=function(e,t,o){var i=this;function n(e){t.setHeight(i.startHeight+((void 0===e.screenY?e.touches[0].screenY:e.screenY)-i.startY))}function r(e){document.body.removeEventListener("mouseup",n),document.body.removeEventListener("mousemove",n),o.removeEventListener("touchmove",n),o.removeEventListener("touchend",r),i.table.element.classList.remove("tabulator-block-select"),i.table.options.rowResized.call(this.table,t.getComponent())}i.table.element.classList.add("tabulator-block-select"),e.stopPropagation(),i.startY=void 0===e.screenY?e.touches[0].screenY:e.screenY,i.startHeight=t.getHeight(),document.body.addEventListener("mousemove",n),document.body.addEventListener("mouseup",r),o.addEventListener("touchmove",n,{passive:!0}),o.addEventListener("touchend",r)},d.prototype.registerModule("resizeRows",V);var W=function(e){this.table=e,this.binding=!1,this.observer=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1};W.prototype.initialize=function(e){var t,o=this,i=this.table;this.tableHeight=i.element.clientHeight,this.tableWidth=i.element.clientWidth,i.element.parentNode&&(this.containerHeight=i.element.parentNode.clientHeight,this.containerWidth=i.element.parentNode.clientWidth),"undefined"!=typeof ResizeObserver&&"virtual"===i.rowManager.getRenderMode()?(this.autoResize=!0,this.observer=new ResizeObserver((function(e){if(!i.browserMobile||i.browserMobile&&!i.modules.edit.currentCell){var t=Math.floor(e[0].contentRect.height),n=Math.floor(e[0].contentRect.width);o.tableHeight==t&&o.tableWidth==n||(o.tableHeight=t,o.tableWidth=n,i.element.parentNode&&(o.containerHeight=i.element.parentNode.clientHeight,o.containerWidth=i.element.parentNode.clientWidth),i.redraw())}})),this.observer.observe(i.element),t=window.getComputedStyle(i.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver((function(e){if(!i.browserMobile||i.browserMobile&&!i.modules.edit.currentCell){var t=Math.floor(e[0].contentRect.height),n=Math.floor(e[0].contentRect.width);o.containerHeight==t&&o.containerWidth==n||(o.containerHeight=t,o.containerWidth=n,o.tableHeight=i.element.clientHeight,o.tableWidth=i.element.clientWidth,i.redraw()),i.redraw()}})),this.containerObserver.observe(this.table.element.parentNode))):(this.binding=function(){(!i.browserMobile||i.browserMobile&&!i.modules.edit.currentCell)&&i.redraw()},window.addEventListener("resize",this.binding))},W.prototype.clearBindings=function(e){this.binding&&window.removeEventListener("resize",this.binding),this.observer&&this.observer.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)},d.prototype.registerModule("resizeTable",W);var $=function(e){this.table=e,this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1};$.prototype.initialize=function(){var e=this,t=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach((function(o,i){o.modules.responsive&&o.modules.responsive.order&&o.modules.responsive.visible&&(o.modules.responsive.index=i,t.push(o),o.visible||"collapse"!==e.mode||e.hiddenColumns.push(o))})),t=(t=t.reverse()).sort((function(e,t){return t.modules.responsive.order-e.modules.responsive.order||t.modules.responsive.index-e.modules.responsive.index})),this.columns=t,"collapse"===this.mode&&this.generateCollapsedContent();var o=this.table.columnManager.columnsByIndex,i=Array.isArray(o),n=0;for(o=i?o:o[Symbol.iterator]();;){var r;if(i){if(n>=o.length)break;r=o[n++]}else{if((n=o.next()).done)break;r=n.value}var a=r;if("responsiveCollapse"==a.definition.formatter){this.collapseHandleColumn=a;break}}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())},$.prototype.initializeColumn=function(e){var t=e.getDefinition();e.modules.responsive={order:void 0===t.responsive?1:t.responsive,visible:!1!==t.visible}},$.prototype.initializeRow=function(e){var t;"calc"!==e.type&&((t=document.createElement("div")).classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))},$.prototype.layoutRow=function(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))},$.prototype.updateColumnVisibility=function(e,t){e.modules.responsive&&(e.modules.responsive.visible=t,this.initialize())},$.prototype.hideColumn=function(e){var t=this.hiddenColumns.length;e.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())},$.prototype.showColumn=function(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),"collapse"===this.mode&&((t=this.hiddenColumns.indexOf(e))>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())},$.prototype.update=function(){for(var e=!0;e;){var t="fitColumns"==this.table.modules.layout.getMode()?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),o=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(o<0){var i=this.columns[this.index];i?(this.hideColumn(i),this.index++):e=!1}else{var n=this.columns[this.index-1];n&&o>0&&o>=n.getWidth()?(this.showColumn(n),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}},$.prototype.generateCollapsedContent=function(){var e=this;this.table.rowManager.getDisplayRows().forEach((function(t){e.generateCollapsedRowContent(t)}))},$.prototype.generateCollapsedRowContent=function(e){var t,o;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);(o=this.collapseFormatter(this.generateCollapsedRowData(e)))&&t.appendChild(o)}},$.prototype.generateCollapsedRowData=function(e){var t,o=this,i=e.getData(),n=[];return this.hiddenColumns.forEach((function(r){var a=r.getFieldValue(i);r.definition.title&&r.field&&(r.modules.format&&o.table.options.responsiveLayoutCollapseUseFormatters?(t={value:!1,data:{},getValue:function(){return a},getData:function(){return i},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return r.getComponent()}},n.push({title:r.definition.title,value:r.modules.format.formatter.call(o.table.modules.format,t,r.modules.format.params)})):n.push({title:r.definition.title,value:a}))})),n},$.prototype.formatCollapsedData=function(e){var t=document.createElement("table"),o="";return e.forEach((function(e){var t=document.createElement("div");e.value instanceof Node&&(t.appendChild(e.value),e.value=t.innerHTML),o+="<tr><td><strong>"+e.title+"</strong></td><td>"+e.value+"</td></tr>"})),t.innerHTML=o,Object.keys(e).length?t:""},d.prototype.registerModule("responsiveLayout",$);var G=function(e){this.table=e,this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null};G.prototype.clearSelectionData=function(e){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],e||this._rowSelectionChanged()},G.prototype.initializeRow=function(e){var t=this,o=e.getElement(),i=function e(){setTimeout((function(){t.selecting=!1}),50),document.body.removeEventListener("mouseup",e)};e.modules.select={selected:!1},t.table.options.selectableCheck.call(this.table,e.getComponent())?(o.classList.add("tabulator-selectable"),o.classList.remove("tabulator-unselectable"),t.table.options.selectable&&"highlight"!=t.table.options.selectable&&("click"===t.table.options.selectableRangeMode?o.addEventListener("click",(function(o){if(o.shiftKey){t.table._clearSelection(),t.lastClickedRow=t.lastClickedRow||e;var i=t.table.rowManager.getDisplayRowIndex(t.lastClickedRow),n=t.table.rowManager.getDisplayRowIndex(e),r=i<=n?i:n,a=i>=n?i:n,s=t.table.rowManager.getDisplayRows().slice(0).splice(r,a-r+1);o.ctrlKey||o.metaKey?(s.forEach((function(o){o!==t.lastClickedRow&&(!0===t.table.options.selectable||t.isRowSelected(e)||t.selectedRows.length<t.table.options.selectable)&&t.toggleRow(o)})),t.lastClickedRow=e):(t.deselectRows(void 0,!0),!0!==t.table.options.selectable&&s.length>t.table.options.selectable&&(s=s.slice(0,t.table.options.selectable)),t.selectRows(s)),t.table._clearSelection()}else o.ctrlKey||o.metaKey?(t.toggleRow(e),t.lastClickedRow=e):(t.deselectRows(void 0,!0),t.selectRows(e),t.lastClickedRow=e)})):(o.addEventListener("click",(function(o){t.table.modExists("edit")&&t.table.modules.edit.getCurrentCell()||t.table._clearSelection(),t.selecting||t.toggleRow(e)})),o.addEventListener("mousedown",(function(o){if(o.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",i),document.body.addEventListener("keyup",i),t.toggleRow(e),!1})),o.addEventListener("mouseenter",(function(o){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))})),o.addEventListener("mouseout",(function(o){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))}))))):(o.classList.add("tabulator-unselectable"),o.classList.remove("tabulator-selectable"))},G.prototype.toggleRow=function(e){this.table.options.selectableCheck.call(this.table,e.getComponent())&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))},G.prototype.selectRows=function(e){var t,o=this;switch(void 0===e?"undefined":s(e)){case"undefined":this.table.rowManager.rows.forEach((function(e){o._selectRow(e,!0,!0)})),this._rowSelectionChanged();break;case"string":(t=this.table.rowManager.findRow(e))?this._selectRow(t,!0,!0):this.table.rowManager.getRows(e).forEach((function(e){o._selectRow(e,!0,!0)})),this._rowSelectionChanged();break;default:Array.isArray(e)?(e.forEach((function(e){o._selectRow(e,!0,!0)})),this._rowSelectionChanged()):this._selectRow(e,!1,!0)}},G.prototype._selectRow=function(e,t,o){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!o&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var i=this.table.rowManager.findRow(e);i?-1==this.selectedRows.indexOf(i)&&(i.modules.select||(i.modules.select={}),i.modules.select.selected=!0,i.modules.select.checkboxEl&&(i.modules.select.checkboxEl.checked=!0),i.getElement().classList.add("tabulator-selected"),this.selectedRows.push(i),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(i,!0),t||this.table.options.rowSelected.call(this.table,i.getComponent()),this._rowSelectionChanged(t)):t||console.warn("Selection Error - No such row found, ignoring selection:"+e)},G.prototype.isRowSelected=function(e){return-1!==this.selectedRows.indexOf(e)},G.prototype.deselectRows=function(e,t){var o,i=this;if(void 0===e){o=i.selectedRows.length;for(var n=0;n<o;n++)i._deselectRow(i.selectedRows[0],!0);i._rowSelectionChanged(t)}else Array.isArray(e)?(e.forEach((function(e){i._deselectRow(e,!0)})),i._rowSelectionChanged(t)):i._deselectRow(e,t)},G.prototype._deselectRow=function(e,t){var o,i=this.table.rowManager.findRow(e);i?(o=this.selectedRows.findIndex((function(e){return e==i})))>-1&&(i.modules.select||(i.modules.select={}),i.modules.select.selected=!1,i.modules.select.checkboxEl&&(i.modules.select.checkboxEl.checked=!1),i.getElement().classList.remove("tabulator-selected"),this.selectedRows.splice(o,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(i,!1),t||this.table.options.rowDeselected.call(this.table,i.getComponent()),this._rowSelectionChanged(t)):t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)},G.prototype.getSelectedData=function(){var e=[];return this.selectedRows.forEach((function(t){e.push(t.getData())})),e},G.prototype.getSelectedRows=function(){var e=[];return this.selectedRows.forEach((function(t){e.push(t.getComponent())})),e},G.prototype._rowSelectionChanged=function(e){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||this.table.options.rowSelectionChanged.call(this.table,this.getSelectedData(),this.getSelectedRows())},G.prototype.registerRowSelectCheckbox=function(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t},G.prototype.registerHeaderSelectCheckbox=function(e){this.headerCheckboxElement=e},G.prototype.childRowSelection=function(e,t){var o=this.table.modules.dataTree.getChildren(e);if(t){var i=o,n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var a;if(n){if(r>=i.length)break;a=i[r++]}else{if((r=i.next()).done)break;a=r.value}var s=a;this._selectRow(s,!0)}}else{var l=o,c=Array.isArray(l),u=0;for(l=c?l:l[Symbol.iterator]();;){var d;if(c){if(u>=l.length)break;d=l[u++]}else{if((u=l.next()).done)break;d=u.value}var h=d;this._deselectRow(h,!0)}}},d.prototype.registerModule("selectRow",G);var q=function(e){this.table=e,this.sortList=[],this.changed=!1};q.prototype.initializeColumn=function(e,t){var o,i,n=this,r=!1;switch(s(e.definition.sorter)){case"string":n.sorters[e.definition.sorter]?r=n.sorters[e.definition.sorter]:console.warn("Sort Error - No such sorter found: ",e.definition.sorter);break;case"function":r=e.definition.sorter}e.modules.sort={sorter:r,dir:"none",params:e.definition.sorterParams||{},startingDir:e.definition.headerSortStartingDir||"asc",tristate:void 0!==e.definition.headerSortTristate?e.definition.headerSortTristate:this.table.options.headerSortTristate},(void 0===e.definition.headerSort?!1!==this.table.options.headerSort:!1!==e.definition.headerSort)&&((o=e.getElement()).classList.add("tabulator-sortable"),(i=document.createElement("div")).classList.add("tabulator-arrow"),t.appendChild(i),o.addEventListener("click",(function(t){var o="",i=[],r=!1;if(e.modules.sort){if(e.modules.sort.tristate)o="none"==e.modules.sort.dir?e.modules.sort.startingDir:e.modules.sort.dir==e.modules.sort.startingDir?"asc"==e.modules.sort.dir?"desc":"asc":"none";else switch(e.modules.sort.dir){case"asc":o="desc";break;case"desc":o="asc";break;default:o=e.modules.sort.startingDir}n.table.options.columnHeaderSortMulti&&(t.shiftKey||t.ctrlKey)?((r=(i=n.getSort()).findIndex((function(t){return t.field===e.getField()})))>-1?(i[r].dir=o,r!=i.length-1&&(r=i.splice(r,1)[0],"none"!=o&&i.push(r))):"none"!=o&&i.push({column:e,dir:o}),n.setSort(i)):"none"==o?n.clear():n.setSort(e,o),n.table.rowManager.sorterRefresh(!n.sortList.length)}})))},q.prototype.hasChanged=function(){var e=this.changed;return this.changed=!1,e},q.prototype.getSort=function(){var e=[];return this.sortList.forEach((function(t){t.column&&e.push({column:t.column.getComponent(),field:t.column.getField(),dir:t.dir})})),e},q.prototype.setSort=function(e,t){var o=this,i=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach((function(e){var t;(t=o.table.columnManager.findColumn(e.column))?(e.column=t,i.push(e),o.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",e.column)})),o.sortList=i,this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.sort&&this.table.modules.persistence.save("sort")},q.prototype.clear=function(){this.setSort([])},q.prototype.findSorter=function(e){var t,o=this.table.rowManager.activeRows[0],i="string";if(o&&(o=o.getData(),e.getField()))switch(void 0===(t=e.getFieldValue(o))?"undefined":s(t)){case"undefined":i="string";break;case"boolean":i="boolean";break;default:isNaN(t)||""===t?t.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(i="alphanum"):i="number"}return this.sorters[i]},q.prototype.sort=function(e){var t,o=this;t=this.table.options.sortOrderReverse?o.sortList.slice().reverse():o.sortList,o.table.options.dataSorting&&o.table.options.dataSorting.call(o.table,o.getSort()),o.clearColumnHeaders(),o.table.options.ajaxSorting?t.forEach((function(e,t){o.setColumnHeader(e.column,e.dir)})):t.forEach((function(i,n){i.column&&i.column.modules.sort&&(i.column.modules.sort.sorter||(i.column.modules.sort.sorter=o.findSorter(i.column)),o._sortItem(e,i.column,i.dir,t,n)),o.setColumnHeader(i.column,i.dir)})),o.table.options.dataSorted&&o.table.options.dataSorted.call(o.table,o.getSort(),o.table.rowManager.getComponents("active"))},q.prototype.clearColumnHeaders=function(){this.table.columnManager.getRealColumns().forEach((function(e){e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"))}))},q.prototype.setColumnHeader=function(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t)},q.prototype._sortItem=function(e,t,o,i,n){var r=this,a="function"==typeof t.modules.sort.params?t.modules.sort.params(t.getComponent(),o):t.modules.sort.params;e.sort((function(e,s){var l=r._sortRow(e,s,t,o,a);if(0===l&&n)for(var c=n-1;c>=0&&0===(l=r._sortRow(e,s,i[c].column,i[c].dir,a));c--);return l}))},q.prototype._sortRow=function(e,t,o,i,n){var r,a,s="asc"==i?e:t,l="asc"==i?t:e;return e=void 0!==(e=o.getFieldValue(s.getData()))?e:"",t=void 0!==(t=o.getFieldValue(l.getData()))?t:"",r=s.getComponent(),a=l.getComponent(),o.modules.sort.sorter.call(this,e,t,r,a,o.getComponent(),i,n)},q.prototype.sorters={number:function(e,t,o,i,n,r,a){var s=a.alignEmptyValues,l=a.decimalSeparator||".",c=a.thousandSeparator||",",u=0;if(e=parseFloat(String(e).split(c).join("").split(l).join(".")),t=parseFloat(String(t).split(c).join("").split(l).join(".")),isNaN(e))u=isNaN(t)?0:-1;else{if(!isNaN(t))return e-t;u=1}return("top"===s&&"desc"===r||"bottom"===s&&"asc"===r)&&(u*=-1),u},string:function(e,t,o,i,n,r,a){var l,c=a.alignEmptyValues,u=0;if(e){if(t){switch(s(a.locale)){case"boolean":a.locale&&(l=this.table.modules.localize.getLocale());break;case"string":l=a.locale}return String(e).toLowerCase().localeCompare(String(t).toLowerCase(),l)}u=1}else u=t?-1:0;return("top"===c&&"desc"===r||"bottom"===c&&"asc"===r)&&(u*=-1),u},date:function(e,t,o,i,n,r,a){return a.format||(a.format="DD/MM/YYYY"),this.sorters.datetime.call(this,e,t,o,i,n,r,a)},time:function(e,t,o,i,n,r,a){return a.format||(a.format="hh:mm"),this.sorters.datetime.call(this,e,t,o,i,n,r,a)},datetime:function(e,t,o,i,n,r,a){var s=a.format||"DD/MM/YYYY hh:mm:ss",l=a.alignEmptyValues,c=0;if("undefined"!=typeof moment){if(e=moment(e,s),t=moment(t,s),e.isValid()){if(t.isValid())return e-t;c=1}else c=t.isValid()?-1:0;return("top"===l&&"desc"===r||"bottom"===l&&"asc"===r)&&(c*=-1),c}console.error("Sort Error - 'datetime' sorter is dependant on moment.js")},boolean:function(e,t,o,i,n,r,a){return(!0===e||"true"===e||"True"===e||1===e?1:0)-(!0===t||"true"===t||"True"===t||1===t?1:0)},array:function(e,t,o,i,n,r,a){var s=a.type||"length",l=a.alignEmptyValues,c=0;function u(e){switch(s){case"length":return e.length;case"sum":return e.reduce((function(e,t){return e+t}));case"max":return Math.max.apply(null,e);case"min":return Math.min.apply(null,e);case"avg":return e.reduce((function(e,t){return e+t}))/e.length}}if(Array.isArray(e)){if(Array.isArray(t))return(e?u(e):0)-(t?u(t):0);l=1}else l=Array.isArray(t)?-1:0;return("top"===l&&"desc"===r||"bottom"===l&&"asc"===r)&&(c*=-1),c},exists:function(e,t,o,i,n,r,a){return(void 0===e?0:1)-(void 0===t?0:1)},alphanum:function(e,t,o,i,n,r,a){var s,l,c,u,d,h=0,p=/(\d+)|(\D+)/g,f=/\d/,m=a.alignEmptyValues,g=0;if(e||0===e){if(t||0===t){if(isFinite(e)&&isFinite(t))return e-t;if((s=String(e).toLowerCase())===(l=String(t).toLowerCase()))return 0;if(!f.test(s)||!f.test(l))return s>l?1:-1;for(s=s.match(p),l=l.match(p),d=s.length>l.length?l.length:s.length;h<d;)if((c=s[h])!==(u=l[h++]))return isFinite(c)&&isFinite(u)?("0"===c.charAt(0)&&(c="."+c),"0"===u.charAt(0)&&(u="."+u),c-u):c>u?1:-1;return s.length>l.length}g=1}else g=t||0===t?-1:0;return("top"===m&&"desc"===r||"bottom"===m&&"asc"===r)&&(g*=-1),g}},d.prototype.registerModule("sort",q);var Y=function(e){this.table=e};return Y.prototype.initializeColumn=function(e){var t,o=this,i=[];e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach((function(e){(t=o._extractValidator(e))&&i.push(t)})):(t=this._extractValidator(e.definition.validator))&&i.push(t),e.modules.validate=!!i.length&&i)},Y.prototype._extractValidator=function(e){var t,o,i;switch(void 0===e?"undefined":s(e)){case"string":return(i=e.indexOf(":"))>-1?(t=e.substring(0,i),o=e.substring(i+1)):t=e,this._buildValidator(t,o);case"function":return this._buildValidator(e);case"object":return this._buildValidator(e.type,e.parameters)}},Y.prototype._buildValidator=function(e,t){var o="function"==typeof e?e:this.validators[e];return o?{type:"function"==typeof e?"function":e,func:o,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)},Y.prototype.validate=function(e,t,o){var i=this,n=[];return e&&e.forEach((function(e){e.func.call(i,t,o,e.params)||n.push({type:e.type,parameters:e.params})})),!n.length||n},Y.prototype.validators={integer:function(e,t,o){return""===t||null==t||"number"==typeof(t=Number(t))&&isFinite(t)&&Math.floor(t)===t},float:function(e,t,o){return""===t||null==t||"number"==typeof(t=Number(t))&&isFinite(t)&&t%1!=0},numeric:function(e,t,o){return""===t||null==t||!isNaN(t)},string:function(e,t,o){return""===t||null==t||isNaN(t)},max:function(e,t,o){return""===t||null==t||parseFloat(t)<=o},min:function(e,t,o){return""===t||null==t||parseFloat(t)>=o},minLength:function(e,t,o){return""===t||null==t||String(t).length>=o},maxLength:function(e,t,o){return""===t||null==t||String(t).length<=o},in:function(e,t,o){return""===t||null==t||("string"==typeof o&&(o=o.split("|")),""===t||o.indexOf(t)>-1)},regex:function(e,t,o){return""===t||null==t||new RegExp(o).test(t)},unique:function(e,t,o){if(""===t||null==t)return!0;var i=!0,n=e.getData(),r=e.getColumn()._getSelf();return this.table.rowManager.rows.forEach((function(e){var o=e.getData();o!==n&&t==r.getFieldValue(o)&&(i=!1)})),i},required:function(e,t,o){return""!==t&&null!=t}},d.prototype.registerModule("validate",Y),d},"object"===s(o)?t.exports=a():void 0===(r="function"==typeof(n=a)?n.call(o,i,o,t):n)||(t.exports=r)},2470:e=>{"use strict";if("undefined"==typeof moment){var t=new Error("Cannot find module 'moment'");throw t.code="MODULE_NOT_FOUND",t}e.exports=moment}},o={};function i(e){if(o[e])return o[e].exports;var n=o[e]={id:e,loaded:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e={};i.r(e),i.d(e,{Chart:()=>V(),Chroma:()=>u(),JWTDecode:()=>$(),Tabulator:()=>N(),TabulatorFormatter:()=>H,bind:()=>n,cloneDeep:()=>Ge(),compose:()=>qe,copyToClipboard:()=>k,createElement:()=>M,dataURLtoBlob:()=>_,deepMerge:()=>S,flatpickr:()=>F,formatDate:()=>z,formatDateTime:()=>I,getCircularReplacer:()=>D,loadScript:()=>C,meltDateStr:()=>O,paramString:()=>x,svg_symbols:()=>d,toggleExpanderParent:()=>E,touch:()=>Ye,turf:()=>Ue,wire:()=>l});var t=function(e){var t={};try{t.WeakMap=WeakMap}catch(u){t.WeakMap=function(e,t){var o=t.defineProperty,i=t.hasOwnProperty,n=r.prototype;return n.delete=function(e){return this.has(e)&&delete e[this._]},n.get=function(e){return this.has(e)?e[this._]:void 0},n.has=function(e){return i.call(e,this._)},n.set=function(e,t){return o(e,this._,{configurable:!0,value:t}),this},r;function r(t){o(this,"_",{value:"_@ungap/weakmap"+e++}),t&&t.forEach(a,this)}function a(e){this.set(e[0],e[1])}}(Math.random(),Object)}var o=t.WeakMap,i={};try{i.WeakSet=WeakSet}catch(u){!function(e,t){var o=n.prototype;function n(){t(this,"_",{value:"_@ungap/weakmap"+e++})}o.add=function(e){return this.has(e)||t(e,this._,{value:!0,configurable:!0}),this},o.has=function(e){return this.hasOwnProperty.call(e,this._)},o.delete=function(e){return this.has(e)&&delete e[this._]},i.WeakSet=n}(Math.random(),Object.defineProperty)}function n(e,t,o,i,n,r){for(var a=("selectedIndex"in t),s=a;i<n;){var l=e(o[i],1);if(t.insertBefore(l,r),a&&s&&l.selected){s=!s;var c=t.selectedIndex;t.selectedIndex=c<0?i:d.call(t.querySelectorAll("option"),l)}i++}}function r(e,t){return e==t}function a(e){return e}function s(e,t,o,i,n,r,a){var s=r-n;if(s<1)return-1;for(;s<=o-t;){for(var l=t,c=n;l<o&&c<r&&a(e[l],i[c]);)l++,c++;if(c===r)return t;t=l+1}return-1}function l(e,t,o,i,n){return o<i?e(t[o],0):0<o?e(t[o-1],-0).nextSibling:n}function c(e,t,o,i){for(;o<i;)p(e(t[o++],-1))}var u=i.WeakSet,d=[].indexOf,h=function(e,t,o){for(var i=1,n=t;i<n;){var r=(i+n)/2>>>0;o<e[r]?n=r:i=1+r}return i},p=function(e){return(e.remove||function(){var e=this.parentNode;e&&e.removeChild(this)}).call(e)};function f(e,t,o,i){for(var u=(i=i||{}).compare||r,d=i.node||a,p=null==i.before?null:d(i.before,0),f=t.length,m=f,g=0,v=o.length,b=0;g<m&&b<v&&u(t[g],o[b]);)g++,b++;for(;g<m&&b<v&&u(t[m-1],o[v-1]);)m--,v--;var y=g===m,w=b===v;if(y&&w)return o;if(y&&b<v)return n(d,e,o,b,v,l(d,t,g,f,p)),o;if(w&&g<m)return c(d,t,g,m),o;var x=m-g,C=v-b,E=-1;if(x<C){if(-1<(E=s(o,b,v,t,g,m,u)))return n(d,e,o,b,E,d(t[g],0)),n(d,e,o,E+x,v,l(d,t,m,f,p)),o}else if(C<x&&-1<(E=s(t,g,m,o,b,v,u)))return c(d,t,g,E),c(d,t,E+C,m),o;return x<2||C<2?(n(d,e,o,b,v,d(t[g],0)),c(d,t,g,m)):x==C&&function(e,t,o,i,n,r){for(;i<n&&r(o[i],e[t-1]);)i++,t--;return 0===t}(o,v,t,g,m,u)?n(d,e,o,b,v,l(d,t,m,f,p)):function(e,t,o,i,r,a,s,l,u,d,p,f,m){!function(e,t,o,i,r,a,s,l,u){for(var d=[],h=e.length,p=s,f=0;f<h;)switch(e[f++]){case 0:r++,p++;break;case 1:d.push(i[r]),n(t,o,i,r++,r,p<l?t(a[p],0):u);break;case-1:p++}for(f=0;f<h;)switch(e[f++]){case 0:s++;break;case-1:-1<d.indexOf(a[s])?s++:c(t,a,s++,s)}}(function(e,t,o,i,n,r,a){var s,l,c,u,d,h,p,f=o+r,m=[];e:for(s=0;s<=f;s++){if(50<s)return null;for(p=s-1,d=s?m[s-1]:[0,0],h=m[s]=[],l=-s;l<=s;l+=2){for(c=(u=l===-s||l!==s&&d[p+l-1]<d[p+l+1]?d[p+l+1]:d[p+l-1]+1)-l;u<r&&c<o&&a(i[n+u],e[t+c]);)u++,c++;if(u===r&&c===o)break e;h[s+l]=u}}var g=Array(s/2+f/2),v=g.length-1;for(s=m.length-1;0<=s;s--){for(;0<u&&0<c&&a(i[n+u-1],e[t+c-1]);)g[v--]=0,u--,c--;if(!s)break;p=s-1,d=s?m[s-1]:[0,0],(l=u-c)==-s||l!==s&&d[p+l-1]<d[p+l+1]?(c--,g[v--]=1):(u--,g[v--]=-1)}return g}(o,i,a,s,l,d,f)||function(e,t,o,i,n,r,a,s){var l=0,c=i<s?i:s,u=Array(c++),d=Array(c);d[0]=-1;for(var p=1;p<c;p++)d[p]=a;for(var f=n.slice(r,a),m=t;m<o;m++){var g=f.indexOf(e[m]);if(-1<g){var v=g+r;-1<(l=h(d,c,v))&&(d[l]=v,u[l]={newi:m,oldi:v,prev:u[l-1]})}}for(l=--c,--a;d[l]>a;)--l;c=s+i-l;var b=Array(c),y=u[l];for(--o;y;){for(var w=y.newi,x=y.oldi;w<o;)b[--c]=1,--o;for(;x<a;)b[--c]=-1,--a;b[--c]=0,--o,--a,y=y.prev}for(;t<=o;)b[--c]=1,--o;for(;r<=a;)b[--c]=-1,--a;return b}(o,i,r,a,s,l,u,d),e,t,o,i,s,l,p,m)}(d,e,o,b,v,C,t,g,m,x,f,u,p),o}var m={};function g(t,o){o=o||{};var i=e.createEvent("CustomEvent");return i.initCustomEvent(t,!!o.bubbles,!!o.cancelable,o.detail),i}m.CustomEvent="function"==typeof CustomEvent?CustomEvent:(g["prototype"]=new g("").constructor.prototype,g);var v=m.CustomEvent,b={};try{b.Map=Map}catch(u){b.Map=function(){var e=0,t=[],o=[];return{delete:function(n){var r=i(n);return r&&(t.splice(e,1),o.splice(e,1)),r},forEach:function(e,i){t.forEach((function(t,n){e.call(i,o[n],t,this)}),this)},get:function(t){return i(t)?o[e]:void 0},has:function(e){return i(e)},set:function(n,r){return o[i(n)?e:t.push(n)-1]=r,this}};function i(o){return-1<(e=t.indexOf(o))}}}var y=b.Map;function w(){return this}function x(e,t){var o="_"+e+"$";return{get:function(){return this[o]||C(this,o,t.call(this,e))},set:function(e){C(this,o,e)}}}var C=function(e,t,o){return Object.defineProperty(e,t,{configurable:!0,value:"function"==typeof o?function(){return e._wire$=o.apply(this,arguments)}:o})[t]};Object.defineProperties(w.prototype,{ELEMENT_NODE:{value:1},nodeType:{value:-1}});var E,k,M,_,D,S,R={},T={},L=[],P=T.hasOwnProperty,A=0,F={attributes:R,define:function(e,t){e.indexOf("-")<0?(e in T||(A=L.push(e)),T[e]=t):R[e]=t},invoke:function(e,t){for(var o=0;o<A;o++){var i=L[o];if(P.call(e,i))return T[i](e[i],t)}}},O=Array.isArray||(k=(E={}.toString).call([]),function(e){return E.call(e)===k}),z=(M=e,_="fragment",S="content"in j(D="template")?function(e){var t=j(D);return t.innerHTML=e,t.content}:function(e){var t=j(_),o=j(D),i=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(e)){var n=RegExp.$1;o.innerHTML="<table>"+e+"</table>",i=o.querySelectorAll(n)}else o.innerHTML=e,i=o.childNodes;return I(t,i),t},function(e,t){return("svg"===t?function(e){var t=j(_),o=j("div");return o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+e+"</svg>",I(t,o.firstChild.childNodes),t}:S)(e)});function I(e,t){for(var o=t.length;o--;)e.appendChild(t[0])}function j(e){return e===_?M.createDocumentFragment():M.createElementNS("http://www.w3.org/1999/xhtml",e)}var N,H,B,V,W,$,G,q,Y,U=(H="appendChild",B="cloneNode",V="createTextNode",$=(W="importNode")in(N=e),(G=N.createDocumentFragment())[H](N[V]("g")),G[H](N[V]("")),($?N[W](G,!0):G[B](!0)).childNodes.length<2?function e(t,o){for(var i=t[B](),n=t.childNodes||[],r=n.length,a=0;o&&a<r;a++)i[H](e(n[a],o));return i}:$?N[W]:function(e,t){return e[B](!!t)}),X="".trim||function(){return String(this).replace(/^\s+|\s+/g,"")},J="-"+Math.random().toFixed(6)+"%",K=!1;try{q=e.createElement("template"),Y="tabindex","content"in q&&(q.innerHTML="<p "+Y+'="'+J+'"></p>',q.content.childNodes[0].getAttribute(Y)==J)||(J="_dt: "+J.slice(1,-1)+";",K=!0)}catch(u){}var Z="\x3c!--"+J+"--\x3e",Q=/^(?:style|textarea)$/i,ee=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,te=" \\f\\n\\r\\t",oe="[^"+te+"\\/>\"'=]+",ie="["+te+"]+"+oe,ne="<([A-Za-z]+[A-Za-z0-9:._-]*)((?:",re="(?:\\s*=\\s*(?:'[^']*?'|\"[^\"]*?\"|<[^>]*?>|"+oe.replace("\\/","")+"))?)",ae=new RegExp(ne+ie+re+"+)(["+te+"]*/?>)","g"),se=new RegExp(ne+ie+re+"*)(["+te+"]*/>)","g"),le=new RegExp("("+ie+"\\s*=\\s*)(['\"]?)"+Z+"\\2","gi");function ce(e,t,o,i){return"<"+t+o.replace(le,ue)+i}function ue(e,t,o){return t+(o||'"')+J+(o||'"')}function de(e,t,o){return ee.test(t)?e:"<"+t+o+"></"+t+">"}var he=K?function(e,t){var o=t.join(" ");return t.slice.call(e,0).sort((function(e,t){return o.indexOf(e.name)<=o.indexOf(t.name)?-1:1}))}:function(e,t){return t.slice.call(e,0)};function pe(e,t){for(var o=t.length,i=0;i<o;)e=e.childNodes[t[i++]];return e}function fe(t,o,i,n){for(var r=t.attributes,a=[],s=[],l=he(r,i),c=l.length,u=0;u<c;){var d,h=l[u++],p=h.value===J;if(p||1<(d=h.value.split(Z)).length){var f=h.name;if(a.indexOf(f)<0){a.push(f);var m=i.shift().replace(p?/^(?:|[\S\s]*?\s)(\S+?)\s*=\s*('|")?$/:new RegExp("^(?:|[\\S\\s]*?\\s)("+f+")\\s*=\\s*('|\")[\\S\\s]*","i"),"$1"),g=r[m]||r[m.toLowerCase()];if(p)o.push(me(g,n,m,null));else{for(var v=d.length-2;v--;)i.shift();o.push(me(g,n,m,d))}}s.push(h)}}for(var b=((u=0)<(c=s.length)&&K&&!("ownerSVGElement"in t));u<c;){var y=s[u++];b&&(y.value=""),t.removeAttribute(y.name)}var w=t.nodeName;if(/^script$/i.test(w)){var x=e.createElement(w);for(c=r.length,u=0;u<c;)x.setAttributeNode(r[u++].cloneNode(!0));x.textContent=t.textContent,t.parentNode.replaceChild(x,t)}}function me(e,t,o,i){return{type:"attr",node:e,path:t,name:o,sparse:i}}function ge(e,t){return{type:"text",node:e,path:t}}var ve,be=(ve=new o,{get:function(e){return ve.get(e)},set:function(e,t){return ve.set(e,t),t}});function ye(e,t){var o=(e.convert||function(e){return e.join(Z).replace(se,de).replace(ae,ce)})(t),i=e.transform;i&&(o=i(o));var n=z(o,e.type);xe(n);var r=[];return function e(t,o,i,n){for(var r=t.childNodes,a=r.length,s=0;s<a;){var l=r[s];switch(l.nodeType){case 1:var c=n.concat(s);fe(l,o,i,c),e(l,o,i,c);break;case 8:var u=l.textContent;if(u===J)i.shift(),o.push(Q.test(t.nodeName)?ge(t,n):{type:"any",node:l,path:n.concat(s)});else switch(u.slice(0,2)){case"/*":if("*/"!==u.slice(-2))break;case"":t.removeChild(l),s--,a--}break;case 3:Q.test(t.nodeName)&&X.call(l.textContent)===Z&&(i.shift(),o.push(ge(t,n)))}s++}}(n,r,t.slice(0),[]),{content:n,updates:function(o){for(var i=[],n=r.length,a=0,s=0;a<n;){var l=r[a++],c=pe(o,l.path);switch(l.type){case"any":i.push({fn:e.any(c,[]),sparse:!1});break;case"attr":var u=l.sparse,d=e.attribute(c,l.name,l.node);null===u?i.push({fn:d,sparse:!1}):(s+=u.length-2,i.push({fn:d,sparse:!0,values:u}));break;case"text":i.push({fn:e.text(c),sparse:!1}),c.textContent=""}}return n+=s,function(){var e=arguments.length;if(n!==e-1)throw new Error(e-1+" values instead of "+n+"\n"+t.join("${value}"));for(var r=1,a=1;r<e;){var s=i[r-a];if(s.sparse){var l=s.values,c=l[0],u=1,d=l.length;for(a+=d-2;u<d;)c+=arguments[r++]+l[u++];s.fn(c)}else s.fn(arguments[r++])}return o}}}}var we=[];function xe(e){for(var t=e.childNodes,o=t.length;o--;){var i=t[o];1!==i.nodeType&&0===X.call(i.textContent).length&&e.removeChild(i)}}var Ce,Ee,ke=(Ce=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,Ee=/([^A-Z])([A-Z]+)/g,function(e,t){return"ownerSVGElement"in e?function(e,t){var o;return(o=t?t.cloneNode(!0):(e.setAttribute("style","--hyper:style;"),e.getAttributeNode("style"))).value="",e.setAttributeNode(o),_e(o,!0)}(e,t):_e(e.style,!1)});function Me(e,t,o){return t+"-"+o.toLowerCase()}function _e(e,t){var o,i;return function(n){var r,a,s,l;switch(typeof n){case"object":if(n){if("object"===o){if(!t&&i!==n)for(a in i)a in n||(e[a]="")}else t?e.value="":e.cssText="";for(a in r=t?{}:e,n)s="number"!=typeof(l=n[a])||Ce.test(a)?l:l+"px",!t&&/^--/.test(a)?r.setProperty(a,s):r[a]=s;o="object",t?e.value=function(e){var t,o=[];for(t in e)o.push(t.replace(Ee,Me),":",e[t],";");return o.join("")}(i=r):i=n;break}default:i!=n&&(o="string",i=n,t?e.value=n||"":e.cssText=n||"")}}}var De,Se,Re=(De=[].slice,(Se=Te.prototype).ELEMENT_NODE=1,Se.nodeType=111,Se.remove=function(e){var t=this.childNodes,o=this.firstChild,i=this.lastChild;if(this._=null,e&&2===t.length)i.parentNode.removeChild(i);else{var n=this.ownerDocument.createRange();n.setStartBefore(e?t[1]:o),n.setEndAfter(i),n.deleteContents()}return o},Se.valueOf=function(e){var t=this._,o=null==t;if(o&&(t=this._=this.ownerDocument.createDocumentFragment()),o||e)for(var i=this.childNodes,n=0,r=i.length;n<r;n++)t.appendChild(i[n]);return t},Te);function Te(e){var t=this.childNodes=De.call(e,0);this.firstChild=t[0],this.lastChild=t[t.length-1],this.ownerDocument=t[0].ownerDocument,this._=null}function Le(e){return{html:e}}function Pe(e,t){switch(e.nodeType){case Ve:return 1/t<0?t?e.remove(!0):e.lastChild:t?e.valueOf(!0):e.firstChild;case Be:return Pe(e.render(),t);default:return e}}function Ae(e,t){t(e.placeholder),"text"in e?Promise.resolve(e.text).then(String).then(t):"any"in e?Promise.resolve(e.any).then(t):"html"in e?Promise.resolve(e.html).then(Le).then(t):Promise.resolve(F.invoke(e,t)).then(t)}function Fe(e){return null!=e&&"then"in e}var Oe,ze,Ie,je,Ne,He="ownerSVGElement",Be=w.prototype.nodeType,Ve=Re.prototype.nodeType,We=(ze=(Oe={Event:v,WeakSet:u}).Event,Ie=Oe.WeakSet,je=!0,Ne=null,function(e){return je&&(je=!je,Ne=new Ie,function(e){var t=new Ie,o=new Ie;try{new MutationObserver(a).observe(e,{subtree:!0,childList:!0})}catch(t){var i=0,n=[],r=function(e){n.push(e),clearTimeout(i),i=setTimeout((function(){a(n.splice(i=0,n.length))}),0)};e.addEventListener("DOMNodeRemoved",(function(e){r({addedNodes:[],removedNodes:[e.target]})}),!0),e.addEventListener("DOMNodeInserted",(function(e){r({addedNodes:[e.target],removedNodes:[]})}),!0)}function a(e){for(var i,n=e.length,r=0;r<n;r++)s((i=e[r]).removedNodes,"disconnected",o,t),s(i.addedNodes,"connected",t,o)}function s(e,t,o,i){for(var n,r=new ze(t),a=e.length,s=0;s<a;1===(n=e[s++]).nodeType&&l(n,r,t,o,i));}function l(e,t,o,i,n){Ne.has(e)&&!i.has(e)&&(n.delete(e),i.add(e),e.dispatchEvent(t));for(var r=e.children||[],a=r.length,s=0;s<a;l(r[s++],t,o,i,n));}}(e.ownerDocument)),Ne.add(e),e}),$e=/^(?:form|list)$/i,Ge=[].slice;function qe(t){return this.type=t,function(t){var o=we,i=xe;return function(n){var r,a,s;return o!==n&&(r=t,a=o=n,s=be.get(a)||be.set(a,ye(r,a)),i=s.updates(U.call(e,s.content,!0))),i.apply(null,arguments)}}(this)}var Ye=!(qe.prototype={attribute:function(e,t,o){var i,n=He in e;if("style"===t)return ke(e,o,n);if("."===t.slice(0,1))return a=e,s=t.slice(1),n?function(e){try{a[s]=e}catch(t){a.setAttribute(s,e)}}:function(e){a[s]=e};if(/^on/.test(t)){var r=t.slice(2);return"connected"===r||"disconnected"===r?We(e):t.toLowerCase()in e&&(r=r.toLowerCase()),function(t){i!==t&&(i&&e.removeEventListener(r,i,!1),(i=t)&&e.addEventListener(r,t,!1))}}if("data"===t||!n&&t in e&&!$e.test(t))return function(o){i!==o&&(i=o,e[t]!==o&&null==o?(e[t]="",e.removeAttribute(t)):e[t]=o)};if(t in F.attributes)return function(o){var n=F.attributes[t](e,o);i!==n&&(null==(i=n)?e.removeAttribute(t):e.setAttribute(t,n))};var a,s,l=!1,c=o.cloneNode(!0);return function(t){i!==t&&(i=t,c.value!==t&&(null==t?(l&&(l=!1,e.removeAttributeNode(c)),c.value=t):(c.value=t,l||(l=!0,e.setAttributeNode(c)))))}},any:function(e,t){var o,i={node:Pe,before:e},n=He in e?"svg":"html",r=!1;return function a(s){switch(typeof s){case"string":case"number":case"boolean":r?o!==s&&(o=s,t[0].textContent=s):(r=!0,o=s,t=f(e.parentNode,t,[(l=s,e.ownerDocument.createTextNode(l))],i));break;case"function":a(s(e));break;case"object":case"undefined":if(null==s){r=!1,t=f(e.parentNode,t,[],i);break}default:if(r=!1,O(o=s))if(0===s.length)t.length&&(t=f(e.parentNode,t,[],i));else switch(typeof s[0]){case"string":case"number":case"boolean":a({html:s});break;case"object":if(O(s[0])&&(s=s.concat.apply([],s)),Fe(s[0])){Promise.all(s).then(a);break}default:t=f(e.parentNode,t,s,i)}else"ELEMENT_NODE"in s?t=f(e.parentNode,t,11===s.nodeType?Ge.call(s.childNodes):[s],i):Fe(s)?s.then(a):"placeholder"in s?Ae(s,a):"text"in s?a(String(s.text)):"any"in s?a(s.any):"html"in s?t=f(e.parentNode,t,Ge.call(z([].concat(s.html).join(""),n).childNodes),i):a("length"in s?Ge.call(s):F.invoke(s,a))}var l}},text:function(e){var t;return function o(i){if(t!==i){var n=typeof(t=i);"object"==n&&i?Fe(i)?i.then(o):"placeholder"in i?Ae(i,o):o("text"in i?String(i.text):"any"in i?i.any:"html"in i?[].concat(i.html).join(""):"length"in i?Ge.call(i).join(""):F.invoke(i,o)):"function"==n?o(i(e)):e.textContent=null==i?"":i}}}}),Ue=function(t){var i,n=(i=(e.defaultView.navigator||{}).userAgent,/(Firefox|Safari)\/(\d+)/.test(i)&&!/(Chrom[eium]+|Android)\/(\d+)/.test(i)),r=!("raw"in t)||t.propertyIsEnumerable("raw")||!Object.isFrozen(t.raw);if(n||r){var a={},s=function(e){for(var t=".",o=0;o<e.length;o++)t+=e[o].length+"."+e[o];return a[t]||(a[t]=e)};if(r)Ue=s;else{var l=new o;Ue=function(e){return l.get(e)||(o=s(t=e),l.set(t,o),o);var t,o}}}else Ye=!0;return Xe(t)};function Xe(e){return Ye?e:Ue(e)}function Je(e){for(var t=arguments.length,o=[Xe(e)],i=1;i<t;)o.push(arguments[i++]);return o}var Ke=new o,Ze=function(e){var t,o,i;return function(){var n=Je.apply(null,arguments);return i!==n[0]?(i=n[0],o=new qe(e),t=et(o.apply(o,n))):o.apply(o,n),t}},Qe=function(e,t){var o=t.indexOf(":"),i=Ke.get(e),n=t;return-1<o&&(n=t.slice(o+1),t=t.slice(0,o)||"html"),i||Ke.set(e,i={}),i[n]||(i[n]=Ze(t))},et=function(e){var t=e.childNodes,o=t.length;return 1===o?t[0]:o?new Re(t):e},tt=new o;function ot(){var e=tt.get(this),t=Je.apply(null,arguments);return e&&e.template===t[0]?e.tagger.apply(null,t):function(e){var t=new qe(He in this?"svg":"html");tt.set(this,{tagger:t,template:e}),this.textContent="",this.appendChild(t.apply(null,arguments))}.apply(this,t),this}var it,nt,rt,at,st=F.define,lt=qe.prototype;function ct(e){return arguments.length<2?null==e?Ze("html"):"string"==typeof e?ct.wire(null,e):"raw"in e?Ze("html")(e):"nodeType"in e?ct.bind(e):Qe(e,"html"):("raw"in e?Ze("html"):ct.wire).apply(null,arguments)}return ct.Component=w,ct.bind=function(e){return ot.bind(e)},ct.define=st,ct.diff=f,(ct.hyper=ct).observe=We,ct.tagger=lt,ct.wire=function(e,t){return null==e?Ze(t||"html"):Qe(e,t||"html")},ct._={WeakMap:o,WeakSet:u},it=Ze,nt=new o,rt=Object.create,at=function(e,t){var o={w:null,p:null};return t.set(e,o),o},Object.defineProperties(w,{for:{configurable:!0,value:function(e,t){return function(e,t,i,n){var r,a,s,l=t.get(e)||at(e,t);switch(typeof n){case"object":case"function":var c=l.w||(l.w=new o);return c.get(n)||(r=c,a=n,s=new e(i),r.set(a,s),s);default:var u=l.p||(l.p=rt(null));return u[n]||(u[n]=new e(i))}}(this,nt.get(e)||(i=e,n=new y,nt.set(i,n),n),e,null==t?"default":t);var i,n}}}),Object.defineProperties(w.prototype,{handleEvent:{value:function(e){var t=e.currentTarget;this["getAttribute"in t&&t.getAttribute("data-call")||"on"+e.type](e)}},html:x("html",it),svg:x("svg",it),state:x("state",(function(){return this.defaultState})),defaultState:{get:function(){return{}}},dispatch:{value:function(e,t){var o=this._wire$;if(o){var i=new v(e,{bubbles:!0,cancelable:!0,detail:t});return i.component=this,(o.dispatchEvent?o:o.firstChild).dispatchEvent(i)}return!1}},setState:{value:function(e,t){var o=this.state,i="function"==typeof e?e.call(this,o):e;for(var n in i)o[n]=i[n];return!1!==t&&this.render(),this}}}),ct}(document);const{Component:o,bind:n,define:r,diff:a,hyper:s,wire:l}=t;var c=i(5792),u=i.n(c);const d=e=>{if(e.svg)return e.svg;const t={dot:p(e),target:f(e),triangle:m(e),square:g(e),semiCircle:v(e),markerLetter:b(e),markerColor:y(e),geo:w()};return e.type?t[e.type]:p({color:"#666"})},h=new XMLSerializer;function p(e){const t=l()`
  <svg width=866 height=1000 viewBox='0 0 866 1000' xmlns='http://www.w3.org/2000/svg'>`;return t.appendChild(l(null,"svg")`
  <circle cx=466 cy=532 r=395 fill=${u()(e.fillColor||"#fff").darken()}>`),t.appendChild(l(null,"svg")`
  <circle cx=400 cy=468 r=395 fill=${e.fillColor||"#fff"}>`),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function f(e){const t=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let o=l(null,"svg")`
  <circle cx=540 cy=540 fill='#333' opacity=0.4>`;o.setAttribute("r",400),t.appendChild(o);let i=l(null,"svg")`<circle cx=500 cy=500 fill=${e.fillColor||"#FFF"}>`;return i.setAttribute("r",400),t.appendChild(i),e.layers?(Object.entries(e.layers).forEach(e=>{const o=l(null,"svg")`<circle cx=500 cy=500 fill=${e[1]}>`;o.setAttribute("r",400*parseFloat(e[0])),t.appendChild(o)}),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))):"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function m(e){const t=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let o="M0,-19.618873042551414L16.990442448471224,9.809436521275707L-16.990442448471224,9.809436521275707Z",i=l(null,"svg")`<path fill='#333' opacity=0.4>`;i.setAttribute("d",o),i.setAttribute("transform","translate(540 520) rotate(180) scale(-20, -20)"),t.appendChild(i);let n=l(null,"svg")`<path fill=${e.fillColor||"#FFF"}>`;return n.setAttribute("d",o),n.setAttribute("transform","translate(500 500) rotate(180) scale(-20, -20)"),t.appendChild(n),e.layers?(Object.entries(e.layers).map(e=>{const i=l(null,"svg")`<path fill=${e[1]}>`;i.setAttribute("d",o),i.setAttribute("transform",`translate(500 500) rotate(180) scale(${-20*e[0]}, ${-20*e[0]})`),t.appendChild(i)}),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))):"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function g(e){let t=1e3,o=800;const i=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let n=l(null,"svg")`<rect fill='#333' opacity=0.3 >`;n.setAttribute("width",o),n.setAttribute("height",o),n.setAttribute("x",110),n.setAttribute("y",110),i.appendChild(n);let r=l(null,"svg")`<rect fill=${e.fillColor||"#FFF"}>`;return r.setAttribute("width",o),r.setAttribute("height",o),r.setAttribute("x",100),r.setAttribute("y",100),i.appendChild(r),e.layers?(Object.entries(e.layers).map(e=>{const n=l(null,"svg")`<rect fill=${e[1]}>`;n.setAttribute("width",e[0]*o),n.setAttribute("height",e[0]*o),n.setAttribute("x",(t-e[0]*o)/2),n.setAttribute("y",(t-e[0]*o)/2),i.appendChild(n)}),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(i))):"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(i))}function v(e){const t=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>
    <defs>
      <clipPath id="cut-off-shade">
        <rect x="0" y="0" width="1000" height="710"/>
      </clipPath>
      <clipPath id="cut-off">
        <rect x="0" y="0" width="1000" height="700"/>
      </clipPath>
    </defs>
    <circle cx="510" cy="710" r="400" fill="#333" opacity="0.3" clip-path="url(#cut-off-shade)"/>
  </svg>`;return t.appendChild(l(null,"svg")`
  <circle cx=500 cy=700 r=400 fill=${e.fillColor} clip-path='url(#cut-off)'>`),e.layers&&Object.entries(e.layers).map(e=>{const o=l(null,"svg")`<circle cx=500 cy=700 fill=${e[1]} clip-path='url(#cut-off)'>`;o.setAttribute("r",parseInt(400*parseFloat(e[0]))),t.appendChild(o)}),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function b(e){const t=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;return t.appendChild(l(null,"svg")`
  <path style="opacity: 0.5;" fill=${e.color}
    d="M570,20C370,20,210,180,210,380C210,460,230,520,280,610C380,780,570,1000,570,1000C570,1000,760,780,860,610C910,520,930,460,930,380C930,180,770,20,570,20Z"/>`),t.appendChild(l(null,"svg")`
  <path fill=${e.color}
    d="M500,20C300,20,140,180,140,380C140,440,160,520,210,610C310,780,500,1000,500,1000C500,1000,690,780,790,610C840,520,860,460,860,380C860,180,700,20,500,20Z"/>`),t.appendChild(l(null,"svg")`
  <circle cx=500 cy=360 r=250 opacity=0.8 fill="rgb(255, 255, 255)"/>`),t.appendChild(l(null,"svg")`
  <text x=500 y=500 style="text-anchor: middle; font-weight: 600; font-size: 470px; font-family: sans-serif; fill: rgb(85, 85, 85);">
    ${e.letter}`),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function y(e){const t=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;return t.appendChild(l(null,"svg")`
  <path style="opacity: 0.5;" fill=${e.colorMarker}
    d="M570,20C370,20,210,180,210,380C210,460,230,520,280,610C380,780,570,1000,570,1000C570,1000,760,780,860,610C910,520,930,460,930,380C930,180,770,20,570,20Z"/>`),t.appendChild(l(null,"svg")`
  <path fill=${e.colorMarker}
    d="M500,20C300,20,140,180,140,380C140,440,160,520,210,610C310,780,500,1000,500,1000C500,1000,690,780,790,610C840,520,860,460,860,380C860,180,700,20,500,20Z"/>`),t.appendChild(l(null,"svg")`
  <circle cx=500 cy=360 r=250 opacity=0.8 fill="rgb(255, 255, 255)"/>`),t.appendChild(l(null,"svg")`
  <circle cx=500 cy=360 r=180 opacity=0.8 fill=${e.colorDot}/>`),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(t))}function w(){const e=l()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;e.appendChild(l(null,"svg")`
  <circle cx=500 cy=500 r=350 stroke='#1F964D' opacity=0.8 stroke-width=75 fill=none>`),e.appendChild(l(null,"svg")`
  <circle cx=500 cy=500 r=200 fill='#1F964D' opacity=0.8>`);let t=l(null,"svg")`
  <path stroke='#1F964D' opacity=0.8 stroke-width=75>`;return t.setAttribute("d","M500,150L500,0M500,850L500,1000M0,500L150,500M850,500L1000,500"),e.appendChild(t),"data:image/svg+xml,"+encodeURIComponent(h.serializeToString(e))}const x=e=>Object.entries(e).filter(e=>0===e[1]||!!e[1]).filter(e=>"{}"!==e[1]).filter(e=>e[1].length>0||"object"!=typeof e[1]).map(e=>encodeURI(`${e[0]}=${e[1]}`)).join("&");function C(e){return new Promise((t,o)=>{const i=Object.assign(document.createElement("script"),{src:e,onerror:()=>o(console.error("failed:"+e)),onload:()=>t(console.log("loaded:"+e))});document.head.appendChild(i)})}function E(e,t){const o=e.closest(".expandable");if(o){if(o.classList.contains("expanded"))return o.classList.remove("expanded");t&&[...o.parentElement.children].forEach(e=>{e.classList.remove("expanded")}),o.classList.add("expanded")}}function k(e){let t=_xyz.utils.wire()`<textarea style="visibility=none;">`;t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove()}function M(e){let t=document.createElement(e.tag);return e.options&&Object.keys(e.options).forEach(o=>{e.options[o]&&(t[o]=e.options[o])}),e.style&&Object.keys(e.style).forEach(o=>t.style[o]=e.style[o]),e.appendTo&&e.appendTo.appendChild(t),e.eventListener&&t.addEventListener(e.eventListener.event,e.eventListener.funct),t}function _(e){if(-1==e.indexOf(";base64,")){let t=e.split(","),o=t[0].split(":")[1],i=t[1];return new Blob([i],{type:o})}let t=e.split(";base64,"),o=t[0].split(":")[1],i=window.atob(t[1]),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);return new Blob([n],{type:o})}const D=()=>{const e=new WeakSet;return(t,o)=>{if("object"==typeof o&&null!==o){if(e.has(o))return;e.add(o)}return o}};function S(e,t,o){var i=Array.isArray(t),n=(o||{arrayMerge:L}).arrayMerge||L;return i?Array.isArray(e)?n(e,t,o):T(t,o):function(e,t,o){var i={};R(e)&&Object.keys(e).forEach((function(t){i[t]=T(e[t],o)}));return Object.keys(t).forEach((function(n){R(t[n])&&e[n]?i[n]=S(e[n],t[n],o):i[n]=T(t[n],o)})),i}(e,t,o)}function R(e){return e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function T(e,t){var o;return t&&!0===t.clone&&R(e)?S((o=e,Array.isArray(o)?[]:{}),e,t):e}function L(e,t,o){var i=e.slice();return t.forEach((function(t,n){void 0===i[n]?i[n]=T(t,o):R(t)?i[n]=S(e[n],t,o):-1===e.indexOf(t)&&i.push(T(t,o))})),i}var P=i(4953),A=i.n(P);function F(e){return A()(e.element,{defaultDate:e.value,enableTime:e.enableTime||!1,time_24hr:!0,dateFormat:e.enableTime?"j M Y H:i":"j M Y",onClose:(t,o,i)=>{e.callback(o)}})}function O(e){return Math.round(new Date(e).getTime()/1e3)}function z(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let t=new Date(1e3*e),o=t.getFullYear(),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],n=t.getDate();t.getDay();return`${n} ${i} ${o}`}function I(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let t=z(e),o=new Date(1e3*e),i="0"+o.getHours(),n="0"+o.getMinutes();o.getSeconds();return`${t}, ${i.substr(-2)}:${n.substr(-2)}`}var j=i(8508),N=i.n(j);const H={red:(e,t,o)=>{e.getElement().style.backgroundColor="red"},colour:(e,t,o)=>{e.getElement().style.backgroundColor=t.colour},conditional:(e,t,o)=>{if(e.getValue())return t[""+e.getValue()]?void(e.getElement().style.backgroundColor=t[""+e.getValue()]):e.getValue()}};var B=i(7757),V=i.n(B),W=i(6489),$=i.n(W);i(9523);function G(e,t,o){if(!Y(o=o||{}))throw new Error("options is invalid");var i=o.bbox,n=o.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");i&&U(i),n&&X(n);var r={type:"Feature"};return n&&(r.id=n),i&&(r.bbox=i),r.properties=t||{},r.geometry=e,r}function q(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function Y(e){return!!e&&e.constructor===Object}function U(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!q(e))throw new Error("bbox must only contain numbers")}))}function X(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function J(e,t,o){if(null!==e)for(var i,n,r,a,s,l,c,u,d=0,h=0,p=e.type,f="FeatureCollection"===p,m="Feature"===p,g=f?e.features.length:1,v=0;v<g;v++){s=(u=!!(c=f?e.features[v].geometry:m?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var b=0;b<s;b++){var y=0,w=0;if(null!==(a=u?c.geometries[b]:c)){l=a.coordinates;var x=a.type;switch(d=!o||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===t(l,h,v,y,w))return!1;h++,y++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===t(l[i],h,v,y,w))return!1;h++,"MultiPoint"===x&&y++}"LineString"===x&&y++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(n=0;n<l[i].length-d;n++){if(!1===t(l[i][n],h,v,y,w))return!1;h++}"MultiLineString"===x&&y++,"Polygon"===x&&w++}"Polygon"===x&&y++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===x&&(w=0),n=0;n<l[i].length;n++){for(r=0;r<l[i][n].length-d;r++){if(!1===t(l[i][n][r],h,v,y,w))return!1;h++}w++}y++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===J(a.geometries[i],t,o))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function K(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var o=0;o<e.features.length&&!1!==t(e.features[o],o);o++);}function Z(e,t){var o,i,n,r,a,s,l,c,u,d,h=0,p="FeatureCollection"===e.type,f="Feature"===e.type,m=p?e.features.length:1;for(o=0;o<m;o++){for(s=p?e.features[o].geometry:f?e.geometry:e,c=p?e.features[o].properties:f?e.properties:{},u=p?e.features[o].bbox:f?e.bbox:void 0,d=p?e.features[o].id:f?e.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<a;n++)if(null!==(r=l?s.geometries[n]:s))switch(r.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(r,h,c,u,d))return!1;break;case"GeometryCollection":for(i=0;i<r.geometries.length;i++)if(!1===t(r.geometries[i],h,c,u,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,c,u,d))return!1;h++}}function Q(e,t){Z(e,(function(e,o,i,n,r){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(G(e,i,{bbox:n,id:r}),o,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<e.coordinates.length;l++){var c=e.coordinates[l];if(!1===t(G({type:a,coordinates:c},i),o,l))return!1}}))}function ee(e,t,o){if(!ne(o=o||{}))throw new Error("options is invalid");var i=o.bbox,n=o.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");i&&re(i),n&&ae(n);var r={type:"Feature"};return n&&(r.id=n),i&&(r.bbox=i),r.properties=t||{},r.geometry=e,r}function te(e,t,o){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ie(e[0])||!ie(e[1]))throw new Error("coordinates must contain numbers");return ee({type:"Point",coordinates:e},t,o)}function oe(e,t){if(!ne(t=t||{}))throw new Error("options is invalid");var o=t.bbox,i=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");o&&re(o),i&&ae(i);var n={type:"FeatureCollection"};return i&&(n.id=i),o&&(n.bbox=o),n.features=e,n}function ie(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function ne(e){return!!e&&e.constructor===Object}function re(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!ie(e))throw new Error("bbox must only contain numbers")}))}function ae(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}const se=function(e){var t=[];return"FeatureCollection"===e.type?K(e,(function(e){J(e,(function(o){t.push(te(o,e.properties))}))})):J(e,(function(o){t.push(te(o,e.properties))})),oe(t)};const le=function(e){var t=[1/0,1/0,-1/0,-1/0];return J(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t};function ce(e,t,o){if(!he(o=o||{}))throw new Error("options is invalid");var i=o.bbox,n=o.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");i&&pe(i),n&&fe(n);var r={type:"Feature"};return n&&(r.id=n),i&&(r.bbox=i),r.properties=t||{},r.geometry=e,r}function ue(e,t,o){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!de(e[0])||!de(e[1]))throw new Error("coordinates must contain numbers");return ce({type:"Point",coordinates:e},t,o)}function de(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function he(e){return!!e&&e.constructor===Object}function pe(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!de(e))throw new Error("bbox must only contain numbers")}))}function fe(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}const me=function(e,t){if(!he(t=t||{}))throw new Error("options is invalid");var o=t.properties;if(!e)throw new Error("geojson is required");var i=le(e);return ue([(i[0]+i[2])/2,(i[1]+i[3])/2],o)};function ge(e){var t={type:"Feature"};return Object.keys(e).forEach((function(o){switch(o){case"type":case"properties":case"geometry":return;default:t[o]=e[o]}})),t.properties=function e(t){var o={};return t?(Object.keys(t).forEach((function(i){var n=t[i];"object"==typeof n?null===n?o[i]=null:n.length?o[i]=n.map((function(e){return e})):o[i]=e(n):o[i]=n})),o):o}(e.properties),t.geometry=ve(e.geometry),t}function ve(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return ve(e)})),t):(t.coordinates=function e(t){if("object"!=typeof t[0])return t.slice();return t.map((function(t){return e(t)}))}(e.coordinates),t)}const be=function(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return ge(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(o){switch(o){case"type":case"features":return;default:t[o]=e[o]}})),t.features=e.features.map((function(e){return ge(e)})),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return ve(e);default:throw new Error("unknown GeoJSON type")}};function ye(e){if(!e)throw new Error("coord is required");if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates;if(Array.isArray(e)&&e.length>=2&&void 0===e[0].length&&void 0===e[1].length)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}var we={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function xe(e,t){if(null==e)throw new Error("radians is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");var o=we[t||"kilometers"];if(!o)throw new Error(t+" units is invalid");return e*o}function Ce(e){if(null==e)throw new Error("degrees is required");return e%360*Math.PI/180}function Ee(e){return!!e&&e.constructor===Object}const ke=function(e,t,o){if(!Ee(o=o||{}))throw new Error("options is invalid");var i=o.units,n=ye(e),r=ye(t),a=Ce(r[1]-n[1]),s=Ce(r[0]-n[0]),l=Ce(n[1]),c=Ce(r[1]),u=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(l)*Math.cos(c);return xe(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),i)};const Me=function(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var o,i=1/0;return K(t,(function(t,n){var r=ke(e,t);r<i&&((o=be(t)).properties.featureIndex=n,o.properties.distanceToPoint=r,i=r)})),o};function _e(e,t,o){var i=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var n=0,r=t.length-1;n<t.length;r=n++){var a=t[n][0],s=t[n][1],l=t[r][0],c=t[r][1];if(e[1]*(a-l)+s*(l-e[0])+c*(e[0]-a)==0&&(a-e[0])*(l-e[0])<=0&&(s-e[1])*(c-e[1])<=0)return!o;s>e[1]!=c>e[1]&&e[0]<(l-a)*(e[1]-s)/(c-s)+a&&(i=!i)}return i}const De=function(e,t,o){if("object"!=typeof(o=o||{}))throw new Error("options is invalid");var i=o.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var n=ye(e),r=function(e){if(!e)throw new Error("coords is required");if("Feature"===e.type&&null!==e.geometry)return e.geometry.coordinates;if(e.coordinates)return e.coordinates;if(Array.isArray(e))return e;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(t),a=t.geometry?t.geometry.type:t.type,s=t.bbox;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(n,s))return!1;"Polygon"===a&&(r=[r]);for(var l=0,c=!1;l<r.length&&!c;l++)if(_e(n,r[l][0],i)){for(var u=!1,d=1;d<r[l].length&&!u;)_e(n,r[l][d],!i)&&(u=!0),d++;u||(c=!0)}return c};function Se(e,t,o){if(!Pe(o=o||{}))throw new Error("options is invalid");var i=o.bbox,n=o.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");i&&Ae(i),n&&Fe(n);var r={type:"Feature"};return n&&(r.id=n),i&&(r.bbox=i),r.properties=t||{},r.geometry=e,r}function Re(e,t,o){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Le(e[0])||!Le(e[1]))throw new Error("coordinates must contain numbers");return Se({type:"Point",coordinates:e},t,o)}function Te(e,t){if(!Pe(t=t||{}))throw new Error("options is invalid");var o=t.bbox,i=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");o&&Ae(o),i&&Fe(i);var n={type:"FeatureCollection"};return i&&(n.id=i),o&&(n.bbox=o),n.features=e,n}function Le(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function Pe(e){return!!e&&e.constructor===Object}function Ae(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!Le(e))throw new Error("bbox must only contain numbers")}))}function Fe(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function Oe(e,t,o,i,n,r){return Math.sqrt((n-o)*(n-o)+(r-i)*(r-i))===Math.sqrt((e-o)*(e-o)+(t-i)*(t-i))+Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}const ze=function(e){for(var t=function(e){if("FeatureCollection"!==e.type)return"Feature"!==e.type?Te([Se(e)]):Te([e]);return e}(e),o=me(t),i=!1,n=0;!i&&n<t.features.length;){var r,a=t.features[n].geometry,s=!1;if("Point"===a.type)o.geometry.coordinates[0]===a.coordinates[0]&&o.geometry.coordinates[1]===a.coordinates[1]&&(i=!0);else if("MultiPoint"===a.type){var l=!1;for(r=0;!l&&r<a.coordinates.length;)o.geometry.coordinates[0]===a.coordinates[r][0]&&o.geometry.coordinates[1]===a.coordinates[r][1]&&(i=!0,l=!0),r++}else if("LineString"===a.type)for(r=0;!s&&r<a.coordinates.length-1;)Oe(o.geometry.coordinates[0],o.geometry.coordinates[1],a.coordinates[r][0],a.coordinates[r][1],a.coordinates[r+1][0],a.coordinates[r+1][1])&&(s=!0,i=!0),r++;else if("MultiLineString"===a.type)for(var c=0;c<a.coordinates.length;){s=!1,r=0;for(var u=a.coordinates[c];!s&&r<u.length-1;)Oe(o.geometry.coordinates[0],o.geometry.coordinates[1],u[r][0],u[r][1],u[r+1][0],u[r+1][1])&&(s=!0,i=!0),r++;c++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||De(o,a)&&(i=!0);n++}if(i)return o;var d=Te([]);for(n=0;n<t.features.length;n++)d.features=d.features.concat(se(t.features[n]).features);return Re(Me(o,d).geometry.coordinates)};var Ie=i(1848);function je(e,t){if(!He(t=t||{}))throw new Error("options is invalid");var o=t.bbox,i=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");o&&Be(o),i&&Ve(i);var n={type:"FeatureCollection"};return i&&(n.id=i),o&&(n.bbox=o),n.features=e,n}function Ne(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function He(e){return!!e&&e.constructor===Object}function Be(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!Ne(e))throw new Error("bbox must only contain numbers")}))}function Ve(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}const We=function(e){if(!e)throw new Error("geojson is required");var t=[];return Q(e,(function(e){t.push(e)})),je(t)};var $e=i(361),Ge=i.n($e);const qe=(...e)=>t=>e.forEach(e=>e(t)),Ye=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,Ue={pointOnFeature:ze,kinks:Ie.Z,flatten:We},Xe=e=>({fetchLocales:async function(){const t=await fetch(e.host+"/api/workspace/get/locales");e.workspace.locales=await t.json()},getLocales:function(t){const o=new XMLHttpRequest;o.open("GET",e.host+"/api/workspace/get/locales"),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=o=>{if(200!==o.target.status)return console.error("Failed to retrieve workspace from XYZ host!");e.workspace.locales=o.target.response,function(t){e.locale=e.locale||e.hooks&&e.hooks.current.locale||e.workspace.locales[0];const o=new XMLHttpRequest;o.open("GET",e.host+"/api/workspace/get/locale?"+e.utils.paramString({locale:e.locale})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=o=>{if(200!==o.target.status)return console.error("Failed to retrieve workspace from XYZ host!");e.workspace.locale=Object.assign({key:e.locale},o.target.response),Object.keys(e.workspace.locale.layers).filter(e=>-1===e.indexOf("__")).forEach(t=>{e.layers.list[t]=e.layers.decorate(e.workspace.locale.layers[t])}),t&&t(e)},o.send()}(t)},o.send()}}),Je=e=>t=>{if(!t.target)return console.log("No target for mapview!");e.mapview.node=t.target,e.mapview.srid=t.srid||"3857";const o=t.view&&t.view.z||e.workspace.locale.view.z||e.workspace.locale.minZoom||0,i=ol.proj.fromLonLat([parseFloat(t.view&&t.view.lng||e.workspace.locale.view.lng||0),parseFloat(t.view&&t.view.lat||e.workspace.locale.view.lat||0)]);if(e.map=new ol.Map({target:e.mapview.node,interactions:ol.interaction.defaults({mouseWheelZoom:t.scrollWheelZoom||!1}),controls:[],view:new ol.View({projection:"EPSG:"+e.mapview.srid,zoom:o,minZoom:e.workspace.locale.minZoom,maxZoom:e.workspace.locale.maxZoom,center:i,extent:ol.proj.transformExtent([parseFloat(t.bounds&&t.bounds.west||e.workspace.locale.bounds.west),parseFloat(t.bounds&&t.bounds.south||e.workspace.locale.bounds.south),parseFloat(t.bounds&&t.bounds.east||e.workspace.locale.bounds.east),parseFloat(t.bounds&&t.bounds.north||e.workspace.locale.bounds.north)],"EPSG:4326","EPSG:"+e.mapview.srid)})}),e.map.on("movestart",()=>e.mapview.interaction.break=!0),e.mapview.node.addEventListener("changeEnd",()=>{if(Object.values(e.layers.list).forEach(e=>{e.display&&e._dataviews.forEach(e=>e.update()),e.view&&e.tables&&(null===e.tableCurrent()?e.view.classList.add("disabled"):e.view.classList.remove("disabled"))}),e.hooks){const t=ol.proj.transform(e.map.getView().getCenter(),"EPSG:"+e.mapview.srid,"EPSG:4326");e.hooks.set({lat:t[1],lng:t[0],z:e.map.getView().getZoom()})}setTimeout(()=>delete e.mapview.interaction.break,500)}),e.mapview.interaction.highlight.begin(),"never"!==t.zoomControl&&(t.zoomControl||e.workspace.locale.zoomControl)&&e.map.addControl(new ol.control.Zoom),t.attribution&&e.mapview.attribution.create(t.attribution),"never"!==t.showScaleBar&&(t.showScaleBar||e.workspace.locale.showScaleBar)&&e.map.addControl(new ol.control.ScaleLine({target:"ol-scale"})),t.maskBounds||e.workspace.locale.maskBounds){const t=[[180,90],[180,-90],[-180,-90],[-180,90],[180,90]],o=[[e.workspace.locale.bounds.east,e.workspace.locale.bounds.north],[e.workspace.locale.bounds.east,e.workspace.locale.bounds.south],[e.workspace.locale.bounds.west,e.workspace.locale.bounds.south],[e.workspace.locale.bounds.west,e.workspace.locale.bounds.north],[e.workspace.locale.bounds.east,e.workspace.locale.bounds.north]];var n=new ol.Feature({geometry:new ol.geom.Polygon([t,o]).transform("EPSG:4326","EPSG:"+e.mapview.srid)}),r=new ol.layer.Vector({source:new ol.source.Vector({features:[n]}),style:new ol.style.Style({fill:new ol.style.Fill({color:e.utils.Chroma("#000").alpha(.2).rgba()})}),zIndex:999});e.map.addLayer(r)}let a;e.map.on("moveend",(function(){clearTimeout(a),a=setTimeout(()=>e.mapview.node.dispatchEvent(e.mapview.changeEndEvent),500)})),e.hooks&&e.hooks.current.layers.length&&Object.values(e.layers.list).forEach(t=>{t.display=!!~e.hooks.current.layers.indexOf(t.key)}),Object.values(e.layers.list).forEach(e=>e.display&&e.show())},Ke=e=>{const t={create:function(i){t.container&&t.container.remove(),t.container=e.utils.wire()`<div class="attribution">`,e.mapview.node.appendChild(t.container),t.scalebar=e.utils.wire()`<div id="ol-scale">`,t.container.appendChild(t.scalebar),i.logo&&t.container.appendChild(i.logo),t.links=e.utils.wire()`
    <div>
      <a target="_blank" href="https://geolytix.github.io/xyz">XYZ v${e.version}</a>
      <a target="_blank" href="https://openlayers.org">Openlayers</a>`,t.container.appendChild(t.links),e.workspace.locale.attribution&&Object.entries(e.workspace.locale.attribution).forEach(o=>{t.links.appendChild(e.utils.wire()`
        <a target="_blank" href="${o[1]}">${o[0]}`)});t.layer={},o()},check:o,set:i,remove:function(e){Object.entries(e).forEach(e=>{t.layer&&t.layer[e[0]]&&(t.layer[e[0]].remove(),delete t.layer[e[0]])})}};return t;function o(){Object.values(e.layers.list).forEach(e=>{e.display&&e.attribution&&i(e.attribution)})}function i(o){Object.entries(o).forEach(o=>{t.layer&&!t.layer[o[0]]&&(t.layer[o[0]]=e.utils.wire()`
        <a target="_blank" href="${o[1]}">${o[0]}</a>`,t.links.appendChild(t.layer[o[0]]))})}},Ze=e=>{const t={toggle:function(){t.active=!t.active;let o=!0;t.L||(t.L=new ol.layer.Vector({source:new ol.source.Vector({features:[t.marker]}),zIndex:40,style:new ol.style.Style({image:e.mapview.icon(e.mapview.locate.icon)})}));if(!t.active)return e.map.removeLayer(t.L);e.map.addLayer(t.L),t.watcher||(t.watcher=navigator.geolocation.watchPosition(i=>{if(t.active){const n=ol.proj.fromLonLat([parseFloat(i.coords.longitude),parseFloat(i.coords.latitude)]);t.marker.getGeometry().setCoordinates(n),o&&e.map.getView().animate({center:n},{zoom:e.workspace.locale.maxZoom}),o=!1}},e=>{console.error(e)},{}))},active:!1,icon:{type:"geo",scale:.05},marker:new ol.Feature({geometry:new ol.geom.Point([0,0])})};return t},Qe=e=>function(t){const o=(new ol.format.GeoJSON).readFeature({type:"Feature",geometry:t.geometry},{dataProjection:"EPSG:"+(t.dataProjection||e.mapview.srid),featureProjection:"EPSG:"+(t.featureProjection||e.mapview.srid)}),i=new ol.source.Vector({features:[o]}),n=new ol.layer.Vector({source:i,zIndex:isNaN(t.zIndex)?2e3:t.zIndex,style:t.style});return e.map.addLayer(n),n},et=e=>({create:function(t){this.node&&this.node.remove(),this.node=e.utils.wire()`<div class="popup">`,this.node.addEventListener("mousemove",e=>e.stopPropagation());const o=e.utils.wire()`<div>`;o.appendChild(t.content),this.node.appendChild(o),this.overlay&&e.map.removeOverlay(this.overlay);this.overlay=new ol.Overlay({element:this.node,positioning:"bottom-center",autoPan:!0,insertFirst:!0,autoPanAnimation:{duration:250}}),e.map.addOverlay(this.overlay),this.overlay.setPosition(t.coords)}}),tt=e=>{const t={begin:function(){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=t,e.mapview.node.style.cursor="auto",t.featureSet=new Set,e.utils.touch()&&(e.mapview.node.addEventListener("touchend",a),e.mapview.node.addEventListener("touchmove",o),e.mapview.node.addEventListener("touchstart",o));e.mapview.node.addEventListener("click",s),e.mapview.node.addEventListener("mousemove",i),e.mapview.node.addEventListener("mouseout",n)},pointerMove:r,finish:function(){e.mapview.node.removeEventListener("click",s),e.utils.touch()&&(e.mapview.node.removeEventListener("touchend",a),e.mapview.node.removeEventListener("touchmove",o),e.mapview.node.removeEventListener("touchstart",o));e.mapview.node.removeEventListener("mousemove",i),e.mapview.node.removeEventListener("mouseout",n)},select:s,clear:l};return t;function o(e){t.lastmove=e}function i(t){e.mapview.interaction.break||(e.mapview.pointerLocation={x:t.clientX,y:t.clientY},e.mapview.infotip.node&&e.mapview.infotip.position(),r(t))}function n(t){e.mapview.pointerLocation={x:null,y:null},l()}function r(o){const i=new Set;e.map.forEachFeatureAtPixel(e.map.getEventPixel(o),(o,n)=>{i.add(o),t.featureSet.has(o)||(t.feature=o,t.layer=n.get("layer"),t.layer.highlight=o.get("id"),e.mapview.node.style.cursor="pointer",t.layer.L.setStyle(t.layer.L.getStyle()),t.layer.hover&&t.layer.hover.field&&t.layer.infotip())},{layerFilter:t=>Object.values(e.layers.list).some(e=>e.qID&&e.style&&e.style.highlight&&e.L===t),hitTolerance:5}),t.featureSet=i,i.size&&i.has(t.feature)||l()}function a(o){if(t.recentTouched)return;if(t.recentTouched=!0,setTimeout(()=>delete t.recentTouched,1e3),e.mapview.interaction.break)return;if(o.touches.length>1)return;const i=new Set;e.map.forEachFeatureAtPixel(e.map.getEventPixel(t.lastmove),(e,o)=>{i.add(e),t.featureSet.has(e)||(t.feature=e,t.layer=o.get("layer"))},{layerFilter:t=>Object.values(e.layers.list).some(e=>e.qID&&e.L===t),hitTolerance:5}),t.featureSet=i,i.size&&t.feature&&t.layer.select(t.feature)}function s(){t.recentTouched||(e.mapview.popup.overlay&&e.map.removeOverlay(e.mapview.popup.overlay),t.layer&&t.feature&&t.layer.select(t.feature))}function l(){t.featureSet=new Set,e.mapview.infotip.node&&e.mapview.infotip.node.remove(),t.layer&&(t.layer.highlight=!0,e.mapview.node.style.cursor="auto",t.layer.L.setStyle(t.layer.L.getStyle()),delete t.layer,delete t.feature)}},ot=e=>{const t={begin:function(i){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=t,delete t.kinks,t.finish=i.finish||n,t.callback=i.callback,t.layer=i.layer,t.layer.display||t.layer.show();e.mapview.node.style.cursor="crosshair",t.vertices=[],e.map.addLayer(t.Layer),t.interaction=new ol.interaction.Draw({source:t.Layer.getSource(),geometryFunction:i.geometryFunction||o,freehand:i.freehand,type:i.type,condition:o=>!t.kinks&&(1===o.pointerEvent.buttons?(t.vertices.push(o.coordinate),e.mapview.popup.node&&e.mapview.popup.node.remove(),!0):void 0)}),t.interaction.on("drawstart",o=>{i.style&&o.feature.setStyle(new ol.style.Style({stroke:i.style.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(i.style.strokeColor),width:i.style.strokeWidth||1})})),t.Layer.getSource().clear(),e.mapview.popup.node&&e.mapview.popup.node.remove()}),t.interaction.on("drawend",e=>{if(i.freehand&&t.vertices.push(e.target.sketchCoords_.pop()),i.drawend)return i.drawend(e);setTimeout(a,400)}),e.map.addInteraction(t.interaction),e.mapview.node.addEventListener("contextmenu",a)},finish:n,cancel:i,update:r,feature:function(o){const i=t.format.readFeature({type:"Feature",geometry:o.geometry},{dataProjection:o.dataProjection||"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid});t.Layer.getSource().clear(),t.Layer.getSource().addFeature(i)},format:new ol.format.GeoJSON,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return t;function o(o,i){if(!i)return new ol.geom[t.interaction.type_](o);const n=e.utils.turf.kinks({type:t.interaction.type_,coordinates:i.getCoordinates()}).features;return"Polygon"===t.interaction.type_&&o[0].length&&i.setCoordinates([o[0].concat([o[0][0]])]),t.kinks=n.length>0&&n[0].geometry.coordinates.join()!==o[0][0].join(),e.mapview.node.style.cursor=t.kinks?"not-allowed":"crosshair",i}function i(){n(),e.mapview.interaction.highlight.begin()}function n(){t.callback&&(t.callback(),delete t.callback),e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.node.removeEventListener("contextmenu",a),e.map.removeInteraction(t.interaction),e.map.removeLayer(t.Layer),t.Layer.getSource().clear()}function r(){const o=t.Layer.getSource().getFeatures(),n=JSON.parse(t.format.writeFeature(o[0],{dataProjection:"EPSG:"+t.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})),r=new XMLHttpRequest;r.open("POST",e.host+"/api/location/new?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.layer.key,table:t.layer.table})),r.setRequestHeader("Content-Type","application/json"),r.onload=o=>{200===o.target.status&&(t.layer.reload(),e.locations.select({layer:t.layer,table:t.layer.table,id:o.target.response}))},r.send(JSON.stringify({geometry:n.geometry})),i()}function a(o){if(0===t.vertices.length)return;o&&o.preventDefault();const i=e.utils.wire()`<ul>`,a=t.Layer.getSource().getFeatures();a.length&&i.appendChild(e.utils.wire()`
      <li  class="off-white-hover" onclick=${r}>Save</li>`),a.length||i.appendChild(e.utils.wire()`
      <li  class="off-white-hover" onclick=${o=>{o.preventDefault(),t.interaction.removeLastPoint(),t.vertices.pop(),e.mapview.popup.node&&e.mapview.popup.node.remove()}}>Remove last vertex</li>`),i.appendChild(e.utils.wire()`
      <li  class="off-white-hover" onclick=${n}>Cancel</li>`),e.mapview.popup.create({coords:t.vertices[t.vertices.length-1],content:i})}},it=e=>{return{begin:function(o){e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=e.mapview.interaction.edit,e.mapview.interaction.edit.finish=o.finish||t,e.mapview.interaction.edit.callback=o.callback,e.mapview.interaction.edit.location=o.location,e.mapview.node.style.cursor="crosshair",e.mapview.interaction.edit.vertices=[o.location.marker],e.mapview.interaction.edit.feature=[],e.mapview.interaction.edit.Source=new ol.source.Vector({features:[e.mapview.interaction.edit.location.Layer.getSource().getFeatures()[0].clone()]}),e.mapview.interaction.edit.Layer=new ol.layer.Vector({source:e.mapview.interaction.edit.Source,zIndex:20,style:e.mapview.interaction.edit.style}),e.map.addLayer(e.mapview.interaction.edit.Layer),e.mapview.interaction.edit.interaction=new ol.interaction.Modify({source:e.mapview.interaction.edit.Source,condition:t=>"Polygon"!==o.type&&"LineString"===o.type||!(e.mapview.interaction.edit.trail&&e.utils.turf.kinks(e.utils.flatten(e.mapview.interaction.edit.trail).features[0]).features.length>0)}),e.mapview.interaction.edit.interaction.on("modifystart",t=>{e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.feature.push(e.mapview.interaction.edit.Source.getFeatures()[0].clone())}),e.mapview.interaction.edit.interaction.on("modifyend",t=>{e.mapview.interaction.edit.vertices.push(t.mapBrowserEvent.coordinate),"Polygon"!==o.type&&"LineString"!==o.type||r(t)}),e.map.addInteraction(e.mapview.interaction.edit.interaction),e.mapview.node.addEventListener("contextmenu",n)},finish:t,update:o,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#3399CC",width:1})}),new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#3399CC",width:1})}),geometry:function(e){const t=e.getGeometry();return"Point"===t.getType()?new ol.geom.Point(t.getCoordinates()):"LineString"===t.getType()?new ol.geom.MultiPoint(t.getCoordinates()):new ol.geom.MultiPoint(t.getCoordinates()[0])}})]};function t(){delete e.mapview.interaction.edit.finish,e.mapview.interaction.edit.Source&&e.mapview.interaction.edit.Source.clear(),e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.node.removeEventListener("contextmenu",n),e.map.removeLayer(e.mapview.interaction.edit.Layer),e.map.removeInteraction(e.mapview.interaction.edit.interaction),e.mapview.interaction.edit.callback&&e.mapview.interaction.edit.callback(),e.mapview.interaction.highlight.begin(),e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.mapview.interaction.edit.trail=null}function o(){const o=e.mapview.interaction.edit.Source.getFeatures(),i=e.mapview.interaction.edit.location,n=i.layer,r=new ol.format.GeoJSON,a=JSON.parse(r.writeFeature(o[0],{dataProjection:"EPSG:"+n.srid,featureProjection:"EPSG:"+e.mapview.srid})),s=new XMLHttpRequest;s.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.workspace.locale.key,layer:n.key,table:i.table,id:i.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=t=>{if(200!==t.target.status)return;i.Layer.getSource().getFeatures()[0].setGeometry(o[0].getGeometry()),e.map.removeLayer(i.Marker),i.geometry=a.geometry,i.marker=ol.proj.transform(e.utils.turf.pointOnFeature(a.geometry).geometry.coordinates,"EPSG:"+i.layer.srid,"EPSG:"+e.mapview.srid),i.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:i.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(i.record)),color:i.style.strokeColor,scale:.05,anchor:[.5,1]})})}),n.reload()},s.send(JSON.stringify({[n.geom]:a.geometry})),t()}function i(t){e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.Source.clear(),e.mapview.interaction.edit.Source.addFeature(e.mapview.interaction.edit.feature.pop()),e.mapview.interaction.edit.vertices.pop(),r(t)}function n(n){n.preventDefault();const r=e.utils.wire()`<ul>`;!e.mapview.interaction.edit.info&&e.mapview.interaction.edit.feature.length&&r.appendChild(e.utils.wire()`<li class="off-white-hover" onclick=${o}>Update</li>`),e.mapview.interaction.edit.feature.length&&r.appendChild(e.utils.wire()`<li class="off-white-hover" onclick=${i}>Undo</li>`),r.appendChild(e.utils.wire()`<li class="off-white-hover" onclick=${t}>Cancel</li>`),e.mapview.popup.create({coords:e.mapview.interaction.edit.vertices[e.mapview.interaction.edit.vertices.length-1],content:r})}function r(t){const o=new ol.format.GeoJSON;e.mapview.interaction.edit.trail=null,e.mapview.interaction.edit.trail=o.writeFeatureObject(e.mapview.interaction.edit.Source.getFeatures()[0].clone(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid}),"Point"!==e.mapview.interaction.edit.trail.geometry.type&&(e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.utils.turf.kinks(e.mapview.interaction.edit.trail).features.length>0&&(e.mapview.interaction.edit.info=e.utils.wire()`<div class="infotip" style="color:#d32f2f;">Invalid geometry. Right click to continue.`,e.mapview.node.appendChild(e.mapview.interaction.edit.info),e.mapview.interaction.edit.info.style.left=t.mapBrowserEvent.originalEvent.clientX+"px",e.mapview.interaction.edit.info.style.top=t.mapBrowserEvent.originalEvent.clientY+"px",e.mapview.interaction.edit.info.style.opacity=1))}},nt=e=>{const t={begin:function(i={}){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=t,t.callback=i.callback,t.Layer.getSource().clear(),e.map.addLayer(t.Layer),e.mapview.node.style.cursor="zoom-in",t.interaction=new ol.interaction.Draw({source:t.Layer.getSource(),type:"Circle",geometryFunction:ol.draw.createBox(),style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#ddd",width:1}),fill:new ol.style.Stroke({color:e.utils.Chroma("#fff").alpha(.3).rgba()})})}),t.interaction.on("drawend",t=>{e.mapview.flyToBounds(t.feature.getGeometry().getExtent()),o()}),e.map.addInteraction(t.interaction)},finish:i,cancel:o,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return t;function o(){i(),e.mapview.interaction.highlight.begin()}function i(){t.callback&&(t.callback(),delete t.callback),e.mapview.node.style.cursor="auto",e.map.removeInteraction(t.interaction),e.map.removeLayer(t.Layer),t.Layer.getSource().clear()}},rt=e=>({current:{},highlight:tt(e),draw:ot(e),edit:it(e),zoom:nt(e)}),at=e=>function(t){const o=e.map.getView().calculateExtent();if(!t)return{south:o[1],west:o[0],north:o[3],east:o[2]};const i=ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+t);return{south:i[1],west:i[0],north:i[3],east:i[2]}},st=e=>function(t){return(t.svg||t.type&&"circle"!==t.type)&&(t.url=e.utils.svg_symbols(t)),t.type&&"circle"===t.type?new ol.style.Circle({radius:parseInt(t.radius)||10,fill:t.fillColor&&new ol.style.Fill({color:e.utils.Chroma(t.fillColor).alpha(0===t.fillOpacity?0:parseFloat(t.fillOpacity)||1).rgba()}),stroke:t.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(t.strokeColor).alpha(0===t.strokeColor?0:parseFloat(t.strokeOpacity)||1).rgba(),width:parseInt(t.strokeWidth)||1})}):new ol.style.Icon({src:t.url,scale:t.scale||1,anchor:t.anchor||[.5,.5]})},lt=e=>({create:function(t){this.node&&this.node.remove();this.node=e.utils.wire()`<div class="infotip">`,this.node.innerHTML=t,e.mapview.node.appendChild(this.node),this.position()},position:function(){this.node.style.opacity=1,this.node.style.left=e.mapview.pointerLocation.x-this.node.offsetWidth/2+"px",this.node.style.top=e.mapview.pointerLocation.y-15-this.node.offsetHeight+"px"}}),ct=e=>function(t){e.locations.select({locale:e.workspace.locale.key,layer:this,table:this.tableCurrent(),id:t.get("id")})},ut=e=>function(){const t=this,o=new XMLHttpRequest;o.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"infotip",locale:e.workspace.locale.key,layer:t.key,table:t.tableCurrent(),id:t.highlight,coords:"cluster"===t.format&&ol.proj.transform(e.mapview.interaction.highlight.feature.getGeometry().getCoordinates(),"EPSG:"+e.mapview.srid,"EPSG:"+t.srid),field:t.hover.field})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=o=>{200===o.target.status&&e.mapview.infotip.create(o.target.response[t.hover.field])},o.send()},dt=e=>t=>{t.highlight=!0,t.select=ct(e),t.infotip=ut(e),t.reload=()=>{o.clear(),o.refresh({force:!0})};const o=new ol.source.VectorTile({format:new ol.format.MVT({}),transition:0,tileUrlFunction:i=>{const n=t.tableCurrent();if(!n)return o.clear();return`${e.host}/api/layer/mvt/${i[0]}/${i[1]}/${i[2]}?`+e.utils.paramString({locale:e.workspace.locale.key,srid:e.mapview.srid,layer:t.key,table:n,filter:t.filter&&JSON.stringify(t.filter.current)})}});t.L=new ol.layer.VectorTile({source:o,zIndex:t.style.zIndex||1,style:o=>{const i=Object.assign({},t.style.default),n=t.style.theme;if(o.get("strokecolor")&&(i.strokeColor=o.get("strokecolor")),n&&"categorized"===n.type){const e=o.get(n.field);if(void 0===e)return Object.assign(i,{});Object.assign(i,n.cat[e]&&n.cat[e].style||n.cat[e])}if(n&&"graduated"===n.type&&n.cat_arr){const e=parseFloat(o.get(n.field));if(e||0===e){for(let t=0;t<n.cat_arr.length&&!(e<n.cat_arr[t].value);t++)var r=n.cat_arr[t].style||n.cat_arr[t];Object.assign(i,r)}}return Object.assign(i,t.highlight===o.get("id")?t.style.highlight:{},t.highlight===o.get("id")?{zIndex:30}:{zIndex:10}),new ol.style.Style({zIndex:i.zIndex,stroke:i.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(i.strokeColor).alpha(void 0===i.strokeOpacity?1:parseFloat(i.strokeOpacity)||0).rgba(),width:parseFloat(i.strokeWidth)||1}),fill:i.fillColor&&new ol.style.Fill({color:e.utils.Chroma(i.fillColor).alpha(void 0===i.fillOpacity?1:parseFloat(i.fillOpacity)||0).rgba()}),image:i.marker&&e.mapview.icon(i.marker)})}}),t.L.set("layer",t,!0),t.label=e.mapview.layer.mvtLabel(t)},ht=e=>t=>{if(!t.style.label)return;const o=new ol.source.Vector({loader:function(i,n,r){t.xhr&&t.xhr.abort(),this.resolution=n,o.clear();const a=t.tableCurrent();a&&(t.xhr=new XMLHttpRequest,t.xhr.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"labels",locale:e.workspace.locale.key,layer:t.key,table:a,label:t.style.label&&t.style.label.field,filter:t.filter&&JSON.stringify(t.filter.current),west:i[0],south:i[1],east:i[2],north:i[3]})),t.xhr.setRequestHeader("Content-Type","application/json"),t.xhr.responseType="json",t.xhr.onload=e=>{if(200!==e.target.status)return;const t=e.target.response.map(e=>new ol.Feature({geometry:new ol.geom.Point([e.x,e.y]),properties:{label:e.label}}));o.addFeatures(t)},t.xhr.send())},strategy:function(o,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid)]}});return new ol.layer.Vector({source:o,declutter:!!t.style.label&&!!t.style.label.declutter,zIndex:t.style.zIndex||1,style:e=>{const o=e.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:t.style.label.font||"12px sans-serif",text:o.label,stroke:t.style.label.strokeColor&&new ol.style.Stroke({color:t.style.label.strokeColor,width:t.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:t.style.label.fillColor||"#000"})})})}})},pt=e=>t=>{t.highlight=!0,t.select=ct(e),t.infotip=ut(e),t.reload=()=>{o.refresh()};const o=new ol.source.Vector({loader:function(){t.xhr&&t.xhr.abort(),o.clear();const i=t.tableCurrent();i&&(t.xhr=new XMLHttpRequest,t.xhr.open("GET",e.host+"/api/layer/geojson?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.key,table:i,cat:t.style.theme&&t.style.theme.field,filter:t.filter&&JSON.stringify(t.filter.current)})),t.xhr.setRequestHeader("Content-Type","application/json"),t.xhr.responseType="json",t.xhr.onload=i=>{if(200!==i.target.status)return;const n=new ol.format.GeoJSON,r=i.target.response.map(o=>n.readFeature({type:"Feature",geometry:o.geometry,properties:{id:o.properties.id}},{dataProjection:"EPSG:"+t.srid,featureProjection:"EPSG:"+e.mapview.srid}));o.addFeatures(r)},t.xhr.send())},strategy:function(o,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid)]}});t.L=new ol.layer.Vector({source:o,zIndex:t.style.zIndex||1,style:o=>{const i=Object.assign({},t.style.default),n=t.style.theme;if(n&&"categorized"===n.type&&Object.assign(i,n.cat[o.get(n.field)].style||{}),n&&"graduated"===n.type&&n.cat_arr){const e=parseFloat(o.get(n.field));if(e){for(let t=0;t<n.cat_arr.length&&!(e<n.cat_arr[t].value);t++)var r=n.cat_arr[t].style;Object.assign(i,r)}}return Object.assign(i,t.highlight===o.get("id")?t.style.highlight:{},t.highlight===o.get("id")?{zIndex:30}:{zIndex:10}),new ol.style.Style({zIndex:i.zIndex,stroke:i.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(i.strokeColor).alpha(void 0===i.strokeOpacity?1:parseFloat(i.strokeOpacity)||0).rgba(),width:parseInt(i.strokeWidth)||1}),fill:i.fillColor&&new ol.style.Fill({color:e.utils.Chroma(i.fillColor).alpha(void 0===i.fillOpacity?1:parseFloat(i.fillOpacity)||0).rgba()}),image:i.marker&&e.mapview.icon(i.marker)})}}),t.L.set("layer",t,!0)},ft=e=>function(t){const o=this;let i=t.get("properties").count,n=t.getGeometry().getCoordinates(),r=ol.proj.transform(n,"EPSG:"+e.mapview.srid,"EPSG:"+o.srid);const a=new XMLHttpRequest;a.open("GET",e.host+"/api/query/get_nnearest?"+e.utils.paramString({locale:e.workspace.locale.key,layer:o.key,table:o.tableCurrent(),filter:o.filter&&JSON.stringify(o.filter.current),n:i>99?99:i,coords:r})),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.onload=t=>{if(t.target.status>=300)return;let i=t.target.response;if(!(i&&i.length>1))return e.locations.select({locale:e.workspace.locale.key,layer:o,table:o.tableCurrent(),id:i.id});{const t=e.utils.wire()`
      <ul>
      ${i.map(t=>e.utils.wire()`
        <li class="secondary-colour-hover" onclick=${()=>e.locations.select({locale:e.workspace.locale.key,layer:o,table:o.tableCurrent(),id:t.id,marker:t.coords})}>${t.label||'"'+o.cluster_label+'"'}`)}`;e.mapview.popup.create({coords:ol.proj.transform(r,"EPSG:"+o.srid,"EPSG:"+e.mapview.srid),content:t})}},a.send()},mt=e=>t=>{t.highlight=!0,t.select=ft(e),t.infotip=ut(e),t.reload=()=>{o.clear(),o.refresh({force:!0})};const o=new ol.source.Vector({loader:function(i,n,r){t.xhr&&t.xhr.abort(),this.resolution=n,o.clear();const a=t.tableCurrent();a&&(t.xhr=new XMLHttpRequest,t.xhr.open("GET",e.host+"/api/layer/cluster?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.key,table:a,kmeans:t.cluster_kmeans,dbscan:t.cluster_dbscan,pixelRatio:window.devicePixelRatio,aggregate:t.style.theme&&t.style.theme.aggregate,theme:t.style.theme&&encodeURIComponent(Object.keys(t.style.themes).find(e=>t.style.themes[e]===t.style.theme)),label:t.style.label&&t.style.label.field,filter:t.filter&&JSON.stringify(t.filter.current),viewport:[i[0],i[1],i[2],i[3]],z:e.mapview.getZoom()})),t.xhr.setRequestHeader("Content-Type","application/json"),t.xhr.responseType="json",t.xhr.onload=e=>{if(200!==e.target.status)return;const i=e.target.response;t.max_size=i.reduce((e,t)=>Math.max(e,t.properties.size),0);let n=1;const r=i.map(e=>new ol.Feature({id:n++,geometry:new ol.geom.Point(4326==t.srid&&ol.proj.fromLonLat([e.geometry.x,e.geometry.y])||[e.geometry.x,e.geometry.y]),properties:e.properties}));o.addFeatures(r)},t.xhr.send())},strategy:function(o,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid)]}});t.L=new ol.layer.Vector({layer:t,source:o,zIndex:t.style.zIndex||1,style:o=>{const i=o.getProperties().properties,n=i.size>1?Object.assign({},t.style.markerMulti):Object.assign({},t.style.marker),r=Object.assign({},t.style.theme);if(r&&"categorized"===r.type&&Object.assign(n,r.cat[i.cat]&&r.cat[i.cat].style||r.cat[i.cat]),r&&"graduated"===r.type){const e=parseFloat(i.cat);if(e||0===e){for(let t=0;t<r.cat_arr.length&&!(e<r.cat_arr[t].value);t++)var a=r.cat_arr[t].style||r.cat_arr[t];Object.assign(n,a)}}if(r&&"competition"===r.type){let e=i.size,t={layers:{}};Object.entries(i.cat).sort((e,t)=>e[1]-t[1]).forEach(o=>{r.cat[o[0]]&&(t.layers[e/i.size]=r.cat[o[0]].style.fillColor),e-=o[1]}),Object.assign({},n,t)}const s=t.cluster_logscale?1===i.count?n.markerMin||t.style.markerMin:(n.markerMin||t.style.markerMin)+(n.markerMax||t.style.markerMax)/Math.log(t.max_size)*Math.log(i.size):1===i.count?n.markerMin||t.style.markerMin:(n.markerMax||t.style.markerMin)+(n.markerMax||t.style.markerMax)/t.max_size*i.size;return Object.assign(n,t.highlight===o.get("id")&&t.style.highlight),new ol.style.Style({zIndex:parseInt(t.max_size-i.size),image:e.mapview.icon(Object.assign({},n,{scale:s/40*(n.scale||.05)}))})}}),t.label=e.mapview.layer.clusterLabel(t)},gt=e=>t=>{const o=t.URI.indexOf("provider")>0?e.host+"/api/proxy?"+e.utils.paramString({uri:t.URI}):t.URI,i=new ol.source.OSM({url:decodeURIComponent(o),opaque:!1,transition:0});t.L=new ol.layer.Tile({source:i,layer:t,zIndex:-1})},vt=e=>t=>{t.grid_size=Object.values(t.grid_fields)[0],t.grid_color=Object.values(t.grid_fields)[1],t.grid_ratio=!1,t.reload=()=>o.refresh();const o=new ol.source.Vector({loader:function(i,n,r){t.xhr&&t.xhr.abort(),this.resolution=n,o.clear();const a=t.tableCurrent();a&&(t.xhr=new XMLHttpRequest,t.xhr.open("GET",e.host+"/api/layer/grid?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.key,table:a,size:t.grid_size,color:t.grid_color,viewport:[i[0],i[1],i[2],i[3]]})),t.xhr.setRequestHeader("Content-Type","application/json"),t.xhr.responseType="json",t.xhr.onload=e=>{if(200!==e.target.status)return;const i=e.target.response;t.sizeAvg=0,t.colorAvg=0;const n=i.map(e=>{if(parseFloat(e[2])>0)return e[2]=isNaN(e[2])?e[2]:parseFloat(e[2]),e[3]=isNaN(e[3])?e[3]:parseFloat(e[3]),t.grid_ratio&&e[3]>0&&(e[3]/=e[2]),t.sizeAvg+=parseFloat(e[2]),t.colorAvg+=isNaN(e[3])?0:parseFloat(e[3]),new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([e[0],e[1]])),properties:{size:parseFloat(e[2]),color:isNaN(e[3])?e[3]:parseFloat(e[3])}})});function r(e,t,o){const i=e.filter(e=>isFinite(e[t]));return Math[o].apply(null,i.map(e=>e[t]))}t.sizeMin=r(i,2,"min"),t.sizeAvg/=n.length,t.sizeMax=r(i,2,"max"),t.colorMin=r(i,3,"min"),t.colorAvg/=n.length,t.colorMax=r(i,3,"max"),t.colorBins=[];let a=t.style.range.length;for(var s=1;s<a;s++)s<a/2&&t.colorBins.push(t.colorMin+(t.colorAvg-t.colorMin)/(a/2)*s),s===a/2&&t.colorBins.push(t.colorAvg),s>a/2&&t.colorBins.push(t.colorAvg+(t.colorMax-t.colorAvg)/(a/2)*(s-a/2));o.addFeatures(n),t.style.legend.size_min&&(t.style.legend.size_min.textContent=t.sizeMin.toLocaleString("en-GB",{maximumFractionDigits:0})),t.style.legend.size_avg&&(t.style.legend.size_avg.textContent=t.sizeAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),t.style.legend.size_max&&(t.style.legend.size_max.textContent=t.sizeMax.toLocaleString("en-GB",{maximumFractionDigits:0})),t.grid_ratio?(t.style.legend.color_min&&(t.style.legend.color_min.textContent=t.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),t.style.legend.color_avg&&(t.style.legend.color_avg.textContent=t.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),t.style.legend.color_max&&(t.style.legend.color_max.textContent=t.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"}))):(t.style.legend.color_min&&(t.style.legend.color_min.textContent=t.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0})),t.style.legend.color_avg&&(t.style.legend.color_avg.textContent=t.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),t.style.legend.color_max&&(t.style.legend.color_max.textContent=t.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0})))},t.xhr.send())},strategy:function(o,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid)]}});t.L=new ol.layer.Vector({source:o,zIndex:t.style.zIndex||1,style:o=>{const i=o.getProperties().properties,n=i.size<=t.sizeAvg?7+7/t.sizeAvg*i.size:14+7/(t.sizeMax-t.sizeAvg)*(i.size-t.sizeAvg);if(i.hxcolor="#C0C0C0",parseFloat(i.color)){i.hxcolor=t.style.range[0];for(let e=0;e<t.colorBins.length&&!(i.color<t.colorBins[e]);e++)i.hxcolor=t.style.range[e+1]}return new ol.style.Style({image:e.mapview.icon({type:"dot",fillColor:i.hxcolor,scale:n/40*.05})})}}),t.L.set("layer",t,!0)},bt=e=>({mvt:dt(e),mvtLabel:ht(e),geojson:pt(e),cluster:mt(e),clusterLabel:e=>{if(e.style.label)return new ol.layer.Vector({source:e.L.getSource(),declutter:!!e.style.label&&!!e.style.label.declutter,zIndex:e.style.zIndex||1,style:t=>{const o=t.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:e.style.label.font||"12px sans-serif",text:o.label||""+(o.count>1?o.count:""),stroke:e.style.label.strokeColor&&new ol.style.Stroke({color:e.style.label.strokeColor,width:e.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:e.style.label.fillColor||"#000"})})})}})},tiles:gt(e),grid:vt(e)}),yt=e=>(t,o,i)=>{i&&t.style.legend.appendChild(e.utils.wire()`
  <div class="title bold off-black secondary-colour-bb">${i}`);const n={};let r;n.node=e.utils.wire()`<div class="block">`,t.style.legend.appendChild(n.node),n.wrapper=e.utils.wire()`<div style="display: inline-block; width: 65%;">`,n.node.appendChild(n.wrapper),n.stroke_color=e.utils.wire()`<div>Stroke Colour `,n.wrapper.appendChild(n.stroke_color),n.strokeColor=e.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${e=>{n.colorSelect="strokeColor",n.colour_swatch.style.display="table"}}>${o.strokeColor||"#ffffff"}`,n.stroke_color.appendChild(n.strokeColor),n.fill_colour=e.utils.wire()`<div>Fill Colour `,n.wrapper.appendChild(n.fill_colour),n.fillColor=e.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${e=>{n.colorSelect="fillColor",n.colour_swatch.style.display="table"}}>${o.fillColor||"#ffffff"}`,n.fill_colour.appendChild(n.fillColor),n.sample_poly=e.utils.wire()`
  <div
    class="sample-poly"
    style="display: inline-block; ${"border:"+(o.strokeWidth||1)+"px solid "+(o.strokeColor||"#ffffff")}">`,n.sample_poly.style.backgroundColor=o.fillColor,n.node.appendChild(n.sample_poly),n.colour_swatch=e.utils.wire()`
  <tr
    style="width: 100%; margin-bottom: 10px; display: none">`,n.node.appendChild(n.colour_swatch),e.defaults.colours.forEach(i=>{n.colour_swatch.appendChild(e.utils.wire()`
    <td
      title=${i.name}
      style="${"height: 20px; background-color:"+i.hex}"
      onclick=${e=>{n[n.colorSelect].textContent=i.hex,o[n.colorSelect]=i.hex,n.sample_poly.style.backgroundColor=o.fillColor,n.sample_poly.style.border=(o.strokeWidth||1)+"px solid "+o.strokeColor,n.colour_swatch.style.display="none",t.reload()}}>`)}),n.node.appendChild(e.utils.wire()`
  <div style="display: inline-block; width: 35%;">Stroke Weight`),n.node.appendChild(e.utils.wire()`
  <div
    class="input-range"
    style="display: inline-block; width: 65%; padding-top:10px; padding-bottom:6px;">
    <input
      type="range"
      class="secondary-colour-bg"
      min=1
      value=${o.strokeWidth||1}
      max=5
      oninput=${e=>{o.strokeWidth=parseInt(e.target.value),n.sample_poly.style.border=o.strokeWidth+"px solid "+o.strokeColor,clearTimeout(r),r=setTimeout(()=>{r=null,t.reload()},500)}}>`),n.node.appendChild(e.utils.wire()`
  <div style="display: inline-block; width: 35%;">Fill Opacity `),n.node.appendChild(e.utils.wire()`
  <div
    class="input-range"
    style="display: inline-block; width: 65%; padding-top:10px; padding-bottom:6px;">
    <input
      type="range"
      class="secondary-colour-bg"
      min=0.1
      value=${void 0===o.fillOpacity?1:parseFloat(o.fillOpacity)||0}
      max=1
      step=0.1
      oninput=${e=>{o.fillOpacity=e.target.value,clearTimeout(r),r=setTimeout(()=>{r=null,t.reload()},500)}}>`)},wt=e=>(t,o,i)=>{i&&t.style.legend.appendChild(e.utils.wire()`
  <div class="title bold off-black secondary-colour-bb">${i}`);const n={};n.node=e.utils.wire()`<div class="block">`,t.style.legend.appendChild(n.node),n.fill_colour=e.utils.wire()`<div style="display: inline-block; width: 85%;">Fill Colour `,n.node.appendChild(n.fill_colour),n.fillColor=e.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${e=>{n.colorSelect="fillColor",n.colour_swatch.style.display="table"}}>${o.fillColor}`,n.fill_colour.appendChild(n.fillColor),n.sample_wrapper=e.utils.wire()`<div style="display: inline-block; padding-bottom: 5px;">`,n.node.appendChild(n.sample_wrapper),n.sample=e.utils.wire()`<div class="sample-circle">`,n.sample.style.backgroundColor=o.fillColor&&e.utils.Chroma(o.fillColor).alpha(1).hex(),n.sample_wrapper.appendChild(n.sample),n.node.appendChild(n.sample_wrapper),n.node.appendChild(e.utils.wire()`<br>`),n.colour_swatch=e.utils.wire()`
  <tr
    style="width: 100%; margin-bottom: 10px; display: none;">`,n.node.appendChild(n.colour_swatch),e.defaults.colours.forEach(i=>{n.colour_swatch.appendChild(e.utils.wire()`
    <td
      title="${i.name}"
      style="${"height: 20px; background-color:"+i.hex}"
      onclick=${r=>{n[n.colorSelect].textContent=i.hex,o[n.colorSelect]=i.hex,n.sample.style.backgroundColor=e.utils.Chroma(o.fillColor).alpha(1).hex(),n.colour_swatch.style.display="none",t.reload()}}>`)})},xt=e=>t=>{const o=e.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;if(t.style.legend=o,Object.entries(t.style.theme.cat).forEach(i=>{let n=e.utils.wire()`<div style="height: 24px; width: 24px;">`,r=e.utils.wire()`<svg>`;n.appendChild(r);let a=Object.assign({},t.style.default,i[1].style||i[1]);if(void 0===a.fillOpacity){let t=e.utils.wire(null,"svg")`
      <line
        x1=4
        x2=18
        y1=10
        y2=10
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`;r.appendChild(t)}else{let t=e.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${a.fillColor||"#FFF"}
        fill-opacity=${a.fillOpacity}
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`;r.appendChild(t)}o.appendChild(n),o.appendChild(e.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${e=>{e.stopPropagation(),"line-through"===e.target.style.textDecoration?(e.target.style.textDecoration="none",e.target.style.opacity=1,e.target.style.fillOpacity=1,t.filter.current[t.style.theme.field].ni.splice(t.filter.current[t.style.theme.field].ni.indexOf(i[0]),1)):(e.target.style.textDecoration="line-through",e.target.style.opacity=.8,e.target.style.fillOpacity=.8,t.filter.current[t.style.theme.field]||(t.filter.current[t.style.theme.field]={ni:[]}),t.filter.current[t.style.theme.field].ni.push(i[0])),t.reload()}}>${i[1].label||i[0]}`)}),t.style.theme.other){let i=e.utils.wire()`<div style="height: 24px; width: 24px;">`,n=e.utils.wire()`<svg>`;if(i.appendChild(n),void 0===t.style.default.fillOpacity){let o=e.utils.wire(null,"svg")`
      <line
        x1=4
        x2=18
        y1=10
        y2=10
        stroke=${t.style.default.strokeColor}
        stroke-width=${t.style.default.strokeWidth||1}>`;n.appendChild(o)}else{let o=e.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${t.style.default.fillColor||"#FFF"}
        fill-opacity=${t.style.default.fillOpacity}
        stroke=${t.style.default.strokeColor}
        stroke-width=${t.style.default.strokeWidth||1}>`;n.appendChild(o)}o.appendChild(i),o.appendChild(e.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${e=>{e.stopPropagation(),"line-through"===e.target.style.textDecoration?(e.target.style.textDecoration="none",e.target.style.opacity=1,e.target.style.fillOpacity=1,t.filter.current[t.style.theme.field].in=[]):(e.target.style.textDecoration="line-through",e.target.style.opacity=.8,e.target.style.fillOpacity=.8,t.filter.current[t.style.theme.field]||(t.filter.current[t.style.theme.field]={ni:[]}),t.filter.current[t.style.theme.field].in=Object.keys(t.style.theme.cat)),t.reload()}}>other`)}return o},Ct=e=>t=>{if(!t.style.theme.cat_arr)return;const o=e.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;return t.style.legend=o,t.style.theme.cat_arr.forEach(i=>{let n=e.utils.wire()`<div style="height: 24px; width: 24px;">`,r=e.utils.wire()`<svg>`;n.appendChild(r);let a=Object.assign({},t.style.default,i.style||i);r.appendChild(e.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${a.fillColor}
        fill-opacity=${a.fillOpacity}
        stroke=${a.strokeColor}/>`),o.appendChild(n);let s=e.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default;">${i.label||i.value}`;o.appendChild(s)}),o},Et=e=>t=>{const o=e.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;if(t.style.legend=o,Object.entries(t.style.theme.cat).forEach(i=>{let n=e.utils.wire()`<div style="height: 24px; width: 24px;">`,r=e.utils.wire()`<img height=20 width=20>`;r.setAttribute("src",e.utils.svg_symbols(Object.assign({},t.style.marker,i[1].style||i[1]))),n.appendChild(r),o.appendChild(n),o.appendChild(e.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${e=>{e.stopPropagation(),"line-through"===e.target.style.textDecoration?(e.target.style.textDecoration="none",e.target.style.opacity=1,e.target.style.fillOpacity=1,t.filter.current[t.style.theme.field].ni.splice(t.filter.current[t.style.theme.field].ni.indexOf(i[0]),1)):(e.target.style.textDecoration="line-through",e.target.style.opacity=.8,e.target.style.fillOpacity=.8,t.filter.current[t.style.theme.field]||(t.filter.current[t.style.theme.field]={ni:[]}),t.filter.current[t.style.theme.field].ni.push(i[0])),t.reload()}}>${i[1].label||i[0]}`)}),t.style.theme.other){let i=e.utils.wire()`<div style="height: 24px; width: 24px;">`,n=e.utils.wire()`<svg>`,r=e.utils.wire(null,"svg")`
    <image x=0 y=0 width=20 height=20>`;r.setAttribute("href",e.utils.svg_symbols(t.style.marker)),n.appendChild(r),i.appendChild(n),o.appendChild(i),o.appendChild(e.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${e=>{e.stopPropagation(),"line-through"===e.target.style.textDecoration?(e.target.style.textDecoration="none",e.target.style.opacity=1,e.target.style.fillOpacity=1,t.filter.current[t.style.theme.field].in=[]):(e.target.style.textDecoration="line-through",e.target.style.opacity=.8,e.target.style.fillOpacity=.8,t.filter.current[t.style.theme.field]||(t.filter.current[t.style.theme.field]={ni:[]}),t.filter.current[t.style.theme.field].in=Object.keys(t.style.theme.cat)),t.reload()}}>other`)}let i=e.utils.wire()`<div style="height: 40px; width: 40px;">`,n=e.utils.wire()`<img height=40 width=40>`;n.setAttribute("src",e.utils.svg_symbols(t.style.markerMulti)),i.appendChild(n),o.appendChild(i);let r=e.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default; margin-left: 20px; margin-top: 10px;">Multiple Locations`;return o.appendChild(r),o},kt=e=>t=>{if(!t.style.theme.cat_arr)return;const o=e.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;return t.style.legend=o,t.style.theme.cat_arr.forEach(i=>{let n=e.utils.wire()`<div style="height: 24px; width: 24px;">`,r=e.utils.wire()`<img width=20 height=20>`;r.setAttribute("src",e.utils.svg_symbols(Object.assign({},t.style.marker,i.style))),n.appendChild(r),o.appendChild(n);let a=e.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default;">${i.label||i.style}`;o.appendChild(a)}),o},Mt=e=>t=>{t.style.legend.appendChild(e.utils.wire()`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(t.grid_fields)[0]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(t.grid_fields).map(o=>e.utils.wire()`
        <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=o[0],t.grid_size=o[1],t.reload()}}>${o[0]}`)}`);const o=t.style.legend.appendChild(e.utils.wire()`
  <svg xmlns='http://www.w3.org/2000/svg'>`);t.style.legend.appendChild(e.utils.wire()`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(t.grid_fields)[1]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(t.grid_fields).map(o=>e.utils.wire()`
      <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=o[0],t.grid_color=o[1],t.reload()}}>${o[0]}`)}`);let i=15,n=t.style.range.length,r=100/n;for(let t=0;t<n;t++){let a=10*(t+2)/n,s=t*r,l=e.utils.wire(null,"svg")`
    <circle fill='#777'>`;l.setAttribute("cx",s+r/2+1+"%"),l.setAttribute("cy",i+1),l.setAttribute("r",a),o.appendChild(l);let c=e.utils.wire(null,"svg")`
    <circle fill='#999'>`;c.setAttribute("cx",s+r/2+"%"),c.setAttribute("cy",i),c.setAttribute("r",a),o.appendChild(c)}i+=20;for(let a=0;a<n;a++){let s=a*r,l=e.utils.wire(null,"svg")`
    <rect
      height=20
      fill=${t.style.range[a]}>`;l.setAttribute("x",s+"%"),l.setAttribute("y",i),l.setAttribute("width",r+"%"),o.appendChild(l),0===a&&(t.style.legend.color_min=e.utils.wire(null,"svg")`
      <text
        style='font-size:11px; text-anchor: start; 
        font-family: "Open Sans", sans-serif;'>min`,t.style.legend.color_min.setAttribute("x",s+"%"),t.style.legend.color_min.setAttribute("y",i+40),o.appendChild(t.style.legend.color_min)),a===(n/2%1!=0&&Math.round(n/2)-1)&&(t.style.legend.color_avg=e.utils.wire(null,"svg")`
      <text id="grid_legend_color__avg"
        style='font-size:11px; text-anchor: middle; 
        font-family: "Open Sans", sans-serif;'>avg`,t.style.legend.color_avg.setAttribute("x",s+r/2+"%"),t.style.legend.color_avg.setAttribute("y",i+40),o.appendChild(t.style.legend.color_avg)),a===n-1&&(t.style.legend.color_max=e.utils.wire(null,"svg")`
      <text id="grid_legend_color__max"
        style='font-size:11px; text-anchor: end; 
        font-family: "Open Sans", sans-serif;'>max`,t.style.legend.color_max.setAttribute("x",s+r+"%"),t.style.legend.color_max.setAttribute("y",i+40),o.appendChild(t.style.legend.color_max))}return o.style.height=i+43+"px",t.style.legend.appendChild(e.utils.wire()`
  <td style="padding-top: 5px;" colSpan=2>
  <label class="input-checkbox">
  <input type="checkbox"
    onchange=${e=>{t.grid_ratio=e.target.checked,t.reload()}}>
  </input>
  <div></div><span>Display colour as a ratio to the size.`),t.style.legend},_t=e=>{const t={polyCategorized:xt(e),polyGraduated:Ct(e),clusterCategorized:Et(e),clusterGraduated:kt(e),grid:Mt(e)};return o=>(o.style.legend=e.utils.wire()`<div class="legend">`,"grid"===o.format?t.grid(o):(o.filter=o.filter||{},"mvt"===o.format&&"categorized"===o.style.theme.type?t.polyCategorized(o):"mvt"===o.format&&"graduated"===o.style.theme.type?t.polyGraduated(o):"cluster"===o.format&&"categorized"===o.style.theme.type||"cluster"===o.format&&"competition"===o.style.theme.type?t.clusterCategorized(o):"cluster"===o.format&&"graduated"===o.style.theme.type?t.clusterGraduated(o):void 0))},Dt=e=>{const t={panel:function(o){if(!o.style)return;if(!o.style.theme&&o.style.hidden)return;const i=e.utils.wire()`
    <div class="drawer panel expandable ${o.style.theme||"grid"===o.format?"expanded":""}">`;if(i.appendChild(e.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}><span>Style</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),o.style.label&&i.appendChild(e.utils.wire()`
    <label class="input-checkbox" style="margin-bottom: 10px;">
    <input type="checkbox"
      checked=${!!o.style.label.display}
      onchange=${e=>{o.style.label.display=e.target.checked,o.show()}}>
    </input>
    <div></div><span>Display Labels.`),o.style.theme&&!o.style.hidden){const t=Object.assign({Basic:null},o.style.themes);i.appendChild(e.utils.wire()`<div>Select thematic style.`),i.appendChild(e.utils.wire()`
      <button class="btn-drop">
      <div
        class="head"
        onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
        <span>${Object.keys(t)[1]}</span>
        <div class="icon"></div>
      </div>
      <ul>
        ${Object.entries(t).map(t=>e.utils.wire()`
          <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.querySelector("span").textContent=t[0],i.classList.toggle("active"),o.style.theme=t[1],n(o),o.reload()}}>${t[0]}`)}`)}o.style.theme&&o.style.themes&&o.style.hidden&&i.appendChild(e.utils.wire()`<span style="font-weight: bold;">${Object.keys(o.style.themes)[0]}`);return i.appendChild(e.utils.wire()`
      <div class="switch-all" style="font-size: 90%; display:none;">Click on labels to switch visibity or 
      <a class="primary-colour" style="cursor: pointer;"
      onclick=${e=>{e.stopPropagation();i.querySelectorAll(".switch").forEach(e=>e.click()),o.reload()}}>switch all</a>.`),o.style.bringToFront=e.utils.wire()`<button 
      title="Bring layer to front."
      style="margin-top: 5px;"
      class="btn-wide primary-colour"
      onclick=${()=>o.bringToFront()}>Bring layer to front`,n(o),i;function n(o){if(i.querySelector(".switch-all").style.display=o.style.theme&&"categorized"===o.style.theme.type?"block":"none",o.style.legend&&o.style.legend.remove(),o.style.bringToFront.remove(),o.style.theme||"grid"===o.format)return o.style.bringToFront.disabled=!o.display,i.appendChild(e.layers.view.style.legend(o)),void i.appendChild(o.style.bringToFront);o.style.legend=e.utils.wire()`<div class="legend">`,o.style.marker&&t.clusterStyle(o,o.style.marker,"Marker"),o.style.markerMulti&&t.clusterStyle(o,o.style.markerMulti,"MultiMarker"),o.style.default&&t.polyStyle(o,o.style.default,"Polygon"),o.style.highlight&&t.polyStyle(o,o.style.highlight,"Highlight"),i.appendChild(o.style.legend),o.style.bringToFront.disabled=!o.display,i.appendChild(o.style.bringToFront)}},legend:_t(e),polyStyle:yt(e),clusterStyle:wt(e)};return t},St=e=>(t,o)=>{if(o.el&&o.el.parentNode)return e.layers.view.filter.reset(t,o);const i=e.layers.view.filter.block(t,o);i.dataset.field=o.field,o.el=i,i.appendChild(e.utils.wire()`
  <input type="text" placeholder="Search" onkeyup=${e=>{t.filter.current[o.field]={},t.filter.current[o.field][o.filter]=encodeURIComponent(e.target.value),t.reload(),t.show(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})}}>`)},Rt=e=>(t,o)=>{if(o.el&&o.el.parentNode)return e.layers.view.filter.reset(t,o);const i=new XMLHttpRequest;i.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"field_stats",locale:e.workspace.locale.key,layer:t.key,table:t.tableCurrent(),field:o.field,filter:t.filter&&JSON.stringify(t.filter.current)})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{const n=i.target.response,r=e.layers.view.filter.block(t,o);r.dataset.field=o.field,o.el=r;const a="integer"===o.type?1:.01;var s=e.utils.wire()`
    <div class="input-flex">
      <span>Greater or equal`;const l=e.utils.wire()`
    <input
      type="number"
      min=${n.min}
      value=${n.min}
      max=${n.max}
      step=${a}
      onkeyup=${e=>{u.value=e.target.value,m()}}>`;s.appendChild(l),r.appendChild(s);const c=e.utils.wire()`<div class="input-range">`;r.appendChild(c);const u=e.utils.wire()`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${n.min}
      value=${n.min}
      max=${n.max}
      step=${a}
      oninput=${e=>{l.value=e.target.value,m()}}>`;c.appendChild(u);s=e.utils.wire()`
    <div class="input-flex">
      <span>Smaller or equal`;const d=e.utils.wire()`
    <input
      type="number"
      min=${n.min}
      value=${n.max}
      max=${n.max}
      step=${a}
      onkeyup=${e=>{p.value=e.target.value,m()}}>`;s.appendChild(d),r.appendChild(s);var h=e.utils.wire()`<div class="input-range">`;r.appendChild(h);const p=e.utils.wire()`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${n.min}
      value=${n.max}
      max=${n.max}
      step=${a}
      oninput=${e=>{d.value=e.target.value,m()}}>`;let f;function m(){clearTimeout(f),f=setTimeout(()=>{f=null,t.filter.current[o.field]={},t.filter.current[o.field].gte=parseFloat(l.value),t.filter.current[o.field].lte=parseFloat(d.value),t.reload(),t.show(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})},500)}h.appendChild(p)},i.send()},Tt=e=>(t,o)=>{if(o.el&&o.el.parentNode)return e.layers.view.filter.reset(t,o);const i=e.layers.view.filter.block(t,o);i.dataset.field=o.field,o.el=i,o.filter.in.forEach(n=>{i.appendChild(e.utils.wire()`
    <label class="input-checkbox">
    <input
      type="checkbox"
      onchange=${e=>{if(t.filter.current[o.field]||(t.filter.current[o.field]={in:[]}),e.target.checked)t.filter.current[o.field].in.push(encodeURIComponent(e.target.parentNode.innerText));else{let i=t.filter.current[o.field].in.indexOf(encodeURIComponent(e.target.parentNode.innerText));t.filter.current[o.field].in.splice(i,1)}t.reload(),t.show(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})}}>
    </input>
    <div></div><span>${n}`)})},Lt=e=>(t,o)=>{if(o.el&&o.el.parentNode)return e.layers.view.filter.reset(t,o);const i=e.layers.view.filter.block(t,o);i.dataset.field=o.field,o.el=i;var n=e.utils.wire()`
  <div class="input-flex">
    <span>After`;const r=e.utils.wire()`
  <input type="text" readonly placeholder="Pick from calendar." style="width: 60%;">`;n.appendChild(r),i.appendChild(n);n=e.utils.wire()`
  <div class="input-flex">
    <span>Before`;const a=e.utils.wire()`
  <input type="text" readonly placeholder="Pick from calendar." style="width: 60%;">`;let s;function l(){clearTimeout(s),s=setTimeout(()=>{s=null,t.filter.current[o.field]={},t.filter.current[o.field].gt=e.utils.meltDateStr(r.value)||null,t.filter.current[o.field].lt=e.utils.meltDateStr(a.value)||null,t.reload(),t.show(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})},500)}n.appendChild(a),i.appendChild(n),e.utils.flatpickr({element:r,enableTime:"datetime"===o.type,callback:e=>{r.value=e,l()}}),e.utils.flatpickr({element:a,enableTime:"datetime"===o.type,callback:e=>{a.value=e,l()}})},Pt=e=>(t,o)=>{if(o.el&&o.el.parentNode)return e.layers.view.filter.reset(t,o);const i=e.layers.view.filter.block(t,o);i.dataset.field=o.field,o.el=i,t.filter.current[o.field]||(t.filter.current[o.field]={}),t.filter.current[o.field].boolean=!0,i.appendChild(e.utils.wire()`
  <label class="input-checkbox">
  <input type="checkbox"
    checked=true 
    onchange=${e=>{e.target.checked?t.filter.current[o.field].boolean=!0:t.filter.current[o.field].boolean=!1,t.reload(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})}}>
  </input>
  <div></div><span>${o.name||"True"}`),t.reload(),t.show(),t.count(e=>{t.filter.run_output.disabled=!(e>1),o.filterZoom&&e>1&&t.zoomToExtent()})},At=e=>{const t={panel:function(o){if(!o.infoj)return;if(!o.infoj.some(e=>e.filter))return;o.filter.current={};const i=o.infoj.filter(e=>e.filter);i.unshift("Select filter from list.");const n=e.utils.wire()`
    <div class="drawer panel expandable">`;n.appendChild(e.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}><span>Filter</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`);let r={};Object.values(i).forEach(e=>{e.field&&(r[e.field]=e.title||e.field)}),o.filter.select=e.utils.wire()`
      <button class="btn-drop">
      <div
        class="head"
        onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
        <span>Select filter from list.</span>
        <div class="icon"></div>
      </div>
      <ul>
        ${Object.entries(r).map(n=>e.utils.wire()`
          <li onclick=${e=>{e.target.closest(".btn-drop").classList.toggle("active");const r=i.find(e=>e.field===n[0]);return o.filter.clear_all.style.display="block","date"==r.filter?t.filter_date(o,r):"numeric"===r.filter?t.filter_numeric(o,r):"like"===r.filter||"match"===r.filter?t.filter_text(o,r):r.filter.in?t.filter_in(o,r):"boolean"===r.filter?t.filter_boolean(o,r):void 0}}>${n[1]}`)}`,n.appendChild(o.filter.select),o.filter.clear_all=e.utils.wire()`
    <button
      class="primary-colour"
      style="display: none; margin-bottom: 5px;"
      onclick=${e=>{e.target.style.display="none",o.filter.list.innerHTML=null,o.filter.current={},o.reload(),o.count(e=>{o.filter.run_output.disabled=!(e>1)})}}>Clear all filters`,n.appendChild(o.filter.clear_all),o.filter.list=e.utils.wire()`<div>`,n.appendChild(o.filter.list),o.filter.run_output=e.utils.wire()`
    <button
      style="margin-top: 5px;"
      class="btn-wide primary-colour"
      onclick=${()=>{const t=new XMLHttpRequest;t.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"filter_aggregate",locale:e.workspace.locale.key,layer:o.key,table:o.tableMin(),filter:o.filter&&JSON.stringify(o.filter.current)})),t.setRequestHeader("Content-Type","application/json"),t.responseType="json",t.onload=t=>{if(200!==t.target.status)return;const i=o.filter.infoj.map(e=>(e.value=t.target.response[e.field],e));e.locations.select({_new:!0,_flyTo:!0,geometry:JSON.parse(t.target.response.geometry),infoj:i,layer:o})},t.send()}}>Run Output`,n.appendChild(o.filter.run_output),o.filter.infoj||(o.filter.run_output.style.display="none");return o.count(e=>{o.filter.run_output.disabled=!(e>1)}),n},block:function(t,o){const i=e.utils.wire()`
    <div class="drawer">
    <div class="header bold">
    <span>${o.title}</span>
    <button
      class="btn-header xyz-icon icon-close primary-colour-filter"
      onclick=${e=>{delete t.filter.current[o.field],t.reload(),i.remove(),t.filter.list.children.length||(t.filter.clear_all.style.display="none")}}>`;return t.filter.list.appendChild(i),i},reset:function(e,t){t.el.parentNode.removeChild(t.el),t.el=null,e.filter.list.children.length||(e.filter.clear_all.style.display="none")},filter_text:St(e),filter_numeric:Rt(e),filter_in:Tt(e),filter_date:Lt(e),filter_boolean:Pt(e)};return t},Ft=e=>t=>e.utils.wire()`
    <button
      class="btn-wide primary-colour"
      onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Point",callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Point`,Ot=e=>t=>e.utils.wire()`
<button
  class="btn-wide primary-colour"
  onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Polygon",callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Polygon`,zt=e=>t=>e.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Circle",geometryFunction:ol.draw.createBox(),callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Rectangle`,It=e=>t=>e.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Circle",geometryFunction:ol.draw.createRegularPolygon(33),callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Circle`,jt=e=>t=>e.utils.wire()`
    <button
      class="btn-wide primary-colour"
      onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"LineString",callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Line`,Nt=e=>t=>e.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"LineString",freehand:!0,callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Freehand`,Ht=e=>t=>{"object"!=typeof t.edit.isoline_mapbox&&(t.edit.isoline_mapbox={});const o=e.utils.wire()`<div>`,i=e.utils.wire()`
      <div
        class="drawer group panel expandable"
      style="max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${t=>{e.utils.toggleExpanderParent(t.target)}}><span>Mapbox Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;t.edit.isoline_mapbox.profile=t.edit.isoline_mapbox.profile||"driving",t.edit.isoline_mapbox.minutes=t.edit.isoline_mapbox.minutes||10;return t.edit.isoline_mapbox.profile="driving",i.appendChild(e.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"driving"},{Walking:"walking"},{Cycling:"cycling"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_mapbox.profile=Object.values(o)[0]}}>${Object.keys(o)[0]}`)}`),i.appendChild(e.utils.wire()`
    <div style="margin-top: 12px;">
        <span>Travel time in minutes: </span>
        <span class="bold">${t.edit.isoline_mapbox.minutes}</span>
        <div class="input-range">
        <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${t.edit.isoline_mapbox.minutes}
        max=60
        step=1
        oninput=${e=>{t.edit.isoline_mapbox.minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_mapbox.minutes}}>`),o.appendChild(i),o.appendChild(e.utils.wire()`
    <button
        class="btn-wide primary-colour"
        onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Point",geometryFunction:function(o,i){i=new ol.geom.Circle(o,1e3*t.edit.isoline_mapbox.minutes);const n=ol.proj.transform(o,"EPSG:"+e.mapview.srid,"EPSG:4326"),r=new XMLHttpRequest;return r.open("GET",e.host+"/api/provider/mapbox?"+e.utils.paramString({url:`api.mapbox.com/isochrone/v1/mapbox/${t.edit.isoline_mapbox.profile||"driving"}/${n.join(",")}?`,contours_minutes:t.edit.isoline_mapbox.minutes,generalize:t.edit.isoline_mapbox.minutes,polygons:!0})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=t=>{if(200!==t.target.status||!t.target.response.features)return alert("No route found. Try a longer travel time or alternative setup.");e.mapview.interaction.draw.feature({geometry:t.target.response.features[0].geometry,dataProjection:"EPSG:4326"})},r.send(),i},callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Isoline Mapbox`),o},Bt=e=>t=>{"object"!=typeof t.edit.isoline_here&&(t.edit.isoline_here={});const o=e.utils.wire()`<div>`,i=e.utils.wire()`
      <div
        class="drawer group panel expandable"
      style="max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${t=>{e.utils.toggleExpanderParent(t.target)}}><span>Here Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;t.edit.isoline_here.minutes=t.edit.isoline_here.minutes||10,t.edit.isoline_here.distance=t.edit.isoline_here.distance||10;t.edit.isoline_here.mode="car",i.appendChild(e.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"car"},{Walking:"pedestrian"},{Cargo:"truck"},{"HOV lane":"carHOV"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_here.mode=Object.values(o)[0]}}>${Object.keys(o)[0]}`)}`);t.edit.isoline_here.rangetype="time",i.appendChild(e.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Range</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Time (min)</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{"Time (min)":"time"},{"Distance (km)":"distance"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_here.rangetype=Object.values(o)[0];const r=n.querySelector("input");"time"===t.edit.isoline_here.rangetype&&(n.querySelector("span").textContent="Travel time in minutes: ",r.oninput=e=>{t.edit.isoline_here.minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here.minutes},r.value=t.edit.isoline_here.minutes,r.parentNode.previousElementSibling.textContent=t.edit.isoline_here.minutes),"distance"===t.edit.isoline_here.rangetype&&(n.querySelector("span").textContent="Travel distance in kilometer: ",r.oninput=e=>{t.edit.isoline_here.distance=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here.distance},r.value=t.edit.isoline_here.distance,r.parentNode.previousElementSibling.textContent=t.edit.isoline_here.distance)}}>${Object.keys(o)[0]}`)}`);const n=e.utils.wire()`
    <div style="margin-top: 12px;">
        <span>Travel time in minutes: </span>
        <span class="bold">${t.edit.isoline_here.minutes}</span>
        <div class="input-range">
        <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${t.edit.isoline_here.minutes}
        max=60
        step=1
        oninput=${e=>{t.edit.isoline_here.minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here.minutes}}>`;return i.appendChild(n),o.appendChild(i),o.appendChild(e.utils.wire()`
    <button
        class="btn-wide primary-colour"
        onclick=${o=>{o.stopPropagation();const i=o.target;if(i.classList.contains("active"))return e.mapview.interaction.draw.cancel();i.classList.add("active"),t.show(),t.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:t,type:"Point",geometryFunction:function(o,i){i=new ol.geom.Circle(o,1e3*t.edit.isoline_here.minutes);const n=ol.proj.transform(o,"EPSG:"+e.mapview.srid,"EPSG:4326"),r=new XMLHttpRequest,a="time"===t.edit.isoline_here.rangetype?60*(t.edit.isoline_here.minutes||10)||600:"distance"===t.edit.isoline_here.rangetype?1e3*(t.edit.isoline_here.distance||1)||1e3:600;return r.open("GET",e.host+"/api/provider/here?"+e.utils.paramString({url:"isoline.route.api.here.com/routing/7.2/calculateisoline.json?",mode:`${t.edit.isoline_here.type||"fastest"};${t.edit.isoline_here.mode||"car"};traffic:disabled`,start:"geo!"+n.reverse().join(","),range:a,rangetype:t.edit.isoline_here.rangetype||"time"})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=t=>{if(200!==t.target.status||!t.target.response.response)return alert("No route found. Try a longer travel time or alternative setup.");e.mapview.interaction.draw.feature({geometry:{type:"Polygon",coordinates:[t.target.response.response.isoline[0].component[0].shape.map(e=>e.split(",").reverse())]},dataProjection:"EPSG:4326"})},r.send(),i},callback:()=>{t.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),i.classList.remove("active")}})}}>Isoline Here`),o},Vt=e=>{const t={panel:function(o){if(!o.edit)return;const i=e.utils.wire()`
    <div class="drawer panel expandable">`;if(i.appendChild(e.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}><span>Add new Locations</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),o.edit.point&&i.appendChild(t.point(o)),o.edit.polygon&&i.appendChild(t.polygon(o)),o.edit.rectangle&&i.appendChild(t.rectangle(o)),o.edit.circle&&i.appendChild(t.circle(o)),o.edit.line&&i.appendChild(t.line(o)),o.edit.freehand&&i.appendChild(t.freehand(o)),o.edit.isoline_mapbox&&i.appendChild(t.isoline_mapbox(o)),o.edit.isoline_here&&i.appendChild(t.isoline_here(o)),i.children.length<2)return;return i},polygon:Ot(e),point:Ft(e),rectangle:zt(e),circle:It(e),line:jt(e),freehand:Nt(e),isoline_mapbox:Ht(e),isoline_here:Bt(e)};return t},Wt=e=>({panel:function(t){if(!t.dataviews||!e.dataviews.tabview.node)return;const o=e.utils.wire()`
    <div class="drawer panel expandable">`;return o.appendChild(e.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}><span>Data Views</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(t.dataviews).forEach(i=>{i[1].key=i[0],i[1].layer=t,o.appendChild(e.utils.wire()`
        <label class="input-checkbox">
        <input
          type="checkbox"
          checked=${!!i[1].display}
          onchange=${t=>{if(i[1].display=t.target.checked,i[1].display)return e.dataviews.tabview.add(i[1]);i[1].remove()}}>
        </input>
        <div></div><span>${i[1].title||i[0]}`),i[1].display&&t.display&&e.dataviews.tabview.add(i[1])}),o}}),$t=e=>({panel:function(t){if(!t.report)return;if(!t.report.templates)return;const o=e.utils.wire()`
    <div class="drawer panel expandable">`;return o.appendChild(e.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}><span>Reports</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(t.report.templates).forEach(i=>{const n=e.host+"/view/"+encodeURIComponent(t.report.template)+"?"+e.utils.paramString(Object.assign(i[1],{locale:e.workspace.locale.key,layer:t.key,lat:e.hooks.current.lat,lng:e.hooks.current.lng,z:e.hooks.current.z}));o.appendChild(e.utils.wire()`
      <a
        target="_blank"
        href="${n}"
        class="link-with-img">
        <div class="xyz-icon icon-event-note"></div><span>${i[1].name||i[0]}`)}),o}}),Gt=e=>{const t={create:function(o){o.view=e.utils.wire()`<div class="drawer layer-view">`;const i=e.utils.wire()`
    <div class="header enabled"><span>${o.name||o.key}`;"cluster"===o.format&&o.style.marker&&i.appendChild(e.utils.wire()`
      <img
        class="btn-header"
        title="Default icon"
        style="float: right; cursor: help;"
        src="${e.utils.svg_symbols(o.style.marker)}">`);if(i.appendChild(e.utils.wire()`
    <button
      title="Zoom to filtered layer extent"
      class="btn-header xyz-icon icon-fullscreen"
      onclick=${e=>{e.stopPropagation(),o.zoomToExtent()}}>`),i.toggleDisplay=e.utils.wire()`
    <button
      title="Toggle visibility"
      class="${"btn-header xyz-icon icon-toggle "+(o.display&&"on")}"
      onclick=${e=>{e.stopPropagation(),o.display?o.remove():o.show()}}>`,i.appendChild(i.toggleDisplay),o.view.addEventListener("toggleDisplay",()=>{i.toggleDisplay.classList.toggle("on"),o.style&&o.style.bringToFront&&(o.style.bringToFront.disabled=!!o.display)}),o.view.appendChild(i),o.meta){const t=e.utils.wire()`<p class="meta">`;t.innerHTML=o.meta,o.view.appendChild(t)}const n=t.style.panel(o);n&&o.view.appendChild(n);const r=t.filter.panel(o);r&&o.view.appendChild(r);const a=t.data.panel(o);a&&o.view.appendChild(a);const s=t.draw.panel(o);s&&o.view.appendChild(s);const l=t.report.panel(o);if(l&&o.view.appendChild(l),o.scripts&&Object.entries(o.scripts).forEach(t=>{const i=e.utils.wire()`<script src="${t[1]}">`,n=r=>{r.detail(e,o),document.removeEventListener(t[0],n,!0),i.remove()};document.addEventListener(t[0],n,!0),o.view.appendChild(i)}),o.view.children.length<=1)return;o.view.classList.add("expandable"),i.onclick=t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)},i.appendChild(e.utils.wire()`
    <button
      title="Toggle layer dashboard"
      class="btn-header xyz-icon icon-expander"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target)}}>`);const c=o.view.querySelector(".panel");c&&c.classList.add("expanded")},style:Dt(e),filter:At(e),draw:Vt(e),report:$t(e),data:Wt(e)};return t},qt=e=>({init:function(t){e.layers.listview.node=t.target,e.layers.listview.node.innerHTML="",e.layers.listview.groups={},Object.values(e.layers.list).forEach(t=>{if(e.layers.view.create(t),!t.group)return e.layers.listview.node.appendChild(t.view),t.view.querySelectorAll(".panel").forEach(e=>{e.style.maxHeight=e.querySelector(".header").offsetHeight+"px"}),void(t.view.style.maxHeight=t.view.querySelector(".header").offsetHeight+"px");e.layers.listview.groups[t.group]||function(t){const o={list:[]};e.layers.listview.groups[t.group]=o;const i=e.utils.wire()`
    <div class="drawer layer-group expandable">`;e.layers.listview.node.appendChild(i);const n=e.utils.wire()`
    <div
      class="header enabled"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target,!0)}}>
      <span>${t.group}`;i.appendChild(n);const r=e.utils.wire()`<div class="meta">`;i.appendChild(r),o.chkVisibleLayer=()=>{o.list.some(e=>e.display)?a.classList.add("on"):a.classList.remove("on")},o.addLayer=t=>{if(t.groupmeta){const o=e.utils.wire()`<div>`;o.innerHTML=t.groupmeta,r.appendChild(o)}o.list.push(t),i.appendChild(t.view),t.view.querySelectorAll(".panel").forEach(e=>{e.style.maxHeight=e.querySelector(".header").offsetHeight+"px"}),t.view.style.maxHeight=t.view.querySelector(".header").offsetHeight+"px",o.chkVisibleLayer()};const a=e.utils.wire()`
    <button
      class="btn-header xyz-icon icon-toggle"
      title="Hide layers from group"
      onclick=${e=>{e.stopPropagation(),e.target.classList.toggle("on"),e.target.classList.contains("on")?o.list.filter(e=>!e.display).forEach(e=>e.show()):o.list.filter(e=>e.display).forEach(e=>e.remove())}}>`;n.appendChild(a),n.appendChild(e.utils.wire()`
    <button 
      class="xyz-icon btn-header icon-expander"
      title="Toggle group panel"
      onclick=${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target)}}>`),i.style.maxHeight=n.offsetHeight+"px"}(t),e.layers.listview.groups[t.group].addLayer(t)})}}),Yt=e=>function(){if(!this.tables)return this.table;let t,o=parseInt(e.mapview.getZoom()),i=Object.keys(this.tables),n=parseInt(i[0]),r=parseInt(i[i.length-1]);return t=this.tables[o],t=o<n?this.tables[n]:t,t=o>r?this.tables[r]:t,t},Ut=e=>function(){if(!this.tables)return this.table;let e=Object.keys(this.tables);return this.tables[e[0]]||this.tables[e[1]]},Xt=e=>function(){if(!this.tables)return this.table;let e=Object.keys(this.tables);return this.tables[e[e.length-1]]||this.tables[e[e.length-2]]},Jt=e=>function(t){const o=new XMLHttpRequest;o.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"layer_extent",locale:e.workspace.locale.key,srid:e.mapview.srid,layer:this.key,filter:this.filter&&JSON.stringify(this.filter.current)})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=o=>{if(200!==o.target.status)return;const i=/\((.*?)\)/.exec(o.target.response.box2d)[1].replace(/ /g,",");e.mapview.flyToBounds(i.split(",").map(e=>parseFloat(e)),t)},o.send()},Kt=e=>function(){const t=this;!t.display&&t.view&&t.view.dispatchEvent(new CustomEvent("toggleDisplay")),t.display=!0,t.L&&e.map.removeLayer(t.L),e.map.addLayer(t.L),t.style&&t.style.label&&(e.map.getLayers().forEach(o=>{o===t.label&&e.map.removeLayer(t.label)}),t.style.label.display&&e.map.addLayer(t.label)),e.mapview.attribution.check(),e.hooks&&e.hooks.push("layers",t.key),t.group&&e.layers.listview.groups&&e.layers.listview.groups[t.group]&&e.layers.listview.groups[t.group].chkVisibleLayer(),t.dataviews&&e.dataviews.tabview.node&&Object.entries(t.dataviews).forEach(t=>{t[1].display&&e.dataviews.tabview.add(t[1])})},Zt=e=>function(){const t=this;t.display&&t.view&&t.view.dispatchEvent(new CustomEvent("toggleDisplay")),t.display=!1,t.L&&e.map.removeLayer(t.L),t.style&&t.style.label&&t.label&&e.map.removeLayer(t.label),t.attribution&&e.mapview.attribution.remove(t.attribution),e.mapview.attribution.check(),e.hooks&&e.hooks.filter("layers",t.key),t.group&&e.layers.listview.groups&&e.layers.listview.groups[t.group]&&e.layers.listview.groups[t.group].chkVisibleLayer(),t.dataviews&&e.dataviews.tabview.node&&Object.entries(t.dataviews).forEach(e=>{e[1].tab&&e[1].remove()})},Qt=e=>function(t){const o=new XMLHttpRequest;o.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"count_locations",locale:e.workspace.locale.key,layer:this.key,table:this.tableMin(),filter:this.filter&&JSON.stringify(this.filter.current)})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=e=>{200===e.target.status&&t&&t(parseInt(e.target.response.count))},o.send()},eo=e=>function(){1e3!==this.L.getZIndex()&&(Object.values(e.layers.list).map(e=>{"tiles"!==e.format&&e.L.setZIndex(e.style.zIndex||1)&&e.display&&e.reload()}),this.L.setZIndex(1e3),this.reload())},to=e=>t=>{e.mapview.popup.node&&e.mapview.popup.node.remove(),t.hook=`${t.layer.key}!${t.table}!${t.id}`;let o={stamp:parseInt(Date.now())};if(e.locations.list.some(e=>{if(e.location&&e.location.hook===t.hook)return e.location.remove(),e.stamp=0,!0}))return;for(const t of e.locations.list){if(!t.location){o=t;break}t.stamp<o.stamp&&(o=t)}if(o.stamp=parseInt(Date.now()),o.location&&o.location.remove(),o.location=t,t.style=o.style,t.colorFilter=o.colorFilter,t._new)return e.locations.decorate(t),t.marker=ol.proj.transform(e.utils.turf.pointOnFeature(t.geometry).geometry.coordinates,"EPSG:"+t.layer.srid,"EPSG:"+e.mapview.srid),"function"==typeof t.callback?t.callback(t):e.locations.selectCallback(t);const i=new XMLHttpRequest;o.location.xhr=i,i.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.layer.key,table:t.table,id:t.id})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{if(i.target.status>200)return delete o.stamp,void(e.hooks&&e.hooks.filter("locations",t.hook));e.hooks&&e.hooks.push("locations",t.hook);const n=t.layer.infoj.map(t=>{const o=e.utils.cloneDeep(t);return o.title=i.target.response.properties[o.field+"_label"]||o.title,o.value=i.target.response.properties[o.field],o});if(e.locations.decorate(t,{infoj:n,geometry:i.target.response.geometry,editable:t.layer.edit,record:o}),t.marker=ol.proj.transform(e.utils.turf.pointOnFeature(i.target.response.geometry).geometry.coordinates,"EPSG:"+t.layer.srid,"EPSG:"+e.mapview.srid),"function"==typeof t.callback)return t.callback(t);e.locations.selectCallback(t)},i.send(),o.location.remove=()=>{o.location.xhr.abort(),o.location=null}},oo=e=>t=>(e.locations.view.create(t),t.draw(),t.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:t.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(t.record)),color:t.style.strokeColor,scale:.05,anchor:[.5,1]})})}),t._flyTo&&t.flyTo(),e.mapview.popup?e.locations.listview.node?e.locations.listview.add(t):void e.mapview.popup.create({coords:t.marker,content:t.view}):alert(JSON.stringify(t.infoj,e.utils.getCircularReplacer()," "))),io=e=>t=>{if(!t.infoj||t.infoj.length<1)return;t.geometries=t.geometries.filter(t=>{e.map.removeLayer(t)}),t.geometryCollection=t.geometryCollection.filter(t=>{e.map.removeLayer(t)}),t.tabviews.forEach(e=>e.remove&&e.remove());const o=e.utils.wire()`
  <div class="location-view-grid" style="display: grid;">`,i={};for(const n of t.infoj){if(t.view&&t.view.classList.contains("disabled"))break;if(n.edit||null!==n.value)if(n.listview=o,"report"===document.body.dataset.viewmode&&(n.edit=null),n.location=t,n.displayValue="numeric"===n.type?parseFloat(n.value).toLocaleString("en-GB",{maximumFractionDigits:2}):"integer"===n.type?parseInt(n.value).toLocaleString("en-GB",{maximumFractionDigits:0}):"date"===n.type?e.utils.formatDate(n.value):"datetime"===n.type?e.utils.formatDateTime(n.value):n.value,n.prefix&&(n.displayValue=n.prefix+n.displayValue),n.suffix&&(n.displayValue=n.displayValue+n.suffix),n.group&&(i[n.group]||(i[n.group]=e.utils.wire()`
        <div
          class="drawer group panel expandable ${n.class||""}"
          style="display: grid; grid-column: 1 / 3; max-height: 20px;">
          <div
            class="header primary-colour"
            style="text-align: left; grid-column: 1 / 3;"
            onclick=${t=>{e.utils.toggleExpanderParent(t.target)}}>
            <span>${n.group}</span>
            <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,n.listview.appendChild(i[n.group])),n.group_class&&n.group_class.split(" ").forEach(e=>i[n.group].classList.add(e)),n.expanded&&i[n.group].classList.add("expanded"),n.listview=i[n.group]),n.script){const t=e.utils.wire()`<script src="${n.src}">`;n.target=e.utils.wire()`
      <div style="grid-column: 1 / 3;" class="${n.class||""}">`;const o=i=>{i.detail(e,n),document.removeEventListener(n.script,o,!0),t.remove()};document.addEventListener(n.script,o,!0),n.target.appendChild(t),n.listview.appendChild(n.target)}else if("dataview"!==n.type)n.title&&(n.title_div=e.utils.wire()`
      <div
        class="${`label lv-${n.level||"0"} ${n.class||""}`}"
        style="grid-column: 1;"
        title="${n.tooltip||null}">${n.title}`,n.listview.appendChild(n.title_div)),"key"!==n.type?"title"!==n.type?"streetview"!==n.type?"report"!==n.type?"images"!==n.type?"documents"!==n.type?"geometry"!==n.type?"meta"!==n.type?"boolean"!==n.type?(n.edit||n.displayValue||n.query)&&(n.inline||"integer"===n.type^"numeric"===n.type^"date"===n.type?(n.val=e.utils.wire()`<div class="val num ${n.class||""}" style="grid-column: 2;">`,n.listview.appendChild(n.val)):(n.title_div&&(n.title_div.style.gridColumn="1 / 3"),n.val=e.utils.wire()`<div class="val ${n.class||""}" style="grid-column: 1 / 3;">`,n.listview.appendChild(n.val)),n.query?(n.layer=n.location.layer,n.id=n.location.id,n.promise=e.dataviews.query(n),n.promise.then(e=>{n.val.textContent=e[n.key]})):!n.edit||n.fieldfx?"html"!==n.type?n.val.textContent=n.displayValue:(n.val.style="grid-column: 1 / 3;",n.val.innerHTML=n.value):e.locations.view.edit.input(n)):e.locations.view.boolean(n):e.locations.view.meta(n):e.locations.view.geometry(n):e.locations.view.documents(n):e.locations.view.images(n):e.locations.view.report(n):e.locations.view.streetview(n):n.title_div.style.gridColumn="1 / 3":n.listview.appendChild(e.utils.wire()`
      <div
        class="label lv-0 ${n.class||""}"
        style="grid-column: 2; margin: 3px;">
        <span
          title="Source layer"
          style="${"float: right; padding: 3px; cursor: help; border-radius: 2px; background-color: "+e.utils.Chroma(t.style.strokeColor).alpha(.3)+";"}"
          >${t.layer.name}`);else{const t=e.locations.view.dataview(n);t&&n.listview.appendChild(t)}}return o},no=e=>t=>{t.__title_div&&(t.__title_div.style.gridColumn="1 / 3");const o=ol.proj.transform(t.location.marker,"EPSG:"+e.mapview.srid,"EPSG:4326"),i=`${e.host}/api/proxy?uri=/maps/api/streetview?location=${o[1]},${o[0]}%26source=outdoor%26size=300x230&provider=GOOGLE&host=maps.googleapis.com`;t.listview.appendChild(e.utils.wire()`
    <div
      class="${t.class||""}"
      style="grid-column: 1 / 3;">
      <a
        target="_blank"
        href="${"https://www.google.com/maps?cbll="+o[1]+","+o[0]+"&layer=c"}">
        <img src="${i}">`)},ro=e=>t=>{if(!t.value.length&&!t.edit)return t.title_div.remove();t.title_div&&(t.title_div.style.gridColumn="1 / 3");for(let i of t.value)t.listview.appendChild(e.utils.wire()`
      <div
        class="${t.class||""}"
        style="grid-column: 1 / 3; position: relative;">
        <img src=${i} style="width:100%;">
        ${t.edit&&e.utils.wire()`
        <button
          class="xyz-icon icon-trash img-remove"
          data-name=${i.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
          data-src=${i}
          onclick=${e=>o(e)}>
        </button>`}`);function o(o){if(!confirm("Remove image?"))return;const i=o.target,n=new XMLHttpRequest;n.open("GET",e.host+"/api/provider/cloudinary?"+e.utils.paramString({destroy:!0,public_id:i.dataset.name})),n.onload=o=>{if(o.target.status>202)return;const n=new XMLHttpRequest;n.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,action:"remove",field:t.field,secure_url:i.dataset.src,id:t.location.id})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=e=>{e.target.status>202||i.parentNode.remove()},n.send()},n.send()}t.edit&&t.listview.appendChild(e.utils.wire()`
    <div class="list" style="grid-column: 1 / 3;">
    <div class="add xyz-icon icon-add-photo off-black-filter">
    <input
      type="file"
      accept="image/*;capture=camera"
      onchange=${i=>{const n=new FileReader,r=i.target.files[0];if(!r)return;const a=e.utils.wire()`
          <div><div class="xyz-icon loader">`;t.listview.insertBefore(a,t.listview.childNodes[t.listview.childNodes.length-1]),n.onload=i=>{const n=new Image;n.onload=()=>{let i=e.utils.wire()`<canvas>`,r=n.width,s=n.height;r>s&&r>1024?(s*=1024/r,r=1024):s>1024&&(r*=1024/s,s=1024),i.width=r,i.height=s,i.getContext("2d").drawImage(n,0,0,r,s);const l=i.toDataURL("image/jpeg",.5),c=new XMLHttpRequest;c.open("POST",e.host+"/api/provider/cloudinary?"+e.utils.paramString({resource_type:"image"})),c.setRequestHeader("Content-Type","application/octet-stream"),c.responseType="json",c.onload=i=>{if(i.target.status>202)return console.error("image upload failed");const n=i.target.response.secure_url,r=i.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),s=new XMLHttpRequest;s.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,action:"append",field:t.field,secure_url:n,id:t.location.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=i=>{i.target.status>202||e.utils.bind(a)`
                  <img src=${n}>
                    ${t.edit&&e.utils.wire()`
                      <button
                        class="xyz-icon icon-trash img-remove"
                        data-name=${r}
                        data-src=${n}
                        onclick=${e=>o(e)}>
                      </button>`}`},s.send()},c.send(e.utils.dataURLtoBlob(l))},n.src=i.target.result},n.readAsDataURL(r),i.target.value=""}}>`)},ao=e=>t=>{if(!t.value.length&&!t.edit)return t.title_div.remove();t.title_div&&(t.title_div.style.gridColumn="1 / 3"),t.documents=e.utils.wire()`<div style="grid-column: 1 / 3;"">`,t.listview.appendChild(t.documents);for(let i of t.value)t.documents.appendChild(e.utils.wire()`
		<div class="item">
		${t.edit&&e.utils.wire()`
		<button
			class="xyz-icon icon-trash link-remove"
			data-name=${i.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
			data-href=${i}
			onclick=${e=>o(e)}>
		</button>`}		
		<a href=${i}>${i.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}`);function o(o){if(!confirm("Remove document link?"))return;const i=o.target,n=new XMLHttpRequest;n.open("GET",e.host+"/api/provider/cloudinary?"+e.utils.paramString({destroy:!0,public_id:i.dataset.name})),n.onload=o=>{if(o.target.status>202)return;const n=new XMLHttpRequest;n.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,action:"remove",field:t.field,secure_url:i.dataset.href,id:t.location.id})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=e=>{e.target.status>202||i.parentNode.remove()},n.send()},n.send()}t.edit&&t.listview.appendChild(e.utils.wire()`
    <div class="list" style="grid-column: 1 / 3;">
	<div class="add xyz-icon icon-cloud-upload off-black-filter">
	<input
	type="file"
	accept=".txt,.pdf,.doc,.docx,.xls,.xlsx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document;"
	onchange=${i=>{const n=new FileReader,r=i.target.files[0];if(!r)return;const a=e.utils.wire()`<div class="item"><div class="xyz-icon loader">`;t.documents.appendChild(a),n.onload=i=>{const n=new XMLHttpRequest;n.open("POST",e.host+"/api/provider/cloudinary?"+e.utils.paramString({resource_type:"raw",public_id:r.name})),n.setRequestHeader("Content-Type","application/octet-stream"),n.responseType="json",n.onload=i=>{if(i.target.status>202)return console.log("document_upload failed");const n=i.target.response.secure_url,r=i.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),s=new XMLHttpRequest;s.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,action:"append",field:t.field,secure_url:n,id:t.location.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=i=>{i.target.status>202||e.utils.bind(a)`
				<div class="item">
				${t.edit&&e.utils.wire()`
				<button
					class="xyz-icon icon-trash link-remove"
					data-name=${r}
					data-href=${n}
					onclick=${e=>o(e)}>
				</button>`}
				<a href=${n} target="_blank">${r}`},s.send()},n.send(i.target.result)},n.readAsDataURL(r),i.target.value=""}}>`)},so=e=>t=>{if(!t.value)return;let o=e.utils.wire()`
   <div 
    style="grid-column: 1 / 3;
    width: 100%;
    padding: 4px;
    margin-top: 2px;
    color: #666;
    border-radius: 4px;
    background-color: linen;">`,i=e.utils.wire()`<div style="display: grid;">`;o.appendChild(i),t.listview.appendChild(o),Object.entries(t.value).forEach(t=>{i.appendChild(e.utils.wire()`<div style="grid-column: 1;">${t[0]}`),i.appendChild(e.utils.wire()`<div style="grid-column: 2;">${t[1]}`)})},lo=e=>t=>{if(!t.report.template)return;const o=e.host+"/view/"+encodeURIComponent(t.report.template)+"?"+e.utils.paramString(Object.assign(t.report,{locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,id:t.location.id,host:e.host}));t.listview.appendChild(e.utils.wire()`
    <div
      class="${"label lv-0 "+(t.class||"")}"
      style="grid-column: 1 / 3;">
      <a
        class="primary-colour"
        target="_blank"
        href="${o}">
          ${t.report.title||t.report.name||"Location Report"}`)},co=e=>t=>{t.listview.appendChild(e.utils.wire()`
    <div style="padding-top: 5px; grid-column: 1 / 3">
      <label class="input-checkbox">
        <input type="checkbox"
          disabled=${!t.edit}
          checked=${!!t.value}
          onchange=${e=>{t.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:e.target,entry:t,newValue:!!e.target.checked}}))}}>
        </input>
        <div></div><span>${t.title||t.name||t.field}`)},uo=e=>{const t=(e=>({create:function(t){const o=[t.location.geometry.coordinates[1],t.location.geometry.coordinates[0]],i=new XMLHttpRequest,n="time"!==t.edit.isoline_here.rangetype&&t.edit.isoline_here.rangetype?"distance"===t.edit.isoline_here.rangetype?1e3*(t.edit.isoline_here._distance||1)||1e3:600:60*(t.edit.isoline_here._minutes||t.edit.isoline_here.minutes||10)||600;i.open("GET",e.host+"/api/provider/here?"+e.utils.paramString({url:"isoline.route.api.here.com/routing/7.2/calculateisoline.json?",mode:`${t.edit.isoline_here.type||"fastest"};${t.edit.isoline_here.mode||"car"};traffic:disabled`,start:"geo!"+o.join(","),range:n,rangetype:t.edit.isoline_here.rangetype||"time"})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=e=>{if(200!==e.target.status||!e.target.response.response)return t.location.view&&t.location.view.classList.remove("disabled"),console.log(e.target.response),alert("No route found. Try alternative set up.");if(t.newValue={type:"Polygon",coordinates:[e.target.response.response.isoline[0].component[0].shape.map(e=>e.split(",").reverse())]},t.edit.isoline_here.meta){let e=new Date;t.location.infoj.filter(e=>"meta"===e.type&&e.field===t.edit.isoline_here.meta).forEach(o=>o.newValue={"Recent isoline":"Here",Mode:t.edit.isoline_here.mode,"Range type":t.edit.isoline_here.rangetype,Range:"time"===t.edit.isoline_here.rangetype?t.edit.isoline_here._minutes:t.edit.isoline_here._distance,Created:`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()} ${e.getHours()}:${e.getMinutes()>8?e.getMinutes()+1:"0"+(e.getMinutes()+1)}`})}t.location.update()},i.send(),t.location.view&&t.location.view.classList.add("disabled")},settings:function(t){if(t.edit.isoline_here&&(t.edit.isoline_here.minutes||!t.edit.isoline_here.minutes&&t.value))return e.utils.wire()`<div>`;const o=e.utils.wire()`
      <div
        class="drawer group panel expandable ${t.class||""}"
      style="display: grid; grid-column: 1 / 3; max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${t=>{e.utils.toggleExpanderParent(t.target)}}><span>Here Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;t.edit.isoline_here._minutes=t.edit.isoline_here.minutes||10,t.edit.isoline_here._distance=t.edit.isoline_here.distance||10;t.edit.isoline_here.mode="car",o.appendChild(e.utils.wire()`
    <div
        style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"car"},{Walking:"pedestrian"},{Cargo:"truck"},{"HOV lane":"carHOV"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_here.mode=Object.values(o)[0]}}>${Object.keys(o)[0]}`)}`);t.edit.isoline_here.rangetype="time",o.appendChild(e.utils.wire()`
    <div
        style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Range</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Time (min)</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{"Time (min)":"time"},{"Distance (km)":"distance"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const n=e.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_here.rangetype=Object.values(o)[0];const r=i.querySelector("input");"time"===t.edit.isoline_here.rangetype&&(i.querySelector("span").textContent="Travel time in minutes: ",r.oninput=e=>{t.edit.isoline_here._minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here._minutes},r.value=t.edit.isoline_here._minutes,r.parentNode.previousElementSibling.textContent=t.edit.isoline_here._minutes),"distance"===t.edit.isoline_here.rangetype&&(i.querySelector("span").textContent="Travel distance in kilometer: ",r.oninput=e=>{t.edit.isoline_here._distance=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here._distance},r.value=t.edit.isoline_here._distance,r.parentNode.previousElementSibling.textContent=t.edit.isoline_here._distance)}}>${Object.keys(o)[0]}`)}`);const i=e.utils.wire()`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>Travel time in minutes: </span>
        <span class="bold">${t.edit.isoline_here._minutes}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${t.edit.isoline_here._minutes}
          max=60
          step=1
          oninput=${e=>{t.edit.isoline_here._minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_here._minutes}}>`;return o.appendChild(i),o}}))(e),o=(e=>({create:function(t){const o=t.location.geometry.coordinates,i=new XMLHttpRequest;i.open("GET",e.host+"/api/location/edit/isoline/mapbox?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.location.layer.key,table:t.location.table,coordinates:o.join(","),minutes:t.edit.isoline_mapbox._minutes||t.edit.isoline_mapbox.minutes,profile:t.edit.isoline_mapbox.profile,meta:t.edit.isoline_mapbox.meta||null})),i.open("GET",e.host+"/api/provider/mapbox?"+e.utils.paramString({url:`api.mapbox.com/isochrone/v1/mapbox/${t.edit.isoline_mapbox.profile||"driving"}/${o.join(",")}?`,contours_minutes:t.edit.isoline_mapbox._minutes||t.edit.isoline_mapbox.minutes,generalize:t.edit.isoline_mapbox._minutes||t.edit.isoline_mapbox.minutes,polygons:!0})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=e=>{if(200!==e.target.status||!e.target.response.features)return t.location.view&&t.location.view.classList.remove("disabled"),console.log(e.target.response),alert("No route found. Try alternative set up.");if(t.newValue=e.target.response.features[0].geometry,t.edit.isoline_mapbox.meta){let e=new Date;t.location.infoj.filter(e=>"meta"===e.type&&e.field===t.edit.isoline_mapbox.meta).forEach(o=>o.newValue={"Recent isoline":"Mapbox",Mode:t.edit.isoline_mapbox.profile,Minutes:t.edit.isoline_mapbox._minutes,Created:`${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()} ${e.getHours()}:${e.getMinutes()>8?e.getMinutes()+1:"0"+(e.getMinutes()+1)}`})}t.location.update()},i.send(),t.location.view&&t.location.view.classList.add("disabled")},settings:function(t){if(t.edit.isoline_mapbox&&(t.edit.isoline_mapbox.minutes||!t.edit.isoline_mapbox.minutes&&t.value))return e.utils.wire()`<div>`;const o=e.utils.wire()`
      <div
        class="drawer group panel expandable ${t.class||""}"
      style="display: grid; grid-column: 1 / 3; max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${t=>{e.utils.toggleExpanderParent(t.target)}}><span>Mapbox Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;t.edit.isoline_mapbox.profile=t.edit.isoline_mapbox.profile||"driving",t.edit.isoline_mapbox._minutes=t.edit.isoline_mapbox.minutes||10;return t.edit.isoline_mapbox.profile="driving",o.appendChild(e.utils.wire()`
    <div
      style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"driving"},{Walking:"walking"},{Cycling:"cycling"}].map(o=>e.utils.wire()`
                <li onclick=${e=>{const i=e.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=Object.keys(o)[0],t.edit.isoline_mapbox.profile=Object.values(o)[0]}}>${Object.keys(o)[0]}`)}`),o.appendChild(e.utils.wire()`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
      <span>Travel time in minutes: </span>
      <span class="bold">${t.edit.isoline_mapbox._minutes}</span>
      <div class="input-range">
      <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${t.edit.isoline_mapbox._minutes}
        max=60
        step=1
        oninput=${e=>{t.edit.isoline_mapbox._minutes=parseInt(e.target.value),e.target.parentNode.previousElementSibling.textContent=t.edit.isoline_mapbox._minutes}}>`),o}}))(e),i=(e=>t=>{t.value.features&&(t.value.features.map(o=>{let i;if(t.style||(i=t.location.style),t.style.theme||(i=t.style),t.style.theme&&"categorized"===t.style.theme.type&&(i=t.style.theme&&t.style.theme.cat[o.properties[t.style.theme.field]].style),t.style.theme&&"graduated"===t.style.theme.type)for(let e=0;e<t.style.theme.cat_arr.length&&!(o.properties[t.style.theme.field]<t.style.theme.cat_arr[e].value);e++)i=t.style.theme.cat_arr[e].style;let n=e.mapview.geoJSON({geometry:o.geometry,dataProjection:"4326",zIndex:t.location.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:i.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(i.color||i.strokeColor).alpha(1),width:t.style.strokeWidth||1}),fill:new ol.style.Fill({color:e.utils.Chroma(i.fillColor||i.strokeColor).alpha(void 0===i.fillOpacity?1:parseFloat(i.fillOpacity)||0).rgba()})})});t.location.geometryCollection.push(n)}),t.location.geometries.push(t.location.geometryCollection),t.display=!0,t.style&&t.style.theme&&t.style.theme.legend&&(t.legend=e.utils.wire()`<div class="legend lv-1">`,t.legend.appendChild(e.layers.view.style.legend({format:"mvt",style:t.style})),t.container.style.display="block",t.container.appendChild(t.legend)))})(e),n=(e=>t=>new Promise((o,i)=>{const n=new XMLHttpRequest;n.open("GET",e.host+"/api/query?"+e.utils.paramString(Object.assign({locale:e.workspace.locale.key,layer:t.location.layer&&t.location.layer.key,id:t.location.id,template:encodeURIComponent(t.query)},t.queryparams||{}))),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=e=>{if(e.target.status>=300)return i({err:e.target.status});o(e.target.response)},n.send()}))(e);return r=>{if(r.query)r.display&&u(),a(Object.assign(r,{callback:e=>{r.display?u():l()}}));else{if(!r.value&&!r.edit)return;a(r)}function a(t){t.style=Object.assign({},t.location.style,t.style),t.container=e.utils.wire()`
      <div 
      class=${"lv-"+(t.level||0)+" "+(t.class||"")}
      style="grid-column: 1 / 3; position: relative; display: flex; align-items: center;">`,t.listview.appendChild(t.container),t.container.appendChild(e.utils.wire()`
        <label class="input-checkbox">
        <input type="checkbox"
        checked=${t.edit&&t.value||!!t.display}
        onchange=${e=>(t.display=e.target.checked,t.callback?t.callback(e):t.display&&t.edit?c():t.display&&!t.edit?s():!t.display&&t.edit?(t.newValue=null,t.edit.isoline_here&&t.edit.isoline_here.meta&&t.location.infoj.filter(e=>"meta"===e.type&&e.field===t.edit.isoline_here.meta).forEach(e=>e.newValue=null),t.edit.isoline_mapbox&&t.edit.isoline_mapbox.meta&&t.location.infoj.filter(e=>"meta"===e.type&&e.field===t.edit.isoline_mapbox.meta).forEach(e=>e.newValue=null),void t.location.update()):t.display||t.edit?void 0:l())}>
        </input>
        <div></div>
        <span>${t.name||"Geometry"}<span>`),!t.style.theme&&t.container.appendChild(e.utils.wire()`
        <div class="sample-circle"
        style="${`\n          background-color: ${e.utils.Chroma(t.style.fillColor||t.style.strokeColor).alpha(void 0===t.style.fillOpacity?1:parseFloat(t.style.fillOpacity)||0)};\n          border-color: ${e.utils.Chroma(t.style.color||t.style.strokeColor).alpha(1)};\n          border-style: solid;\n          border-width: ${t.style.strokeWidth||1}px;\n          margin-left: auto;`}">`)}function s(){"FeatureCollection"===r.value.type?i(r):(r.geometry=r.value&&e.mapview.geoJSON({geometry:"object"==typeof r.value&&r.value||JSON.parse(r.value),dataProjection:"4326",zIndex:r.location.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:r.style.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(r.style.color||r.style.strokeColor).alpha(1),width:r.style.strokeWidth||1}),fill:new ol.style.Fill({color:e.utils.Chroma(r.style.fillColor||r.style.strokeColor).alpha(void 0===r.style.fillOpacity?1:parseFloat(r.style.fillOpacity)||0).rgba()})})}),r.geometry&&r.location.geometries.push(r.geometry),r.display=!0)}function l(){r.display=!1,r.legend&&r.legend.remove(),"FeatureCollection"===r.value.type?r.location.geometries.splice(r.location.geometries.indexOf(r.geometryCollection),1)&&r.location.geometryCollection.map(t=>e.map.removeLayer(t)):r.geometry&&r.location.geometries.splice(r.location.geometries.indexOf(r.geometry),1)&&e.map.removeLayer(r.geometry)}function c(){if(r.edit)return r.edit.isoline_mapbox?o.create(r):r.edit.isoline_here?t.create(r):void 0}function u(){r.promise=n(r),r.promise.then(e=>{r.value=e[r.field],s()})}if(r.edit&&r.edit.isoline_mapbox&&r.container.parentNode.insertBefore(o.settings(r),r.container.nextSibling),r.edit&&r.edit.isoline_here&&r.container.parentNode.insertBefore(t.settings(r),r.container.nextSibling),r.value&&(r.display||r.edit))return s();!r.value&&r.display&&c()}},ho=e=>t=>{t.val.appendChild(e.utils.wire()`
  <div>
  <span>${t.edit.range.label}</span>
  <span class="bold">${t.value}</span>
  <div class="input-range">
  <input
    class="secondary-colour-bg"
    type="range"
    min=${t.edit.range.min}
    value=${t.value}
    max=${t.edit.range.max}
    oninput=${e=>{e.target.parentNode.previousElementSibling.textContent=e.target.value}}>`)},po=e=>t=>{const o=t.edit.options.find(e=>"object"==typeof e&&Object.values(e)[0]===t.value||e===t.value)||t.value;t.displayValue=o&&"object"==typeof o&&Object.keys(o)[0]||o||t.value,t.val.appendChild(e.utils.wire()`
      <button class="btn-drop">
      <div
      class="head"
      onclick=${e=>{e.preventDefault(),e.target.parentElement.classList.toggle("active")}}>
      <span>${t.displayValue}</span>
      <div class="icon"></div>
      </div>
      <ul>
      ${t.edit.options.map(o=>{let i=o,n=o;return"object"==typeof o&&(i=Object.keys(o)[0],n=Object.values(o)[0]),e.utils.wire()`<li onclick=${e=>{const o=e.target.closest(".btn-drop");o.classList.toggle("active"),o.querySelector(":first-child").textContent=i,o.querySelector(":first-child").value=n,t.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:o.querySelector(":first-child"),entry:t}}))}}>${i}`})}`)},fo=e=>t=>{const o=e.utils.wire()`<input type="text" placeholder="Pick from calendar." style="text-align: end;">${"datetime"===t.type&&e.utils.formatDateTime(t.value)||e.utils.formatDate(t.value)||""}`.childNodes[0];o.value="datetime"===t.type&&e.utils.formatDateTime(t.value)||e.utils.formatDate(t.value)||"",t.val.appendChild(o),e.utils.flatpickr({value:t.value?new Date(1e3*t.value).toISOString():"",element:o,enableTime:"datetime"===t.type,callback:i=>{o.value=i;const n=e.utils.meltDateStr(i);t.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:o,entry:t,newValue:n}}))}})},mo=e=>t=>{let o=e.utils.wire()`
  <textarea
    value=${t.value||""}
    style="auto; min-height: 50px;"
	  onfocus=${e=>{e.target.style.height=e.target.scrollHeight+"px"}}
	  onfocusout=${e=>{e.target.style.height="auto"}}
	  onkeyup=${e=>{t.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:e.target,entry:t}}))}}
	  onkeydown=${e=>setTimeout(()=>{e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},100)}>`;return t.val.style.gridColumn="1 / 3",t.val.appendChild(o),o},go=e=>{const t={input:function(o){if(!o.edit)return;if("date"===o.type||"datetime"===o.type)return t.date(o);if(o.edit.range)return t.range(o);if(o.edit.options)return t.options(o);if("textarea"===o.type||"html"===o.type)return t.textarea(o);o.val.appendChild(e.utils.wire()`
    <input type="${"numeric"===o.type||"integer"===o.type?"number":"text"}" value="${o.value||o.displayValue||""}"
      onkeyup=${e=>{o.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:e.target,entry:o}}))}}>`)},range:ho(e),date:fo(e),options:po(e),textarea:mo(e)};return t},vo=e=>t=>(t.dependents&&t.dependents.some(e=>t.location.infoj.some(t=>!t.value&&t.field===e))&&delete t.display,t.layer=t.location.layer,t.id=t.location.id,"location"===t._target?t.target:(t._target=t.target,"location"===t.target?(t.active=!0,t.target=e.utils.wire()`
    <div
      class=${t.class}
      style="grid-column: 1 / 3; padding-top: 10px;">`,e.dataviews.create(t),t.target):document.getElementById(t.target)?(t.active=!0,t.target=document.getElementById(t.target),void e.dataviews.create(t)):e.dataviews.tabview.node?(t.tab_style="border-bottom: 2px solid "+t.location.style.strokeColor,t.display&&e.dataviews.tabview.add(t),t.location.tabviews.push(t),e.utils.wire()`
    <label
      class="input-checkbox ${t.class}"
      style="grid-column: 1 / 3">
      <input
        type="checkbox"
        checked=${!!t.display}
        onchange=${o=>{if(t.display=o.target.checked,t.display)return e.dataviews.tabview.add(t);t.remove()}}>
      </input>
      <div></div><span>${t.title||"Dataview"}`):void 0)),bo=e=>({create:function(t){t.view||(t.view=e.utils.wire()`<div class="drawer location-view expandable expanded">`);t.view.classList.remove("disabled"),t.view.innerHTML="",t.view.classList.remove("disabled"),t.view.addEventListener("valChange",e=>{const t=void 0===e.detail.newValue?e.detail.input.value:e.detail.newValue;e.detail.entry.value!=t?(e.detail.entry.newValue=t,e.detail.input.classList.add("primary-colour")):(delete e.detail.entry.newValue,e.detail.input.classList.remove("primary-colour")),e.detail.entry.location.infoj.some(e=>void 0!==e.newValue)?i.style.display="inline-block":i.style.display="none"});const o=e.utils.wire()`
    <div
      class = "header"
      style = "${"border-bottom: 2px solid "+t.style.strokeColor}"
      onclick = ${t=>{t.preventDefault(),e.utils.toggleExpanderParent(t.target,!0)}}>
      <div>${String.fromCharCode(65+e.locations.list.indexOf(t.record))}`;t.view.appendChild(o),t.infoj&&o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Toggle location view drawer."
      class = "btn-header xyz-icon icon-expander "
      onclick = ${t=>{t.stopPropagation(),e.utils.toggleExpanderParent(t.target)}}>`),o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Zoom map to feature bounds"
      class = "btn-header xyz-icon icon-search"
      onclick = ${e=>{e.stopPropagation(),t.flyTo()}}>`);const i=e.utils.wire()`
    <button
      style = "${"display: none; filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Save changes to cloud."
      class = "btn-header xyz-icon icon-cloud-upload"
      onclick = ${e=>{e.stopPropagation(),t.update()}}>`;o.appendChild(i),t.layer.edit&&t.layer.edit.geometry&&o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Edit location geometry."
      class = "btn-header xyz-icon icon-build"
      onclick = ${i=>{if(i.stopPropagation(),o.classList.contains("edited"))return e.mapview.interaction.edit.finish();o.classList.add("edited","secondary-colour-bg"),e.mapview.interaction.edit.begin({location:t,type:"LineString",callback:()=>{o.classList.remove("edited","secondary-colour-bg")}})}}>`),t.layer.edit&&t.layer.edit.delete&&o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Delete location."
      class = "btn-header xyz-icon icon-trash"
      onclick = ${e=>{e.stopPropagation(),t.trash()}}>`),o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Hide marker"
      class = "btn-header xyz-icon icon-location-tick" 
      onclick = ${o=>{o.stopPropagation(),o.target.classList.contains("icon-location")?(o.target.classList.remove("icon-location"),o.target.classList.add("icon-location-tick"),e.map.addLayer(t.Marker)):(o.target.classList.remove("icon-location-tick"),o.target.classList.add("icon-location"),e.map.removeLayer(t.Marker))}}>`),o.appendChild(e.utils.wire()`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = "Remove feature from selection"
      class = "btn-header xyz-icon icon-close"
      onclick = ${o=>{o.stopPropagation(),t.remove(),e.map.updateSize()}}>`),t.infoj&&t.view.appendChild(e.locations.view.infoj(t))},infoj:io(e),streetview:no(e),images:ro(e),documents:ao(e),geometry:uo(e),meta:so(e),edit:go(e),boolean:co(e),report:lo(e),dataview:vo(e)}),yo=e=>{const t={init:function(i){t.add=o,t.callbackAdd=t.callbackAdd||i.callbackAdd,t.callbackInit=t.callbackInit||i.callbackInit,t.node=t.node||i.target,t.node.innerHTML="",e.locations.list=[["#4227b0","invert(19%) sepia(57%) saturate(4245%) hue-rotate(247deg) brightness(76%) contrast(101%)"],["#2196f3","invert(60%) sepia(94%) saturate(3876%) hue-rotate(184deg) brightness(98%) contrast(94%)"],["#009688","invert(37%) sepia(46%) saturate(1993%) hue-rotate(144deg) brightness(96%) contrast(101%)"],["#cddc39","invert(84%) sepia(82%) saturate(420%) hue-rotate(6deg) brightness(88%) contrast(94%)"],["#ff9800","invert(59%) sepia(90%) saturate(1526%) hue-rotate(358deg) brightness(99%) contrast(106%)"],["#673ab7","invert(23%) sepia(26%) saturate(6371%) hue-rotate(251deg) brightness(87%) contrast(87%)"],["#03a9f4","invert(65%) sepia(61%) saturate(5963%) hue-rotate(168deg) brightness(101%) contrast(103%)"],["#4caf50","invert(65%) sepia(8%) saturate(3683%) hue-rotate(73deg) brightness(92%) contrast(69%)"],["#ffeb3b","invert(75%) sepia(76%) saturate(391%) hue-rotate(2deg) brightness(104%) contrast(109%)"],["#ff5722","invert(47%) sepia(96%) saturate(3254%) hue-rotate(346deg) brightness(100%) contrast(102%)"],["#0d47a1","invert(15%) sepia(99%) saturate(2827%) hue-rotate(213deg) brightness(87%) contrast(90%)"],["#00bcd4","invert(60%) sepia(39%) saturate(2788%) hue-rotate(144deg) brightness(93%) contrast(102%)"],["#8bc34a","invert(87%) sepia(8%) saturate(3064%) hue-rotate(35deg) brightness(85%) contrast(85%)"],["#ffc107","invert(79%) sepia(86%) saturate(3969%) hue-rotate(346deg) brightness(98%) contrast(111%)"],["#d32f2f","invert(28%) sepia(94%) saturate(3492%) hue-rotate(345deg) brightness(85%) contrast(92%)"]].map(e=>({style:{strokeColor:e[0]},colorFilter:e[1]})),t.callbackInit&&t.callbackInit()}};return t;function o(e){t.node&&(Object.values(t.node.children).forEach(e=>e.classList.remove("expanded")),t.node.insertBefore(e.view,t.node.firstChild),e.view.style.maxHeight="30px",t.callbackAdd&&t.callbackAdd())}},wo=e=>function(){this.Layer=e.mapview.geoJSON({geometry:this.geometry,zIndex:1999,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:8})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:6})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:4})}),new ol.style.Style({stroke:this.style.strokeColor&&new ol.style.Stroke({color:this.style.strokeColor,width:this.style.strokeWidth||1}),fill:this.style.fillColor&&new ol.style.Fill({color:e.utils.Chroma(this.style.fillColor).alpha(void 0===this.style.fillOpacity?1:parseFloat(this.style.fillOpacity)||0).rgba()})})],dataProjection:this.layer.srid,featureProjection:e.mapview.srid})},xo=e=>function(){e.hooks&&e.hooks.filter("locations",this.hook),e.mapview.interaction.edit.finish&&e.mapview.interaction.edit.finish(),this.view&&this.view.remove(),e.locations.listview.node&&0===e.locations.listview.node.childElementCount&&e.locations.listview.init(),this.tabviews.forEach(e=>e.remove&&e.remove()),this.geometries.forEach(t=>e.map.removeLayer(t)),this.geometryCollection.forEach(t=>e.map.removeLayer(t)),this.Layer&&e.map.removeLayer(this.Layer),this.Marker&&e.map.removeLayer(this.Marker),"function"==typeof this.removeCallback&&this.removeCallback(),this.record.location=null},Co=e=>function(){if(!e.map)return;const t=new ol.source.Vector;this.Layer&&t.addFeatures(this.Layer.getSource().getFeatures()),this.Marker&&t.addFeatures(this.Marker.getSource().getFeatures()),this.geometries.forEach(e=>{e.length?e.forEach(e=>t.addFeatures(e.getSource().getFeatures())):t.addFeatures(e.getSource().getFeatures())}),e.mapview.flyToBounds(t.getExtent())},Eo=e=>function(t){const o=this,i={};if(o.infoj.filter(e=>void 0!==e.newValue).forEach(e=>{"integer"===e.type&&(e.newValue=isNaN(parseInt(e.newValue))?null:e.newValue),"numeric"===e.type&&(e.newValue=isNaN(parseFloat(e.newValue))?null:e.newValue),Object.assign(i,{[e.field]:e.newValue})}),!Object.keys(i).length)return;o.view&&o.view.classList.add("disabled");const n=new XMLHttpRequest;n.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.workspace.locale.key,layer:o.layer.key,table:o.table,id:o.id})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=i=>{if(200!==i.target.status)return console.error(i.target.response);const n=[];if(o.infoj.filter(e=>void 0!==e.newValue).forEach(e=>{e.dependents&&e.dependents.forEach(e=>{if(o.infoj.some(t=>t.field===e))return n.push(e);o.infoj.filter(e=>"dataview"===e.type).forEach(t=>{if(t.query===e&&t.update)return t.update();t.dataviews&&t.dataviews.filter(t=>t.query===e).forEach(e=>e.update&&e.update())})}),e.value=e.newValue,delete e.newValue}),n.length>0){const i=new XMLHttpRequest;return i.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.workspace.locale.key,layer:o.layer.key,table:o.table,id:o.id,fields:n.join()})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{o.infoj.filter(e=>void 0!==i.target.response[e.field]).forEach(e=>{e.value=i.target.response[e.field]}),o.view&&e.locations.view.create(o),o.layer.reload(),t&&t()},void i.send()}o.view&&e.locations.view.create(o),o.layer.reload(),t&&t()},n.send(JSON.stringify(i))},ko=e=>function(){const t=this,o=new XMLHttpRequest;o.open("GET",e.host+"/api/location/delete?"+e.utils.paramString({locale:e.workspace.locale.key,layer:t.layer.key,table:t.table,id:t.id})),o.onload=e=>{200===e.target.status&&(t.layer.reload(),t.remove())},confirm("Are you sure you want to delete this feature? This cannot be undone.")&&o.send()},Mo=e=>t=>new Promise((o,i)=>{const n=new XMLHttpRequest,r=t.viewport&&e.mapview&&e.mapview.getBounds(),a=t.center&&e.mapview&&ol.proj.transform(e.map.getView().getCenter(),"EPSG:"+e.mapview.srid,"EPSG:4326");n.open("GET",e.host+"/api/query?"+e.utils.paramString(Object.assign({locale:e.workspace.locale.key,layer:t.layer&&t.layer.key,dbs:t.dbs,id:t.id,template:encodeURIComponent(t.query),lat:a&&a[1],lng:a&&a[0],filter:t.layer&&t.layer.filter&&JSON.stringify(t.layer.filter.current),viewport:r&&[r.west,r.south,r.east,r.north,e.mapview.srid]},t.queryparams||{}))),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=e=>{if(e.target.status>=300)return i({err:e.target.status});o(e.target.response)},n.send()}),_o=e=>{const t={init:function(o){if(!o.target)return;t.node=o.target;const i=e.utils.wire()`<div class="tab-bar">`;let n;t.bar=e.utils.wire()`<div>`,i.appendChild(t.bar),t.node.appendChild(i),t.panel=e.utils.wire()`<div class="tab-panel">`,t.node.appendChild(t.panel),t._dataviews=new Set,t.add=o=>{if(o.showTab)return t.bar.appendChild(o.tab),t.panel.appendChild(o.target),t._dataviews.add(o),o.showTab();o.showTab=()=>{t._dataviews.forEach(e=>{e.target.style.display="none",e.tab.classList.remove("active"),e.target.classList.remove("active")}),o.tab.classList.add("active"),o.target.style.display="grid",o.target.classList.add("active"),t.node.style.display="block",o.update&&o.update(),o.dataviews&&o.dataviews.forEach(e=>e.update()),e.mapview.attribution.container&&(e.mapview.attribution.container.style.bottom="65px")},o.tab=e.utils.wire()`
      <div
        style="${o.tab_style||""}"
        class="active"
        onclick=${()=>{clearTimeout(n),n=setTimeout(()=>o.showTab(),500)}}>${o.title||o.key||"Tab"}`,t.bar.appendChild(o.tab),o.target=e.utils.wire()`
        <div
          class="${o.class||""}"
          style="${o.style||""}">`,t.panel.appendChild(o.target),e.dataviews.create(o),t._dataviews.add(o),o.remove=()=>{if(o.target.remove(),o.layer&&o.layer._dataviews.delete(o),o.tab.remove(),t._dataviews.delete(o),t._dataviews.size)return Array.from(t._dataviews)[0].showTab();t.node.style.display="none",e.mapview.attribution.container&&(e.mapview.attribution.container.style.bottom="0")},o.tab.click()}}};return t},Do=e=>{return{create:t,query:Mo(e),tabview:_o(e)};function t(o){if(o.target=o.target instanceof HTMLElement&&o.target||e.utils.wire()`<div class="${o.class||""}" style="${o.style||""}">`,o.dataviews)return function(o){return o.dataviews.forEach(i=>{i.active=o.active,i.tab=o.tab,i.layer=o.layer,i.id=o.id,i.target=e.utils.wire()`
        <div class="${i.class||""}" style="${i.style||""}">`,o.target.appendChild(i.target),t(i)}),o}(o);o.layer&&o.layer._dataviews.add(o),o.remove=()=>{o.target.remove(),o.layer&&o.layer._dataviews.delete(o)};const i=e.utils.wire()`<div class="toolbar">`;o.target.appendChild(i);const n=e.utils.wire()`<div>`;if(o.target.appendChild(n),o.update=()=>{(o.active||o.tab&&o.tab.classList.contains("active"))&&(o.promise=e.dataviews.query(o),o.promise.then(e=>o.setData(e)))},o.chart){o.chart.div=e.utils.wire()`<div style="position: relative;">`;const t=e.utils.wire()`<canvas>`;o.chart.height&&t.setAttribute("height",o.chart.height),o.chart.width&&t.setAttribute("width",o.chart.width),o.chart.div.appendChild(t),e.utils.Chart.defaults.global.plugins.datalabels.display=!1,o.chart.ChartJS=new e.utils.Chart(t,{type:o.chart.type||"bar",plugins:o.chart.plugins||[],options:o.chart.options||{legend:{display:!1}}}),o.chart.options&&Object.assign(o.chart.ChartJS.options,o.chart.options),o.chart.setData=e=>{o.chart.ChartJS.data={labels:"function"==typeof o.chart.labels&&o.chart.labels(e)||o.chart.labels,datasets:o.chart.datasets.map(t=>Object.assign(t,{data:t.fields&&t.fields.map(t=>e[t])||t.field&&e[t.field]||e}))}},n.appendChild(o.chart.div),o.setData=e=>{e&&(o.chart.setData(e),o.chart.ChartJS.update())}}return o.columns&&(!function t(o){o.forEach(o=>{o.customFormatter&&(o.formatter=e.utils.TabulatorFormatter[o.customFormatter]),o.columns&&t(o.columns)})}(o.columns),o.Tabulator=new e.utils.Tabulator(n,Object.assign({invalidOptionWarnings:!1,tooltipsHeader:!0,columnHeaderVertAlign:"center",layout:o.layout||"fitDataFill",height:"auto",rowFormatter:e=>{if(e.getData().backgroundcolour){e.getElement().style.backgroundColor=e.getData().backgroundcolour}},selectable:!1,rowClick:(t,i)=>{const n=i.getData();o.layer&&n.id&&(e.locations.select({locale:e.workspace.locale.key,layer:n.layer&&e.layers.list[n.layer]||o.layer,table:n.table||o.table,id:n.id}),i.deselect())}},o)),o.setData=e=>{e&&o.Tabulator.setData(e.length&&e||[e])}),!o.tab&&o.update(),o.toolbar&&o.toolbar.viewport&&i.appendChild(e.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${e=>{e.target.classList.toggle("primary-colour"),o.viewport=!o.viewport,o.update()}}>Viewport`),o.toolbar&&o.toolbar.download_csv&&i.appendChild(e.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${()=>{o.Tabulator.download("csv",(o.title||"table")+".csv")}}>CSV`),o.toolbar&&o.toolbar.download_json&&i.appendChild(e.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${()=>{o.Tabulator.download("json",(o.title||"table")+".json")}}>JSON`),o}};async function So(t){const o=Object.assign({version:"3.3.0",defaults:{colours:[{hex:"#c62828",name:"Fire Engine Red"},{hex:"#f50057",name:"Folly"},{hex:"#9c27b0",name:"Dark Orchid"},{hex:"#673ab7",name:"Plump Purple"},{hex:"#3f51b5",name:"Violet Blue"},{hex:"#2196f3",name:"Dodger Blue"},{hex:"#03a9f4",name:"Vivid Cerulean"},{hex:"#00bcd4",name:"Turquoise Surf"},{hex:"#009688",name:"Dark Cyan"},{hex:"#4caf50",name:"Middle Green"},{hex:"#8bc34a",name:"Dollar Bill"},{hex:"#cddc39",name:"Pear"},{hex:"#ffeb3b",name:"Banana Yellow"},{hex:"#ffb300",name:"UCLA Gold"},{hex:"#fb8c00",name:"Dark Orange"},{hex:"#f4511e",name:"Orioles Orange"},{hex:"#8d6e63",name:"Dark Chestnut"},{hex:"#777777",name:"Sonic Silver"},{hex:"#bdbdbd",name:"X11 Gray"},{hex:"#aaaaaa",name:"Dark Medium Gray"},{hex:"#78909c",name:"Light Slate Gray"}]},utils:e},t);return o.workspace=Xe(o),o.hooks=(e=>{if(!e.hooks)return null;const t={layers:[],locations:[]};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(e,o,i)=>{t[o]?t[o]=decodeURI(i).split(","):t[o]=decodeURI(i)}),{current:t,set:function(t){Object.assign(e.hooks.current,t),i()},remove:o,removeAll:function(){Object.keys(e.hooks.current).forEach(e=>o(e)),i()},push:function(t,o){e.hooks.current[t]?e.hooks.current[t].indexOf(o)<0&&e.hooks.current[t].push(o):e.hooks.current[t]=[o];i()},filter:function(t,o){e.hooks.current[t]=e.hooks.current[t].filter(e=>e!==o),i()}};function o(t){Array.isArray(e.hooks.current[t])?e.hooks.current[t].length=0:delete e.hooks.current[t],i()}function i(){try{history.pushState({hooks:!0},"hooks","?"+e.utils.paramString(e.hooks.current))}catch(e){console.log(e)}}})(o),o.mapview=(e=>({create:Je(e),changeEndEvent:new CustomEvent("changeEnd"),attribution:Ke(e),locate:Ze(e),interaction:rt(e),popup:et(e),infotip:lt(e),geoJSON:Qe(e),icon:st(e),layer:bt(e),getBounds:at(e),flyToBounds:(t,o={})=>{e.map.getView().fit(t,Object.assign({padding:[50,50,50,50],duration:1e3},o))},getZoom:()=>e.map.getView().getZoom()}))(o),o.layers=(e=>({decorate:function(t){const o=Object.assign({tableCurrent:Yt(e),tableMin:Ut(),tableMax:Xt(),zoomToExtent:Jt(e),show:Kt(e),remove:Zt(e),count:Qt(e),bringToFront:eo(e),_dataviews:new Set},t);o.filter=Object.assign(o.filter||{},{current:{}}),o.style&&o.style.themes&&(o.style.theme=o.style.themes[Object.keys(o.style.themes)[0]]);return e.mapview.layer[t.format](o),o},list:{},view:Gt(e),listview:qt(e)}))(o),o.locations=(e=>({select:to(e),selectCallback:oo(e),list:[{style:{strokeColor:"#9c27b0"},colorFilter:"invert(22%) sepia(80%) saturate(1933%) hue-rotate(272deg) brightness(97%) contrast(104%)"}],view:bo(e),listview:yo(e),custom:{},decorate:function(t,o={}){Object.assign(t,{remove:xo(e),trash:ko(e),flyTo:Co(e),update:Eo(e),draw:wo(e),geometries:[],tables:[],tabviews:[],geometryCollection:[],style:Object.assign({strokeColor:"#1F964D"},t.style||{})},o)}}))(o),o.gazetteer=(e=>{const t={init:function(o){if(!o)return;Object.assign(t,o),t.result=t.group.querySelector("ul"),t.input=t.group.querySelector("input"),t.input.placeholder=e.workspace.locale.gazetteer.placeholder||"",t.input.addEventListener("keyup",e=>{!new Set([37,38,39,40,13]).has(e.keyCode||e.charCode)&&e.target.value.length>0&&t.search(e.target.value)}),t.input.addEventListener("keydown",o=>{const i=o.keyCode||o.charCode;if(46===i||8===i)return t.xhr&&t.xhr.abort(),t.clear(),void(t.layer&&e.map.removeLayer(t.layer));if(13===i){let e=o.target.value.split(",").map(parseFloat);e[1]>-90&&e[1]<90&&e[0]>-180&&e[0]<180&&(t.xhr&&t.xhr.abort(),t.clear(),t.createFeature({type:"Point",coordinates:[e[1],e[0]]})),t.result.querySelector("li").click()}}),t.input.addEventListener("focusout",()=>{t.xhr&&t.xhr.abort(),setTimeout(t.clear,400)}),t.clear=()=>{t.group.classList.remove("active"),t.result.innerHTML=""}},search:function(o,i={}){t.clear&&t.clear(),t.xhr&&t.xhr.abort(),t.xhr=new XMLHttpRequest,t.xhr.open("GET",e.host+"/api/gazetteer?"+e.utils.paramString({locale:e.workspace.locale.key,q:encodeURIComponent(o),source:i.source})),t.xhr.setRequestHeader("Content-Type","application/json"),t.xhr.responseType="json",t.xhr.onload=o=>{if(200===o.target.status)return i.callback?i.callback(o.target.response):0===o.target.response.length?(t.result.appendChild(e.utils.wire()`
        <li>No results for this search.`),t.group.classList.add("active")):void Object.values(o.target.response).forEach(o=>{t.result.appendChild(e.utils.wire()`
        <li style="cursor:pointer;" onclick=${e=>{if(e.preventDefault(),!o.source||!o.id)return t.callback?t.callback(o):void(o.marker&&t.createFeature({type:"Point",coordinates:o.marker.split(",")}));t.select({label:o.label,id:o.id,source:o.source,layer:o.layer,table:o.table,marker:o.marker,callback:i.callback})}}>
        ${e.workspace.locale.gazetteer.label?e.utils.wire()`
          <span class="secondary-colour-bg" 
          style="font-size: smaller; padding: 0 2px 0 2px; cursor: help; border-radius: 2px;"
          >${o.layer||o.source}</span>`:""}
          <span>${o.label}</span>
        `),t.group.classList.add("active")})},t.xhr.send()},sources:{glx:function(o){if(t.callback)return t.callback(o);e.locations.select({locale:e.workspace.locale.key,layer:e.layers.list[o.layer],table:o.table,id:o.id,_flyTo:!0}),o.callback&&o.callback()},mapbox:function(e){t.createFeature({type:"Point",coordinates:e.marker}),e.callback&&e.callback()},google:function(o){const i=new XMLHttpRequest;i.open("GET",`${e.host}/api/provider/google?url=maps.googleapis.com/maps/api/place/details/json?placeid=${o.id}`),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=e=>{if(200!==e.target.status||!e.target.response.result)return;let i={type:"Point",coordinates:[e.target.response.result.geometry.location.lng,e.target.response.result.geometry.location.lat]};if(t.createFeature(i),t.callback)return t.callback(i);o.callback&&o.callback(i)},i.send()},opencage:function(e){t.createFeature({type:"Point",coordinates:e.marker}),e.callback&&e.callback()}},select:function(e){t.clear&&t.clear(),t.input&&(t.input.value=e.label);t.sources[e.source](e)},createFeature:function(o){o="string"==typeof o?JSON.parse(o):o,t.layer&&e.map.removeLayer(t.layer);t.layer=e.mapview.geoJSON({geometry:o,dataProjection:"4326",style:new ol.style.Style({image:e.mapview.icon(t.icon)})}),e.mapview.flyToBounds(t.layer.getSource().getExtent())},icon:{type:"markerColor",colorMarker:"#64dd17",colorDot:"#33691e",anchor:[.5,1],scale:.05}};return t})(o),o.dataviews=Do(o),t.callback?o.workspace.getLocales(t.callback):(await o.workspace.fetchLocales(),o)}window._xyz=So})()})();
//# sourceMappingURL=xyz_openlayers.js.map