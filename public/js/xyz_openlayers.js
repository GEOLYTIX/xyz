!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=63)}([function(t,e,i){var n=i(31),o="object"==typeof self&&self&&self.Object===Object&&self,r=n||o||Function("return this")();t.exports=r},function(t,e,i){"use strict";i.r(e),i.d(e,"coordEach",(function(){return c})),i.d(e,"coordReduce",(function(){return h})),i.d(e,"propEach",(function(){return d})),i.d(e,"propReduce",(function(){return p})),i.d(e,"featureEach",(function(){return f})),i.d(e,"featureReduce",(function(){return g})),i.d(e,"coordAll",(function(){return m})),i.d(e,"geomEach",(function(){return v})),i.d(e,"geomReduce",(function(){return y})),i.d(e,"flattenEach",(function(){return b})),i.d(e,"flattenReduce",(function(){return w})),i.d(e,"segmentEach",(function(){return _})),i.d(e,"segmentReduce",(function(){return x})),i.d(e,"lineEach",(function(){return C})),i.d(e,"lineReduce",(function(){return E})),i.d(e,"findSegment",(function(){return k})),i.d(e,"findPoint",(function(){return S}));function n(t,e,i){if(!s(i=i||{}))throw new Error("options is invalid");var n=i.bbox,o=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&l(n),o&&u(o);var r={type:"Feature"};return o&&(r.id=o),n&&(r.bbox=n),r.properties=e||{},r.geometry=t,r}function o(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!a(t[0])||!a(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function r(t,e,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!a(t[0][1])||!a(t[0][1]))throw new Error("coordinates must contain numbers");return n({type:"LineString",coordinates:t},e,i)}function a(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function s(t){return!!t&&t.constructor===Object}function l(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!a(t))throw new Error("bbox must only contain numbers")}))}function u(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function c(t,e,i){if(null!==t)for(var n,o,r,a,s,l,u,h,d=0,p=0,f=t.type,g="FeatureCollection"===f,m="Feature"===f,v=g?t.features.length:1,y=0;y<v;y++){s=(h=!!(u=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var b=0;b<s;b++){var w=0,_=0;if(null!==(a=h?u.geometries[b]:u)){l=a.coordinates;var x=a.type;switch(d=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,p,y,w,_))return!1;p++,w++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],p,y,w,_))return!1;p++,"MultiPoint"===x&&w++}"LineString"===x&&w++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-d;o++){if(!1===e(l[n][o],p,y,w,_))return!1;p++}"MultiLineString"===x&&w++,"Polygon"===x&&_++}"Polygon"===x&&w++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for("MultiPolygon"===x&&(_=0),o=0;o<l[n].length;o++){for(r=0;r<l[n][o].length-d;r++){if(!1===e(l[n][o][r],p,y,w,_))return!1;p++}_++}w++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===c(a.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function h(t,e,i,n){var o=i;return c(t,(function(t,n,r,a,s){o=0===n&&void 0===i?t:e(o,t,n,r,a,s)}),n),o}function d(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function p(t,e,i){var n=i;return d(t,(function(t,o){n=0===o&&void 0===i?t:e(n,t,o)})),n}function f(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function g(t,e,i){var n=i;return f(t,(function(t,o){n=0===o&&void 0===i?t:e(n,t,o)})),n}function m(t){var e=[];return c(t,(function(t){e.push(t)})),e}function v(t,e){var i,n,o,r,a,s,l,u,c,h,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,g=p?t.features.length:1;for(i=0;i<g;i++){for(s=p?t.features[i].geometry:f?t.geometry:t,u=p?t.features[i].properties:f?t.properties:{},c=p?t.features[i].bbox:f?t.bbox:void 0,h=p?t.features[i].id:f?t.id:void 0,a=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(r=l?s.geometries[o]:s))switch(r.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(r,d,u,c,h))return!1;break;case"GeometryCollection":for(n=0;n<r.geometries.length;n++)if(!1===e(r.geometries[n],d,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,c,h))return!1;d++}}function y(t,e,i){var n=i;return v(t,(function(t,o,r,a,s){n=0===o&&void 0===i?t:e(n,t,o,r,a,s)})),n}function b(t,e){v(t,(function(t,i,o,r,a){var s,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n(t,o,{bbox:r,id:a}),i,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u];if(!1===e(n({type:s,coordinates:c},o),i,u))return!1}}))}function w(t,e,i){var n=i;return b(t,(function(t,o,r){n=0===o&&0===r&&void 0===i?t:e(n,t,o,r)})),n}function _(t,e){b(t,(function(t,i,n){var o=0;if(t.geometry){var a,s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s)return!1!==c(t,(function(s,l,u,c,h){if(void 0!==a){var d=r([a,s],t.properties);if(!1===e(d,i,n,h,o))return!1;o++,a=s}else a=s}))&&void 0}}))}function x(t,e,i){var n=i,o=!1;return _(t,(function(t,r,a,s,l){n=!1===o&&void 0===i?t:e(n,t,r,a,s,l),o=!0})),n}function C(t,e){if(!t)throw new Error("geojson is required");b(t,(function(t,i,n){if(null!==t.geometry){var o=t.geometry.type,a=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,i,n,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===e(r(a[s],t.properties),i,n,s))return!1}}}))}function E(t,e,i){var n=i;return C(t,(function(t,o,r,a){n=0===o&&void 0===i?t:e(n,t,o,r,a)})),n}function k(t,e){if(!s(e=e||{}))throw new Error("options is invalid");var i,n=e.featureIndex||0,o=e.multiFeatureIndex||0,a=e.geometryIndex||0,l=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),u=u||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":u=u||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var c=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return l<0&&(l=c.length+l-1),r([c[l],c[l+1]],u,e);case"Polygon":return a<0&&(a=c.length+a),l<0&&(l=c[a].length+l-1),r([c[a][l],c[a][l+1]],u,e);case"MultiLineString":return o<0&&(o=c.length+o),l<0&&(l=c[o].length+l-1),r([c[o][l],c[o][l+1]],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),l<0&&(l=c[o][a].length-l-1),r([c[o][a][l],c[o][a][l+1]],u,e)}throw new Error("geojson is invalid")}function S(t,e){if(!s(e=e||{}))throw new Error("options is invalid");var i,n=e.featureIndex||0,r=e.multiFeatureIndex||0,a=e.geometryIndex||0,l=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),u=u||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":u=u||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var c=i.coordinates;switch(i.type){case"Point":return o(c,u,e);case"MultiPoint":return r<0&&(r=c.length+r),o(c[r],u,e);case"LineString":return l<0&&(l=c.length+l),o(c[l],u,e);case"Polygon":return a<0&&(a=c.length+a),l<0&&(l=c[a].length+l),o(c[a][l],u,e);case"MultiLineString":return r<0&&(r=c.length+r),l<0&&(l=c[r].length+l),o(c[r][l],u,e);case"MultiPolygon":return r<0&&(r=c.length+r),a<0&&(a=c[r].length+a),l<0&&(l=c[r][a].length-l),o(c[r][a][l],u,e)}throw new Error("geojson is invalid")}},function(t,e,i){var n=i(84),o=i(90);t.exports=function(t,e){var i=o(t,e);return n(i)?i:void 0}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}));function n(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function o(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,i){var n=i(74),o=i(75),r=i(76),a=i(77),s=i(78);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(29);t.exports=function(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}},function(t,e,i){var n=i(16),o=i(86),r=i(87),a=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):r(t)}},function(t,e,i){var n=i(2)(Object,"create");t.exports=n},function(t,e,i){var n=i(100);t.exports=function(t,e){var i=t.__data__;return n(e)?i["string"==typeof e?"string":"hash"]:i.map}},function(t,e,i){var n=i(33),o=i(34);t.exports=function(t,e,i,r){var a=!i;i||(i={});for(var s=-1,l=e.length;++s<l;){var u=e[s],c=r?r(i[u],t[u],u,i,t):void 0;void 0===c&&(c=t[u]),a?o(i,u,c):n(i,u,c)}return i}},function(t,e,i){
/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */
t.exports=function(){"use strict";for(var t=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),t<e?e:t>i?i:t},e={},i=0,n=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<n.length;i+=1){var o=n[i];e["[object "+o+"]"]=o.toLowerCase()}var r=function(t){return e[Object.prototype.toString.call(t)]||"object"},a=Math.PI,s={clip_rgb:function(e){e._clipped=!1,e._unclipped=e.slice(0);for(var i=0;i<=3;i++)i<3?((e[i]<0||e[i]>255)&&(e._clipped=!0),e[i]=t(e[i],0,255)):3===i&&(e[i]=t(e[i],0,1));return e},limit:t,type:r,unpack:function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==r(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==r(t[e])?t[e].toLowerCase():null},PI:a,TWOPI:2*a,PITHIRD:a/3,DEG2RAD:a/180,RAD2DEG:180/a},l={format:{},autodetect:[]},u=s.last,c=s.clip_rgb,h=s.type,d=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=this;if("object"===h(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var n=u(t),o=!1;if(!n){o=!0,l.sorted||(l.autodetect=l.autodetect.sort((function(t,e){return e.p-t.p})),l.sorted=!0);for(var r=0,a=l.autodetect;r<a.length;r+=1){var s=a[r];if(n=s.test.apply(s,t))break}}if(!l.format[n])throw new Error("unknown format: "+t);var d=l.format[n].apply(null,o?t:t.slice(0,-1));i._rgb=c(d),3===i._rgb.length&&i._rgb.push(1)};d.prototype.toString=function(){return"function"==h(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var p=d,f=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(f.Color,[null].concat(t)))};f.Color=p,f.version="2.1.0";var g=f,m=s.unpack,v=Math.max,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=m(t,"rgb"),n=i[0],o=i[1],r=i[2],a=1-v(n/=255,v(o/=255,r/=255)),s=a<1?1/(1-a):0,l=(1-n-a)*s,u=(1-o-a)*s,c=(1-r-a)*s;return[l,u,c,a]},b=s.unpack,w=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=b(t,"cmyk"))[0],n=t[1],o=t[2],r=t[3],a=t.length>4?t[4]:1;return 1===r?[0,0,0,a]:[i>=1?0:255*(1-i)*(1-r),n>=1?0:255*(1-n)*(1-r),o>=1?0:255*(1-o)*(1-r),a]},_=s.unpack,x=s.type;p.prototype.cmyk=function(){return y(this._rgb)},g.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["cmyk"])))},l.format.cmyk=w,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=_(t,"cmyk"),"array"===x(t)&&4===t.length)return"cmyk"}});var C=s.unpack,E=s.last,k=function(t){return Math.round(100*t)/100},S=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=C(t,"hsla"),n=E(t)||"lsa";return i[0]=k(i[0]||0),i[1]=k(100*i[1])+"%",i[2]=k(100*i[2])+"%","hsla"===n||i.length>3&&i[3]<1?(i[3]=i.length>3?i[3]:1,n="hsla"):i.length=3,n+"("+i.join(",")+")"},M=s.unpack,T=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=M(t,"rgba"))[0],n=t[1],o=t[2];i/=255,n/=255,o/=255;var r,a,s=Math.min(i,n,o),l=Math.max(i,n,o),u=(l+s)/2;return l===s?(r=0,a=Number.NaN):r=u<.5?(l-s)/(l+s):(l-s)/(2-l-s),i==l?a=(n-o)/(l-s):n==l?a=2+(o-i)/(l-s):o==l&&(a=4+(i-n)/(l-s)),(a*=60)<0&&(a+=360),t.length>3&&void 0!==t[3]?[a,r,u,t[3]]:[a,r,u]},R=s.unpack,P=s.last,D=Math.round,L=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=R(t,"rgba"),n=P(t)||"rgb";return"hsl"==n.substr(0,3)?S(T(i),n):(i[0]=D(i[0]),i[1]=D(i[1]),i[2]=D(i[2]),("rgba"===n||i.length>3&&i[3]<1)&&(i[3]=i.length>3?i[3]:1,n="rgba"),n+"("+i.slice(0,"rgb"===n?3:4).join(",")+")")},F=s.unpack,O=Math.round,A=function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];var n,o,r,a=(e=F(e,"hsl"))[0],s=e[1],l=e[2];if(0===s)n=o=r=255*l;else{var u=[0,0,0],c=[0,0,0],h=l<.5?l*(1+s):l+s-l*s,d=2*l-h,p=a/360;u[0]=p+1/3,u[1]=p,u[2]=p-1/3;for(var f=0;f<3;f++)u[f]<0&&(u[f]+=1),u[f]>1&&(u[f]-=1),6*u[f]<1?c[f]=d+6*(h-d)*u[f]:2*u[f]<1?c[f]=h:3*u[f]<2?c[f]=d+(h-d)*(2/3-u[f])*6:c[f]=d;n=(t=[O(255*c[0]),O(255*c[1]),O(255*c[2])])[0],o=t[1],r=t[2]}return e.length>3?[n,o,r,e[3]]:[n,o,r,1]},I=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,j=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,z=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,N=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,H=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,B=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,G=Math.round,V=function(t){var e;if(t=t.toLowerCase().trim(),l.format.named)try{return l.format.named(t)}catch(t){}if(e=t.match(I)){for(var i=e.slice(1,4),n=0;n<3;n++)i[n]=+i[n];return i[3]=1,i}if(e=t.match(j)){for(var o=e.slice(1,5),r=0;r<4;r++)o[r]=+o[r];return o}if(e=t.match(z)){for(var a=e.slice(1,4),s=0;s<3;s++)a[s]=G(2.55*a[s]);return a[3]=1,a}if(e=t.match(N)){for(var u=e.slice(1,5),c=0;c<3;c++)u[c]=G(2.55*u[c]);return u[3]=+u[3],u}if(e=t.match(H)){var h=e.slice(1,4);h[1]*=.01,h[2]*=.01;var d=A(h);return d[3]=1,d}if(e=t.match(B)){var p=e.slice(1,4);p[1]*=.01,p[2]*=.01;var f=A(p);return f[3]=+e[4],f}};V.test=function(t){return I.test(t)||j.test(t)||z.test(t)||N.test(t)||H.test(t)||B.test(t)};var W=V,q=s.type;p.prototype.css=function(t){return L(this._rgb,t)},g.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["css"])))},l.format.css=W,l.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===q(t)&&W.test(t))return"css"}});var $=s.unpack;l.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=$(t,"rgba");return i[0]*=255,i[1]*=255,i[2]*=255,i},g.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["gl"])))},p.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var Y=s.unpack,X=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n=Y(t,"rgb"),o=n[0],r=n[1],a=n[2],s=Math.min(o,r,a),l=Math.max(o,r,a),u=l-s,c=100*u/255,h=s/(255-u)*100;return 0===u?i=Number.NaN:(o===l&&(i=(r-a)/u),r===l&&(i=2+(a-o)/u),a===l&&(i=4+(o-r)/u),(i*=60)<0&&(i+=360)),[i,c,h]},U=s.unpack,K=Math.floor,Z=function(){for(var t,e,i,n,o,r,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,u,c,h=(a=U(a,"hcg"))[0],d=a[1],p=a[2];p*=255;var f=255*d;if(0===d)l=u=c=p;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var g=K(h/=60),m=h-g,v=p*(1-d),y=v+f*(1-m),b=v+f*m,w=v+f;switch(g){case 0:l=(t=[w,b,v])[0],u=t[1],c=t[2];break;case 1:l=(e=[y,w,v])[0],u=e[1],c=e[2];break;case 2:l=(i=[v,w,b])[0],u=i[1],c=i[2];break;case 3:l=(n=[v,y,w])[0],u=n[1],c=n[2];break;case 4:l=(o=[b,v,w])[0],u=o[1],c=o[2];break;case 5:l=(r=[w,v,y])[0],u=r[1],c=r[2]}}return[l,u,c,a.length>3?a[3]:1]},J=s.unpack,Q=s.type;p.prototype.hcg=function(){return X(this._rgb)},g.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hcg"])))},l.format.hcg=Z,l.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=J(t,"hcg"),"array"===Q(t)&&3===t.length)return"hcg"}});var tt=s.unpack,et=s.last,it=Math.round,nt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=tt(t,"rgba"),n=i[0],o=i[1],r=i[2],a=i[3],s=et(t)||"auto";void 0===a&&(a=1),"auto"===s&&(s=a<1?"rgba":"rgb");var l=(n=it(n))<<16|(o=it(o))<<8|(r=it(r)),u="000000"+l.toString(16);u=u.substr(u.length-6);var c="0"+it(255*a).toString(16);switch(c=c.substr(c.length-2),s.toLowerCase()){case"rgba":return"#"+u+c;case"argb":return"#"+c+u;default:return"#"+u}},ot=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,rt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,at=function(t){if(t.match(ot)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(rt)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var i=parseInt(t,16);return[i>>24&255,i>>16&255,i>>8&255,Math.round((255&i)/255*100)/100]}throw new Error("unknown hex color: "+t)},st=s.type;p.prototype.hex=function(t){return nt(this._rgb,t)},g.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hex"])))},l.format.hex=at,l.autodetect.push({p:4,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===st(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var lt=s.unpack,ut=s.TWOPI,ct=Math.min,ht=Math.sqrt,dt=Math.acos,pt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n=lt(t,"rgb"),o=n[0],r=n[1],a=n[2],s=ct(o/=255,r/=255,a/=255),l=(o+r+a)/3,u=l>0?1-s/l:0;return 0===u?i=NaN:(i=(o-r+(o-a))/2,i/=ht((o-r)*(o-r)+(o-a)*(r-a)),i=dt(i),a>r&&(i=ut-i),i/=ut),[360*i,u,l]},ft=s.unpack,gt=s.limit,mt=s.TWOPI,vt=s.PITHIRD,yt=Math.cos,bt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n,o,r=(t=ft(t,"hsi"))[0],a=t[1],s=t[2];return isNaN(r)&&(r=0),isNaN(a)&&(a=0),r>360&&(r-=360),r<0&&(r+=360),(r/=360)<1/3?n=1-((o=(1-a)/3)+(i=(1+a*yt(mt*r)/yt(vt-mt*r))/3)):r<2/3?o=1-((i=(1-a)/3)+(n=(1+a*yt(mt*(r-=1/3))/yt(vt-mt*r))/3)):i=1-((n=(1-a)/3)+(o=(1+a*yt(mt*(r-=2/3))/yt(vt-mt*r))/3)),[255*(i=gt(s*i*3)),255*(n=gt(s*n*3)),255*(o=gt(s*o*3)),t.length>3?t[3]:1]},wt=s.unpack,_t=s.type;p.prototype.hsi=function(){return pt(this._rgb)},g.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hsi"])))},l.format.hsi=bt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=wt(t,"hsi"),"array"===_t(t)&&3===t.length)return"hsi"}});var xt=s.unpack,Ct=s.type;p.prototype.hsl=function(){return T(this._rgb)},g.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hsl"])))},l.format.hsl=A,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=xt(t,"hsl"),"array"===Ct(t)&&3===t.length)return"hsl"}});var Et=s.unpack,kt=Math.min,St=Math.max,Mt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n,o,r=(t=Et(t,"rgb"))[0],a=t[1],s=t[2],l=kt(r,a,s),u=St(r,a,s),c=u-l;return o=u/255,0===u?(i=Number.NaN,n=0):(n=c/u,r===u&&(i=(a-s)/c),a===u&&(i=2+(s-r)/c),s===u&&(i=4+(r-a)/c),(i*=60)<0&&(i+=360)),[i,n,o]},Tt=s.unpack,Rt=Math.floor,Pt=function(){for(var t,e,i,n,o,r,a=[],s=arguments.length;s--;)a[s]=arguments[s];var l,u,c,h=(a=Tt(a,"hsv"))[0],d=a[1],p=a[2];if(p*=255,0===d)l=u=c=p;else{360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360);var f=Rt(h/=60),g=h-f,m=p*(1-d),v=p*(1-d*g),y=p*(1-d*(1-g));switch(f){case 0:l=(t=[p,y,m])[0],u=t[1],c=t[2];break;case 1:l=(e=[v,p,m])[0],u=e[1],c=e[2];break;case 2:l=(i=[m,p,y])[0],u=i[1],c=i[2];break;case 3:l=(n=[m,v,p])[0],u=n[1],c=n[2];break;case 4:l=(o=[y,m,p])[0],u=o[1],c=o[2];break;case 5:l=(r=[p,m,v])[0],u=r[1],c=r[2]}}return[l,u,c,a.length>3?a[3]:1]},Dt=s.unpack,Lt=s.type;p.prototype.hsv=function(){return Mt(this._rgb)},g.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hsv"])))},l.format.hsv=Pt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Dt(t,"hsv"),"array"===Lt(t)&&3===t.length)return"hsv"}});var Ft=18,Ot=.95047,At=1,It=1.08883,jt=.137931034,zt=.206896552,Nt=.12841855,Ht=.008856452,Bt=s.unpack,Gt=Math.pow,Vt=function(t){return(t/=255)<=.04045?t/12.92:Gt((t+.055)/1.055,2.4)},Wt=function(t){return t>Ht?Gt(t,1/3):t/Nt+jt},qt=function(t,e,i){return t=Vt(t),e=Vt(e),i=Vt(i),[Wt((.4124564*t+.3575761*e+.1804375*i)/Ot),Wt((.2126729*t+.7151522*e+.072175*i)/At),Wt((.0193339*t+.119192*e+.9503041*i)/It)]},$t=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Bt(t,"rgb"),n=i[0],o=i[1],r=i[2],a=qt(n,o,r),s=a[0],l=a[1],u=a[2],c=116*l-16;return[c<0?0:c,500*(s-l),200*(l-u)]},Yt=s.unpack,Xt=Math.pow,Ut=function(t){return 255*(t<=.00304?12.92*t:1.055*Xt(t,1/2.4)-.055)},Kt=function(t){return t>zt?t*t*t:Nt*(t-jt)},Zt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,n,o,r=(t=Yt(t,"lab"))[0],a=t[1],s=t[2];return n=(r+16)/116,i=isNaN(a)?n:n+a/500,o=isNaN(s)?n:n-s/200,n=At*Kt(n),i=Ot*Kt(i),o=It*Kt(o),[Ut(3.2404542*i-1.5371385*n-.4985314*o),Ut(-.969266*i+1.8760108*n+.041556*o),Ut(.0556434*i-.2040259*n+1.0572252*o),t.length>3?t[3]:1]},Jt=s.unpack,Qt=s.type;p.prototype.lab=function(){return $t(this._rgb)},g.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["lab"])))},l.format.lab=Zt,l.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Jt(t,"lab"),"array"===Qt(t)&&3===t.length)return"lab"}});var te=s.unpack,ee=s.RAD2DEG,ie=Math.sqrt,ne=Math.atan2,oe=Math.round,re=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=te(t,"lab"),n=i[0],o=i[1],r=i[2],a=ie(o*o+r*r),s=(ne(r,o)*ee+360)%360;return 0===oe(1e4*a)&&(s=Number.NaN),[n,a,s]},ae=s.unpack,se=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=ae(t,"rgb"),n=i[0],o=i[1],r=i[2],a=$t(n,o,r),s=a[0],l=a[1],u=a[2];return re(s,l,u)},le=s.unpack,ue=s.DEG2RAD,ce=Math.sin,he=Math.cos,de=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=le(t,"lch"),n=i[0],o=i[1],r=i[2];return isNaN(r)&&(r=0),[n,he(r*=ue)*o,ce(r)*o]},pe=s.unpack,fe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=pe(t,"lch"))[0],n=t[1],o=t[2],r=de(i,n,o),a=r[0],s=r[1],l=r[2],u=Zt(a,s,l),c=u[0],h=u[1],d=u[2];return[c,h,d,t.length>3?t[3]:1]},ge=s.unpack,me=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=ge(t,"hcl").reverse();return fe.apply(void 0,i)},ve=s.unpack,ye=s.type;p.prototype.lch=function(){return se(this._rgb)},p.prototype.hcl=function(){return se(this._rgb).reverse()},g.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["lch"])))},g.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["hcl"])))},l.format.lch=fe,l.format.hcl=me,["lch","hcl"].forEach((function(t){return l.autodetect.push({p:2,test:function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];if(e=ve(e,t),"array"===ye(e)&&3===e.length)return t}})}));var be={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},we=s.type;p.prototype.name=function(){for(var t=nt(this._rgb,"rgb"),e=0,i=Object.keys(be);e<i.length;e+=1){var n=i[e];if(be[n]===t)return n.toLowerCase()}return t},l.format.named=function(t){if(t=t.toLowerCase(),be[t])return at(be[t]);throw new Error("unknown color name: "+t)},l.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===we(t)&&be[t.toLowerCase()])return"named"}});var _e=s.unpack,xe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=_e(t,"rgb"),n=i[0],o=i[1],r=i[2];return(n<<16)+(o<<8)+r},Ce=s.type,Ee=function(t){if("number"==Ce(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},ke=s.type;p.prototype.num=function(){return xe(this._rgb)},g.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["num"])))},l.format.num=Ee,l.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===ke(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var Se=s.unpack,Me=s.type,Te=Math.round;p.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Te)},p.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,i){return i<3?!1===t?e:Te(e):e}))},g.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["rgb"])))},l.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Se(t,"rgba");return void 0===i[3]&&(i[3]=1),i},l.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Se(t,"rgba"),"array"===Me(t)&&(3===t.length||4===t.length&&"number"==Me(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var Re=Math.log,Pe=function(t){var e,i,n,o=t/100;return o<66?(e=255,i=-155.25485562709179-.44596950469579133*(i=o-2)+104.49216199393888*Re(i),n=o<20?0:.8274096064007395*(n=o-10)-254.76935184120902+115.67994401066147*Re(n)):(e=351.97690566805693+.114206453784165*(e=o-55)-40.25366309332127*Re(e),i=325.4494125711974+.07943456536662342*(i=o-50)-28.0852963507957*Re(i),n=255),[e,i,n,1]},De=s.unpack,Le=Math.round,Fe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var i,n=De(t,"rgb"),o=n[0],r=n[2],a=1e3,s=4e4,l=.4;s-a>l;){var u=Pe(i=.5*(s+a));u[2]/u[0]>=r/o?s=i:a=i}return Le(i)};p.prototype.temp=p.prototype.kelvin=p.prototype.temperature=function(){return Fe(this._rgb)},g.temp=g.kelvin=g.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(p,[null].concat(t,["temp"])))},l.format.temp=l.format.kelvin=l.format.temperature=Pe;var Oe=s.type;p.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===Oe(t)?e?(this._rgb[3]=t,this):new p([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},p.prototype.clipped=function(){return this._rgb._clipped||!1},p.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=Ft*t,new p(e,"lab").alpha(this.alpha(),!0)},p.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},p.prototype.darker=p.prototype.darken,p.prototype.brighter=p.prototype.brighten,p.prototype.get=function(t){var e=t.split("."),i=e[0],n=e[1],o=this[i]();if(n){var r=i.indexOf(n);if(r>-1)return o[r];throw new Error("unknown channel "+n+" in mode "+i)}return o};var Ae=s.type,Ie=Math.pow;p.prototype.luminance=function(t){if(void 0!==t&&"number"===Ae(t)){if(0===t)return new p([0,0,0,this._rgb[3]],"rgb");if(1===t)return new p([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),i=20,n=function(e,o){var r=e.interpolate(o,.5,"rgb"),a=r.luminance();return Math.abs(t-a)<1e-7||!i--?r:a>t?n(e,r):n(r,o)},o=(e>t?n(new p([0,0,0]),this):n(this,new p([255,255,255]))).rgb();return new p(o.concat([this._rgb[3]]))}return je.apply(void 0,this._rgb.slice(0,3))};var je=function(t,e,i){return.2126*(t=ze(t))+.7152*(e=ze(e))+.0722*(i=ze(i))},ze=function(t){return(t/=255)<=.03928?t/12.92:Ie((t+.055)/1.055,2.4)},Ne={},He=s.type,Be=function(t,e,i){void 0===i&&(i=.5);for(var n=[],o=arguments.length-3;o-- >0;)n[o]=arguments[o+3];var r=n[0]||"lrgb";if(Ne[r]||n.length||(r=Object.keys(Ne)[0]),!Ne[r])throw new Error("interpolation mode "+r+" is not defined");return"object"!==He(t)&&(t=new p(t)),"object"!==He(e)&&(e=new p(e)),Ne[r](t,e,i).alpha(t.alpha()+i*(e.alpha()-t.alpha()))};p.prototype.mix=p.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];return Be.apply(void 0,[this,t,e].concat(i))},p.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,i=e[3];return t?(this._rgb=[e[0]*i,e[1]*i,e[2]*i,i],this):new p([e[0]*i,e[1]*i,e[2]*i,i],"rgb")},p.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=Ft*t,e[1]<0&&(e[1]=0),new p(e,"lch").alpha(this.alpha(),!0)},p.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var Ge=s.type;p.prototype.set=function(t,e,i){void 0===i&&(i=!1);var n=t.split("."),o=n[0],r=n[1],a=this[o]();if(r){var s=o.indexOf(r);if(s>-1){if("string"==Ge(e))switch(e.charAt(0)){case"+":case"-":a[s]+=+e;break;case"*":a[s]*=+e.substr(1);break;case"/":a[s]/=+e.substr(1);break;default:a[s]=+e}else{if("number"!==Ge(e))throw new Error("unsupported value for Color.set");a[s]=e}var l=new p(a,o);return i?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+r+" in mode "+o)}return a},Ne.rgb=function(t,e,i){var n=t._rgb,o=e._rgb;return new p(n[0]+i*(o[0]-n[0]),n[1]+i*(o[1]-n[1]),n[2]+i*(o[2]-n[2]),"rgb")};var Ve=Math.sqrt,We=Math.pow;Ne.lrgb=function(t,e,i){var n=t._rgb,o=n[0],r=n[1],a=n[2],s=e._rgb,l=s[0],u=s[1],c=s[2];return new p(Ve(We(o,2)*(1-i)+We(l,2)*i),Ve(We(r,2)*(1-i)+We(u,2)*i),Ve(We(a,2)*(1-i)+We(c,2)*i),"rgb")},Ne.lab=function(t,e,i){var n=t.lab(),o=e.lab();return new p(n[0]+i*(o[0]-n[0]),n[1]+i*(o[1]-n[1]),n[2]+i*(o[2]-n[2]),"lab")};var qe=function(t,e,i,n){var o,r,a,s,l,u,c,h,d,f,g,m;return"hsl"===n?(a=t.hsl(),s=e.hsl()):"hsv"===n?(a=t.hsv(),s=e.hsv()):"hcg"===n?(a=t.hcg(),s=e.hcg()):"hsi"===n?(a=t.hsi(),s=e.hsi()):"lch"!==n&&"hcl"!==n||(n="hcl",a=t.hcl(),s=e.hcl()),"h"===n.substr(0,1)&&(l=(o=a)[0],c=o[1],d=o[2],u=(r=s)[0],h=r[1],f=r[2]),isNaN(l)||isNaN(u)?isNaN(l)?isNaN(u)?m=Number.NaN:(m=u,1!=d&&0!=d||"hsv"==n||(g=h)):(m=l,1!=f&&0!=f||"hsv"==n||(g=c)):m=l+i*(u>l&&u-l>180?u-(l+360):u<l&&l-u>180?u+360-l:u-l),void 0===g&&(g=c+i*(h-c)),new p([m,g,d+i*(f-d)],n)},$e=function(t,e,i){return qe(t,e,i,"lch")};Ne.lch=$e,Ne.hcl=$e,Ne.num=function(t,e,i){var n=t.num(),o=e.num();return new p(n+i*(o-n),"num")},Ne.hcg=function(t,e,i){return qe(t,e,i,"hcg")},Ne.hsi=function(t,e,i){return qe(t,e,i,"hsi")},Ne.hsl=function(t,e,i){return qe(t,e,i,"hsl")},Ne.hsv=function(t,e,i){return qe(t,e,i,"hsv")};var Ye=s.clip_rgb,Xe=Math.pow,Ue=Math.sqrt,Ke=Math.PI,Ze=Math.cos,Je=Math.sin,Qe=Math.atan2,ti=function(t,e){for(var i=t.length,n=[0,0,0,0],o=0;o<t.length;o++){var r=t[o],a=e[o]/i,s=r._rgb;n[0]+=Xe(s[0],2)*a,n[1]+=Xe(s[1],2)*a,n[2]+=Xe(s[2],2)*a,n[3]+=s[3]*a}return n[0]=Ue(n[0]),n[1]=Ue(n[1]),n[2]=Ue(n[2]),n[3]>.9999999&&(n[3]=1),new p(Ye(n))},ei=s.type,ii=Math.pow,ni=function(t){var e="rgb",i=g("#ccc"),n=0,o=[0,1],r=[],a=[0,0],s=!1,l=[],u=!1,c=0,h=1,d=!1,p={},f=!0,m=1,v=function(t){if((t=t||["#fff","#000"])&&"string"===ei(t)&&g.brewer&&g.brewer[t.toLowerCase()]&&(t=g.brewer[t.toLowerCase()]),"array"===ei(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=g(t[e]);r.length=0;for(var i=0;i<t.length;i++)r.push(i/(t.length-1))}return _(),l=t},y=function(t){return t},b=function(t){return t},w=function(t,n){var o,u;if(null==n&&(n=!1),isNaN(t)||null===t)return i;u=n?t:s&&s.length>2?function(t){if(null!=s){for(var e=s.length-1,i=0;i<e&&t>=s[i];)i++;return i-1}return 0}(t)/(s.length-2):h!==c?(t-c)/(h-c):1,u=b(u),n||(u=y(u)),1!==m&&(u=ii(u,m)),u=a[0]+u*(1-a[0]-a[1]),u=Math.min(1,Math.max(0,u));var d=Math.floor(1e4*u);if(f&&p[d])o=p[d];else{if("array"===ei(l))for(var v=0;v<r.length;v++){var w=r[v];if(u<=w){o=l[v];break}if(u>=w&&v===r.length-1){o=l[v];break}if(u>w&&u<r[v+1]){u=(u-w)/(r[v+1]-w),o=g.interpolate(l[v],l[v+1],u,e);break}}else"function"===ei(l)&&(o=l(u));f&&(p[d]=o)}return o},_=function(){return p={}};v(t);var x=function(t){var e=g(w(t));return u&&e[u]?e[u]():e};return x.classes=function(t){if(null!=t){if("array"===ei(t))s=t,o=[t[0],t[t.length-1]];else{var e=g.analyze(o);s=0===t?[e.min,e.max]:g.limits(e,"e",t)}return x}return s},x.domain=function(t){if(!arguments.length)return o;c=t[0],h=t[t.length-1],r=[];var e=l.length;if(t.length===e&&c!==h)for(var i=0,n=Array.from(t);i<n.length;i+=1){var a=n[i];r.push((a-c)/(h-c))}else{for(var s=0;s<e;s++)r.push(s/(e-1));if(t.length>2){var u=t.map((function(e,i){return i/(t.length-1)})),d=t.map((function(t){return(t-c)/(h-c)}));d.every((function(t,e){return u[e]===t}))||(b=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=d[e+1];)e++;var i=(t-d[e])/(d[e+1]-d[e]);return u[e]+i*(u[e+1]-u[e])})}}return o=[c,h],x},x.mode=function(t){return arguments.length?(e=t,_(),x):e},x.range=function(t,e){return v(t),x},x.out=function(t){return u=t,x},x.spread=function(t){return arguments.length?(n=t,x):n},x.correctLightness=function(t){return null==t&&(t=!0),d=t,_(),y=d?function(t){for(var e=w(0,!0).lab()[0],i=w(1,!0).lab()[0],n=e>i,o=w(t,!0).lab()[0],r=e+(i-e)*t,a=o-r,s=0,l=1,u=20;Math.abs(a)>.01&&u-- >0;)n&&(a*=-1),a<0?(s=t,t+=.5*(l-t)):(l=t,t+=.5*(s-t)),o=w(t,!0).lab()[0],a=o-r;return t}:function(t){return t},x},x.padding=function(t){return null!=t?("number"===ei(t)&&(t=[t,t]),a=t,x):a},x.colors=function(e,i){arguments.length<2&&(i="hex");var n=[];if(0===arguments.length)n=l.slice(0);else if(1===e)n=[x(.5)];else if(e>1){var r=o[0],a=o[1]-r;n=oi(0,e,!1).map((function(t){return x(r+t/(e-1)*a)}))}else{t=[];var u=[];if(s&&s.length>2)for(var c=1,h=s.length,d=1<=h;d?c<h:c>h;d?c++:c--)u.push(.5*(s[c-1]+s[c]));else u=o;n=u.map((function(t){return x(t)}))}return g[i]&&(n=n.map((function(t){return t[i]()}))),n},x.cache=function(t){return null!=t?(f=t,x):f},x.gamma=function(t){return null!=t?(m=t,x):m},x.nodata=function(t){return null!=t?(i=g(t),x):i},x};function oi(t,e,i){for(var n=[],o=t<e,r=i?o?e+1:e-1:e,a=t;o?a<r:a>r;o?a++:a--)n.push(a);return n}var ri=function(t){var e,i,n,o,r,a,s;if(2===(t=t.map((function(t){return new p(t)}))).length)e=t.map((function(t){return t.lab()})),r=e[0],a=e[1],o=function(t){var e=[0,1,2].map((function(e){return r[e]+t*(a[e]-r[e])}));return new p(e,"lab")};else if(3===t.length)i=t.map((function(t){return t.lab()})),r=i[0],a=i[1],s=i[2],o=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*r[e]+2*(1-t)*t*a[e]+t*t*s[e]}));return new p(e,"lab")};else if(4===t.length){var l;n=t.map((function(t){return t.lab()})),r=n[0],a=n[1],s=n[2],l=n[3],o=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*r[e]+3*(1-t)*(1-t)*t*a[e]+3*(1-t)*t*t*s[e]+t*t*t*l[e]}));return new p(e,"lab")}}else if(5===t.length){var u=ri(t.slice(0,3)),c=ri(t.slice(2,5));o=function(t){return t<.5?u(2*t):c(2*(t-.5))}}return o},ai=function(t,e,i){if(!ai[i])throw new Error("unknown blend mode "+i);return ai[i](t,e)},si=function(t){return function(e,i){var n=g(i).rgb(),o=g(e).rgb();return g.rgb(t(n,o))}},li=function(t){return function(e,i){var n=[];return n[0]=t(e[0],i[0]),n[1]=t(e[1],i[1]),n[2]=t(e[2],i[2]),n}};ai.normal=si(li((function(t){return t}))),ai.multiply=si(li((function(t,e){return t*e/255}))),ai.screen=si(li((function(t,e){return 255*(1-(1-t/255)*(1-e/255))}))),ai.overlay=si(li((function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))}))),ai.darken=si(li((function(t,e){return t>e?e:t}))),ai.lighten=si(li((function(t,e){return t>e?t:e}))),ai.dodge=si(li((function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t}))),ai.burn=si(li((function(t,e){return 255*(1-(1-e/255)/(t/255))})));for(var ui=ai,ci=s.type,hi=s.clip_rgb,di=s.TWOPI,pi=Math.pow,fi=Math.sin,gi=Math.cos,mi=Math.floor,vi=Math.random,yi=Math.log,bi=Math.pow,wi=Math.floor,_i=Math.abs,xi=function(t,e){void 0===e&&(e=null);var i={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===r(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===r(t)&&(t=t[e]),null==t||isNaN(t)||(i.values.push(t),i.sum+=t,t<i.min&&(i.min=t),t>i.max&&(i.max=t),i.count+=1)})),i.domain=[i.min,i.max],i.limits=function(t,e){return Ci(i,t,e)},i},Ci=function(t,e,i){void 0===e&&(e="equal"),void 0===i&&(i=7),"array"==r(t)&&(t=xi(t));var n=t.min,o=t.max,a=t.values.sort((function(t,e){return t-e}));if(1===i)return[n,o];var s=[];if("c"===e.substr(0,1)&&(s.push(n),s.push(o)),"e"===e.substr(0,1)){s.push(n);for(var l=1;l<i;l++)s.push(n+l/i*(o-n));s.push(o)}else if("l"===e.substr(0,1)){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");var u=Math.LOG10E*yi(n),c=Math.LOG10E*yi(o);s.push(n);for(var h=1;h<i;h++)s.push(bi(10,u+h/i*(c-u)));s.push(o)}else if("q"===e.substr(0,1)){s.push(n);for(var d=1;d<i;d++){var p=(a.length-1)*d/i,f=wi(p);if(f===p)s.push(a[f]);else{var g=p-f;s.push(a[f]*(1-g)+a[f+1]*g)}}s.push(o)}else if("k"===e.substr(0,1)){var m,v=a.length,y=new Array(v),b=new Array(i),w=!0,_=0,x=null;(x=[]).push(n);for(var C=1;C<i;C++)x.push(n+C/i*(o-n));for(x.push(o);w;){for(var E=0;E<i;E++)b[E]=0;for(var k=0;k<v;k++)for(var S=a[k],M=Number.MAX_VALUE,T=void 0,R=0;R<i;R++){var P=_i(x[R]-S);P<M&&(M=P,T=R),b[T]++,y[k]=T}for(var D=new Array(i),L=0;L<i;L++)D[L]=null;for(var F=0;F<v;F++)null===D[m=y[F]]?D[m]=a[F]:D[m]+=a[F];for(var O=0;O<i;O++)D[O]*=1/b[O];w=!1;for(var A=0;A<i;A++)if(D[A]!==x[A]){w=!0;break}x=D,++_>200&&(w=!1)}for(var I={},j=0;j<i;j++)I[j]=[];for(var z=0;z<v;z++)I[m=y[z]].push(a[z]);for(var N=[],H=0;H<i;H++)N.push(I[H][0]),N.push(I[H][I[H].length-1]);N=N.sort((function(t,e){return t-e})),s.push(N[0]);for(var B=1;B<N.length;B+=2){var G=N[B];isNaN(G)||-1!==s.indexOf(G)||s.push(G)}}return s},Ei={analyze:xi,limits:Ci},ki=Math.sqrt,Si=Math.atan2,Mi=Math.abs,Ti=Math.cos,Ri=Math.PI,Pi={cool:function(){return ni([g.hsl(180,1,.9),g.hsl(250,.7,.4)])},hot:function(){return ni(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Di={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Li=0,Fi=Object.keys(Di);Li<Fi.length;Li+=1){var Oi=Fi[Li];Di[Oi.toLowerCase()]=Di[Oi]}var Ai=Di;return g.average=function(t,e,i){void 0===e&&(e="lrgb"),void 0===i&&(i=null);var n=t.length;i||(i=Array.from(new Array(n)).map((function(){return 1})));var o=n/i.reduce((function(t,e){return t+e}));if(i.forEach((function(t,e){i[e]*=o})),t=t.map((function(t){return new p(t)})),"lrgb"===e)return ti(t,i);for(var r=t.shift(),a=r.get(e),s=[],l=0,u=0,c=0;c<a.length;c++)if(a[c]=(a[c]||0)*i[0],s.push(isNaN(a[c])?0:i[0]),"h"===e.charAt(c)&&!isNaN(a[c])){var h=a[c]/180*Ke;l+=Ze(h)*i[0],u+=Je(h)*i[0]}var d=r.alpha()*i[0];t.forEach((function(t,n){var o=t.get(e);d+=t.alpha()*i[n+1];for(var r=0;r<a.length;r++)if(!isNaN(o[r]))if(s[r]+=i[n+1],"h"===e.charAt(r)){var c=o[r]/180*Ke;l+=Ze(c)*i[n+1],u+=Je(c)*i[n+1]}else a[r]+=o[r]*i[n+1]}));for(var f=0;f<a.length;f++)if("h"===e.charAt(f)){for(var g=Qe(u/s[f],l/s[f])/Ke*180;g<0;)g+=360;for(;g>=360;)g-=360;a[f]=g}else a[f]=a[f]/s[f];return d/=n,new p(a,e).alpha(d>.99999?1:d,!0)},g.bezier=function(t){var e=ri(t);return e.scale=function(){return ni(e)},e},g.blend=ui,g.cubehelix=function(t,e,i,n,o){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===i&&(i=1),void 0===n&&(n=1),void 0===o&&(o=[0,1]);var r,a=0;"array"===ci(o)?r=o[1]-o[0]:(r=0,o=[o,o]);var s=function(s){var l=di*((t+120)/360+e*s),u=pi(o[0]+r*s,n),c=(0!==a?i[0]+s*a:i)*u*(1-u)/2,h=gi(l),d=fi(l);return g(hi([255*(u+c*(-.14861*h+1.78277*d)),255*(u+c*(-.29227*h-.90649*d)),255*(u+c*(1.97294*h)),1]))};return s.start=function(e){return null==e?t:(t=e,s)},s.rotations=function(t){return null==t?e:(e=t,s)},s.gamma=function(t){return null==t?n:(n=t,s)},s.hue=function(t){return null==t?i:("array"===ci(i=t)?0==(a=i[1]-i[0])&&(i=i[1]):a=0,s)},s.lightness=function(t){return null==t?o:("array"===ci(t)?(o=t,r=t[1]-t[0]):(o=[t,t],r=0),s)},s.scale=function(){return g.scale(s)},s.hue(i),s},g.mix=g.interpolate=Be,g.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(mi(16*vi()));return new p(t,"hex")},g.scale=ni,g.analyze=Ei.analyze,g.contrast=function(t,e){t=new p(t),e=new p(e);var i=t.luminance(),n=e.luminance();return i>n?(i+.05)/(n+.05):(n+.05)/(i+.05)},g.deltaE=function(t,e,i,n){void 0===i&&(i=1),void 0===n&&(n=1),t=new p(t),e=new p(e);for(var o=Array.from(t.lab()),r=o[0],a=o[1],s=o[2],l=Array.from(e.lab()),u=l[0],c=l[1],h=l[2],d=ki(a*a+s*s),f=ki(c*c+h*h),g=r<16?.511:.040975*r/(1+.01765*r),m=.0638*d/(1+.0131*d)+.638,v=d<1e-6?0:180*Si(s,a)/Ri;v<0;)v+=360;for(;v>=360;)v-=360;var y=v>=164&&v<=345?.56+Mi(.2*Ti(Ri*(v+168)/180)):.36+Mi(.4*Ti(Ri*(v+35)/180)),b=d*d*d*d,w=ki(b/(b+1900)),_=m*(w*y+1-w),x=d-f,C=a-c,E=s-h,k=(r-u)/(i*g),S=x/(n*m);return ki(k*k+S*S+(C*C+E*E-x*x)/(_*_))},g.distance=function(t,e,i){void 0===i&&(i="lab"),t=new p(t),e=new p(e);var n=t.get(i),o=e.get(i),r=0;for(var a in n){var s=(n[a]||0)-(o[a]||0);r+=s*s}return Math.sqrt(r)},g.limits=Ei.limits,g.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(p,[null].concat(t))),!0}catch(t){return!1}},g.scales=Pi,g.colors=be,g.brewer=Ai,g}()},function(t,e,i){t.exports=function(){"use strict";function t(t,n,o,r,a){!function t(i,n,o,r,a){for(;r>o;){if(r-o>600){var s=r-o+1,l=n-o+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(o,Math.floor(n-l*c/s+h)),p=Math.min(r,Math.floor(n+(s-l)*c/s+h));t(i,n,d,p,a)}var f=i[n],g=o,m=r;for(e(i,o,n),a(i[r],f)>0&&e(i,o,r);g<m;){for(e(i,g,m),g++,m--;a(i[g],f)<0;)g++;for(;a(i[m],f)>0;)m--}0===a(i[o],f)?e(i,o,m):(m++,e(i,m,r)),m<=n&&(o=m+1),n<=m&&(r=m-1)}}(t,n,o||0,r||t.length-1,a||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function r(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,o){o||(o=f(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r=e;r<i;r++){var a=t.children[r];s(o,t.leaf?n(a):a)}return o}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,o,r){for(var a=[i,n];a.length;)if(!((n=a.pop())-(i=a.pop())<=o)){var s=i+Math.ceil((n-i)/o/2)*o;t(e,s,i,n,r),a.push(i,s,s,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!p(t,e))return i;for(var n=this.toBBox,o=[];e;){for(var r=0;r<e.children.length;r++){var a=e.children[r],s=e.leaf?n(a):a;p(t,s)&&(e.leaf?i.push(a):d(t,s)?this._all(a,i):o.push(a))}e=o.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var o=e.children[n],r=e.leaf?this.toBBox(o):o;if(p(t,r)){if(e.leaf||d(t,r))return!0;i.push(o)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,r,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],i=u.pop(),r=!0),a.leaf){var c=o(t,a.children,e);if(-1!==c)return a.children.splice(c,1),l.push(a),this._condense(l),this}r||a.leaf||!d(a,s)?n?(i++,a=n.children[i],r=!1):a=null:(l.push(a),u.push(i),i=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var o,a=i-e+1,s=this._maxEntries;if(a<=s)return r(o=f(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=f([])).leaf=!1,o.height=n;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));g(t,e,i,u,this.compareMinX);for(var c=e;c<=i;c+=u){var h=Math.min(c+u-1,i);g(t,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var p=Math.min(d+l-1,h);o.children.push(this._build(t,d,p,n-1))}}return r(o,this.toBBox),o},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var o=1/0,r=1/0,a=void 0,s=0;s<e.children.length;s++){var l=e.children[s],u=c(l),h=(d=t,p=l,(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u);h<r?(r=h,o=u<o?u:o,a=l):h===r&&u<o&&(o=u,a=l)}e=a||e.children[0]}var d,p;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),o=[],r=this._chooseSubtree(n,this.data,e,o);for(r.children.push(t),s(r,n);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(n,o,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var a=this._chooseSplitIndex(i,o,n),s=f(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,r(i,this.toBBox),r(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,o,r,s,l,u,h,d=1/0,p=1/0,f=e;f<=i-e;f++){var g=a(t,0,f,this.toBBox),m=a(t,f,i,this.toBBox),v=(o=g,r=m,s=void 0,l=void 0,u=void 0,h=void 0,s=Math.max(o.minX,r.minX),l=Math.max(o.minY,r.minY),u=Math.min(o.maxX,r.maxX),h=Math.min(o.maxY,r.maxY),Math.max(0,u-s)*Math.max(0,h-l)),y=c(g)+c(m);v<d?(d=v,n=f,p=y<p?y:p):v===d&&y<p&&(p=y,n=f)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,o=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var o=this.toBBox,r=a(t,0,e,o),l=a(t,i-e,i,o),u=h(r)+h(l),c=e;c<i-e;c++){var d=t.children[c];s(r,t.leaf?o(d):d),u+=h(r)}for(var p=i-e-1;p>=e;p--){var f=t.children[p];s(l,t.leaf?o(f):f),u+=h(l)}return u},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)s(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():r(t[e],this.toBBox)},n}()},function(t,e,i){
/*!
 * Chart.js v2.9.3
 * https://www.chartjs.org
 * (c) 2019 Chart.js Contributors
 * Released under the MIT License
 */
t.exports=function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},i=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[e[n]]=n);var o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var r in o)if(o.hasOwnProperty(r)){if(!("channels"in o[r]))throw new Error("missing channels property: "+r);if(!("labels"in o[r]))throw new Error("missing channel labels property: "+r);if(o[r].labels.length!==o[r].channels)throw new Error("channel and label counts mismatch: "+r);var a=o[r].channels,s=o[r].labels;delete o[r].channels,delete o[r].labels,Object.defineProperty(o[r],"channels",{value:a}),Object.defineProperty(o[r],"labels",{value:s})}o.rgb.hsl=function(t){var e,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,a=Math.min(n,o,r),s=Math.max(n,o,r),l=s-a;return s===a?e=0:n===s?e=(o-r)/l:o===s?e=2+(r-n)/l:r===s&&(e=4+(n-o)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(a+s)/2,[e,100*(s===a?0:i<=.5?l/(s+a):l/(2-s-a)),100*i]},o.rgb.hsv=function(t){var e,i,n,o,r,a=t[0]/255,s=t[1]/255,l=t[2]/255,u=Math.max(a,s,l),c=u-Math.min(a,s,l),h=function(t){return(u-t)/6/c+.5};return 0===c?o=r=0:(r=c/u,e=h(a),i=h(s),n=h(l),a===u?o=n-i:s===u?o=1/3+e-n:l===u&&(o=2/3+i-e),o<0?o+=1:o>1&&(o-=1)),[360*o,100*r,100*u]},o.rgb.hwb=function(t){var e=t[0],i=t[1],n=t[2];return[o.rgb.hsl(t)[0],1/255*Math.min(e,Math.min(i,n))*100,100*(n=1-1/255*Math.max(e,Math.max(i,n)))]},o.rgb.cmyk=function(t){var e,i=t[0]/255,n=t[1]/255,o=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-o)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-o-e)/(1-e)||0),100*e]},o.rgb.keyword=function(t){var n=i[t];if(n)return n;var o,r,a,s=1/0;for(var l in e)if(e.hasOwnProperty(l)){var u=e[l],c=(r=t,a=u,Math.pow(r[0]-a[0],2)+Math.pow(r[1]-a[1],2)+Math.pow(r[2]-a[2],2));c<s&&(s=c,o=l)}return o},o.keyword.rgb=function(t){return e[t]},o.rgb.xyz=function(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]},o.rgb.lab=function(t){var e=o.rgb.xyz(t),i=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},o.hsl.rgb=function(t){var e,i,n,o,r,a=t[0]/360,s=t[1]/100,l=t[2]/100;if(0===s)return[r=255*l,r,r];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),o=[0,0,0];for(var u=0;u<3;u++)(n=a+1/3*-(u-1))<0&&n++,n>1&&n--,r=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,o[u]=255*r;return o},o.hsl.hsv=function(t){var e=t[0],i=t[1]/100,n=t[2]/100,o=i,r=Math.max(n,.01);return i*=(n*=2)<=1?n:2-n,o*=r<=1?r:2-r,[e,100*(0===n?2*o/(r+o):2*i/(n+i)),(n+i)/2*100]},o.hsv.rgb=function(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,o=Math.floor(e)%6,r=e-Math.floor(e),a=255*n*(1-i),s=255*n*(1-i*r),l=255*n*(1-i*(1-r));switch(n*=255,o){case 0:return[n,l,a];case 1:return[s,n,a];case 2:return[a,n,l];case 3:return[a,s,n];case 4:return[l,a,n];case 5:return[n,a,s]}},o.hsv.hsl=function(t){var e,i,n,o=t[0],r=t[1]/100,a=t[2]/100,s=Math.max(a,.01);return n=(2-r)*a,i=r*s,[o,100*(i=(i/=(e=(2-r)*s)<=1?e:2-e)||0),100*(n/=2)]},o.hwb.rgb=function(t){var e,i,n,o,r,a,s,l=t[0]/360,u=t[1]/100,c=t[2]/100,h=u+c;switch(h>1&&(u/=h,c/=h),n=6*l-(e=Math.floor(6*l)),0!=(1&e)&&(n=1-n),o=u+n*((i=1-c)-u),e){default:case 6:case 0:r=i,a=o,s=u;break;case 1:r=o,a=i,s=u;break;case 2:r=u,a=i,s=o;break;case 3:r=u,a=o,s=i;break;case 4:r=o,a=u,s=i;break;case 5:r=i,a=u,s=o}return[255*r,255*a,255*s]},o.cmyk.rgb=function(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,o=t[3]/100;return[255*(1-Math.min(1,e*(1-o)+o)),255*(1-Math.min(1,i*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o))]},o.xyz.rgb=function(t){var e,i,n,o=t[0]/100,r=t[1]/100,a=t[2]/100;return i=-.9689*o+1.8758*r+.0415*a,n=.0557*o+-.204*r+1.057*a,e=(e=3.2406*o+-1.5372*r+-.4986*a)>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]},o.xyz.lab=function(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},o.lab.xyz=function(t){var e,i,n,o=t[0];e=t[1]/500+(i=(o+16)/116),n=i-t[2]/200;var r=Math.pow(i,3),a=Math.pow(e,3),s=Math.pow(n,3);return i=r>.008856?r:(i-16/116)/7.787,e=a>.008856?a:(e-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,[e*=95.047,i*=100,n*=108.883]},o.lab.lch=function(t){var e,i=t[0],n=t[1],o=t[2];return(e=360*Math.atan2(o,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+o*o),e]},o.lch.lab=function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},o.rgb.ansi16=function(t){var e=t[0],i=t[1],n=t[2],r=1 in arguments?arguments[1]:o.rgb.hsv(t)[2];if(0===(r=Math.round(r/50)))return 30;var a=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(e/255));return 2===r&&(a+=60),a},o.hsv.ansi16=function(t){return o.rgb.ansi16(o.hsv.rgb(t),t[2])},o.rgb.ansi256=function(t){var e=t[0],i=t[1],n=t[2];return e===i&&i===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(n/255*5)},o.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),[e=e/10.5*255,e,e];var i=.5*(1+~~(t>50));return[(1&e)*i*255,(e>>1&1)*i*255,(e>>2&1)*i*255]},o.ansi256.rgb=function(t){if(t>=232){var e=10*(t-232)+8;return[e,e,e]}var i;return t-=16,[Math.floor(t/36)/5*255,Math.floor((i=t%36)/6)/5*255,i%6/5*255]},o.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},o.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var i=e[0];3===e[0].length&&(i=i.split("").map((function(t){return t+t})).join(""));var n=parseInt(i,16);return[n>>16&255,n>>8&255,255&n]},o.rgb.hcg=function(t){var e,i=t[0]/255,n=t[1]/255,o=t[2]/255,r=Math.max(Math.max(i,n),o),a=Math.min(Math.min(i,n),o),s=r-a;return e=s<=0?0:r===i?(n-o)/s%6:r===n?2+(o-i)/s:4+(i-n)/s+4,e/=6,[360*(e%=1),100*s,100*(s<1?a/(1-s):0)]},o.hsl.hcg=function(t){var e=t[1]/100,i=t[2]/100,n=1,o=0;return(n=i<.5?2*e*i:2*e*(1-i))<1&&(o=(i-.5*n)/(1-n)),[t[0],100*n,100*o]},o.hsv.hcg=function(t){var e=t[1]/100,i=t[2]/100,n=e*i,o=0;return n<1&&(o=(i-n)/(1-n)),[t[0],100*n,100*o]},o.hcg.rgb=function(t){var e=t[0]/360,i=t[1]/100,n=t[2]/100;if(0===i)return[255*n,255*n,255*n];var o,r=[0,0,0],a=e%1*6,s=a%1,l=1-s;switch(Math.floor(a)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=l,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=l,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=l}return o=(1-i)*n,[255*(i*r[0]+o),255*(i*r[1]+o),255*(i*r[2]+o)]},o.hcg.hsv=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e),n=0;return i>0&&(n=e/i),[t[0],100*n,100*i]},o.hcg.hsl=function(t){var e=t[1]/100,i=t[2]/100*(1-e)+.5*e,n=0;return i>0&&i<.5?n=e/(2*i):i>=.5&&i<1&&(n=e/(2*(1-i))),[t[0],100*n,100*i]},o.hcg.hwb=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e);return[t[0],100*(i-e),100*(1-i)]},o.hwb.hcg=function(t){var e=t[1]/100,i=1-t[2]/100,n=i-e,o=0;return n<1&&(o=(i-n)/(1-n)),[t[0],100*n,100*o]},o.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},o.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},o.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},o.gray.hsl=o.gray.hsv=function(t){return[0,0,t[0]]},o.gray.hwb=function(t){return[0,100,t[0]]},o.gray.cmyk=function(t){return[0,0,0,t[0]]},o.gray.lab=function(t){return[t[0],0,0]},o.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),i=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(i.length)+i},o.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}}));function n(t){var e=function(){for(var t={},e=Object.keys(i),n=e.length,o=0;o<n;o++)t[e[o]]={distance:-1,parent:null};return t}(),n=[t];for(e[t].distance=0;n.length;)for(var o=n.pop(),r=Object.keys(i[o]),a=r.length,s=0;s<a;s++){var l=r[s],u=e[l];-1===u.distance&&(u.distance=e[o].distance+1,u.parent=o,n.unshift(l))}return e}function o(t,e){return function(i){return e(t(i))}}function r(t,e){for(var n=[e[t].parent,t],r=i[e[t].parent][t],a=e[t].parent;e[a].parent;)n.unshift(e[a].parent),r=o(i[e[a].parent][a],r),a=e[a].parent;return r.conversion=n,r}i.rgb,i.hsl,i.hsv,i.hwb,i.cmyk,i.xyz,i.lab,i.lch,i.hex,i.keyword,i.ansi16,i.ansi256,i.hcg,i.apple,i.gray;var a={};Object.keys(i).forEach((function(t){a[t]={},Object.defineProperty(a[t],"channels",{value:i[t].channels}),Object.defineProperty(a[t],"labels",{value:i[t].labels});var e=function(t){for(var e=n(t),i={},o=Object.keys(e),a=o.length,s=0;s<a;s++){var l=o[s];null!==e[l].parent&&(i[l]=r(l,e))}return i}(t);Object.keys(e).forEach((function(i){var n=e[i];a[t][i]=function(t){var e=function(e){if(null==e)return e;arguments.length>1&&(e=Array.prototype.slice.call(arguments));var i=t(e);if("object"==typeof i)for(var n=i.length,o=0;o<n;o++)i[o]=Math.round(i[o]);return i};return"conversion"in t&&(e.conversion=t.conversion),e}(n),a[t][i].raw=function(t){var e=function(e){return null==e?e:(arguments.length>1&&(e=Array.prototype.slice.call(arguments)),t(e))};return"conversion"in t&&(e.conversion=t.conversion),e}(n)}))}));var s=a,l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},u={getRgba:c,getHsla:h,getRgb:function(t){var e=c(t);return e&&e.slice(0,3)},getHsl:function(t){var e=h(t);return e&&e.slice(0,3)},getHwb:d,getAlpha:function(t){var e=c(t);return e||(e=h(t))||(e=d(t))?e[3]:void 0},hexString:function(t,e){return e=void 0!==e&&3===t.length?e:t[3],"#"+v(t[0])+v(t[1])+v(t[2])+(e>=0&&e<1?v(Math.round(255*e)):"")},rgbString:function(t,e){return e<1||t[3]&&t[3]<1?p(t,e):"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:p,percentString:function(t,e){if(e<1||t[3]&&t[3]<1)return f(t,e);var i=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),o=Math.round(t[2]/255*100);return"rgb("+i+"%, "+n+"%, "+o+"%)"},percentaString:f,hslString:function(t,e){return e<1||t[3]&&t[3]<1?g(t,e):"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:g,hwbString:function(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return y[t.slice(0,3)]}};function c(t){if(t){var e=[0,0,0],i=1,n=t.match(/^#([a-fA-F0-9]{3,4})$/i),o="";if(n){o=(n=n[1])[3];for(var r=0;r<e.length;r++)e[r]=parseInt(n[r]+n[r],16);o&&(i=Math.round(parseInt(o+o,16)/255*100)/100)}else if(n=t.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){for(o=n[2],n=n[1],r=0;r<e.length;r++)e[r]=parseInt(n.slice(2*r,2*r+2),16);o&&(i=Math.round(parseInt(o,16)/255*100)/100)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=parseInt(n[r+1]);i=parseFloat(n[4])}else if(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(r=0;r<e.length;r++)e[r]=Math.round(2.55*parseFloat(n[r+1]));i=parseFloat(n[4])}else if(n=t.match(/(\w+)/)){if("transparent"==n[1])return[0,0,0,0];if(!(e=l[n[1]]))return}for(r=0;r<e.length;r++)e[r]=m(e[r],0,255);return i=i||0==i?m(i,0,1):1,e[3]=i,e}}function h(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[m(parseInt(e[1]),0,360),m(parseFloat(e[2]),0,100),m(parseFloat(e[3]),0,100),m(isNaN(i)?1:i,0,1)]}}}function d(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[m(parseInt(e[1]),0,360),m(parseFloat(e[2]),0,100),m(parseFloat(e[3]),0,100),m(isNaN(i)?1:i,0,1)]}}}function p(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function f(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function g(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function m(t,e,i){return Math.min(Math.max(e,t),i)}function v(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}var y={};for(var b in l)y[l[b]]=b;var w=function(t){return t instanceof w?t:this instanceof w?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=u.getRgba(t))?this.setValues("rgb",e):(e=u.getHsla(t))?this.setValues("hsl",e):(e=u.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new w(t);var e};w.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return u.hexString(this.values.rgb)},rgbString:function(){return u.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return u.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return u.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return u.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return u.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return u.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return u.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,i=(e[0]+t)%360;return e[0]=i<0?360+i:i,this.setValues("hsl",e),this},mix:function(t,e){var i=t,n=void 0===e?.5:e,o=2*n-1,r=this.alpha()-i.alpha(),a=((o*r==-1?o:(o+r)/(1+o*r))+1)/2,s=1-a;return this.rgb(a*this.red()+s*i.red(),a*this.green()+s*i.green(),a*this.blue()+s*i.blue()).alpha(this.alpha()*n+i.alpha()*(1-n))},toJSON:function(){return this.rgb()},clone:function(){var t,e,i=new w,n=this.values,o=i.values;for(var r in n)n.hasOwnProperty(r)&&(t=n[r],"[object Array]"===(e={}.toString.call(t))?o[r]=t.slice(0):"[object Number]"===e?o[r]=t:console.error("unexpected color value:",t));return i}},w.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},w.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},w.prototype.getValues=function(t){for(var e=this.values,i={},n=0;n<t.length;n++)i[t.charAt(n)]=e[t][n];return 1!==e.alpha&&(i.a=e.alpha),i},w.prototype.setValues=function(t,e){var i,n,o=this.values,r=this.spaces,a=this.maxes,l=1;if(this.valid=!0,"alpha"===t)l=e;else if(e.length)o[t]=e.slice(0,t.length),l=e[t.length];else if(void 0!==e[t.charAt(0)]){for(i=0;i<t.length;i++)o[t][i]=e[t.charAt(i)];l=e.a}else if(void 0!==e[r[t][0]]){var u=r[t];for(i=0;i<t.length;i++)o[t][i]=e[u[i]];l=e.alpha}if(o.alpha=Math.max(0,Math.min(1,void 0===l?o.alpha:l)),"alpha"===t)return!1;for(i=0;i<t.length;i++)n=Math.max(0,Math.min(a[t][i],o[t][i])),o[t][i]=Math.round(n);for(var c in r)c!==t&&(o[c]=s[t][c](o[t]));return!0},w.prototype.setSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i),this)},w.prototype.setChannel=function(t,e,i){var n=this.values[t];return void 0===i?n[e]:(i===n[e]||(n[e]=i,this.setValues(t,n)),this)},"undefined"!=typeof window&&(window.Color=w);var _,x=w,C={noop:function(){},uid:(_=0,function(){return _++}),isNullOrUndef:function(t){return null==t},isArray:function(t){if(Array.isArray&&Array.isArray(t))return!0;var e=Object.prototype.toString.call(t);return"[object"===e.substr(0,7)&&"Array]"===e.substr(-6)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},isFinite:function(t){return("number"==typeof t||t instanceof Number)&&isFinite(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,i){return C.valueOrDefault(C.isArray(t)?t[e]:t,i)},callback:function(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)},each:function(t,e,i,n){var o,r,a;if(C.isArray(t))if(r=t.length,n)for(o=r-1;o>=0;o--)e.call(i,t[o],o);else for(o=0;o<r;o++)e.call(i,t[o],o);else if(C.isObject(t))for(r=(a=Object.keys(t)).length,o=0;o<r;o++)e.call(i,t[a[o]],a[o])},arrayEquals:function(t,e){var i,n,o,r;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(o=t[i],r=e[i],o instanceof Array&&r instanceof Array){if(!C.arrayEquals(o,r))return!1}else if(o!==r)return!1;return!0},clone:function(t){if(C.isArray(t))return t.map(C.clone);if(C.isObject(t)){for(var e={},i=Object.keys(t),n=i.length,o=0;o<n;++o)e[i[o]]=C.clone(t[i[o]]);return e}return t},_merger:function(t,e,i,n){var o=e[t],r=i[t];C.isObject(o)&&C.isObject(r)?C.merge(o,r,n):e[t]=C.clone(r)},_mergerIf:function(t,e,i){var n=e[t],o=i[t];C.isObject(n)&&C.isObject(o)?C.mergeIf(n,o):e.hasOwnProperty(t)||(e[t]=C.clone(o))},merge:function(t,e,i){var n,o,r,a,s,l=C.isArray(e)?e:[e],u=l.length;if(!C.isObject(t))return t;for(n=(i=i||{}).merger||C._merger,o=0;o<u;++o)if(e=l[o],C.isObject(e))for(s=0,a=(r=Object.keys(e)).length;s<a;++s)n(r[s],t,e,i);return t},mergeIf:function(t,e){return C.merge(t,e,{merger:C._mergerIf})},extend:Object.assign||function(t){return C.merge(t,[].slice.call(arguments,1),{merger:function(t,e,i){e[t]=i[t]}})},inherits:function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=C.inherits,t&&C.extend(i.prototype,t),i.__super__=e.prototype,i},_deprecated:function(t,e,i,n){void 0!==e&&console.warn(t+': "'+i+'" is deprecated. Please use "'+n+'" instead')}},E=C;C.callCallback=C.callback,C.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)},C.getValueOrDefault=C.valueOrDefault,C.getValueAtIndexOrDefault=C.valueAtIndexOrDefault;var k={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.45),n<1?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},easeInBack:function(t){var e=1.70158;return t*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-k.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*k.easeInBounce(2*t):.5*k.easeOutBounce(2*t-1)+.5}},S={effects:k};E.easingEffects=k;var M=Math.PI,T=M/180,R=2*M,P=M/2,D=M/4,L=2*M/3,F={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,i,n,o,r){if(r){var a=Math.min(r,o/2,n/2),s=e+a,l=i+a,u=e+n-a,c=i+o-a;t.moveTo(e,l),s<u&&l<c?(t.arc(s,l,a,-M,-P),t.arc(u,l,a,-P,0),t.arc(u,c,a,0,P),t.arc(s,c,a,P,M)):s<u?(t.moveTo(s,i),t.arc(u,l,a,-P,P),t.arc(s,l,a,P,M+P)):l<c?(t.arc(s,l,a,-M,0),t.arc(s,c,a,0,M)):t.arc(s,l,a,-M,M),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,o)},drawPoint:function(t,e,i,n,o,r){var a,s,l,u,c,h=(r||0)*T;if(e&&"object"==typeof e&&("[object HTMLImageElement]"===(a=e.toString())||"[object HTMLCanvasElement]"===a))return t.save(),t.translate(n,o),t.rotate(h),t.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),void t.restore();if(!(isNaN(i)||i<=0)){switch(t.beginPath(),e){default:t.arc(n,o,i,0,R),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(h)*i,o-Math.cos(h)*i),h+=L,t.lineTo(n+Math.sin(h)*i,o-Math.cos(h)*i),h+=L,t.lineTo(n+Math.sin(h)*i,o-Math.cos(h)*i),t.closePath();break;case"rectRounded":u=i-(c=.516*i),s=Math.cos(h+D)*u,l=Math.sin(h+D)*u,t.arc(n-s,o-l,c,h-M,h-P),t.arc(n+l,o-s,c,h-P,h),t.arc(n+s,o+l,c,h,h+P),t.arc(n-l,o+s,c,h+P,h+M),t.closePath();break;case"rect":if(!r){u=Math.SQRT1_2*i,t.rect(n-u,o-u,2*u,2*u);break}h+=D;case"rectRot":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,o-l),t.lineTo(n+l,o-s),t.lineTo(n+s,o+l),t.lineTo(n-l,o+s),t.closePath();break;case"crossRot":h+=D;case"cross":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,o-l),t.lineTo(n+s,o+l),t.moveTo(n+l,o-s),t.lineTo(n-l,o+s);break;case"star":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,o-l),t.lineTo(n+s,o+l),t.moveTo(n+l,o-s),t.lineTo(n-l,o+s),h+=D,s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,o-l),t.lineTo(n+s,o+l),t.moveTo(n+l,o-s),t.lineTo(n-l,o+s);break;case"line":s=Math.cos(h)*i,l=Math.sin(h)*i,t.moveTo(n-s,o-l),t.lineTo(n+s,o+l);break;case"dash":t.moveTo(n,o),t.lineTo(n+Math.cos(h)*i,o+Math.sin(h)*i)}t.fill(),t.stroke()}},_isPointInArea:function(t,e){return t.x>e.left-1e-6&&t.x<e.right+1e-6&&t.y>e.top-1e-6&&t.y<e.bottom+1e-6},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,i,n){var o=i.steppedLine;if(o){if("middle"===o){var r=(e.x+i.x)/2;t.lineTo(r,n?i.y:e.y),t.lineTo(r,n?e.y:i.y)}else"after"===o&&!n||"after"!==o&&n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}else i.tension?t.bezierCurveTo(n?e.controlPointPreviousX:e.controlPointNextX,n?e.controlPointPreviousY:e.controlPointNextY,n?i.controlPointNextX:i.controlPointPreviousX,n?i.controlPointNextY:i.controlPointPreviousY,i.x,i.y):t.lineTo(i.x,i.y)}},O=F;E.clear=F.clear,E.drawRoundedRectangle=function(t){t.beginPath(),F.roundedRect.apply(F,arguments)};var A={_set:function(t,e){return E.merge(this[t]||(this[t]={}),e)}};A._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var I=A,j=E.valueOrDefault,z={toLineHeight:function(t,e){var i=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,i,n,o;return E.isObject(t)?(e=+t.top||0,i=+t.right||0,n=+t.bottom||0,o=+t.left||0):e=i=n=o=+t||0,{top:e,right:i,bottom:n,left:o,height:e+n,width:o+i}},_parseFont:function(t){var e=I.global,i=j(t.fontSize,e.defaultFontSize),n={family:j(t.fontFamily,e.defaultFontFamily),lineHeight:E.options.toLineHeight(j(t.lineHeight,e.defaultLineHeight),i),size:i,style:j(t.fontStyle,e.defaultFontStyle),weight:null,string:""};return n.string=function(t){return!t||E.isNullOrUndef(t.size)||E.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(n),n},resolve:function(t,e,i,n){var o,r,a,s=!0;for(o=0,r=t.length;o<r;++o)if(void 0!==(a=t[o])&&(void 0!==e&&"function"==typeof a&&(a=a(e),s=!1),void 0!==i&&E.isArray(a)&&(a=a[i],s=!1),void 0!==a))return n&&!s&&(n.cacheable=!1),a}},N={_factorize:function(t){var e,i=[],n=Math.sqrt(t);for(e=1;e<n;e++)t%e==0&&(i.push(e),i.push(t/e));return n===(0|n)&&i.push(n),i.sort((function(t,e){return t-e})).pop(),i},log10:Math.log10||function(t){var e=Math.log(t)*Math.LOG10E,i=Math.round(e);return t===Math.pow(10,i)?i:e}},H=N;E.log10=N.log10;var B=E,G=S,V=O,W=z,q=H,$={getRtlAdapter:function(t,e,i){return t?function(t,e){return{x:function(i){return t+t+e-i},setWidth:function(t){e=t},textAlign:function(t){return"center"===t?t:"right"===t?"left":"right"},xPlus:function(t,e){return t-e},leftForLtr:function(t,e){return t-e}}}(e,i):{x:function(t){return t},setWidth:function(t){},textAlign:function(t){return t},xPlus:function(t,e){return t+e},leftForLtr:function(t,e){return t}}},overrideTextDirection:function(t,e){var i,n;"ltr"!==e&&"rtl"!==e||(n=[(i=t.canvas.style).getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=n)},restoreTextDirection:function(t){var e=t.prevTextDirection;void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}};B.easing=G,B.canvas=V,B.options=W,B.math=q,B.rtl=$;var Y=function(t){B.extend(this,t),this.initialize.apply(this,arguments)};B.extend(Y.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=B.extend({},t._model)),t._start={},t},transition:function(t){var e=this,i=e._model,n=e._start,o=e._view;return i&&1!==t?(o||(o=e._view={}),n||(n=e._start={}),function(t,e,i,n){var o,r,a,s,l,u,c,h,d,p=Object.keys(i);for(o=0,r=p.length;o<r;++o)if(u=i[a=p[o]],e.hasOwnProperty(a)||(e[a]=u),(s=e[a])!==u&&"_"!==a[0]){if(t.hasOwnProperty(a)||(t[a]=s),(c=typeof u)==typeof(l=t[a]))if("string"===c){if((h=x(l)).valid&&(d=x(u)).valid){e[a]=d.mix(h,n).rgbString();continue}}else if(B.isFinite(l)&&B.isFinite(u)){e[a]=l+(u-l)*n;continue}e[a]=u}}(n,o,i,t),e):(e._view=B.extend({},i),e._start=null,e)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return B.isNumber(this._model.x)&&B.isNumber(this._model.y)}}),Y.extend=B.inherits;var X=Y,U=X.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),K=U;Object.defineProperty(U.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(U.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}}),I._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:B.noop,onComplete:B.noop}});var Z={animations:[],request:null,addAnimation:function(t,e,i,n){var o,r,a=this.animations;for(e.chart=t,e.startTime=Date.now(),e.duration=i,n||(t.animating=!0),o=0,r=a.length;o<r;++o)if(a[o].chart===t)return void(a[o]=e);a.push(e),1===a.length&&this.requestAnimationFrame()},cancelAnimation:function(t){var e=B.findIndex(this.animations,(function(e){return e.chart===t}));-1!==e&&(this.animations.splice(e,1),t.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=B.requestAnimFrame.call(window,(function(){t.request=null,t.startDigest()})))},startDigest:function(){this.advance(),this.animations.length>0&&this.requestAnimationFrame()},advance:function(){for(var t,e,i,n,o=this.animations,r=0;r<o.length;)e=(t=o[r]).chart,i=t.numSteps,n=Math.floor((Date.now()-t.startTime)/t.duration*i)+1,t.currentStep=Math.min(n,i),B.callback(t.render,[e,t],e),B.callback(t.onAnimationProgress,[t],e),t.currentStep>=i?(B.callback(t.onAnimationComplete,[t],e),e.animating=!1,o.splice(r,1)):++r}},J=B.options.resolve,Q=["push","pop","shift","splice","unshift"];function tt(t,e){var i=t._chartjs;if(i){var n=i.listeners,o=n.indexOf(e);-1!==o&&n.splice(o,1),n.length>0||(Q.forEach((function(e){delete t[e]})),delete t._chartjs)}}var et=function(t,e){this.initialize(t,e)};B.extend(et.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(t,e){var i=this;i.chart=t,i.index=e,i.linkScales(),i.addElements(),i._type=i.getMeta().type},updateIndex:function(t){this.index=t},linkScales:function(){var t=this.getMeta(),e=this.chart,i=e.scales,n=this.getDataset(),o=e.options.scales;null!==t.xAxisID&&t.xAxisID in i&&!n.xAxisID||(t.xAxisID=n.xAxisID||o.xAxes[0].id),null!==t.yAxisID&&t.yAxisID in i&&!n.yAxisID||(t.yAxisID=n.yAxisID||o.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&tt(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,i=this.getMeta(),n=this.getDataset().data||[],o=i.data;for(t=0,e=n.length;t<e;++t)o[t]=o[t]||this.createMetaData(t);i.dataset=i.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var t,e,i=this,n=i.getDataset(),o=n.data||(n.data=[]);i._data!==o&&(i._data&&tt(i._data,i),o&&Object.isExtensible(o)&&(e=i,(t=o)._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Q.forEach((function(e){var i="onData"+e.charAt(0).toUpperCase()+e.slice(1),n=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),o=n.apply(this,e);return B.each(t._chartjs.listeners,(function(t){"function"==typeof t[i]&&t[i].apply(t,e)})),o}})})))),i._data=o),i.resyncElements()},_configure:function(){this._config=B.merge({},[this.chart.options.datasets[this._type],this.getDataset()],{merger:function(t,e,i){"_meta"!==t&&"data"!==t&&B._merger(t,e,i)}})},_update:function(t){this._configure(),this._cachedDataOpts=null,this.update(t)},update:B.noop,transition:function(t){for(var e=this.getMeta(),i=e.data||[],n=i.length,o=0;o<n;++o)i[o].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],i=e.length,n=0;for(t.dataset&&t.dataset.draw();n<i;++n)e[n].draw()},getStyle:function(t){var e,i=this.getMeta(),n=i.dataset;return this._configure(),n&&void 0===t?e=this._resolveDatasetElementOptions(n||{}):(t=t||0,e=this._resolveDataElementOptions(i.data[t]||{},t)),!1!==e.fill&&null!==e.fill||(e.backgroundColor=e.borderColor),e},_resolveDatasetElementOptions:function(t,e){var i,n,o,r,a=this,s=a.chart,l=a._config,u=t.custom||{},c=s.options.elements[a.datasetElementType.prototype._type]||{},h=a._datasetElementOptions,d={},p={chart:s,dataset:a.getDataset(),datasetIndex:a.index,hover:e};for(i=0,n=h.length;i<n;++i)o=h[i],r=e?"hover"+o.charAt(0).toUpperCase()+o.slice(1):o,d[o]=J([u[r],l[r],c[r]],p);return d},_resolveDataElementOptions:function(t,e){var i=this,n=t&&t.custom,o=i._cachedDataOpts;if(o&&!n)return o;var r,a,s,l,u=i.chart,c=i._config,h=u.options.elements[i.dataElementType.prototype._type]||{},d=i._dataElementOptions,p={},f={chart:u,dataIndex:e,dataset:i.getDataset(),datasetIndex:i.index},g={cacheable:!n};if(n=n||{},B.isArray(d))for(a=0,s=d.length;a<s;++a)p[l=d[a]]=J([n[l],c[l],h[l]],f,e,g);else for(a=0,s=(r=Object.keys(d)).length;a<s;++a)p[l=r[a]]=J([n[l],c[d[l]],c[l],h[l]],f,e,g);return g.cacheable&&(i._cachedDataOpts=Object.freeze(p)),p},removeHoverStyle:function(t){B.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},o=t._model,r=B.getHoverColor;t.$previousStyle={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderWidth:o.borderWidth},o.backgroundColor=J([n.hoverBackgroundColor,e.hoverBackgroundColor,r(o.backgroundColor)],void 0,i),o.borderColor=J([n.hoverBorderColor,e.hoverBorderColor,r(o.borderColor)],void 0,i),o.borderWidth=J([n.hoverBorderWidth,e.hoverBorderWidth,o.borderWidth],void 0,i)},_removeDatasetHoverStyle:function(){var t=this.getMeta().dataset;t&&this.removeHoverStyle(t)},_setDatasetHoverStyle:function(){var t,e,i,n,o,r,a=this.getMeta().dataset,s={};if(a){for(r=a._model,o=this._resolveDatasetElementOptions(a,!0),t=0,e=(n=Object.keys(o)).length;t<e;++t)s[i=n[t]]=r[i],r[i]=o[i];a.$previousStyle=s}},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,i=t.data.length,n=e.length;n<i?t.data.splice(n,i-n):n>i&&this.insertElements(i,n-i)},insertElements:function(t,e){for(var i=0;i<e;++i)this.addElementAndReset(t+i)},onDataPush:function(){var t=arguments.length;this.insertElements(this.getDataset().data.length-t,t)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),et.extend=B.inherits;var it=et,nt=2*Math.PI;function ot(t,e){var i=e.startAngle,n=e.endAngle,o=e.pixelMargin,r=o/e.outerRadius,a=e.x,s=e.y;t.beginPath(),t.arc(a,s,e.outerRadius,i-r,n+r),e.innerRadius>o?(r=o/e.innerRadius,t.arc(a,s,e.innerRadius-o,n+r,i-r,!0)):t.arc(a,s,o,n+Math.PI/2,i-Math.PI/2),t.closePath(),t.clip()}function rt(t,e,i){var n="inner"===e.borderAlign;n?(t.lineWidth=2*e.borderWidth,t.lineJoin="round"):(t.lineWidth=e.borderWidth,t.lineJoin="bevel"),i.fullCircles&&function(t,e,i,n){var o,r=i.endAngle;for(n&&(i.endAngle=i.startAngle+nt,ot(t,i),i.endAngle=r,i.endAngle===i.startAngle&&i.fullCircles&&(i.endAngle+=nt,i.fullCircles--)),t.beginPath(),t.arc(i.x,i.y,i.innerRadius,i.startAngle+nt,i.startAngle,!0),o=0;o<i.fullCircles;++o)t.stroke();for(t.beginPath(),t.arc(i.x,i.y,e.outerRadius,i.startAngle,i.startAngle+nt),o=0;o<i.fullCircles;++o)t.stroke()}(t,e,i,n),n&&ot(t,i),t.beginPath(),t.arc(i.x,i.y,e.outerRadius,i.startAngle,i.endAngle),t.arc(i.x,i.y,i.innerRadius,i.endAngle,i.startAngle,!0),t.closePath(),t.stroke()}I._set("global",{elements:{arc:{backgroundColor:I.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var at=X.extend({_type:"arc",inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var i=this._view;if(i){for(var n=B.getAngleFromPoint(i,{x:t,y:e}),o=n.angle,r=n.distance,a=i.startAngle,s=i.endAngle;s<a;)s+=nt;for(;o>s;)o-=nt;for(;o<a;)o+=nt;var l=o>=a&&o<=s,u=r>=i.innerRadius&&r<=i.outerRadius;return l&&u}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,i=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,i=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},draw:function(){var t,e=this._chart.ctx,i=this._view,n="inner"===i.borderAlign?.33:0,o={x:i.x,y:i.y,innerRadius:i.innerRadius,outerRadius:Math.max(i.outerRadius-n,0),pixelMargin:n,startAngle:i.startAngle,endAngle:i.endAngle,fullCircles:Math.floor(i.circumference/nt)};if(e.save(),e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,o.fullCircles){for(o.endAngle=o.startAngle+nt,e.beginPath(),e.arc(o.x,o.y,o.outerRadius,o.startAngle,o.endAngle),e.arc(o.x,o.y,o.innerRadius,o.endAngle,o.startAngle,!0),e.closePath(),t=0;t<o.fullCircles;++t)e.fill();o.endAngle=o.startAngle+i.circumference%nt}e.beginPath(),e.arc(o.x,o.y,o.outerRadius,o.startAngle,o.endAngle),e.arc(o.x,o.y,o.innerRadius,o.endAngle,o.startAngle,!0),e.closePath(),e.fill(),i.borderWidth&&rt(e,i,o),e.restore()}}),st=B.valueOrDefault,lt=I.global.defaultColor;I._set("global",{elements:{line:{tension:.4,backgroundColor:lt,borderWidth:3,borderColor:lt,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var ut=X.extend({_type:"line",draw:function(){var t,e,i,n=this,o=n._view,r=n._chart.ctx,a=o.spanGaps,s=n._children.slice(),l=I.global,u=l.elements.line,c=-1,h=n._loop;if(s.length){if(n._loop){for(t=0;t<s.length;++t)if(e=B.previousItem(s,t),!s[t]._view.skip&&e._view.skip){s=s.slice(t).concat(s.slice(0,t)),h=a;break}h&&s.push(s[0])}for(r.save(),r.lineCap=o.borderCapStyle||u.borderCapStyle,r.setLineDash&&r.setLineDash(o.borderDash||u.borderDash),r.lineDashOffset=st(o.borderDashOffset,u.borderDashOffset),r.lineJoin=o.borderJoinStyle||u.borderJoinStyle,r.lineWidth=st(o.borderWidth,u.borderWidth),r.strokeStyle=o.borderColor||l.defaultColor,r.beginPath(),(i=s[0]._view).skip||(r.moveTo(i.x,i.y),c=0),t=1;t<s.length;++t)i=s[t]._view,e=-1===c?B.previousItem(s,t):s[c],i.skip||(c!==t-1&&!a||-1===c?r.moveTo(i.x,i.y):B.canvas.lineTo(r,e._view,i),c=t);h&&r.closePath(),r.stroke(),r.restore()}}}),ct=B.valueOrDefault,ht=I.global.defaultColor;function dt(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}I._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:ht,borderColor:ht,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var pt=X.extend({_type:"point",inRange:function(t,e){var i=this._view;return!!i&&Math.pow(t-i.x,2)+Math.pow(e-i.y,2)<Math.pow(i.hitRadius+i.radius,2)},inLabelRange:dt,inXRange:dt,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,i=this._chart.ctx,n=e.pointStyle,o=e.rotation,r=e.radius,a=e.x,s=e.y,l=I.global,u=l.defaultColor;e.skip||(void 0===t||B.canvas._isPointInArea(e,t))&&(i.strokeStyle=e.borderColor||u,i.lineWidth=ct(e.borderWidth,l.elements.point.borderWidth),i.fillStyle=e.backgroundColor||u,B.canvas.drawPoint(i,n,r,a,s,o))}}),ft=I.global.defaultColor;function gt(t){return t&&void 0!==t.width}function mt(t){var e,i,n,o,r;return gt(t)?(r=t.width/2,e=t.x-r,i=t.x+r,n=Math.min(t.y,t.base),o=Math.max(t.y,t.base)):(r=t.height/2,e=Math.min(t.x,t.base),i=Math.max(t.x,t.base),n=t.y-r,o=t.y+r),{left:e,top:n,right:i,bottom:o}}function vt(t,e,i){return t===e?i:t===i?e:t}function yt(t,e,i){var n,o,r,a,s=t.borderWidth,l=function(t){var e=t.borderSkipped,i={};return e?(t.horizontal?t.base>t.x&&(e=vt(e,"left","right")):t.base<t.y&&(e=vt(e,"bottom","top")),i[e]=!0,i):i}(t);return B.isObject(s)?(n=+s.top||0,o=+s.right||0,r=+s.bottom||0,a=+s.left||0):n=o=r=a=+s||0,{t:l.top||n<0?0:n>i?i:n,r:l.right||o<0?0:o>e?e:o,b:l.bottom||r<0?0:r>i?i:r,l:l.left||a<0?0:a>e?e:a}}function bt(t,e,i){var n=null===e,o=null===i,r=!(!t||n&&o)&&mt(t);return r&&(n||e>=r.left&&e<=r.right)&&(o||i>=r.top&&i<=r.bottom)}I._set("global",{elements:{rectangle:{backgroundColor:ft,borderColor:ft,borderSkipped:"bottom",borderWidth:0}}});var wt=X.extend({_type:"rectangle",draw:function(){var t=this._chart.ctx,e=this._view,i=function(t){var e=mt(t),i=e.right-e.left,n=e.bottom-e.top,o=yt(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n},inner:{x:e.left+o.l,y:e.top+o.t,w:i-o.l-o.r,h:n-o.t-o.b}}}(e),n=i.outer,o=i.inner;t.fillStyle=e.backgroundColor,t.fillRect(n.x,n.y,n.w,n.h),n.w===o.w&&n.h===o.h||(t.save(),t.beginPath(),t.rect(n.x,n.y,n.w,n.h),t.clip(),t.fillStyle=e.borderColor,t.rect(o.x,o.y,o.w,o.h),t.fill("evenodd"),t.restore())},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){return bt(this._view,t,e)},inLabelRange:function(t,e){var i=this._view;return gt(i)?bt(i,t,null):bt(i,null,e)},inXRange:function(t){return bt(this._view,t,null)},inYRange:function(t){return bt(this._view,null,t)},getCenterPoint:function(){var t,e,i=this._view;return gt(i)?(t=i.x,e=(i.y+i.base)/2):(t=(i.x+i.base)/2,e=i.y),{x:t,y:e}},getArea:function(){var t=this._view;return gt(t)?t.width*Math.abs(t.y-t.base):t.height*Math.abs(t.x-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}}),_t={},xt=at,Ct=ut,Et=pt,kt=wt;_t.Arc=xt,_t.Line=Ct,_t.Point=Et,_t.Rectangle=kt;var St=B._deprecated,Mt=B.valueOrDefault;function Tt(t,e,i){var n,o,r=i.barThickness,a=e.stackCount,s=e.pixels[t],l=B.isNullOrUndef(r)?function(t,e){var i,n,o,r,a=t._length;for(o=1,r=e.length;o<r;++o)a=Math.min(a,Math.abs(e[o]-e[o-1]));for(o=0,r=t.getTicks().length;o<r;++o)n=t.getPixelForTick(o),a=o>0?Math.min(a,Math.abs(n-i)):a,i=n;return a}(e.scale,e.pixels):-1;return B.isNullOrUndef(r)?(n=l*i.categoryPercentage,o=i.barPercentage):(n=r*a,o=1),{chunk:n/a,ratio:o,start:s-n/2}}I._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),I._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var Rt=it.extend({dataElementType:_t.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var t,e,i=this;it.prototype.initialize.apply(i,arguments),(t=i.getMeta()).stack=i.getDataset().stack,t.bar=!0,e=i._getIndexScale().options,St("bar chart",e.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),St("bar chart",e.barThickness,"scales.[x/y]Axes.barThickness","dataset.barThickness"),St("bar chart",e.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),St("bar chart",i._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),St("bar chart",e.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(t){var e,i,n=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,i=n.length;e<i;++e)this.updateElement(n[e],e,t)},updateElement:function(t,e,i){var n=this,o=n.getMeta(),r=n.getDataset(),a=n._resolveDataElementOptions(t,e);t._xScale=n.getScaleForId(o.xAxisID),t._yScale=n.getScaleForId(o.yAxisID),t._datasetIndex=n.index,t._index=e,t._model={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderSkipped:a.borderSkipped,borderWidth:a.borderWidth,datasetLabel:r.label,label:n.chart.data.labels[e]},B.isArray(r.data[e])&&(t._model.borderSkipped=null),n._updateElementGeometry(t,e,i,a),t.pivot()},_updateElementGeometry:function(t,e,i,n){var o=this,r=t._model,a=o._getValueScale(),s=a.getBasePixel(),l=a.isHorizontal(),u=o._ruler||o.getRuler(),c=o.calculateBarValuePixels(o.index,e,n),h=o.calculateBarIndexPixels(o.index,e,u,n);r.horizontal=l,r.base=i?s:c.base,r.x=l?i?s:c.head:h.center,r.y=l?h.center:i?s:c.head,r.height=l?h.size:void 0,r.width=l?void 0:h.size},_getStacks:function(t){var e,i,n=this._getIndexScale(),o=n._getMatchingVisibleMetas(this._type),r=n.options.stacked,a=o.length,s=[];for(e=0;e<a&&(i=o[e],(!1===r||-1===s.indexOf(i.stack)||void 0===r&&void 0===i.stack)&&s.push(i.stack),i.index!==t);++e);return s},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var i=this._getStacks(t),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n},getRuler:function(){var t,e,i=this._getIndexScale(),n=[];for(t=0,e=this.getMeta().data.length;t<e;++t)n.push(i.getPixelForValue(null,t,this.index));return{pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this.getStackCount(),scale:i}},calculateBarValuePixels:function(t,e,i){var n,o,r,a,s,l,u,c=this.chart,h=this._getValueScale(),d=h.isHorizontal(),p=c.data.datasets,f=h._getMatchingVisibleMetas(this._type),g=h._parseValue(p[t].data[e]),m=i.minBarLength,v=h.options.stacked,y=this.getMeta().stack,b=void 0===g.start?0:g.max>=0&&g.min>=0?g.min:g.max,w=void 0===g.start?g.end:g.max>=0&&g.min>=0?g.max-g.min:g.min-g.max,_=f.length;if(v||void 0===v&&void 0!==y)for(n=0;n<_&&(o=f[n]).index!==t;++n)o.stack===y&&(r=void 0===(u=h._parseValue(p[o.index].data[e])).start?u.end:u.min>=0&&u.max>=0?u.max:u.min,(g.min<0&&r<0||g.max>=0&&r>0)&&(b+=r));return a=h.getPixelForValue(b),l=(s=h.getPixelForValue(b+w))-a,void 0!==m&&Math.abs(l)<m&&(l=m,s=w>=0&&!d||w<0&&d?a-m:a+m),{size:l,base:a,head:s,center:s+l/2}},calculateBarIndexPixels:function(t,e,i,n){var o="flex"===n.barThickness?function(t,e,i){var n,o=e.pixels,r=o[t],a=t>0?o[t-1]:null,s=t<o.length-1?o[t+1]:null,l=i.categoryPercentage;return null===a&&(a=r-(null===s?e.end-e.start:s-r)),null===s&&(s=r+r-a),n=r-(r-Math.min(a,s))/2*l,{chunk:Math.abs(s-a)/2*l/e.stackCount,ratio:i.barPercentage,start:n}}(e,i,n):Tt(e,i,n),r=this.getStackIndex(t,this.getMeta().stack),a=o.start+o.chunk*r+o.chunk/2,s=Math.min(Mt(n.maxBarThickness,1/0),o.chunk*o.ratio);return{base:a-s/2,head:a+s/2,center:a,size:s}},draw:function(){var t=this.chart,e=this._getValueScale(),i=this.getMeta().data,n=this.getDataset(),o=i.length,r=0;for(B.canvas.clipArea(t.ctx,t.chartArea);r<o;++r){var a=e._parseValue(n.data[r]);isNaN(a.min)||isNaN(a.max)||i[r].draw()}B.canvas.unclipArea(t.ctx)},_resolveDataElementOptions:function(){var t=this,e=B.extend({},it.prototype._resolveDataElementOptions.apply(t,arguments)),i=t._getIndexScale().options,n=t._getValueScale().options;return e.barPercentage=Mt(i.barPercentage,e.barPercentage),e.barThickness=Mt(i.barThickness,e.barThickness),e.categoryPercentage=Mt(i.categoryPercentage,e.categoryPercentage),e.maxBarThickness=Mt(i.maxBarThickness,e.maxBarThickness),e.minBarLength=Mt(n.minBarLength,e.minBarLength),e}}),Pt=B.valueOrDefault,Dt=B.options.resolve;I._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.datasets[t.datasetIndex].label||"",n=e.datasets[t.datasetIndex].data[t.index];return i+": ("+t.xLabel+", "+t.yLabel+", "+n.r+")"}}}});var Lt=it.extend({dataElementType:_t.Point,_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(t){var e=this,i=e.getMeta().data;B.each(i,(function(i,n){e.updateElement(i,n,t)}))},updateElement:function(t,e,i){var n=this,o=n.getMeta(),r=t.custom||{},a=n.getScaleForId(o.xAxisID),s=n.getScaleForId(o.yAxisID),l=n._resolveDataElementOptions(t,e),u=n.getDataset().data[e],c=n.index,h=i?a.getPixelForDecimal(.5):a.getPixelForValue("object"==typeof u?u:NaN,e,c),d=i?s.getBasePixel():s.getPixelForValue(u,e,c);t._xScale=a,t._yScale=s,t._options=l,t._datasetIndex=c,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:i?0:l.radius,skip:r.skip||isNaN(h)||isNaN(d),x:h,y:d},t.pivot()},setHoverStyle:function(t){var e=t._model,i=t._options,n=B.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Pt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Pt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Pt(i.hoverBorderWidth,i.borderWidth),e.radius=i.radius+i.hoverRadius},_resolveDataElementOptions:function(t,e){var i=this,n=i.chart,o=i.getDataset(),r=t.custom||{},a=o.data[e]||{},s=it.prototype._resolveDataElementOptions.apply(i,arguments),l={chart:n,dataIndex:e,dataset:o,datasetIndex:i.index};return i._cachedDataOpts===s&&(s=B.extend({},s)),s.radius=Dt([r.radius,a.r,i._config.radius,n.options.elements.point.radius],l,e),s}}),Ft=B.valueOrDefault,Ot=Math.PI,At=2*Ot,It=Ot/2;I._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e,i,n,o=document.createElement("ul"),r=t.data,a=r.datasets,s=r.labels;if(o.setAttribute("class",t.id+"-legend"),a.length)for(e=0,i=a[0].data.length;e<i;++e)(n=o.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[e],s[e]&&n.appendChild(document.createTextNode(s[e]));return o.outerHTML},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map((function(i,n){var o=t.getDatasetMeta(0),r=o.controller.getStyle(n);return{text:i,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(e.datasets[0].data[n])||o.data[n].hidden,index:n}})):[]}},onClick:function(t,e){var i,n,o,r=e.index,a=this.chart;for(i=0,n=(a.data.datasets||[]).length;i<n;++i)(o=a.getDatasetMeta(i)).data[r]&&(o.data[r].hidden=!o.data[r].hidden);a.update()}},cutoutPercentage:50,rotation:-It,circumference:At,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.labels[t.index],n=": "+e.datasets[t.datasetIndex].data[t.index];return B.isArray(i)?(i=i.slice())[0]+=n:i+=n,i}}}});var jt=it.extend({dataElementType:_t.Arc,linkScales:B.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&++e;return e},update:function(t){var e,i,n,o,r=this,a=r.chart,s=a.chartArea,l=a.options,u=1,c=1,h=0,d=0,p=r.getMeta(),f=p.data,g=l.cutoutPercentage/100||0,m=l.circumference,v=r._getRingWeight(r.index);if(m<At){var y=l.rotation%At,b=(y+=y>=Ot?-At:y<-Ot?At:0)+m,w=Math.cos(y),_=Math.sin(y),x=Math.cos(b),C=Math.sin(b),E=y<=0&&b>=0||b>=At,k=y<=It&&b>=It||b>=At+It,S=y<=-It&&b>=-It||b>=Ot+It,M=y===-Ot||b>=Ot?-1:Math.min(w,w*g,x,x*g),T=S?-1:Math.min(_,_*g,C,C*g),R=E?1:Math.max(w,w*g,x,x*g),P=k?1:Math.max(_,_*g,C,C*g);u=(R-M)/2,c=(P-T)/2,h=-(R+M)/2,d=-(P+T)/2}for(n=0,o=f.length;n<o;++n)f[n]._options=r._resolveDataElementOptions(f[n],n);for(a.borderWidth=r.getMaxBorderWidth(),e=(s.right-s.left-a.borderWidth)/u,i=(s.bottom-s.top-a.borderWidth)/c,a.outerRadius=Math.max(Math.min(e,i)/2,0),a.innerRadius=Math.max(a.outerRadius*g,0),a.radiusLength=(a.outerRadius-a.innerRadius)/(r._getVisibleDatasetWeightTotal()||1),a.offsetX=h*a.outerRadius,a.offsetY=d*a.outerRadius,p.total=r.calculateTotal(),r.outerRadius=a.outerRadius-a.radiusLength*r._getRingWeightOffset(r.index),r.innerRadius=Math.max(r.outerRadius-a.radiusLength*v,0),n=0,o=f.length;n<o;++n)r.updateElement(f[n],n,t)},updateElement:function(t,e,i){var n=this,o=n.chart,r=o.chartArea,a=o.options,s=a.animation,l=(r.left+r.right)/2,u=(r.top+r.bottom)/2,c=a.rotation,h=a.rotation,d=n.getDataset(),p=i&&s.animateRotate||t.hidden?0:n.calculateCircumference(d.data[e])*(a.circumference/At),f=i&&s.animateScale?0:n.innerRadius,g=i&&s.animateScale?0:n.outerRadius,m=t._options||{};B.extend(t,{_datasetIndex:n.index,_index:e,_model:{backgroundColor:m.backgroundColor,borderColor:m.borderColor,borderWidth:m.borderWidth,borderAlign:m.borderAlign,x:l+o.offsetX,y:u+o.offsetY,startAngle:c,endAngle:h,circumference:p,outerRadius:g,innerRadius:f,label:B.valueAtIndexOrDefault(d.label,e,o.data.labels[e])}});var v=t._model;i&&s.animateRotate||(v.startAngle=0===e?a.rotation:n.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var t,e=this.getDataset(),i=this.getMeta(),n=0;return B.each(i.data,(function(i,o){t=e.data[o],isNaN(t)||i.hidden||(n+=Math.abs(t))})),n},calculateCircumference:function(t){var e=this.getMeta().total;return e>0&&!isNaN(t)?At*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){var e,i,n,o,r,a,s,l,u=0,c=this.chart;if(!t)for(e=0,i=c.data.datasets.length;e<i;++e)if(c.isDatasetVisible(e)){t=(n=c.getDatasetMeta(e)).data,e!==this.index&&(r=n.controller);break}if(!t)return 0;for(e=0,i=t.length;e<i;++e)o=t[e],r?(r._configure(),a=r._resolveDataElementOptions(o,e)):a=o._options,"inner"!==a.borderAlign&&(s=a.borderWidth,u=(l=a.hoverBorderWidth)>(u=s>u?s:u)?l:u);return u},setHoverStyle:function(t){var e=t._model,i=t._options,n=B.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=Ft(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Ft(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Ft(i.hoverBorderWidth,i.borderWidth)},_getRingWeightOffset:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e},_getRingWeight:function(t){return Math.max(Ft(this.chart.data.datasets[t].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});I._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),I._set("global",{datasets:{horizontalBar:{categoryPercentage:.8,barPercentage:.9}}});var zt=Rt.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Nt=B.valueOrDefault,Ht=B.options.resolve,Bt=B.canvas._isPointInArea;function Gt(t,e){var i=t&&t.options.ticks||{},n=i.reverse,o=void 0===i.min?e:0,r=void 0===i.max?e:0;return{start:n?r:o,end:n?o:r}}function Vt(t,e,i){var n=i/2,o=Gt(t,n),r=Gt(e,n);return{top:r.end,right:o.end,bottom:r.start,left:o.start}}function Wt(t){var e,i,n,o;return B.isObject(t)?(e=t.top,i=t.right,n=t.bottom,o=t.left):e=i=n=o=t,{top:e,right:i,bottom:n,left:o}}I._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var qt=it.extend({datasetElementType:_t.Line,dataElementType:_t.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(t){var e,i,n=this,o=n.getMeta(),r=o.dataset,a=o.data||[],s=n.chart.options,l=n._config,u=n._showLine=Nt(l.showLine,s.showLines);for(n._xScale=n.getScaleForId(o.xAxisID),n._yScale=n.getScaleForId(o.yAxisID),u&&(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=n._yScale,r._datasetIndex=n.index,r._children=a,r._model=n._resolveDatasetElementOptions(r),r.pivot()),e=0,i=a.length;e<i;++e)n.updateElement(a[e],e,t);for(u&&0!==r._model.tension&&n.updateBezierControlPoints(),e=0,i=a.length;e<i;++e)a[e].pivot()},updateElement:function(t,e,i){var n,o,r=this,a=r.getMeta(),s=t.custom||{},l=r.getDataset(),u=r.index,c=l.data[e],h=r._xScale,d=r._yScale,p=a.dataset._model,f=r._resolveDataElementOptions(t,e);n=h.getPixelForValue("object"==typeof c?c:NaN,e,u),o=i?d.getBasePixel():r.calculatePointY(c,e,u),t._xScale=h,t._yScale=d,t._options=f,t._datasetIndex=u,t._index=e,t._model={x:n,y:o,skip:s.skip||isNaN(n)||isNaN(o),radius:f.radius,pointStyle:f.pointStyle,rotation:f.rotation,backgroundColor:f.backgroundColor,borderColor:f.borderColor,borderWidth:f.borderWidth,tension:Nt(s.tension,p?p.tension:0),steppedLine:!!p&&p.steppedLine,hitRadius:f.hitRadius}},_resolveDatasetElementOptions:function(t){var e=this,i=e._config,n=t.custom||{},o=e.chart.options,r=o.elements.line,a=it.prototype._resolveDatasetElementOptions.apply(e,arguments);return a.spanGaps=Nt(i.spanGaps,o.spanGaps),a.tension=Nt(i.lineTension,r.tension),a.steppedLine=Ht([n.steppedLine,i.steppedLine,r.stepped]),a.clip=Wt(Nt(i.clip,Vt(e._xScale,e._yScale,a.borderWidth))),a},calculatePointY:function(t,e,i){var n,o,r,a,s,l,u,c=this.chart,h=this._yScale,d=0,p=0;if(h.options.stacked){for(s=+h.getRightValue(t),u=(l=c._getSortedVisibleDatasetMetas()).length,n=0;n<u&&(r=l[n]).index!==i;++n)o=c.data.datasets[r.index],"line"===r.type&&r.yAxisID===h.id&&((a=+h.getRightValue(o.data[e]))<0?p+=a||0:d+=a||0);return s<0?h.getPixelForValue(p+s):h.getPixelForValue(d+s)}return h.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,i,n,o=this.chart,r=this.getMeta(),a=r.dataset._model,s=o.chartArea,l=r.data||[];function u(t,e,i){return Math.max(Math.min(t,i),e)}if(a.spanGaps&&(l=l.filter((function(t){return!t._model.skip}))),"monotone"===a.cubicInterpolationMode)B.splineCurveMonotone(l);else for(t=0,e=l.length;t<e;++t)i=l[t]._model,n=B.splineCurve(B.previousItem(l,t)._model,i,B.nextItem(l,t)._model,a.tension),i.controlPointPreviousX=n.previous.x,i.controlPointPreviousY=n.previous.y,i.controlPointNextX=n.next.x,i.controlPointNextY=n.next.y;if(o.options.elements.line.capBezierPoints)for(t=0,e=l.length;t<e;++t)i=l[t]._model,Bt(i,s)&&(t>0&&Bt(l[t-1]._model,s)&&(i.controlPointPreviousX=u(i.controlPointPreviousX,s.left,s.right),i.controlPointPreviousY=u(i.controlPointPreviousY,s.top,s.bottom)),t<l.length-1&&Bt(l[t+1]._model,s)&&(i.controlPointNextX=u(i.controlPointNextX,s.left,s.right),i.controlPointNextY=u(i.controlPointNextY,s.top,s.bottom)))},draw:function(){var t,e=this.chart,i=this.getMeta(),n=i.data||[],o=e.chartArea,r=e.canvas,a=0,s=n.length;for(this._showLine&&(t=i.dataset._model.clip,B.canvas.clipArea(e.ctx,{left:!1===t.left?0:o.left-t.left,right:!1===t.right?r.width:o.right+t.right,top:!1===t.top?0:o.top-t.top,bottom:!1===t.bottom?r.height:o.bottom+t.bottom}),i.dataset.draw(),B.canvas.unclipArea(e.ctx));a<s;++a)n[a].draw(o)},setHoverStyle:function(t){var e=t._model,i=t._options,n=B.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Nt(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Nt(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Nt(i.hoverBorderWidth,i.borderWidth),e.radius=Nt(i.hoverRadius,i.radius)}}),$t=B.options.resolve;I._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e,i,n,o=document.createElement("ul"),r=t.data,a=r.datasets,s=r.labels;if(o.setAttribute("class",t.id+"-legend"),a.length)for(e=0,i=a[0].data.length;e<i;++e)(n=o.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=a[0].backgroundColor[e],s[e]&&n.appendChild(document.createTextNode(s[e]));return o.outerHTML},legend:{labels:{generateLabels:function(t){var e=t.data;return e.labels.length&&e.datasets.length?e.labels.map((function(i,n){var o=t.getDatasetMeta(0),r=o.controller.getStyle(n);return{text:i,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,lineWidth:r.borderWidth,hidden:isNaN(e.datasets[0].data[n])||o.data[n].hidden,index:n}})):[]}},onClick:function(t,e){var i,n,o,r=e.index,a=this.chart;for(i=0,n=(a.data.datasets||[]).length;i<n;++i)(o=a.getDatasetMeta(i)).data[r].hidden=!o.data[r].hidden;a.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}});var Yt=it.extend({dataElementType:_t.Arc,linkScales:B.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(t){var e,i,n,o=this,r=o.getDataset(),a=o.getMeta(),s=o.chart.options.startAngle||0,l=o._starts=[],u=o._angles=[],c=a.data;for(o._updateRadius(),a.count=o.countVisibleElements(),e=0,i=r.data.length;e<i;e++)l[e]=s,n=o._computeAngle(e),u[e]=n,s+=n;for(e=0,i=c.length;e<i;++e)c[e]._options=o._resolveDataElementOptions(c[e],e),o.updateElement(c[e],e,t)},_updateRadius:function(){var t=this,e=t.chart,i=e.chartArea,n=e.options,o=Math.min(i.right-i.left,i.bottom-i.top);e.outerRadius=Math.max(o/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,i){var n=this,o=n.chart,r=n.getDataset(),a=o.options,s=a.animation,l=o.scale,u=o.data.labels,c=l.xCenter,h=l.yCenter,d=a.startAngle,p=t.hidden?0:l.getDistanceFromCenterForValue(r.data[e]),f=n._starts[e],g=f+(t.hidden?0:n._angles[e]),m=s.animateScale?0:l.getDistanceFromCenterForValue(r.data[e]),v=t._options||{};B.extend(t,{_datasetIndex:n.index,_index:e,_scale:l,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,x:c,y:h,innerRadius:0,outerRadius:i?m:p,startAngle:i&&s.animateRotate?d:f,endAngle:i&&s.animateRotate?d:g,label:B.valueAtIndexOrDefault(u,e,u[e])}}),t.pivot()},countVisibleElements:function(){var t=this.getDataset(),e=this.getMeta(),i=0;return B.each(e.data,(function(e,n){isNaN(t.data[n])||e.hidden||i++})),i},setHoverStyle:function(t){var e=t._model,i=t._options,n=B.getHoverColor,o=B.valueOrDefault;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth},e.backgroundColor=o(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=o(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=o(i.hoverBorderWidth,i.borderWidth)},_computeAngle:function(t){var e=this,i=this.getMeta().count,n=e.getDataset(),o=e.getMeta();if(isNaN(n.data[t])||o.data[t].hidden)return 0;var r={chart:e.chart,dataIndex:t,dataset:n,datasetIndex:e.index};return $t([e.chart.options.elements.arc.angle,2*Math.PI/i],r,t)}});I._set("pie",B.clone(I.doughnut)),I._set("pie",{cutoutPercentage:0});var Xt=jt,Ut=B.valueOrDefault;I._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var Kt=it.extend({datasetElementType:_t.Line,dataElementType:_t.Point,linkScales:B.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(t){var e,i,n=this,o=n.getMeta(),r=o.dataset,a=o.data||[],s=n.chart.scale,l=n._config;for(void 0!==l.tension&&void 0===l.lineTension&&(l.lineTension=l.tension),r._scale=s,r._datasetIndex=n.index,r._children=a,r._loop=!0,r._model=n._resolveDatasetElementOptions(r),r.pivot(),e=0,i=a.length;e<i;++e)n.updateElement(a[e],e,t);for(n.updateBezierControlPoints(),e=0,i=a.length;e<i;++e)a[e].pivot()},updateElement:function(t,e,i){var n=this,o=t.custom||{},r=n.getDataset(),a=n.chart.scale,s=a.getPointPositionForValue(e,r.data[e]),l=n._resolveDataElementOptions(t,e),u=n.getMeta().dataset._model,c=i?a.xCenter:s.x,h=i?a.yCenter:s.y;t._scale=a,t._options=l,t._datasetIndex=n.index,t._index=e,t._model={x:c,y:h,skip:o.skip||isNaN(c)||isNaN(h),radius:l.radius,pointStyle:l.pointStyle,rotation:l.rotation,backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,tension:Ut(o.tension,u?u.tension:0),hitRadius:l.hitRadius}},_resolveDatasetElementOptions:function(){var t=this,e=t._config,i=t.chart.options,n=it.prototype._resolveDatasetElementOptions.apply(t,arguments);return n.spanGaps=Ut(e.spanGaps,i.spanGaps),n.tension=Ut(e.lineTension,i.elements.line.tension),n},updateBezierControlPoints:function(){var t,e,i,n,o=this.getMeta(),r=this.chart.chartArea,a=o.data||[];function s(t,e,i){return Math.max(Math.min(t,i),e)}for(o.dataset._model.spanGaps&&(a=a.filter((function(t){return!t._model.skip}))),t=0,e=a.length;t<e;++t)i=a[t]._model,n=B.splineCurve(B.previousItem(a,t,!0)._model,i,B.nextItem(a,t,!0)._model,i.tension),i.controlPointPreviousX=s(n.previous.x,r.left,r.right),i.controlPointPreviousY=s(n.previous.y,r.top,r.bottom),i.controlPointNextX=s(n.next.x,r.left,r.right),i.controlPointNextY=s(n.next.y,r.top,r.bottom)},setHoverStyle:function(t){var e=t._model,i=t._options,n=B.getHoverColor;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=Ut(i.hoverBackgroundColor,n(i.backgroundColor)),e.borderColor=Ut(i.hoverBorderColor,n(i.borderColor)),e.borderWidth=Ut(i.hoverBorderWidth,i.borderWidth),e.radius=Ut(i.hoverRadius,i.radius)}});I._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}}),I._set("global",{datasets:{scatter:{showLine:!1}}});var Zt={bar:Rt,bubble:Lt,doughnut:jt,horizontalBar:zt,line:qt,polarArea:Yt,pie:Xt,radar:Kt,scatter:qt};function Jt(t,e){return t.native?{x:t.x,y:t.y}:B.getRelativePosition(t,e)}function Qt(t,e){var i,n,o,r,a,s,l=t._getSortedVisibleDatasetMetas();for(n=0,r=l.length;n<r;++n)for(o=0,a=(i=l[n].data).length;o<a;++o)(s=i[o])._view.skip||e(s)}function te(t,e){var i=[];return Qt(t,(function(t){t.inRange(e.x,e.y)&&i.push(t)})),i}function ee(t,e,i,n){var o=Number.POSITIVE_INFINITY,r=[];return Qt(t,(function(t){if(!i||t.inRange(e.x,e.y)){var a=t.getCenterPoint(),s=n(e,a);s<o?(r=[t],o=s):s===o&&r.push(t)}})),r}function ie(t){var e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){var o=e?Math.abs(t.x-n.x):0,r=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}}function ne(t,e,i){var n=Jt(e,t);i.axis=i.axis||"x";var o=ie(i.axis),r=i.intersect?te(t,n):ee(t,n,!1,o),a=[];return r.length?(t._getSortedVisibleDatasetMetas().forEach((function(t){var e=t.data[r[0]._index];e&&!e._view.skip&&a.push(e)})),a):[]}var oe={modes:{single:function(t,e){var i=Jt(e,t),n=[];return Qt(t,(function(t){if(t.inRange(i.x,i.y))return n.push(t),n})),n.slice(0,1)},label:ne,index:ne,dataset:function(t,e,i){var n=Jt(e,t);i.axis=i.axis||"xy";var o=ie(i.axis),r=i.intersect?te(t,n):ee(t,n,!1,o);return r.length>0&&(r=t.getDatasetMeta(r[0]._datasetIndex).data),r},"x-axis":function(t,e){return ne(t,e,{intersect:!1})},point:function(t,e){return te(t,Jt(e,t))},nearest:function(t,e,i){var n=Jt(e,t);i.axis=i.axis||"xy";var o=ie(i.axis);return ee(t,n,i.intersect,o)},x:function(t,e,i){var n=Jt(e,t),o=[],r=!1;return Qt(t,(function(t){t.inXRange(n.x)&&o.push(t),t.inRange(n.x,n.y)&&(r=!0)})),i.intersect&&!r&&(o=[]),o},y:function(t,e,i){var n=Jt(e,t),o=[],r=!1;return Qt(t,(function(t){t.inYRange(n.y)&&o.push(t),t.inRange(n.x,n.y)&&(r=!0)})),i.intersect&&!r&&(o=[]),o}}},re=B.extend;function ae(t,e){return B.where(t,(function(t){return t.pos===e}))}function se(t,e){return t.sort((function(t,i){var n=e?i:t,o=e?t:i;return n.weight===o.weight?n.index-o.index:n.weight-o.weight}))}function le(t,e,i,n){return Math.max(t[i],e[i])+Math.max(t[n],e[n])}function ue(t,e,i){var n,o,r=i.box,a=t.maxPadding;if(i.size&&(t[i.pos]-=i.size),i.size=i.horizontal?r.height:r.width,t[i.pos]+=i.size,r.getPadding){var s=r.getPadding();a.top=Math.max(a.top,s.top),a.left=Math.max(a.left,s.left),a.bottom=Math.max(a.bottom,s.bottom),a.right=Math.max(a.right,s.right)}if(n=e.outerWidth-le(a,t,"left","right"),o=e.outerHeight-le(a,t,"top","bottom"),n!==t.w||o!==t.h)return t.w=n,t.h=o,i.horizontal?n!==t.w:o!==t.h}function ce(t,e){var i=e.maxPadding;function n(t){var n={left:0,top:0,right:0,bottom:0};return t.forEach((function(t){n[t]=Math.max(e[t],i[t])})),n}return n(t?["left","right"]:["top","bottom"])}function he(t,e,i){var n,o,r,a,s,l,u=[];for(n=0,o=t.length;n<o;++n)(a=(r=t[n]).box).update(r.width||e.w,r.height||e.h,ce(r.horizontal,e)),ue(e,i,r)&&(l=!0,u.length&&(s=!0)),a.fullWidth||u.push(r);return s&&he(u,e,i)||l}function de(t,e,i){var n,o,r,a,s=i.padding,l=e.x,u=e.y;for(n=0,o=t.length;n<o;++n)a=(r=t[n]).box,r.horizontal?(a.left=a.fullWidth?s.left:e.left,a.right=a.fullWidth?i.outerWidth-s.right:e.left+e.w,a.top=u,a.bottom=u+a.height,a.width=a.right-a.left,u=a.bottom):(a.left=l,a.right=l+a.width,a.top=e.top,a.bottom=e.top+e.h,a.height=a.bottom-a.top,l=a.right);e.x=l,e.y=u}I._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var pe,fe={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw:function(){e.draw.apply(e,arguments)}}]},t.boxes.push(e)},removeBox:function(t,e){var i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure:function(t,e,i){for(var n,o=["fullWidth","position","weight"],r=o.length,a=0;a<r;++a)n=o[a],i.hasOwnProperty(n)&&(e[n]=i[n])},update:function(t,e,i){if(t){var n=t.options.layout||{},o=B.options.toPadding(n.padding),r=e-o.width,a=i-o.height,s=function(t){var e=function(t){var e,i,n,o=[];for(e=0,i=(t||[]).length;e<i;++e)n=t[e],o.push({index:e,box:n,pos:n.position,horizontal:n.isHorizontal(),weight:n.weight});return o}(t),i=se(ae(e,"left"),!0),n=se(ae(e,"right")),o=se(ae(e,"top"),!0),r=se(ae(e,"bottom"));return{leftAndTop:i.concat(o),rightAndBottom:n.concat(r),chartArea:ae(e,"chartArea"),vertical:i.concat(n),horizontal:o.concat(r)}}(t.boxes),l=s.vertical,u=s.horizontal,c=Object.freeze({outerWidth:e,outerHeight:i,padding:o,availableWidth:r,vBoxMaxWidth:r/2/l.length,hBoxMaxHeight:a/2}),h=re({maxPadding:re({},o),w:r,h:a,x:o.left,y:o.top},o);!function(t,e){var i,n,o;for(i=0,n=t.length;i<n;++i)(o=t[i]).width=o.horizontal?o.box.fullWidth&&e.availableWidth:e.vBoxMaxWidth,o.height=o.horizontal&&e.hBoxMaxHeight}(l.concat(u),c),he(l,h,c),he(u,h,c)&&he(l,h,c),function(t){var e=t.maxPadding;function i(i){var n=Math.max(e[i]-t[i],0);return t[i]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}(h),de(s.leftAndTop,h,c),h.x+=h.w,h.y+=h.h,de(s.rightAndBottom,h,c),t.chartArea={left:h.left,top:h.top,right:h.left+h.w,bottom:h.top+h.h},B.each(s.chartArea,(function(e){var i=e.box;re(i,t.chartArea),i.update(h.w,h.h)}))}}},ge=(pe=Object.freeze({__proto__:null,default:"/*\n * DOM element rendering detection\n * https://davidwalsh.name/detect-node-insertion\n */\n@keyframes chartjs-render-animation {\n\tfrom { opacity: 0.99; }\n\tto { opacity: 1; }\n}\n\n.chartjs-render-monitor {\n\tanimation: chartjs-render-animation 0.001s;\n}\n\n/*\n * DOM element resizing detection\n * https://github.com/marcj/css-element-queries\n */\n.chartjs-size-monitor,\n.chartjs-size-monitor-expand,\n.chartjs-size-monitor-shrink {\n\tposition: absolute;\n\tdirection: ltr;\n\tleft: 0;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\toverflow: hidden;\n\tpointer-events: none;\n\tvisibility: hidden;\n\tz-index: -1;\n}\n\n.chartjs-size-monitor-expand > div {\n\tposition: absolute;\n\twidth: 1000000px;\n\theight: 1000000px;\n\tleft: 0;\n\ttop: 0;\n}\n\n.chartjs-size-monitor-shrink > div {\n\tposition: absolute;\n\twidth: 200%;\n\theight: 200%;\n\tleft: 0;\n\ttop: 0;\n}\n"}))&&pe.default||pe,me=["animationstart","webkitAnimationStart"],ve={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function ye(t,e){var i=B.getStyle(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}var be=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function we(t,e,i){t.addEventListener(e,i,be)}function _e(t,e,i){t.removeEventListener(e,i,be)}function xe(t,e,i,n,o){return{type:t,chart:e,native:o||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}function Ce(t){var e=document.createElement("div");return e.className=t||"",e}function Ee(t,e,i){var n,o,r,a,s=t.$chartjs||(t.$chartjs={}),l=s.resizer=function(t){var e=Ce("chartjs-size-monitor"),i=Ce("chartjs-size-monitor-expand"),n=Ce("chartjs-size-monitor-shrink");i.appendChild(Ce()),n.appendChild(Ce()),e.appendChild(i),e.appendChild(n),e._reset=function(){i.scrollLeft=1e6,i.scrollTop=1e6,n.scrollLeft=1e6,n.scrollTop=1e6};var o=function(){e._reset(),t()};return we(i,"scroll",o.bind(i,"expand")),we(n,"scroll",o.bind(n,"shrink")),e}((n=function(){if(s.resizer){var n=i.options.maintainAspectRatio&&t.parentNode,o=n?n.clientWidth:0;e(xe("resize",i)),n&&n.clientWidth<o&&i.canvas&&e(xe("resize",i))}},r=!1,a=[],function(){a=Array.prototype.slice.call(arguments),o=o||this,r||(r=!0,B.requestAnimFrame.call(window,(function(){r=!1,n.apply(o,a)})))}));!function(t,e){var i=t.$chartjs||(t.$chartjs={}),n=i.renderProxy=function(t){"chartjs-render-animation"===t.animationName&&e()};B.each(me,(function(e){we(t,e,n)})),i.reflow=!!t.offsetParent,t.classList.add("chartjs-render-monitor")}(t,(function(){if(s.resizer){var e=t.parentNode;e&&e!==l.parentNode&&e.insertBefore(l,e.firstChild),l._reset()}}))}function ke(t){var e=t.$chartjs||{},i=e.resizer;delete e.resizer,function(t){var e=t.$chartjs||{},i=e.renderProxy;i&&(B.each(me,(function(e){_e(t,e,i)})),delete e.renderProxy),t.classList.remove("chartjs-render-monitor")}(t),i&&i.parentNode&&i.parentNode.removeChild(i)}var Se={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(t){if(!this.disableCSSInjection){var e=t.getRootNode?t.getRootNode():document;!function(t,e){var i=t.$chartjs||(t.$chartjs={});if(!i.containsStyles){i.containsStyles=!0,e="/* Chart.js */\n"+e;var n=document.createElement("style");n.setAttribute("type","text/css"),n.appendChild(document.createTextNode(e)),t.appendChild(n)}}(e.host?e:document.head,ge)}},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(this._ensureLoaded(t),function(t,e){var i=t.style,n=t.getAttribute("height"),o=t.getAttribute("width");if(t.$chartjs={initial:{height:n,width:o,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",null===o||""===o){var r=ye(t,"width");void 0!==r&&(t.width=r)}if(null===n||""===n)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var a=ye(t,"height");void 0!==r&&(t.height=a)}}(t,e),i):null},releaseContext:function(t){var e=t.canvas;if(e.$chartjs){var i=e.$chartjs.initial;["height","width"].forEach((function(t){var n=i[t];B.isNullOrUndef(n)?e.removeAttribute(t):e.setAttribute(t,n)})),B.each(i.style||{},(function(t,i){e.style[i]=t})),e.width=e.width,delete e.$chartjs}},addEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var o=i.$chartjs||(i.$chartjs={});we(n,e,(o.proxies||(o.proxies={}))[t.id+"_"+e]=function(e){i(function(t,e){var i=ve[t.type]||t.type,n=B.getRelativePosition(t,e);return xe(i,e,n.x,n.y,t)}(e,t))})}else Ee(n,i,t)},removeEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var o=((i.$chartjs||{}).proxies||{})[t.id+"_"+e];o&&_e(n,e,o)}else ke(n)}};B.addEvent=we,B.removeEvent=_e;var Me=Se._enabled?Se:{acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}},Te=B.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},Me);I._set("global",{plugins:{}});var Re={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),this._cacheId++},unregister:function(t){var e=this._plugins;[].concat(t).forEach((function(t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)})),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,i){var n,o,r,a,s,l=this.descriptors(t),u=l.length;for(n=0;n<u;++n)if("function"==typeof(s=(r=(o=l[n]).plugin)[e])&&((a=[t].concat(i||[])).push(o.options),!1===s.apply(r,a)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var i=[],n=[],o=t&&t.config||{},r=o.options&&o.options.plugins||{};return this._plugins.concat(o.plugins||[]).forEach((function(t){if(-1===i.indexOf(t)){var e=t.id,o=r[e];!1!==o&&(!0===o&&(o=B.clone(I.global.plugins[e])),i.push(t),n.push({plugin:t,options:o||{}}))}})),e.descriptors=n,e.id=this._cacheId,n},_invalidate:function(t){delete t.$plugins}},Pe={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=B.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?B.merge({},[I.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=B.extend(this.defaults[t],e))},addScalesToLayout:function(t){B.each(t.scales,(function(e){e.fullWidth=e.options.fullWidth,e.position=e.options.position,e.weight=e.options.weight,fe.addBox(t,e)}))}},De=B.valueOrDefault,Le=B.rtl.getRtlAdapter;I._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:B.noop,title:function(t,e){var i="",n=e.labels,o=n?n.length:0;if(t.length>0){var r=t[0];r.label?i=r.label:r.xLabel?i=r.xLabel:o>0&&r.index<o&&(i=n[r.index])}return i},afterTitle:B.noop,beforeBody:B.noop,beforeLabel:B.noop,label:function(t,e){var i=e.datasets[t.datasetIndex].label||"";return i&&(i+=": "),B.isNullOrUndef(t.value)?i+=t.yLabel:i+=t.value,i},labelColor:function(t,e){var i=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:B.noop,afterBody:B.noop,beforeFooter:B.noop,footer:B.noop,afterFooter:B.noop}}});var Fe={average:function(t){if(!t.length)return!1;var e,i,n=0,o=0,r=0;for(e=0,i=t.length;e<i;++e){var a=t[e];if(a&&a.hasValue()){var s=a.tooltipPosition();n+=s.x,o+=s.y,++r}}return{x:n/r,y:o/r}},nearest:function(t,e){var i,n,o,r=e.x,a=e.y,s=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){var l=t[i];if(l&&l.hasValue()){var u=l.getCenterPoint(),c=B.distanceBetweenPoints(e,u);c<s&&(s=c,o=l)}}if(o){var h=o.tooltipPosition();r=h.x,a=h.y}return{x:r,y:a}}};function Oe(t,e){return e&&(B.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ae(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function Ie(t){var e=I.global;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,rtl:t.rtl,textDirection:t.textDirection,bodyFontColor:t.bodyFontColor,_bodyFontFamily:De(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:De(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:De(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:De(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:De(t.titleFontStyle,e.defaultFontStyle),titleFontSize:De(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:De(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:De(t.footerFontStyle,e.defaultFontStyle),footerFontSize:De(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function je(t,e){return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-t.xPadding:t.x+t.xPadding}function ze(t){return Oe([],Ae(t))}var Ne=X.extend({initialize:function(){this._model=Ie(this._options),this._lastActive=[]},getTitle:function(){var t=this,e=t._options,i=e.callbacks,n=i.beforeTitle.apply(t,arguments),o=i.title.apply(t,arguments),r=i.afterTitle.apply(t,arguments),a=[];return a=Oe(a,Ae(n)),a=Oe(a,Ae(o)),a=Oe(a,Ae(r))},getBeforeBody:function(){return ze(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,e){var i=this,n=i._options.callbacks,o=[];return B.each(t,(function(t){var r={before:[],lines:[],after:[]};Oe(r.before,Ae(n.beforeLabel.call(i,t,e))),Oe(r.lines,n.label.call(i,t,e)),Oe(r.after,Ae(n.afterLabel.call(i,t,e))),o.push(r)})),o},getAfterBody:function(){return ze(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this,e=t._options.callbacks,i=e.beforeFooter.apply(t,arguments),n=e.footer.apply(t,arguments),o=e.afterFooter.apply(t,arguments),r=[];return r=Oe(r,Ae(i)),r=Oe(r,Ae(n)),r=Oe(r,Ae(o))},update:function(t){var e,i,n,o,r,a,s,l,u,c,h=this,d=h._options,p=h._model,f=h._model=Ie(d),g=h._active,m=h._data,v={xAlign:p.xAlign,yAlign:p.yAlign},y={x:p.x,y:p.y},b={width:p.width,height:p.height},w={x:p.caretX,y:p.caretY};if(g.length){f.opacity=1;var _=[],x=[];w=Fe[d.position].call(h,g,h._eventPosition);var C=[];for(e=0,i=g.length;e<i;++e)C.push((n=g[e],o=void 0,r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,o=n._xScale,r=n._yScale||n._scale,a=n._index,s=n._datasetIndex,l=n._chart.getDatasetMeta(s).controller,u=l._getIndexScale(),c=l._getValueScale(),{xLabel:o?o.getLabelForIndex(a,s):"",yLabel:r?r.getLabelForIndex(a,s):"",label:u?""+u.getLabelForIndex(a,s):"",value:c?""+c.getLabelForIndex(a,s):"",index:a,datasetIndex:s,x:n._model.x,y:n._model.y}));d.filter&&(C=C.filter((function(t){return d.filter(t,m)}))),d.itemSort&&(C=C.sort((function(t,e){return d.itemSort(t,e,m)}))),B.each(C,(function(t){_.push(d.callbacks.labelColor.call(h,t,h._chart)),x.push(d.callbacks.labelTextColor.call(h,t,h._chart))})),f.title=h.getTitle(C,m),f.beforeBody=h.getBeforeBody(C,m),f.body=h.getBody(C,m),f.afterBody=h.getAfterBody(C,m),f.footer=h.getFooter(C,m),f.x=w.x,f.y=w.y,f.caretPadding=d.caretPadding,f.labelColors=_,f.labelTextColors=x,f.dataPoints=C,b=function(t,e){var i=t._chart.ctx,n=2*e.yPadding,o=0,r=e.body,a=r.reduce((function(t,e){return t+e.before.length+e.lines.length+e.after.length}),0);a+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,u=e.titleFontSize,c=e.bodyFontSize,h=e.footerFontSize;n+=s*u,n+=s?(s-1)*e.titleSpacing:0,n+=s?e.titleMarginBottom:0,n+=a*c,n+=a?(a-1)*e.bodySpacing:0,n+=l?e.footerMarginTop:0,n+=l*h,n+=l?(l-1)*e.footerSpacing:0;var d=0,p=function(t){o=Math.max(o,i.measureText(t).width+d)};return i.font=B.fontString(u,e._titleFontStyle,e._titleFontFamily),B.each(e.title,p),i.font=B.fontString(c,e._bodyFontStyle,e._bodyFontFamily),B.each(e.beforeBody.concat(e.afterBody),p),d=e.displayColors?c+2:0,B.each(r,(function(t){B.each(t.before,p),B.each(t.lines,p),B.each(t.after,p)})),d=0,i.font=B.fontString(h,e._footerFontStyle,e._footerFontFamily),B.each(e.footer,p),{width:o+=2*e.xPadding,height:n}}(this,f),y=function(t,e,i,n){var o=t.x,r=t.y,a=t.caretSize,s=t.caretPadding,l=t.cornerRadius,u=i.xAlign,c=i.yAlign,h=a+s,d=l+s;return"right"===u?o-=e.width:"center"===u&&((o-=e.width/2)+e.width>n.width&&(o=n.width-e.width),o<0&&(o=0)),"top"===c?r+=h:r-="bottom"===c?e.height+h:e.height/2,"center"===c?"left"===u?o+=h:"right"===u&&(o-=h):"left"===u?o-=d:"right"===u&&(o+=d),{x:o,y:r}}(f,b,v=function(t,e){var i,n,o,r,a,s=t._model,l=t._chart,u=t._chart.chartArea,c="center",h="center";s.y<e.height?h="top":s.y>l.height-e.height&&(h="bottom");var d=(u.left+u.right)/2,p=(u.top+u.bottom)/2;"center"===h?(i=function(t){return t<=d},n=function(t){return t>d}):(i=function(t){return t<=e.width/2},n=function(t){return t>=l.width-e.width/2}),o=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},r=function(t){return t-e.width-s.caretSize-s.caretPadding<0},a=function(t){return t<=p?"top":"bottom"},i(s.x)?(c="left",o(s.x)&&(c="center",h=a(s.y))):n(s.x)&&(c="right",r(s.x)&&(c="center",h=a(s.y)));var f=t._options;return{xAlign:f.xAlign?f.xAlign:c,yAlign:f.yAlign?f.yAlign:h}}(this,b),h._chart)}else f.opacity=0;return f.xAlign=v.xAlign,f.yAlign=v.yAlign,f.x=y.x,f.y=y.y,f.width=b.width,f.height=b.height,f.caretX=w.x,f.caretY=w.y,h._model=f,t&&d.custom&&d.custom.call(h,f),h},drawCaret:function(t,e){var i=this._chart.ctx,n=this._view,o=this.getCaretPosition(t,e,n);i.lineTo(o.x1,o.y1),i.lineTo(o.x2,o.y2),i.lineTo(o.x3,o.y3)},getCaretPosition:function(t,e,i){var n,o,r,a,s,l,u=i.caretSize,c=i.cornerRadius,h=i.xAlign,d=i.yAlign,p=t.x,f=t.y,g=e.width,m=e.height;if("center"===d)s=f+m/2,"left"===h?(o=(n=p)-u,r=n,a=s+u,l=s-u):(o=(n=p+g)+u,r=n,a=s-u,l=s+u);else if("left"===h?(n=(o=p+c+u)-u,r=o+u):"right"===h?(n=(o=p+g-c-u)-u,r=o+u):(n=(o=i.caretX)-u,r=o+u),"top"===d)s=(a=f)-u,l=a;else{s=(a=f+m)+u,l=a;var v=r;r=n,n=v}return{x1:n,x2:o,x3:r,y1:a,y2:s,y3:l}},drawTitle:function(t,e,i){var n,o,r,a=e.title,s=a.length;if(s){var l=Le(e.rtl,e.x,e.width);for(t.x=je(e,e._titleAlign),i.textAlign=l.textAlign(e._titleAlign),i.textBaseline="middle",n=e.titleFontSize,o=e.titleSpacing,i.fillStyle=e.titleFontColor,i.font=B.fontString(n,e._titleFontStyle,e._titleFontFamily),r=0;r<s;++r)i.fillText(a[r],l.x(t.x),t.y+n/2),t.y+=n+o,r+1===s&&(t.y+=e.titleMarginBottom-o)}},drawBody:function(t,e,i){var n,o,r,a,s,l,u,c,h=e.bodyFontSize,d=e.bodySpacing,p=e._bodyAlign,f=e.body,g=e.displayColors,m=0,v=g?je(e,"left"):0,y=Le(e.rtl,e.x,e.width),b=function(e){i.fillText(e,y.x(t.x+m),t.y+h/2),t.y+=h+d},w=y.textAlign(p);for(i.textAlign=p,i.textBaseline="middle",i.font=B.fontString(h,e._bodyFontStyle,e._bodyFontFamily),t.x=je(e,w),i.fillStyle=e.bodyFontColor,B.each(e.beforeBody,b),m=g&&"right"!==w?"center"===p?h/2+1:h+2:0,s=0,u=f.length;s<u;++s){for(n=f[s],o=e.labelTextColors[s],r=e.labelColors[s],i.fillStyle=o,B.each(n.before,b),l=0,c=(a=n.lines).length;l<c;++l){if(g){var _=y.x(v);i.fillStyle=e.legendColorBackground,i.fillRect(y.leftForLtr(_,h),t.y,h,h),i.lineWidth=1,i.strokeStyle=r.borderColor,i.strokeRect(y.leftForLtr(_,h),t.y,h,h),i.fillStyle=r.backgroundColor,i.fillRect(y.leftForLtr(y.xPlus(_,1),h-2),t.y+1,h-2,h-2),i.fillStyle=o}b(a[l])}B.each(n.after,b)}m=0,B.each(e.afterBody,b),t.y-=d},drawFooter:function(t,e,i){var n,o,r=e.footer,a=r.length;if(a){var s=Le(e.rtl,e.x,e.width);for(t.x=je(e,e._footerAlign),t.y+=e.footerMarginTop,i.textAlign=s.textAlign(e._footerAlign),i.textBaseline="middle",n=e.footerFontSize,i.fillStyle=e.footerFontColor,i.font=B.fontString(n,e._footerFontStyle,e._footerFontFamily),o=0;o<a;++o)i.fillText(r[o],s.x(t.x),t.y+n/2),t.y+=n+e.footerSpacing}},drawBackground:function(t,e,i,n){i.fillStyle=e.backgroundColor,i.strokeStyle=e.borderColor,i.lineWidth=e.borderWidth;var o=e.xAlign,r=e.yAlign,a=t.x,s=t.y,l=n.width,u=n.height,c=e.cornerRadius;i.beginPath(),i.moveTo(a+c,s),"top"===r&&this.drawCaret(t,n),i.lineTo(a+l-c,s),i.quadraticCurveTo(a+l,s,a+l,s+c),"center"===r&&"right"===o&&this.drawCaret(t,n),i.lineTo(a+l,s+u-c),i.quadraticCurveTo(a+l,s+u,a+l-c,s+u),"bottom"===r&&this.drawCaret(t,n),i.lineTo(a+c,s+u),i.quadraticCurveTo(a,s+u,a,s+u-c),"center"===r&&"left"===o&&this.drawCaret(t,n),i.lineTo(a,s+c),i.quadraticCurveTo(a,s,a+c,s),i.closePath(),i.fill(),e.borderWidth>0&&i.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var i={width:e.width,height:e.height},n={x:e.x,y:e.y},o=Math.abs(e.opacity<.001)?0:e.opacity,r=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&r&&(t.save(),t.globalAlpha=o,this.drawBackground(n,e,t,i),n.y+=e.yPadding,B.rtl.overrideTextDirection(t,e.textDirection),this.drawTitle(n,e,t),this.drawBody(n,e,t),this.drawFooter(n,e,t),B.rtl.restoreTextDirection(t,e.textDirection),t.restore())}},handleEvent:function(t){var e,i=this,n=i._options;return i._lastActive=i._lastActive||[],"mouseout"===t.type?i._active=[]:(i._active=i._chart.getElementsAtEventForMode(t,n.mode,n),n.reverse&&i._active.reverse()),(e=!B.arrayEquals(i._active,i._lastActive))&&(i._lastActive=i._active,(n.enabled||n.custom)&&(i._eventPosition={x:t.x,y:t.y},i.update(!0),i.pivot())),e}}),He=Fe,Be=Ne;Be.positioners=He;var Ge=B.valueOrDefault;function Ve(){return B.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){if("xAxes"===t||"yAxes"===t){var o,r,a,s=i[t].length;for(e[t]||(e[t]=[]),o=0;o<s;++o)a=i[t][o],r=Ge(a.type,"xAxes"===t?"category":"linear"),o>=e[t].length&&e[t].push({}),!e[t][o].type||a.type&&a.type!==e[t][o].type?B.merge(e[t][o],[Pe.getScaleDefaults(r),a]):B.merge(e[t][o],a)}else B._merger(t,e,i,n)}})}function We(){return B.merge({},[].slice.call(arguments),{merger:function(t,e,i,n){var o=e[t]||{},r=i[t];"scales"===t?e[t]=Ve(o,r):"scale"===t?e[t]=B.merge(o,[Pe.getScaleDefaults(r.type),r]):B._merger(t,e,i,n)}})}function qe(t){var e=t.options;B.each(t.scales,(function(e){fe.removeBox(t,e)})),e=We(I.global,I[t.config.type],e),t.options=t.config.options=e,t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.tooltip._options=e.tooltips,t.tooltip.initialize()}function $e(t,e,i){var n,o=function(t){return t.id===n};do{n=e+i++}while(B.findIndex(t,o)>=0);return n}function Ye(t){return"top"===t||"bottom"===t}function Xe(t,e){return function(i,n){return i[t]===n[t]?i[e]-n[e]:i[t]-n[t]}}I._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var Ue=function(t,e){return this.construct(t,e),this};B.extend(Ue.prototype,{construct:function(t,e){var i=this;e=function(t){var e=(t=t||{}).data=t.data||{};return e.datasets=e.datasets||[],e.labels=e.labels||[],t.options=We(I.global,I[t.type],t.options||{}),t}(e);var n=Te.acquireContext(t,e),o=n&&n.canvas,r=o&&o.height,a=o&&o.width;i.id=B.uid(),i.ctx=n,i.canvas=o,i.config=e,i.width=a,i.height=r,i.aspectRatio=r?a/r:null,i.options=e.options,i._bufferedRender=!1,i._layers=[],i.chart=i,i.controller=i,Ue.instances[i.id]=i,Object.defineProperty(i,"data",{get:function(){return i.config.data},set:function(t){i.config.data=t}}),n&&o?(i.initialize(),i.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return Re.notify(t,"beforeInit"),B.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.initToolTip(),Re.notify(t,"afterInit"),t},clear:function(){return B.canvas.clear(this),this},stop:function(){return Z.cancelAnimation(this),this},resize:function(t){var e=this,i=e.options,n=e.canvas,o=i.maintainAspectRatio&&e.aspectRatio||null,r=Math.max(0,Math.floor(B.getMaximumWidth(n))),a=Math.max(0,Math.floor(o?r/o:B.getMaximumHeight(n)));if((e.width!==r||e.height!==a)&&(n.width=e.width=r,n.height=e.height=a,n.style.width=r+"px",n.style.height=a+"px",B.retinaScale(e,i.devicePixelRatio),!t)){var s={width:r,height:a};Re.notify(e,"resize",[s]),i.onResize&&i.onResize(e,s),e.stop(),e.update({duration:i.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},i=t.scale;B.each(e.xAxes,(function(t,i){t.id||(t.id=$e(e.xAxes,"x-axis-",i))})),B.each(e.yAxes,(function(t,i){t.id||(t.id=$e(e.yAxes,"y-axis-",i))})),i&&(i.id=i.id||"scale")},buildOrUpdateScales:function(){var t=this,e=t.options,i=t.scales||{},n=[],o=Object.keys(i).reduce((function(t,e){return t[e]=!1,t}),{});e.scales&&(n=n.concat((e.scales.xAxes||[]).map((function(t){return{options:t,dtype:"category",dposition:"bottom"}})),(e.scales.yAxes||[]).map((function(t){return{options:t,dtype:"linear",dposition:"left"}})))),e.scale&&n.push({options:e.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),B.each(n,(function(e){var n=e.options,r=n.id,a=Ge(n.type,e.dtype);Ye(n.position)!==Ye(e.dposition)&&(n.position=e.dposition),o[r]=!0;var s=null;if(r in i&&i[r].type===a)(s=i[r]).options=n,s.ctx=t.ctx,s.chart=t;else{var l=Pe.getScaleConstructor(a);if(!l)return;s=new l({id:r,type:a,options:n,ctx:t.ctx,chart:t}),i[s.id]=s}s.mergeTicksOptions(),e.isDefault&&(t.scale=s)})),B.each(o,(function(t,e){t||delete i[e]})),t.scales=i,Pe.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t,e,i=this,n=[],o=i.data.datasets;for(t=0,e=o.length;t<e;t++){var r=o[t],a=i.getDatasetMeta(t),s=r.type||i.config.type;if(a.type&&a.type!==s&&(i.destroyDatasetMeta(t),a=i.getDatasetMeta(t)),a.type=s,a.order=r.order||0,a.index=t,a.controller)a.controller.updateIndex(t),a.controller.linkScales();else{var l=Zt[a.type];if(void 0===l)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new l(i,t),n.push(a.controller)}}return n},resetElements:function(){var t=this;B.each(t.data.datasets,(function(e,i){t.getDatasetMeta(i).controller.reset()}),t)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,i,n=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),qe(n),Re._invalidate(n),!1!==Re.notify(n,"beforeUpdate")){n.tooltip._data=n.data;var o=n.buildOrUpdateControllers();for(e=0,i=n.data.datasets.length;e<i;e++)n.getDatasetMeta(e).controller.buildOrUpdateElements();n.updateLayout(),n.options.animation&&n.options.animation.duration&&B.each(o,(function(t){t.reset()})),n.updateDatasets(),n.tooltip.initialize(),n.lastActive=[],Re.notify(n,"afterUpdate"),n._layers.sort(Xe("z","_idx")),n._bufferedRender?n._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:n.render(t)}},updateLayout:function(){var t=this;!1!==Re.notify(t,"beforeLayout")&&(fe.update(this,this.width,this.height),t._layers=[],B.each(t.boxes,(function(e){e._configure&&e._configure(),t._layers.push.apply(t._layers,e._layers())}),t),t._layers.forEach((function(t,e){t._idx=e})),Re.notify(t,"afterScaleUpdate"),Re.notify(t,"afterLayout"))},updateDatasets:function(){if(!1!==Re.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);Re.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==Re.notify(this,"beforeDatasetUpdate",[i])&&(e.controller._update(),Re.notify(this,"afterDatasetUpdate",[i]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var i=e.options.animation,n=Ge(t.duration,i&&i.duration),o=t.lazy;if(!1!==Re.notify(e,"beforeRender")){var r=function(t){Re.notify(e,"afterRender"),B.callback(i&&i.onComplete,[t],e)};if(i&&n){var a=new K({numSteps:n/16.66,easing:t.easing||i.easing,render:function(t,e){var i=B.easing.effects[e.easing],n=e.currentStep,o=n/e.numSteps;t.draw(i(o),o,n)},onAnimationProgress:i.onProgress,onAnimationComplete:r});Z.addAnimation(e,a,n,o)}else e.draw(),r(new K({numSteps:0,chart:e}));return e}},draw:function(t){var e,i,n=this;if(n.clear(),B.isNullOrUndef(t)&&(t=1),n.transition(t),!(n.width<=0||n.height<=0)&&!1!==Re.notify(n,"beforeDraw",[t])){for(i=n._layers,e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(n.chartArea);for(n.drawDatasets(t);e<i.length;++e)i[e].draw(n.chartArea);n._drawTooltip(t),Re.notify(n,"afterDraw",[t])}},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},_getSortedDatasetMetas:function(t){var e,i,n=[];for(e=0,i=(this.data.datasets||[]).length;e<i;++e)t&&!this.isDatasetVisible(e)||n.push(this.getDatasetMeta(e));return n.sort(Xe("order","index")),n},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(t){var e,i;if(!1!==Re.notify(this,"beforeDatasetsDraw",[t])){for(i=(e=this._getSortedVisibleDatasetMetas()).length-1;i>=0;--i)this.drawDataset(e[i],t);Re.notify(this,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var i={meta:t,index:t.index,easingValue:e};!1!==Re.notify(this,"beforeDatasetDraw",[i])&&(t.controller.draw(e),Re.notify(this,"afterDatasetDraw",[i]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==Re.notify(this,"beforeTooltipDraw",[i])&&(e.draw(),Re.notify(this,"afterTooltipDraw",[i]))},getElementAtEvent:function(t){return oe.modes.single(this,t)},getElementsAtEvent:function(t){return oe.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return oe.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,i){var n=oe.modes[e];return"function"==typeof n?n(this,t,i):[]},getDatasetAtEvent:function(t){return oe.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e.order||0,index:t}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],n=i._meta&&i._meta[e];n&&(n.controller.destroy(),delete i._meta[e])},destroy:function(){var t,e,i=this,n=i.canvas;for(i.stop(),t=0,e=i.data.datasets.length;t<e;++t)i.destroyDatasetMeta(t);n&&(i.unbindEvents(),B.canvas.clear(i),Te.releaseContext(i.ctx),i.canvas=null,i.ctx=null),Re.notify(i,"destroy"),delete Ue.instances[i.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new Be({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var t=this,e=t._listeners={},i=function(){t.eventHandler.apply(t,arguments)};B.each(t.options.events,(function(n){Te.addEventListener(t,n,i),e[n]=i})),t.options.responsive&&(i=function(){t.resize()},Te.addEventListener(t,"resize",i),e.resize=i)},unbindEvents:function(){var t=this,e=t._listeners;e&&(delete t._listeners,B.each(e,(function(e,i){Te.removeEventListener(t,i,e)})))},updateHoverStyle:function(t,e,i){var n,o,r,a=i?"set":"remove";for(o=0,r=t.length;o<r;++o)(n=t[o])&&this.getDatasetMeta(n._datasetIndex).controller[a+"HoverStyle"](n);"dataset"===e&&this.getDatasetMeta(t[0]._datasetIndex).controller["_"+a+"DatasetHoverStyle"]()},eventHandler:function(t){var e=this,i=e.tooltip;if(!1!==Re.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var n=e.handleEvent(t);i&&(n=i._start?i.handleEvent(t):n|i.handleEvent(t)),Re.notify(e,"afterEvent",[t]);var o=e._bufferedRequest;return o?e.render(o):n&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,i=this,n=i.options||{},o=n.hover;return i.lastActive=i.lastActive||[],"mouseout"===t.type?i.active=[]:i.active=i.getElementsAtEventForMode(t,o.mode,o),B.callback(n.onHover||n.hover.onHover,[t.native,i.active],i),"mouseup"!==t.type&&"click"!==t.type||n.onClick&&n.onClick.call(i,t.native,i.active),i.lastActive.length&&i.updateHoverStyle(i.lastActive,o.mode,!1),i.active.length&&o.mode&&i.updateHoverStyle(i.active,o.mode,!0),e=!B.arrayEquals(i.active,i.lastActive),i.lastActive=i.active,e}}),Ue.instances={};var Ke=Ue;function Ze(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function Je(t){this.options=t||{}}Ue.Controller=Ue,Ue.types={},B.configMerge=We,B.scaleMerge=Ve,B.extend(Je.prototype,{formats:Ze,parse:Ze,format:Ze,add:Ze,diff:Ze,startOf:Ze,endOf:Ze,_create:function(t){return t}}),Je.override=function(t){B.extend(Je.prototype,t)};var Qe={_date:Je},ti={formatters:{values:function(t){return B.isArray(t)?t:""+t},linear:function(t,e,i){var n=i.length>3?i[2]-i[1]:i[1]-i[0];Math.abs(n)>1&&t!==Math.floor(t)&&(n=t-Math.floor(t));var o=B.log10(Math.abs(n)),r="";if(0!==t)if(Math.max(Math.abs(i[0]),Math.abs(i[i.length-1]))<1e-4){var a=B.log10(Math.abs(t)),s=Math.floor(a)-Math.floor(o);s=Math.max(Math.min(s,20),0),r=t.toExponential(s)}else{var l=-1*Math.floor(o);l=Math.max(Math.min(l,20),0),r=t.toFixed(l)}else r="0";return r},logarithmic:function(t,e,i){var n=t/Math.pow(10,Math.floor(B.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===e||e===i.length-1?t.toExponential():""}}},ei=B.isArray,ii=B.isNullOrUndef,ni=B.valueOrDefault,oi=B.valueAtIndexOrDefault;function ri(t,e,i){var n,o=t.getTicks().length,r=Math.min(e,o-1),a=t.getPixelForTick(r),s=t._startPixel,l=t._endPixel;if(!(i&&(n=1===o?Math.max(a-s,l-a):0===e?(t.getPixelForTick(1)-a)/2:(a-t.getPixelForTick(r-1))/2,(a+=r<e?n:-n)<s-1e-6||a>l+1e-6)))return a}function ai(t,e,i,n){var o,r,a,s,l,u,c,h,d,p,f,g,m,v=i.length,y=[],b=[],w=[];for(o=0;o<v;++o){if(s=i[o].label,l=i[o].major?e.major:e.minor,t.font=u=l.string,c=n[u]=n[u]||{data:{},gc:[]},h=l.lineHeight,d=p=0,ii(s)||ei(s)){if(ei(s))for(r=0,a=s.length;r<a;++r)f=s[r],ii(f)||ei(f)||(d=B.measureText(t,c.data,c.gc,d,f),p+=h)}else d=B.measureText(t,c.data,c.gc,d,s),p=h;y.push(d),b.push(p),w.push(h/2)}function _(t){return{width:y[t]||0,height:b[t]||0,offset:w[t]||0}}return function(t,e){B.each(t,(function(t){var i,n=t.gc,o=n.length/2;if(o>e){for(i=0;i<o;++i)delete t.data[n[i]];n.splice(0,o)}}))}(n,v),g=y.indexOf(Math.max.apply(null,y)),m=b.indexOf(Math.max.apply(null,b)),{first:_(0),last:_(v-1),widest:_(g),highest:_(m)}}function si(t){return t.drawTicks?t.tickMarkLength:0}function li(t){var e,i;return t.display?(e=B.options._parseFont(t),i=B.options.toPadding(t.padding),e.lineHeight+i.height):0}function ui(t,e){return B.extend(B.options._parseFont({fontFamily:ni(e.fontFamily,t.fontFamily),fontSize:ni(e.fontSize,t.fontSize),fontStyle:ni(e.fontStyle,t.fontStyle),lineHeight:ni(e.lineHeight,t.lineHeight)}),{color:B.options.resolve([e.fontColor,t.fontColor,I.global.defaultFontColor])})}function ci(t){var e=ui(t,t.minor);return{minor:e,major:t.major.enabled?ui(t,t.major):e}}function hi(t){var e,i,n,o=[];for(i=0,n=t.length;i<n;++i)void 0!==(e=t[i])._index&&o.push(e);return o}function di(t,e,i,n){var o,r,a,s,l=ni(i,0),u=Math.min(ni(n,t.length),t.length),c=0;for(e=Math.ceil(e),n&&(e=(o=n-i)/Math.floor(o/e)),s=l;s<0;)c++,s=Math.round(l+c*e);for(r=Math.max(l,0);r<u;r++)a=t[r],r===s?(a._index=r,c++,s=Math.round(l+c*e)):delete a.label}I._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:ti.formatters.values,minor:{},major:{}}});var pi=X.extend({zeroLineIndex:0,getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){B.callback(this.options.beforeUpdate,[this])},update:function(t,e,i){var n,o,r,a,s,l=this,u=l.options.ticks,c=u.sampleSize;if(l.beforeUpdate(),l.maxWidth=t,l.maxHeight=e,l.margins=B.extend({left:0,right:0,top:0,bottom:0},i),l._ticks=null,l.ticks=null,l._labelSizes=null,l._maxLabelLines=0,l.longestLabelWidth=0,l.longestTextCache=l.longestTextCache||{},l._gridLineItems=null,l._labelItems=null,l.beforeSetDimensions(),l.setDimensions(),l.afterSetDimensions(),l.beforeDataLimits(),l.determineDataLimits(),l.afterDataLimits(),l.beforeBuildTicks(),a=l.buildTicks()||[],(!(a=l.afterBuildTicks(a)||a)||!a.length)&&l.ticks)for(a=[],n=0,o=l.ticks.length;n<o;++n)a.push({value:l.ticks[n],major:!1});return l._ticks=a,s=c<a.length,r=l._convertTicksToLabels(s?function(t,e){for(var i=[],n=t.length/e,o=0,r=t.length;o<r;o+=n)i.push(t[Math.floor(o)]);return i}(a,c):a),l._configure(),l.beforeCalculateTickRotation(),l.calculateTickRotation(),l.afterCalculateTickRotation(),l.beforeFit(),l.fit(),l.afterFit(),l._ticksToDraw=u.display&&(u.autoSkip||"auto"===u.source)?l._autoSkip(a):a,s&&(r=l._convertTicksToLabels(l._ticksToDraw)),l.ticks=r,l.afterUpdate(),l.minSize},_configure:function(){var t,e,i=this,n=i.options.ticks.reverse;i.isHorizontal()?(t=i.left,e=i.right):(t=i.top,e=i.bottom,n=!n),i._startPixel=t,i._endPixel=e,i._reversePixels=n,i._length=e-t},afterUpdate:function(){B.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){B.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){B.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){B.callback(this.options.beforeDataLimits,[this])},determineDataLimits:B.noop,afterDataLimits:function(){B.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){B.callback(this.options.beforeBuildTicks,[this])},buildTicks:B.noop,afterBuildTicks:function(t){var e=this;return ei(t)&&t.length?B.callback(e.options.afterBuildTicks,[e,t]):(e.ticks=B.callback(e.options.afterBuildTicks,[e,e.ticks])||e.ticks,t)},beforeTickToLabelConversion:function(){B.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){B.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){B.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t,e,i,n,o,r,a,s=this,l=s.options,u=l.ticks,c=s.getTicks().length,h=u.minRotation||0,d=u.maxRotation,p=h;!s._isVisible()||!u.display||h>=d||c<=1||!s.isHorizontal()?s.labelRotation=h:(e=(t=s._getLabelSizes()).widest.width,i=t.highest.height-t.highest.offset,n=Math.min(s.maxWidth,s.chart.width-e),e+6>(o=l.offset?s.maxWidth/c:n/(c-1))&&(o=n/(c-(l.offset?.5:1)),r=s.maxHeight-si(l.gridLines)-u.padding-li(l.scaleLabel),a=Math.sqrt(e*e+i*i),p=B.toDegrees(Math.min(Math.asin(Math.min((t.highest.height+6)/o,1)),Math.asin(Math.min(r/a,1))-Math.asin(i/a))),p=Math.max(h,Math.min(d,p))),s.labelRotation=p)},afterCalculateTickRotation:function(){B.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){B.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},i=t.chart,n=t.options,o=n.ticks,r=n.scaleLabel,a=n.gridLines,s=t._isVisible(),l="bottom"===n.position,u=t.isHorizontal();if(u?e.width=t.maxWidth:s&&(e.width=si(a)+li(r)),u?s&&(e.height=si(a)+li(r)):e.height=t.maxHeight,o.display&&s){var c=ci(o),h=t._getLabelSizes(),d=h.first,p=h.last,f=h.widest,g=h.highest,m=.4*c.minor.lineHeight,v=o.padding;if(u){var y=0!==t.labelRotation,b=B.toRadians(t.labelRotation),w=Math.cos(b),_=Math.sin(b),x=_*f.width+w*(g.height-(y?g.offset:0))+(y?0:m);e.height=Math.min(t.maxHeight,e.height+x+v);var C,E,k=t.getPixelForTick(0)-t.left,S=t.right-t.getPixelForTick(t.getTicks().length-1);y?(C=l?w*d.width+_*d.offset:_*(d.height-d.offset),E=l?_*(p.height-p.offset):w*p.width+_*p.offset):(C=d.width/2,E=p.width/2),t.paddingLeft=Math.max((C-k)*t.width/(t.width-k),0)+3,t.paddingRight=Math.max((E-S)*t.width/(t.width-S),0)+3}else{var M=o.mirror?0:f.width+v+m;e.width=Math.min(t.maxWidth,e.width+M),t.paddingTop=d.height/2,t.paddingBottom=p.height/2}}t.handleMargins(),u?(t.width=t._length=i.width-t.margins.left-t.margins.right,t.height=e.height):(t.width=e.width,t.height=t._length=i.height-t.margins.top-t.margins.bottom)},handleMargins:function(){var t=this;t.margins&&(t.margins.left=Math.max(t.paddingLeft,t.margins.left),t.margins.top=Math.max(t.paddingTop,t.margins.top),t.margins.right=Math.max(t.paddingRight,t.margins.right),t.margins.bottom=Math.max(t.paddingBottom,t.margins.bottom))},afterFit:function(){B.callback(this.options.afterFit,[this])},isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(ii(t))return NaN;if(("number"==typeof t||t instanceof Number)&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},_convertTicksToLabels:function(t){var e,i,n,o=this;for(o.ticks=t.map((function(t){return t.value})),o.beforeTickToLabelConversion(),e=o.convertTicksToLabels(t)||o.ticks,o.afterTickToLabelConversion(),i=0,n=t.length;i<n;++i)t[i].label=e[i];return e},_getLabelSizes:function(){var t=this,e=t._labelSizes;return e||(t._labelSizes=e=ai(t.ctx,ci(t.options.ticks),t.getTicks(),t.longestTextCache),t.longestLabelWidth=e.widest.width),e},_parseValue:function(t){var e,i,n,o;return ei(t)?(e=+this.getRightValue(t[0]),i=+this.getRightValue(t[1]),n=Math.min(e,i),o=Math.max(e,i)):(e=void 0,i=t=+this.getRightValue(t),n=t,o=t),{min:n,max:o,start:e,end:i}},_getScaleLabel:function(t){var e=this._parseValue(t);return void 0!==e.start?"["+e.start+", "+e.end+"]":+this.getRightValue(t)},getLabelForIndex:B.noop,getPixelForValue:B.noop,getValueForPixel:B.noop,getPixelForTick:function(t){var e=this.options.offset,i=this._ticks.length,n=1/Math.max(i-(e?0:1),1);return t<0||t>i-1?null:this.getPixelForDecimal(t*n+(e?n/2:0))},getPixelForDecimal:function(t){return this._reversePixels&&(t=1-t),this._startPixel+t*this._length},getDecimalForPixel:function(t){var e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0},_autoSkip:function(t){var e,i,n,o,r=this.options.ticks,a=this._length,s=r.maxTicksLimit||a/this._tickSize()+1,l=r.major.enabled?function(t){var e,i,n=[];for(e=0,i=t.length;e<i;e++)t[e].major&&n.push(e);return n}(t):[],u=l.length,c=l[0],h=l[u-1];if(u>s)return function(t,e,i){var n,o,r=0,a=e[0];for(i=Math.ceil(i),n=0;n<t.length;n++)o=t[n],n===a?(o._index=n,a=e[++r*i]):delete o.label}(t,l,u/s),hi(t);if(n=function(t,e,i,n){var o,r,a,s,l=function(t){var e,i,n=t.length;if(n<2)return!1;for(i=t[0],e=1;e<n;++e)if(t[e]-t[e-1]!==i)return!1;return i}(t),u=(e.length-1)/n;if(!l)return Math.max(u,1);for(a=0,s=(o=B.math._factorize(l)).length-1;a<s;a++)if((r=o[a])>u)return r;return Math.max(u,1)}(l,t,0,s),u>0){for(e=0,i=u-1;e<i;e++)di(t,n,l[e],l[e+1]);return o=u>1?(h-c)/(u-1):null,di(t,n,B.isNullOrUndef(o)?0:c-o,c),di(t,n,h,B.isNullOrUndef(o)?t.length:h+o),hi(t)}return di(t,n),hi(t)},_tickSize:function(){var t=this.options.ticks,e=B.toRadians(this.labelRotation),i=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),o=this._getLabelSizes(),r=t.autoSkipPadding||0,a=o?o.widest.width+r:0,s=o?o.highest.height+r:0;return this.isHorizontal()?s*i>a*n?a/i:s/n:s*n<a*i?s/i:a/n},_isVisible:function(){var t,e,i,n=this.chart,o=this.options.display;if("auto"!==o)return!!o;for(t=0,e=n.data.datasets.length;t<e;++t)if(n.isDatasetVisible(t)&&((i=n.getDatasetMeta(t)).xAxisID===this.id||i.yAxisID===this.id))return!0;return!1},_computeGridLineItems:function(t){var e,i,n,o,r,a,s,l,u,c,h,d,p,f,g,m,v,y=this,b=y.chart,w=y.options,_=w.gridLines,x=w.position,C=_.offsetGridLines,E=y.isHorizontal(),k=y._ticksToDraw,S=k.length+(C?1:0),M=si(_),T=[],R=_.drawBorder?oi(_.lineWidth,0,0):0,P=R/2,D=B._alignPixel,L=function(t){return D(b,t,R)};for("top"===x?(e=L(y.bottom),s=y.bottom-M,u=e-P,h=L(t.top)+P,p=t.bottom):"bottom"===x?(e=L(y.top),h=t.top,p=L(t.bottom)-P,s=e+P,u=y.top+M):"left"===x?(e=L(y.right),a=y.right-M,l=e-P,c=L(t.left)+P,d=t.right):(e=L(y.left),c=t.left,d=L(t.right)-P,a=e+P,l=y.left+M),i=0;i<S;++i)n=k[i]||{},ii(n.label)&&i<k.length||(i===y.zeroLineIndex&&w.offset===C?(f=_.zeroLineWidth,g=_.zeroLineColor,m=_.zeroLineBorderDash||[],v=_.zeroLineBorderDashOffset||0):(f=oi(_.lineWidth,i,1),g=oi(_.color,i,"rgba(0,0,0,0.1)"),m=_.borderDash||[],v=_.borderDashOffset||0),void 0!==(o=ri(y,n._index||i,C))&&(r=D(b,o,f),E?a=l=c=d=r:s=u=h=p=r,T.push({tx1:a,ty1:s,tx2:l,ty2:u,x1:c,y1:h,x2:d,y2:p,width:f,color:g,borderDash:m,borderDashOffset:v})));return T.ticksLength=S,T.borderValue=e,T},_computeLabelItems:function(){var t,e,i,n,o,r,a,s,l,u,c,h,d=this,p=d.options,f=p.ticks,g=p.position,m=f.mirror,v=d.isHorizontal(),y=d._ticksToDraw,b=ci(f),w=f.padding,_=si(p.gridLines),x=-B.toRadians(d.labelRotation),C=[];for("top"===g?(r=d.bottom-_-w,a=x?"left":"center"):"bottom"===g?(r=d.top+_+w,a=x?"right":"center"):"left"===g?(o=d.right-(m?0:_)-w,a=m?"left":"right"):(o=d.left+(m?0:_)+w,a=m?"right":"left"),t=0,e=y.length;t<e;++t)n=(i=y[t]).label,ii(n)||(s=d.getPixelForTick(i._index||t)+f.labelOffset,u=(l=i.major?b.major:b.minor).lineHeight,c=ei(n)?n.length:1,v?(o=s,h="top"===g?((x?1:.5)-c)*u:(x?0:.5)*u):(r=s,h=(1-c)*u/2),C.push({x:o,y:r,rotation:x,label:n,font:l,textOffset:h,textAlign:a}));return C},_drawGrid:function(t){var e=this,i=e.options.gridLines;if(i.display){var n,o,r,a,s,l=e.ctx,u=e.chart,c=B._alignPixel,h=i.drawBorder?oi(i.lineWidth,0,0):0,d=e._gridLineItems||(e._gridLineItems=e._computeGridLineItems(t));for(r=0,a=d.length;r<a;++r)n=(s=d[r]).width,o=s.color,n&&o&&(l.save(),l.lineWidth=n,l.strokeStyle=o,l.setLineDash&&(l.setLineDash(s.borderDash),l.lineDashOffset=s.borderDashOffset),l.beginPath(),i.drawTicks&&(l.moveTo(s.tx1,s.ty1),l.lineTo(s.tx2,s.ty2)),i.drawOnChartArea&&(l.moveTo(s.x1,s.y1),l.lineTo(s.x2,s.y2)),l.stroke(),l.restore());if(h){var p,f,g,m,v=h,y=oi(i.lineWidth,d.ticksLength-1,1),b=d.borderValue;e.isHorizontal()?(p=c(u,e.left,v)-v/2,f=c(u,e.right,y)+y/2,g=m=b):(g=c(u,e.top,v)-v/2,m=c(u,e.bottom,y)+y/2,p=f=b),l.lineWidth=h,l.strokeStyle=oi(i.color,0),l.beginPath(),l.moveTo(p,g),l.lineTo(f,m),l.stroke()}}},_drawLabels:function(){var t=this;if(t.options.ticks.display){var e,i,n,o,r,a,s,l,u=t.ctx,c=t._labelItems||(t._labelItems=t._computeLabelItems());for(e=0,n=c.length;e<n;++e){if(a=(r=c[e]).font,u.save(),u.translate(r.x,r.y),u.rotate(r.rotation),u.font=a.string,u.fillStyle=a.color,u.textBaseline="middle",u.textAlign=r.textAlign,s=r.label,l=r.textOffset,ei(s))for(i=0,o=s.length;i<o;++i)u.fillText(""+s[i],0,l),l+=a.lineHeight;else u.fillText(s,0,l);u.restore()}}},_drawTitle:function(){var t=this,e=t.ctx,i=t.options,n=i.scaleLabel;if(n.display){var o,r,a=ni(n.fontColor,I.global.defaultFontColor),s=B.options._parseFont(n),l=B.options.toPadding(n.padding),u=s.lineHeight/2,c=i.position,h=0;if(t.isHorizontal())o=t.left+t.width/2,r="bottom"===c?t.bottom-u-l.bottom:t.top+u+l.top;else{var d="left"===c;o=d?t.left+u+l.top:t.right-u-l.top,r=t.top+t.height/2,h=d?-.5*Math.PI:.5*Math.PI}e.save(),e.translate(o,r),e.rotate(h),e.textAlign="center",e.textBaseline="middle",e.fillStyle=a,e.font=s.string,e.fillText(n.labelString,0,0),e.restore()}},draw:function(t){this._isVisible()&&(this._drawGrid(t),this._drawTitle(),this._drawLabels())},_layers:function(){var t=this,e=t.options,i=e.ticks&&e.ticks.z||0,n=e.gridLines&&e.gridLines.z||0;return t._isVisible()&&i!==n&&t.draw===t._draw?[{z:n,draw:function(){t._drawGrid.apply(t,arguments),t._drawTitle.apply(t,arguments)}},{z:i,draw:function(){t._drawLabels.apply(t,arguments)}}]:[{z:i,draw:function(){t.draw.apply(t,arguments)}}]},_getMatchingVisibleMetas:function(t){var e=this,i=e.isHorizontal();return e.chart._getSortedVisibleDatasetMetas().filter((function(n){return(!t||n.type===t)&&(i?n.xAxisID===e.id:n.yAxisID===e.id)}))}});pi.prototype._draw=pi.prototype.draw;var fi=pi,gi=B.isNullOrUndef,mi=fi.extend({determineDataLimits:function(){var t,e=this,i=e._getLabels(),n=e.options.ticks,o=n.min,r=n.max,a=0,s=i.length-1;void 0!==o&&(t=i.indexOf(o))>=0&&(a=t),void 0!==r&&(t=i.indexOf(r))>=0&&(s=t),e.minIndex=a,e.maxIndex=s,e.min=i[a],e.max=i[s]},buildTicks:function(){var t=this._getLabels(),e=this.minIndex,i=this.maxIndex;this.ticks=0===e&&i===t.length-1?t:t.slice(e,i+1)},getLabelForIndex:function(t,e){var i=this.chart;return i.getDatasetMeta(e).controller._getValueScaleId()===this.id?this.getRightValue(i.data.datasets[e].data[t]):this._getLabels()[t]},_configure:function(){var t=this,e=t.options.offset,i=t.ticks;fi.prototype._configure.call(t),t.isHorizontal()||(t._reversePixels=!t._reversePixels),i&&(t._startValue=t.minIndex-(e?.5:0),t._valueRange=Math.max(i.length-(e?0:1),1))},getPixelForValue:function(t,e,i){var n,o,r,a=this;return gi(e)||gi(i)||(t=a.chart.data.datasets[i].data[e]),gi(t)||(n=a.isHorizontal()?t.x:t.y),(void 0!==n||void 0!==t&&isNaN(e))&&(o=a._getLabels(),t=B.valueOrDefault(n,t),e=-1!==(r=o.indexOf(t))?r:e,isNaN(e)&&(e=t)),a.getPixelForDecimal((e-a._startValue)/a._valueRange)},getPixelForTick:function(t){var e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t],t+this.minIndex)},getValueForPixel:function(t){var e=Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange);return Math.min(Math.max(e,0),this.ticks.length-1)},getBasePixel:function(){return this.bottom}}),vi={position:"bottom"};mi._defaults=vi;var yi=B.noop,bi=B.isNullOrUndef,wi=fi.extend({getRightValue:function(t){return"string"==typeof t?+t:fi.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var i=B.sign(t.min),n=B.sign(t.max);i<0&&n<0?t.max=0:i>0&&n>0&&(t.min=0)}var o=void 0!==e.min||void 0!==e.suggestedMin,r=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),o!==r&&t.min>=t.max&&(o?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:function(){var t,e=this.options.ticks,i=e.stepSize,n=e.maxTicksLimit;return i?t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1:(t=this._computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:yi,buildTicks:function(){var t=this,e=t.options.ticks,i=t.getTickLimit(),n={maxTicks:i=Math.max(2,i),min:e.min,max:e.max,precision:e.precision,stepSize:B.valueOrDefault(e.fixedStepSize,e.stepSize)},o=t.ticks=function(t,e){var i,n,o,r,a=[],s=t.stepSize,l=s||1,u=t.maxTicks-1,c=t.min,h=t.max,d=t.precision,p=e.min,f=e.max,g=B.niceNum((f-p)/u/l)*l;if(g<1e-14&&bi(c)&&bi(h))return[p,f];(r=Math.ceil(f/g)-Math.floor(p/g))>u&&(g=B.niceNum(r*g/u/l)*l),s||bi(d)?i=Math.pow(10,B._decimalPlaces(g)):(i=Math.pow(10,d),g=Math.ceil(g*i)/i),n=Math.floor(p/g)*g,o=Math.ceil(f/g)*g,s&&(!bi(c)&&B.almostWhole(c/g,g/1e3)&&(n=c),!bi(h)&&B.almostWhole(h/g,g/1e3)&&(o=h)),r=(o-n)/g,r=B.almostEquals(r,Math.round(r),g/1e3)?Math.round(r):Math.ceil(r),n=Math.round(n*i)/i,o=Math.round(o*i)/i,a.push(bi(c)?n:c);for(var m=1;m<r;++m)a.push(Math.round((n+m*g)*i)/i);return a.push(bi(h)?o:h),a}(n,t);t.handleDirectionalChanges(),t.max=B.max(o),t.min=B.min(o),e.reverse?(o.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),fi.prototype.convertTicksToLabels.call(t)},_configure:function(){var t,e=this,i=e.getTicks(),n=e.min,o=e.max;fi.prototype._configure.call(e),e.options.offset&&i.length&&(n-=t=(o-n)/Math.max(i.length-1,1)/2,o+=t),e._startValue=n,e._endValue=o,e._valueRange=o-n}}),_i={position:"left",ticks:{callback:ti.formatters.linear}};function xi(t,e,i,n){var o,r,a=t.options,s=function(t,e,i){var n=[i.type,void 0===e&&void 0===i.stack?i.index:"",i.stack].join(".");return void 0===t[n]&&(t[n]={pos:[],neg:[]}),t[n]}(e,a.stacked,i),l=s.pos,u=s.neg,c=n.length;for(o=0;o<c;++o)r=t._parseValue(n[o]),isNaN(r.min)||isNaN(r.max)||i.data[o].hidden||(l[o]=l[o]||0,u[o]=u[o]||0,a.relativePoints?l[o]=100:r.min<0||r.max<0?u[o]+=r.min:l[o]+=r.max)}function Ci(t,e,i){var n,o,r=i.length;for(n=0;n<r;++n)o=t._parseValue(i[n]),isNaN(o.min)||isNaN(o.max)||e.data[n].hidden||(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}var Ei=wi.extend({determineDataLimits:function(){var t,e,i,n,o=this,r=o.options,a=o.chart.data.datasets,s=o._getMatchingVisibleMetas(),l=r.stacked,u={},c=s.length;if(o.min=Number.POSITIVE_INFINITY,o.max=Number.NEGATIVE_INFINITY,void 0===l)for(t=0;!l&&t<c;++t)l=void 0!==(e=s[t]).stack;for(t=0;t<c;++t)i=a[(e=s[t]).index].data,l?xi(o,u,e,i):Ci(o,e,i);B.each(u,(function(t){n=t.pos.concat(t.neg),o.min=Math.min(o.min,B.min(n)),o.max=Math.max(o.max,B.max(n))})),o.min=B.isFinite(o.min)&&!isNaN(o.min)?o.min:0,o.max=B.isFinite(o.max)&&!isNaN(o.max)?o.max:1,o.handleTickRangeOptions()},_computeTickLimit:function(){var t;return this.isHorizontal()?Math.ceil(this.width/40):(t=B.options._parseFont(this.options.ticks),Math.ceil(this.height/t.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return this._getScaleLabel(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){return this.getPixelForDecimal((+this.getRightValue(t)-this._startValue)/this._valueRange)},getValueForPixel:function(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange},getPixelForTick:function(t){var e=this.ticksAsNumbers;return t<0||t>e.length-1?null:this.getPixelForValue(e[t])}}),ki=_i;Ei._defaults=ki;var Si=B.valueOrDefault,Mi=B.math.log10,Ti={position:"left",ticks:{callback:ti.formatters.logarithmic}};function Ri(t,e){return B.isFinite(t)&&t>=0?t:e}var Pi=fi.extend({determineDataLimits:function(){var t,e,i,n,o,r,a=this,s=a.options,l=a.chart,u=l.data.datasets,c=a.isHorizontal();function h(t){return c?t.xAxisID===a.id:t.yAxisID===a.id}a.min=Number.POSITIVE_INFINITY,a.max=Number.NEGATIVE_INFINITY,a.minNotZero=Number.POSITIVE_INFINITY;var d=s.stacked;if(void 0===d)for(t=0;t<u.length;t++)if(e=l.getDatasetMeta(t),l.isDatasetVisible(t)&&h(e)&&void 0!==e.stack){d=!0;break}if(s.stacked||d){var p={};for(t=0;t<u.length;t++){var f=[(e=l.getDatasetMeta(t)).type,void 0===s.stacked&&void 0===e.stack?t:"",e.stack].join(".");if(l.isDatasetVisible(t)&&h(e))for(void 0===p[f]&&(p[f]=[]),o=0,r=(n=u[t].data).length;o<r;o++){var g=p[f];i=a._parseValue(n[o]),isNaN(i.min)||isNaN(i.max)||e.data[o].hidden||i.min<0||i.max<0||(g[o]=g[o]||0,g[o]+=i.max)}}B.each(p,(function(t){if(t.length>0){var e=B.min(t),i=B.max(t);a.min=Math.min(a.min,e),a.max=Math.max(a.max,i)}}))}else for(t=0;t<u.length;t++)if(e=l.getDatasetMeta(t),l.isDatasetVisible(t)&&h(e))for(o=0,r=(n=u[t].data).length;o<r;o++)i=a._parseValue(n[o]),isNaN(i.min)||isNaN(i.max)||e.data[o].hidden||i.min<0||i.max<0||(a.min=Math.min(i.min,a.min),a.max=Math.max(i.max,a.max),0!==i.min&&(a.minNotZero=Math.min(i.min,a.minNotZero)));a.min=B.isFinite(a.min)?a.min:null,a.max=B.isFinite(a.max)?a.max:null,a.minNotZero=B.isFinite(a.minNotZero)?a.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;t.min=Ri(e.min,t.min),t.max=Ri(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(Mi(t.min))-1),t.max=Math.pow(10,Math.floor(Mi(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(Mi(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(Mi(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(Mi(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,i=!t.isHorizontal(),n={min:Ri(e.min),max:Ri(e.max)},o=t.ticks=function(t,e){var i,n,o=[],r=Si(t.min,Math.pow(10,Math.floor(Mi(e.min)))),a=Math.floor(Mi(e.max)),s=Math.ceil(e.max/Math.pow(10,a));0===r?(i=Math.floor(Mi(e.minNotZero)),n=Math.floor(e.minNotZero/Math.pow(10,i)),o.push(r),r=n*Math.pow(10,i)):(i=Math.floor(Mi(r)),n=Math.floor(r/Math.pow(10,i)));var l=i<0?Math.pow(10,Math.abs(i)):1;do{o.push(r),10==++n&&(n=1,l=++i>=0?1:l),r=Math.round(n*Math.pow(10,i)*l)/l}while(i<a||i===a&&n<s);var u=Si(t.max,r);return o.push(u),o}(n,t);t.max=B.max(o),t.min=B.min(o),e.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&o.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),fi.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return this._getScaleLabel(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){var e=this.tickValues;return t<0||t>e.length-1?null:this.getPixelForValue(e[t])},_getFirstTickValue:function(t){var e=Math.floor(Mi(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},_configure:function(){var t=this,e=t.min,i=0;fi.prototype._configure.call(t),0===e&&(e=t._getFirstTickValue(t.minNotZero),i=Si(t.options.ticks.fontSize,I.global.defaultFontSize)/t._length),t._startValue=Mi(e),t._valueOffset=i,t._valueRange=(Mi(t.max)-Mi(e))/(1-i)},getPixelForValue:function(t){var e=this,i=0;return(t=+e.getRightValue(t))>e.min&&t>0&&(i=(Mi(t)-e._startValue)/e._valueRange+e._valueOffset),e.getPixelForDecimal(i)},getValueForPixel:function(t){var e=this,i=e.getDecimalForPixel(t);return 0===i&&0===e.min?0:Math.pow(10,e._startValue+(i-e._valueOffset)*e._valueRange)}}),Di=Ti;Pi._defaults=Di;var Li=B.valueOrDefault,Fi=B.valueAtIndexOrDefault,Oi=B.options.resolve,Ai={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:ti.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function Ii(t){var e=t.ticks;return e.display&&t.display?Li(e.fontSize,I.global.defaultFontSize)+2*e.backdropPaddingY:0}function ji(t,e,i,n,o){return t===n||t===o?{start:e-i/2,end:e+i/2}:t<n||t>o?{start:e-i,end:e}:{start:e,end:e+i}}function zi(t){return 0===t||180===t?"center":t<180?"left":"right"}function Ni(t,e,i,n){var o,r,a=i.y+n/2;if(B.isArray(e))for(o=0,r=e.length;o<r;++o)t.fillText(e[o],i.x,a),a+=n;else t.fillText(e,i.x,a)}function Hi(t,e,i){90===t||270===t?i.y-=e.h/2:(t>270||t<90)&&(i.y-=e.h)}function Bi(t){return B.isNumber(t)?t:0}var Gi=wi.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=Ii(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;B.each(e.data.datasets,(function(o,r){if(e.isDatasetVisible(r)){var a=e.getDatasetMeta(r);B.each(o.data,(function(e,o){var r=+t.getRightValue(e);isNaN(r)||a.data[o].hidden||(i=Math.min(r,i),n=Math.max(r,n))}))}})),t.min=i===Number.POSITIVE_INFINITY?0:i,t.max=n===Number.NEGATIVE_INFINITY?0:n,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/Ii(this.options))},convertTicksToLabels:function(){var t=this;wi.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map((function(){var e=B.callback(t.options.pointLabels.callback,arguments,t);return e||0===e?e:""}))},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,o=B.options._parseFont(t.options.pointLabels),r={l:0,r:t.width,t:0,b:t.height-t.paddingTop},a={};t.ctx.font=o.string,t._pointLabelSizes=[];var s,l,u,c=t.chart.data.labels.length;for(e=0;e<c;e++){n=t.getPointPosition(e,t.drawingArea+5),s=t.ctx,l=o.lineHeight,u=t.pointLabels[e],i=B.isArray(u)?{w:B.longestText(s,s.font,u),h:u.length*l}:{w:s.measureText(u).width,h:l},t._pointLabelSizes[e]=i;var h=t.getIndexAngle(e),d=B.toDegrees(h)%360,p=ji(d,n.x,i.w,0,180),f=ji(d,n.y,i.h,90,270);p.start<r.l&&(r.l=p.start,a.l=h),p.end>r.r&&(r.r=p.end,a.r=h),f.start<r.t&&(r.t=f.start,a.t=h),f.end>r.b&&(r.b=f.end,a.b=h)}t.setReductions(t.drawingArea,r,a)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=this,o=e.l/Math.sin(i.l),r=Math.max(e.r-n.width,0)/Math.sin(i.r),a=-e.t/Math.cos(i.t),s=-Math.max(e.b-(n.height-n.paddingTop),0)/Math.cos(i.b);o=Bi(o),r=Bi(r),a=Bi(a),s=Bi(s),n.drawingArea=Math.min(Math.floor(t-(o+r)/2),Math.floor(t-(a+s)/2)),n.setCenterPoint(o,r,a,s)},setCenterPoint:function(t,e,i,n){var o=this,r=o.width-e-o.drawingArea,a=t+o.drawingArea,s=i+o.drawingArea,l=o.height-o.paddingTop-n-o.drawingArea;o.xCenter=Math.floor((a+r)/2+o.left),o.yCenter=Math.floor((s+l)/2+o.top+o.paddingTop)},getIndexAngle:function(t){var e=this.chart,i=(t*(360/e.data.labels.length)+((e.options||{}).startAngle||0))%360;return(i<0?i+360:i)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(B.isNullOrUndef(t))return NaN;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(t){var e=this.min,i=this.max;return this.getPointPositionForValue(t||0,this.beginAtZero?0:e<0&&i<0?i:e>0&&i>0?e:0)},_drawGrid:function(){var t,e,i,n=this,o=n.ctx,r=n.options,a=r.gridLines,s=r.angleLines,l=Li(s.lineWidth,a.lineWidth),u=Li(s.color,a.color);if(r.pointLabels.display&&function(t){var e=t.ctx,i=t.options,n=i.pointLabels,o=Ii(i),r=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),a=B.options._parseFont(n);e.save(),e.font=a.string,e.textBaseline="middle";for(var s=t.chart.data.labels.length-1;s>=0;s--){var l=0===s?o/2:0,u=t.getPointPosition(s,r+l+5),c=Fi(n.fontColor,s,I.global.defaultFontColor);e.fillStyle=c;var h=t.getIndexAngle(s),d=B.toDegrees(h);e.textAlign=zi(d),Hi(d,t._pointLabelSizes[s],u),Ni(e,t.pointLabels[s],u,a.lineHeight)}e.restore()}(n),a.display&&B.each(n.ticks,(function(t,i){0!==i&&(e=n.getDistanceFromCenterForValue(n.ticksAsNumbers[i]),function(t,e,i,n){var o,r=t.ctx,a=e.circular,s=t.chart.data.labels.length,l=Fi(e.color,n-1),u=Fi(e.lineWidth,n-1);if((a||s)&&l&&u){if(r.save(),r.strokeStyle=l,r.lineWidth=u,r.setLineDash&&(r.setLineDash(e.borderDash||[]),r.lineDashOffset=e.borderDashOffset||0),r.beginPath(),a)r.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{o=t.getPointPosition(0,i),r.moveTo(o.x,o.y);for(var c=1;c<s;c++)o=t.getPointPosition(c,i),r.lineTo(o.x,o.y)}r.closePath(),r.stroke(),r.restore()}}(n,a,e,i))})),s.display&&l&&u){for(o.save(),o.lineWidth=l,o.strokeStyle=u,o.setLineDash&&(o.setLineDash(Oi([s.borderDash,a.borderDash,[]])),o.lineDashOffset=Oi([s.borderDashOffset,a.borderDashOffset,0])),t=n.chart.data.labels.length-1;t>=0;t--)e=n.getDistanceFromCenterForValue(r.ticks.reverse?n.min:n.max),i=n.getPointPosition(t,e),o.beginPath(),o.moveTo(n.xCenter,n.yCenter),o.lineTo(i.x,i.y),o.stroke();o.restore()}},_drawLabels:function(){var t=this,e=t.ctx,i=t.options.ticks;if(i.display){var n,o,r=t.getIndexAngle(0),a=B.options._parseFont(i),s=Li(i.fontColor,I.global.defaultFontColor);e.save(),e.font=a.string,e.translate(t.xCenter,t.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",B.each(t.ticks,(function(r,l){(0!==l||i.reverse)&&(n=t.getDistanceFromCenterForValue(t.ticksAsNumbers[l]),i.showLabelBackdrop&&(o=e.measureText(r).width,e.fillStyle=i.backdropColor,e.fillRect(-o/2-i.backdropPaddingX,-n-a.size/2-i.backdropPaddingY,o+2*i.backdropPaddingX,a.size+2*i.backdropPaddingY)),e.fillStyle=s,e.fillText(r,0,-n))})),e.restore()}},_drawTitle:B.noop}),Vi=Ai;Gi._defaults=Vi;var Wi=B._deprecated,qi=B.options.resolve,$i=B.valueOrDefault,Yi=Number.MIN_SAFE_INTEGER||-9007199254740991,Xi=Number.MAX_SAFE_INTEGER||9007199254740991,Ui={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ki=Object.keys(Ui);function Zi(t,e){return t-e}function Ji(t){return B.valueOrDefault(t.time.min,t.ticks.min)}function Qi(t){return B.valueOrDefault(t.time.max,t.ticks.max)}function tn(t,e,i,n){var o=function(t,e,i){for(var n,o,r,a=0,s=t.length-1;a>=0&&a<=s;){if(o=t[(n=a+s>>1)-1]||null,r=t[n],!o)return{lo:null,hi:r};if(r[e]<i)a=n+1;else{if(!(o[e]>i))return{lo:o,hi:r};s=n-1}}return{lo:r,hi:null}}(t,e,i),r=o.lo?o.hi?o.lo:t[t.length-2]:t[0],a=o.lo?o.hi?o.hi:t[t.length-1]:t[1],s=a[e]-r[e],l=s?(i-r[e])/s:0,u=(a[n]-r[n])*l;return r[n]+u}function en(t,e){var i=t._adapter,n=t.options.time,o=n.parser,r=o||n.format,a=e;return"function"==typeof o&&(a=o(a)),B.isFinite(a)||(a="string"==typeof r?i.parse(a,r):i.parse(a)),null!==a?+a:(o||"function"!=typeof r||(a=r(e),B.isFinite(a)||(a=i.parse(a))),a)}function nn(t,e){if(B.isNullOrUndef(e))return null;var i=t.options.time,n=en(t,t.getRightValue(e));return null===n||i.round&&(n=+t._adapter.startOf(n,i.round)),n}function on(t,e,i,n){var o,r,a,s=Ki.length;for(o=Ki.indexOf(t);o<s-1;++o)if(a=(r=Ui[Ki[o]]).steps?r.steps:Xi,r.common&&Math.ceil((i-e)/(a*r.size))<=n)return Ki[o];return Ki[s-1]}function rn(t,e,i){var n,o,r=[],a={},s=e.length;for(n=0;n<s;++n)a[o=e[n]]=n,r.push({value:o,major:!1});return 0!==s&&i?function(t,e,i,n){var o,r,a=t._adapter,s=+a.startOf(e[0].value,n),l=e[e.length-1].value;for(o=s;o<=l;o=+a.add(o,1,n))(r=i[o])>=0&&(e[r].major=!0);return e}(t,r,a,i):r}var an=fi.extend({initialize:function(){this.mergeTicksOptions(),fi.prototype.initialize.call(this)},update:function(){var t=this,e=t.options,i=e.time||(e.time={}),n=t._adapter=new Qe._date(e.adapters.date);return Wi("time scale",i.format,"time.format","time.parser"),Wi("time scale",i.min,"time.min","ticks.min"),Wi("time scale",i.max,"time.max","ticks.max"),B.mergeIf(i.displayFormats,n.formats()),fi.prototype.update.apply(t,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),fi.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,i,n,o,r,a,s=this,l=s.chart,u=s._adapter,c=s.options,h=c.time.unit||"day",d=Xi,p=Yi,f=[],g=[],m=[],v=s._getLabels();for(t=0,i=v.length;t<i;++t)m.push(nn(s,v[t]));for(t=0,i=(l.data.datasets||[]).length;t<i;++t)if(l.isDatasetVisible(t))if(o=l.data.datasets[t].data,B.isObject(o[0]))for(g[t]=[],e=0,n=o.length;e<n;++e)r=nn(s,o[e]),f.push(r),g[t][e]=r;else g[t]=m.slice(0),a||(f=f.concat(m),a=!0);else g[t]=[];m.length&&(d=Math.min(d,m[0]),p=Math.max(p,m[m.length-1])),f.length&&(f=i>1?function(t){var e,i,n,o={},r=[];for(e=0,i=t.length;e<i;++e)o[n=t[e]]||(o[n]=!0,r.push(n));return r}(f).sort(Zi):f.sort(Zi),d=Math.min(d,f[0]),p=Math.max(p,f[f.length-1])),d=nn(s,Ji(c))||d,p=nn(s,Qi(c))||p,d=d===Xi?+u.startOf(Date.now(),h):d,p=p===Yi?+u.endOf(Date.now(),h)+1:p,s.min=Math.min(d,p),s.max=Math.max(d+1,p),s._table=[],s._timestamps={data:f,datasets:g,labels:m}},buildTicks:function(){var t,e,i,n=this,o=n.min,r=n.max,a=n.options,s=a.ticks,l=a.time,u=n._timestamps,c=[],h=n.getLabelCapacity(o),d=s.source,p=a.distribution;for(u="data"===d||"auto"===d&&"series"===p?u.data:"labels"===d?u.labels:function(t,e,i,n){var o,r=t._adapter,a=t.options,s=a.time,l=s.unit||on(s.minUnit,e,i,n),u=qi([s.stepSize,s.unitStepSize,1]),c="week"===l&&s.isoWeekday,h=e,d=[];if(c&&(h=+r.startOf(h,"isoWeek",c)),h=+r.startOf(h,c?"day":l),r.diff(i,e,l)>1e5*u)throw e+" and "+i+" are too far apart with stepSize of "+u+" "+l;for(o=h;o<i;o=+r.add(o,u,l))d.push(o);return o!==i&&"ticks"!==a.bounds||d.push(o),d}(n,o,r,h),"ticks"===a.bounds&&u.length&&(o=u[0],r=u[u.length-1]),o=nn(n,Ji(a))||o,r=nn(n,Qi(a))||r,t=0,e=u.length;t<e;++t)(i=u[t])>=o&&i<=r&&c.push(i);return n.min=o,n.max=r,n._unit=l.unit||(s.autoSkip?on(l.minUnit,n.min,n.max,h):function(t,e,i,n,o){var r,a;for(r=Ki.length-1;r>=Ki.indexOf(i);r--)if(a=Ki[r],Ui[a].common&&t._adapter.diff(o,n,a)>=e-1)return a;return Ki[i?Ki.indexOf(i):0]}(n,c.length,l.minUnit,n.min,n.max)),n._majorUnit=s.major.enabled&&"year"!==n._unit?function(t){for(var e=Ki.indexOf(t)+1,i=Ki.length;e<i;++e)if(Ui[Ki[e]].common)return Ki[e]}(n._unit):void 0,n._table=function(t,e,i,n){if("linear"===n||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var o,r,a,s,l,u=[],c=[e];for(o=0,r=t.length;o<r;++o)(s=t[o])>e&&s<i&&c.push(s);for(c.push(i),o=0,r=c.length;o<r;++o)l=c[o+1],a=c[o-1],s=c[o],void 0!==a&&void 0!==l&&Math.round((l+a)/2)===s||u.push({time:s,pos:o/(r-1)});return u}(n._timestamps.data,o,r,p),n._offsets=function(t,e,i,n,o){var r,a,s=0,l=0;return o.offset&&e.length&&(r=tn(t,"time",e[0],"pos"),s=1===e.length?1-r:(tn(t,"time",e[1],"pos")-r)/2,a=tn(t,"time",e[e.length-1],"pos"),l=1===e.length?a:(a-tn(t,"time",e[e.length-2],"pos"))/2),{start:s,end:l,factor:1/(s+1+l)}}(n._table,c,0,0,a),s.reverse&&c.reverse(),rn(n,c,n._majorUnit)},getLabelForIndex:function(t,e){var i=this,n=i._adapter,o=i.chart.data,r=i.options.time,a=o.labels&&t<o.labels.length?o.labels[t]:"",s=o.datasets[e].data[t];return B.isObject(s)&&(a=i.getRightValue(s)),r.tooltipFormat?n.format(en(i,a),r.tooltipFormat):"string"==typeof a?a:n.format(en(i,a),r.displayFormats.datetime)},tickFormatFunction:function(t,e,i,n){var o=this._adapter,r=this.options,a=r.time.displayFormats,s=a[this._unit],l=this._majorUnit,u=a[l],c=i[e],h=r.ticks,d=l&&u&&c&&c.major,p=o.format(t,n||(d?u:s)),f=d?h.major:h.minor,g=qi([f.callback,f.userCallback,h.callback,h.userCallback]);return g?g(p,e,i):p},convertTicksToLabels:function(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(this.tickFormatFunction(t[e].value,e,t));return n},getPixelForOffset:function(t){var e=this._offsets,i=tn(this._table,"time",t,"pos");return this.getPixelForDecimal((e.start+i)*e.factor)},getPixelForValue:function(t,e,i){var n=null;if(void 0!==e&&void 0!==i&&(n=this._timestamps.datasets[i][e]),null===n&&(n=nn(this,t)),null!==n)return this.getPixelForOffset(n)},getPixelForTick:function(t){var e=this.getTicks();return t>=0&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end,n=tn(this._table,"pos",i,"time");return this._adapter._create(n)},_getLabelSize:function(t){var e=this.options.ticks,i=this.ctx.measureText(t).width,n=B.toRadians(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(n),r=Math.sin(n),a=$i(e.fontSize,I.global.defaultFontSize);return{w:i*o+a*r,h:i*r+a*o}},getLabelWidth:function(t){return this._getLabelSize(t).w},getLabelCapacity:function(t){var e=this,i=e.options.time,n=i.displayFormats,o=n[i.unit]||n.millisecond,r=e.tickFormatFunction(t,0,rn(e,[t],e._majorUnit),o),a=e._getLabelSize(r),s=Math.floor(e.isHorizontal()?e.width/a.w:e.height/a.h);return e.options.offset&&s--,s>0?s:1}}),sn={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};an._defaults=sn;var ln={category:mi,linear:Ei,logarithmic:Pi,radialLinear:Gi,time:an},un={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};Qe._date.override("function"==typeof t?{_id:"moment",formats:function(){return un},parse:function(e,i){return"string"==typeof e&&"string"==typeof i?e=t(e,i):e instanceof t||(e=t(e)),e.isValid()?e.valueOf():null},format:function(e,i){return t(e).format(i)},add:function(e,i,n){return t(e).add(i,n).valueOf()},diff:function(e,i,n){return t(e).diff(t(i),n)},startOf:function(e,i,n){return e=t(e),"isoWeek"===i?e.isoWeekday(n).valueOf():e.startOf(i).valueOf()},endOf:function(e,i){return t(e).endOf(i).valueOf()},_create:function(e){return t(e)}}:{}),I._set("global",{plugins:{filler:{propagate:!0}}});var cn={dataset:function(t){var e=t.fill,i=t.chart,n=i.getDatasetMeta(e),o=n&&i.isDatasetVisible(e)&&n.dataset._children||[],r=o.length||0;return r?function(t,e){return e<r&&o[e]._view||null}:null},boundary:function(t){var e=t.boundary,i=e?e.x:null,n=e?e.y:null;return B.isArray(e)?function(t,i){return e[i]}:function(t){return{x:null===i?t.x:i,y:null===n?t.y:n}}}};function hn(t,e,i){var n,o=t._model||{},r=o.fill;if(void 0===r&&(r=!!o.backgroundColor),!1===r||null===r)return!1;if(!0===r)return"origin";if(n=parseFloat(r,10),isFinite(n)&&Math.floor(n)===n)return"-"!==r[0]&&"+"!==r[0]||(n=e+n),!(n===e||n<0||n>=i)&&n;switch(r){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return r;default:return!1}}function dn(t){return(t.el._scale||{}).getPointPositionForValue?function(t){var e,i,n,o,r,a=t.el._scale,s=a.options,l=a.chart.data.labels.length,u=t.fill,c=[];if(!l)return null;for(e=s.ticks.reverse?a.max:a.min,i=s.ticks.reverse?a.min:a.max,n=a.getPointPositionForValue(0,e),o=0;o<l;++o)r="start"===u||"end"===u?a.getPointPositionForValue(o,"start"===u?e:i):a.getBasePosition(o),s.gridLines.circular&&(r.cx=n.x,r.cy=n.y,r.angle=a.getIndexAngle(o)-Math.PI/2),c.push(r);return c}(t):function(t){var e,i=t.el._model||{},n=t.el._scale||{},o=t.fill,r=null;if(isFinite(o))return null;if("start"===o?r=void 0===i.scaleBottom?n.bottom:i.scaleBottom:"end"===o?r=void 0===i.scaleTop?n.top:i.scaleTop:void 0!==i.scaleZero?r=i.scaleZero:n.getBasePixel&&(r=n.getBasePixel()),null!=r){if(void 0!==r.x&&void 0!==r.y)return r;if(B.isFinite(r))return{x:(e=n.isHorizontal())?r:null,y:e?null:r}}return null}(t)}function pn(t,e,i){var n,o=t[e].fill,r=[e];if(!i)return o;for(;!1!==o&&-1===r.indexOf(o);){if(!isFinite(o))return o;if(!(n=t[o]))return!1;if(n.visible)return o;r.push(o),o=n.fill}return!1}function fn(t){var e=t.fill,i="dataset";return!1===e?null:(isFinite(e)||(i="boundary"),cn[i](t))}function gn(t){return t&&!t.skip}function mn(t,e,i,n,o){var r,a,s,l;if(n&&o){for(t.moveTo(e[0].x,e[0].y),r=1;r<n;++r)B.canvas.lineTo(t,e[r-1],e[r]);if(void 0===i[0].angle)for(t.lineTo(i[o-1].x,i[o-1].y),r=o-1;r>0;--r)B.canvas.lineTo(t,i[r],i[r-1],!0);else for(a=i[0].cx,s=i[0].cy,l=Math.sqrt(Math.pow(i[0].x-a,2)+Math.pow(i[0].y-s,2)),r=o-1;r>0;--r)t.arc(a,s,l,i[r].angle,i[r-1].angle,!0)}}function vn(t,e,i,n,o,r){var a,s,l,u,c,h,d,p,f=e.length,g=n.spanGaps,m=[],v=[],y=0,b=0;for(t.beginPath(),a=0,s=f;a<s;++a)c=i(u=e[l=a%f]._view,l,n),h=gn(u),d=gn(c),r&&void 0===p&&h&&(s=f+(p=a+1)),h&&d?(y=m.push(u),b=v.push(c)):y&&b&&(g?(h&&m.push(u),d&&v.push(c)):(mn(t,m,v,y,b),y=b=0,m=[],v=[]));mn(t,m,v,y,b),t.closePath(),t.fillStyle=o,t.fill()}var yn={id:"filler",afterDatasetsUpdate:function(t,e){var i,n,o,r,a=(t.data.datasets||[]).length,s=e.propagate,l=[];for(n=0;n<a;++n)r=null,(o=(i=t.getDatasetMeta(n)).dataset)&&o._model&&o instanceof _t.Line&&(r={visible:t.isDatasetVisible(n),fill:hn(o,n,a),chart:t,el:o}),i.$filler=r,l.push(r);for(n=0;n<a;++n)(r=l[n])&&(r.fill=pn(l,n,s),r.boundary=dn(r),r.mapper=fn(r))},beforeDatasetsDraw:function(t){var e,i,n,o,r,a,s,l=t._getSortedVisibleDatasetMetas(),u=t.ctx;for(i=l.length-1;i>=0;--i)(e=l[i].$filler)&&e.visible&&(o=(n=e.el)._view,r=n._children||[],a=e.mapper,s=o.backgroundColor||I.global.defaultColor,a&&s&&r.length&&(B.canvas.clipArea(u,t.chartArea),vn(u,r,a,o,s,n._loop),B.canvas.unclipArea(u)))}},bn=B.rtl.getRtlAdapter,wn=B.noop,_n=B.valueOrDefault;function xn(t,e){return t.usePointStyle&&t.boxWidth>e?e:t.boxWidth}I._set("global",{legend:{display:!0,position:"top",align:"center",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var i=e.datasetIndex,n=this.chart,o=n.getDatasetMeta(i);o.hidden=null===o.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(t){var e=t.data.datasets,i=t.options.legend||{},n=i.labels&&i.labels.usePointStyle;return t._getSortedDatasetMetas().map((function(i){var o=i.controller.getStyle(n?0:void 0);return{text:e[i.index].label,fillStyle:o.backgroundColor,hidden:!t.isDatasetVisible(i.index),lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:o.borderWidth,strokeStyle:o.borderColor,pointStyle:o.pointStyle,rotation:o.rotation,datasetIndex:i.index}}),this)}}},legendCallback:function(t){var e,i,n,o=document.createElement("ul"),r=t.data.datasets;for(o.setAttribute("class",t.id+"-legend"),e=0,i=r.length;e<i;e++)(n=o.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=r[e].backgroundColor,r[e].label&&n.appendChild(document.createTextNode(r[e].label));return o.outerHTML}});var Cn=X.extend({initialize:function(t){B.extend(this,t),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:wn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:wn,beforeSetDimensions:wn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:wn,beforeBuildLabels:wn,buildLabels:function(){var t=this,e=t.options.labels||{},i=B.callback(e.generateLabels,[t.chart],t)||[];e.filter&&(i=i.filter((function(i){return e.filter(i,t.chart.data)}))),t.options.reverse&&i.reverse(),t.legendItems=i},afterBuildLabels:wn,beforeFit:wn,fit:function(){var t=this,e=t.options,i=e.labels,n=e.display,o=t.ctx,r=B.options._parseFont(i),a=r.size,s=t.legendHitBoxes=[],l=t.minSize,u=t.isHorizontal();if(u?(l.width=t.maxWidth,l.height=n?10:0):(l.width=n?10:0,l.height=t.maxHeight),n){if(o.font=r.string,u){var c=t.lineWidths=[0],h=0;o.textAlign="left",o.textBaseline="middle",B.each(t.legendItems,(function(t,e){var n=xn(i,a)+a/2+o.measureText(t.text).width;(0===e||c[c.length-1]+n+2*i.padding>l.width)&&(h+=a+i.padding,c[c.length-(e>0?0:1)]=0),s[e]={left:0,top:0,width:n,height:a},c[c.length-1]+=n+i.padding})),l.height+=h}else{var d=i.padding,p=t.columnWidths=[],f=t.columnHeights=[],g=i.padding,m=0,v=0;B.each(t.legendItems,(function(t,e){var n=xn(i,a)+a/2+o.measureText(t.text).width;e>0&&v+a+2*d>l.height&&(g+=m+i.padding,p.push(m),f.push(v),m=0,v=0),m=Math.max(m,n),v+=a+d,s[e]={left:0,top:0,width:n,height:a}})),g+=m,p.push(m),f.push(v),l.width+=g}t.width=l.width,t.height=l.height}else t.width=l.width=t.height=l.height=0},afterFit:wn,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var t=this,e=t.options,i=e.labels,n=I.global,o=n.defaultColor,r=n.elements.line,a=t.height,s=t.columnHeights,l=t.width,u=t.lineWidths;if(e.display){var c,h=bn(e.rtl,t.left,t.minSize.width),d=t.ctx,p=_n(i.fontColor,n.defaultFontColor),f=B.options._parseFont(i),g=f.size;d.textAlign=h.textAlign("left"),d.textBaseline="middle",d.lineWidth=.5,d.strokeStyle=p,d.fillStyle=p,d.font=f.string;var m=xn(i,g),v=t.legendHitBoxes,y=function(t,n){switch(e.align){case"start":return i.padding;case"end":return t-n;default:return(t-n+i.padding)/2}},b=t.isHorizontal();c=b?{x:t.left+y(l,u[0]),y:t.top+i.padding,line:0}:{x:t.left+i.padding,y:t.top+y(a,s[0]),line:0},B.rtl.overrideTextDirection(t.ctx,e.textDirection);var w=g+i.padding;B.each(t.legendItems,(function(e,n){var p=d.measureText(e.text).width,f=m+g/2+p,_=c.x,x=c.y;h.setWidth(t.minSize.width),b?n>0&&_+f+i.padding>t.left+t.minSize.width&&(x=c.y+=w,c.line++,_=c.x=t.left+y(l,u[c.line])):n>0&&x+w>t.top+t.minSize.height&&(_=c.x=_+t.columnWidths[c.line]+i.padding,c.line++,x=c.y=t.top+y(a,s[c.line]));var C=h.x(_);!function(t,e,n){if(!(isNaN(m)||m<=0)){d.save();var a=_n(n.lineWidth,r.borderWidth);if(d.fillStyle=_n(n.fillStyle,o),d.lineCap=_n(n.lineCap,r.borderCapStyle),d.lineDashOffset=_n(n.lineDashOffset,r.borderDashOffset),d.lineJoin=_n(n.lineJoin,r.borderJoinStyle),d.lineWidth=a,d.strokeStyle=_n(n.strokeStyle,o),d.setLineDash&&d.setLineDash(_n(n.lineDash,r.borderDash)),i&&i.usePointStyle){var s=m*Math.SQRT2/2,l=h.xPlus(t,m/2),u=e+g/2;B.canvas.drawPoint(d,n.pointStyle,s,l,u,n.rotation)}else d.fillRect(h.leftForLtr(t,m),e,m,g),0!==a&&d.strokeRect(h.leftForLtr(t,m),e,m,g);d.restore()}}(C,x,e),v[n].left=h.leftForLtr(C,v[n].width),v[n].top=x,function(t,e,i,n){var o=g/2,r=h.xPlus(t,m+o),a=e+o;d.fillText(i.text,r,a),i.hidden&&(d.beginPath(),d.lineWidth=2,d.moveTo(r,a),d.lineTo(h.xPlus(r,n),a),d.stroke())}(C,x,e,p),b?c.x+=f+i.padding:c.y+=w})),B.rtl.restoreTextDirection(t.ctx,e.textDirection)}},_getLegendItemAt:function(t,e){var i,n,o,r=this;if(t>=r.left&&t<=r.right&&e>=r.top&&e<=r.bottom)for(o=r.legendHitBoxes,i=0;i<o.length;++i)if(t>=(n=o[i]).left&&t<=n.left+n.width&&e>=n.top&&e<=n.top+n.height)return r.legendItems[i];return null},handleEvent:function(t){var e,i=this,n=i.options,o="mouseup"===t.type?"click":t.type;if("mousemove"===o){if(!n.onHover&&!n.onLeave)return}else{if("click"!==o)return;if(!n.onClick)return}e=i._getLegendItemAt(t.x,t.y),"click"===o?e&&n.onClick&&n.onClick.call(i,t.native,e):(n.onLeave&&e!==i._hoveredItem&&(i._hoveredItem&&n.onLeave.call(i,t.native,i._hoveredItem),i._hoveredItem=e),n.onHover&&e&&n.onHover.call(i,t.native,e))}});function En(t,e){var i=new Cn({ctx:t.ctx,options:e,chart:t});fe.configure(t,i,e),fe.addBox(t,i),t.legend=i}var kn={id:"legend",_element:Cn,beforeInit:function(t){var e=t.options.legend;e&&En(t,e)},beforeUpdate:function(t){var e=t.options.legend,i=t.legend;e?(B.mergeIf(e,I.global.legend),i?(fe.configure(t,i,e),i.options=e):En(t,e)):i&&(fe.removeBox(t,i),delete t.legend)},afterEvent:function(t,e){var i=t.legend;i&&i.handleEvent(e)}},Sn=B.noop;I._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var Mn=X.extend({initialize:function(t){B.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:Sn,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:Sn,beforeSetDimensions:Sn,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:Sn,beforeBuildLabels:Sn,buildLabels:Sn,afterBuildLabels:Sn,beforeFit:Sn,fit:function(){var t,e=this,i=e.options,n=e.minSize={},o=e.isHorizontal();i.display?(t=(B.isArray(i.text)?i.text.length:1)*B.options._parseFont(i).lineHeight+2*i.padding,e.width=n.width=o?e.maxWidth:t,e.height=n.height=o?t:e.maxHeight):e.width=n.width=e.height=n.height=0},afterFit:Sn,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this,e=t.ctx,i=t.options;if(i.display){var n,o,r,a=B.options._parseFont(i),s=a.lineHeight,l=s/2+i.padding,u=0,c=t.top,h=t.left,d=t.bottom,p=t.right;e.fillStyle=B.valueOrDefault(i.fontColor,I.global.defaultFontColor),e.font=a.string,t.isHorizontal()?(o=h+(p-h)/2,r=c+l,n=p-h):(o="left"===i.position?h+l:p-l,r=c+(d-c)/2,n=d-c,u=Math.PI*("left"===i.position?-.5:.5)),e.save(),e.translate(o,r),e.rotate(u),e.textAlign="center",e.textBaseline="middle";var f=i.text;if(B.isArray(f))for(var g=0,m=0;m<f.length;++m)e.fillText(f[m],0,g,n),g+=s;else e.fillText(f,0,0,n);e.restore()}}});function Tn(t,e){var i=new Mn({ctx:t.ctx,options:e,chart:t});fe.configure(t,i,e),fe.addBox(t,i),t.titleBlock=i}var Rn={},Pn=yn,Dn=kn,Ln={id:"title",_element:Mn,beforeInit:function(t){var e=t.options.title;e&&Tn(t,e)},beforeUpdate:function(t){var e=t.options.title,i=t.titleBlock;e?(B.mergeIf(e,I.global.title),i?(fe.configure(t,i,e),i.options=e):Tn(t,e)):i&&(fe.removeBox(t,i),delete t.titleBlock)}};for(var Fn in Rn.filler=Pn,Rn.legend=Dn,Rn.title=Ln,Ke.helpers=B,function(){function t(t,e,i){var n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}function e(t){return null!=t&&"none"!==t}function i(i,n,o){var r=document.defaultView,a=B._getParentNode(i),s=r.getComputedStyle(i)[n],l=r.getComputedStyle(a)[n],u=e(s),c=e(l),h=Number.POSITIVE_INFINITY;return u||c?Math.min(u?t(s,i,o):h,c?t(l,a,o):h):"none"}B.where=function(t,e){if(B.isArray(t)&&Array.prototype.filter)return t.filter(e);var i=[];return B.each(t,(function(t){e(t)&&i.push(t)})),i},B.findIndex=Array.prototype.findIndex?function(t,e,i){return t.findIndex(e,i)}:function(t,e,i){i=void 0===i?t:i;for(var n=0,o=t.length;n<o;++n)if(e.call(i,t[n],n,t))return n;return-1},B.findNextWhere=function(t,e,i){B.isNullOrUndef(i)&&(i=-1);for(var n=i+1;n<t.length;n++){var o=t[n];if(e(o))return o}},B.findPreviousWhere=function(t,e,i){B.isNullOrUndef(i)&&(i=t.length);for(var n=i-1;n>=0;n--){var o=t[n];if(e(o))return o}},B.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},B.almostEquals=function(t,e,i){return Math.abs(t-e)<i},B.almostWhole=function(t,e){var i=Math.round(t);return i-e<=t&&i+e>=t},B.max=function(t){return t.reduce((function(t,e){return isNaN(e)?t:Math.max(t,e)}),Number.NEGATIVE_INFINITY)},B.min=function(t){return t.reduce((function(t,e){return isNaN(e)?t:Math.min(t,e)}),Number.POSITIVE_INFINITY)},B.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1},B.toRadians=function(t){return t*(Math.PI/180)},B.toDegrees=function(t){return t*(180/Math.PI)},B._decimalPlaces=function(t){if(B.isFinite(t)){for(var e=1,i=0;Math.round(t*e)/e!==t;)e*=10,i++;return i}},B.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,o=Math.sqrt(i*i+n*n),r=Math.atan2(n,i);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:o}},B.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},B.aliasPixel=function(t){return t%2==0?0:.5},B._alignPixel=function(t,e,i){var n=t.currentDevicePixelRatio,o=i/2;return Math.round((e-o)*n)/n+o},B.splineCurve=function(t,e,i,n){var o=t.skip?e:t,r=e,a=i.skip?e:i,s=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),l=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),u=s/(s+l),c=l/(s+l),h=n*(u=isNaN(u)?0:u),d=n*(c=isNaN(c)?0:c);return{previous:{x:r.x-h*(a.x-o.x),y:r.y-h*(a.y-o.y)},next:{x:r.x+d*(a.x-o.x),y:r.y+d*(a.y-o.y)}}},B.EPSILON=Number.EPSILON||1e-14,B.splineCurveMonotone=function(t){var e,i,n,o,r,a,s,l,u,c=(t||[]).map((function(t){return{model:t._model,deltaK:0,mK:0}})),h=c.length;for(e=0;e<h;++e)if(!(n=c[e]).model.skip){if(i=e>0?c[e-1]:null,(o=e<h-1?c[e+1]:null)&&!o.model.skip){var d=o.model.x-n.model.x;n.deltaK=0!==d?(o.model.y-n.model.y)/d:0}!i||i.model.skip?n.mK=n.deltaK:!o||o.model.skip?n.mK=i.deltaK:this.sign(i.deltaK)!==this.sign(n.deltaK)?n.mK=0:n.mK=(i.deltaK+n.deltaK)/2}for(e=0;e<h-1;++e)n=c[e],o=c[e+1],n.model.skip||o.model.skip||(B.almostEquals(n.deltaK,0,this.EPSILON)?n.mK=o.mK=0:(r=n.mK/n.deltaK,a=o.mK/n.deltaK,(l=Math.pow(r,2)+Math.pow(a,2))<=9||(s=3/Math.sqrt(l),n.mK=r*s*n.deltaK,o.mK=a*s*n.deltaK)));for(e=0;e<h;++e)(n=c[e]).model.skip||(i=e>0?c[e-1]:null,o=e<h-1?c[e+1]:null,i&&!i.model.skip&&(u=(n.model.x-i.model.x)/3,n.model.controlPointPreviousX=n.model.x-u,n.model.controlPointPreviousY=n.model.y-u*n.mK),o&&!o.model.skip&&(u=(o.model.x-n.model.x)/3,n.model.controlPointNextX=n.model.x+u,n.model.controlPointNextY=n.model.y+u*n.mK))},B.nextItem=function(t,e,i){return i?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},B.previousItem=function(t,e,i){return i?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},B.niceNum=function(t,e){var i=Math.floor(B.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},B.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},B.getRelativePosition=function(t,e){var i,n,o=t.originalEvent||t,r=t.target||t.srcElement,a=r.getBoundingClientRect(),s=o.touches;s&&s.length>0?(i=s[0].clientX,n=s[0].clientY):(i=o.clientX,n=o.clientY);var l=parseFloat(B.getStyle(r,"padding-left")),u=parseFloat(B.getStyle(r,"padding-top")),c=parseFloat(B.getStyle(r,"padding-right")),h=parseFloat(B.getStyle(r,"padding-bottom")),d=a.right-a.left-l-c,p=a.bottom-a.top-u-h;return{x:i=Math.round((i-a.left-l)/d*r.width/e.currentDevicePixelRatio),y:n=Math.round((n-a.top-u)/p*r.height/e.currentDevicePixelRatio)}},B.getConstraintWidth=function(t){return i(t,"max-width","clientWidth")},B.getConstraintHeight=function(t){return i(t,"max-height","clientHeight")},B._calculatePadding=function(t,e,i){return(e=B.getStyle(t,e)).indexOf("%")>-1?i*parseInt(e,10)/100:parseInt(e,10)},B._getParentNode=function(t){var e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e},B.getMaximumWidth=function(t){var e=B._getParentNode(t);if(!e)return t.clientWidth;var i=e.clientWidth,n=i-B._calculatePadding(e,"padding-left",i)-B._calculatePadding(e,"padding-right",i),o=B.getConstraintWidth(t);return isNaN(o)?n:Math.min(n,o)},B.getMaximumHeight=function(t){var e=B._getParentNode(t);if(!e)return t.clientHeight;var i=e.clientHeight,n=i-B._calculatePadding(e,"padding-top",i)-B._calculatePadding(e,"padding-bottom",i),o=B.getConstraintHeight(t);return isNaN(o)?n:Math.min(n,o)},B.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},B.retinaScale=function(t,e){var i=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==i){var n=t.canvas,o=t.height,r=t.width;n.height=o*i,n.width=r*i,t.ctx.scale(i,i),n.style.height||n.style.width||(n.style.height=o+"px",n.style.width=r+"px")}},B.fontString=function(t,e,i){return e+" "+t+"px "+i},B.longestText=function(t,e,i,n){var o=(n=n||{}).data=n.data||{},r=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(o=n.data={},r=n.garbageCollect=[],n.font=e),t.font=e;var a,s,l,u,c,h=0,d=i.length;for(a=0;a<d;a++)if(null!=(u=i[a])&&!0!==B.isArray(u))h=B.measureText(t,o,r,h,u);else if(B.isArray(u))for(s=0,l=u.length;s<l;s++)null==(c=u[s])||B.isArray(c)||(h=B.measureText(t,o,r,h,c));var p=r.length/2;if(p>i.length){for(a=0;a<p;a++)delete o[r[a]];r.splice(0,p)}return h},B.measureText=function(t,e,i,n,o){var r=e[o];return r||(r=e[o]=t.measureText(o).width,i.push(o)),r>n&&(n=r),n},B.numberOfLabelLines=function(t){var e=1;return B.each(t,(function(t){B.isArray(t)&&t.length>e&&(e=t.length)})),e},B.color=x?function(t){return t instanceof CanvasGradient&&(t=I.global.defaultColor),x(t)}:function(t){return console.error("Color.js not found!"),t},B.getHoverColor=function(t){return t instanceof CanvasPattern||t instanceof CanvasGradient?t:B.color(t).saturate(.5).darken(.1).rgbString()}}(),Ke._adapters=Qe,Ke.Animation=K,Ke.animationService=Z,Ke.controllers=Zt,Ke.DatasetController=it,Ke.defaults=I,Ke.Element=X,Ke.elements=_t,Ke.Interaction=oe,Ke.layouts=fe,Ke.platform=Te,Ke.plugins=Re,Ke.Scale=fi,Ke.scaleService=Pe,Ke.Ticks=ti,Ke.Tooltip=Be,Ke.helpers.each(ln,(function(t,e){Ke.scaleService.registerScaleType(e,t,t._defaults)})),Rn)Rn.hasOwnProperty(Fn)&&Ke.plugins.register(Rn[Fn]);Ke.platform.initialize();var On=Ke;return"undefined"!=typeof window&&(window.Chart=Ke),Ke.Chart=Ke,Ke.Legend=Rn.legend._element,Ke.Title=Rn.title._element,Ke.pluginService=Ke.plugins,Ke.PluginBase=Ke.Element.extend({}),Ke.canvasHelpers=Ke.helpers.canvas,Ke.layoutService=Ke.layouts,Ke.LinearScaleBase=wi,Ke.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],(function(t){Ke[t]=function(e,i){return new Ke(e,Ke.helpers.merge(i||{},{type:t.charAt(0).toLowerCase()+t.slice(1)}))}})),On}(function(){try{return i(64)}catch(t){}}())},function(t,e,i){var n=i(2)(i(0),"Map");t.exports=n},function(t,e,i){var n=i(0).Symbol;t.exports=n},function(t,e,i){var n=i(35),o=i(114),r=i(39);t.exports=function(t){return r(t)?n(t):o(t)}},function(t,e){var i=Array.isArray;t.exports=i},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,i){(function(t){var n=i(31),o=e&&!e.nodeType&&e,r=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===o&&n.process,s=function(){try{var t=r&&r.require&&r.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,i(19)(t))},function(t,e){var i=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},function(t,e,i){var n=i(122),o=i(41),r=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),n(a(t),(function(e){return r.call(t,e)})))}:o;t.exports=s},function(t,e,i){var n=i(126),o=i(15),r=i(127),a=i(128),s=i(129),l=i(8),u=i(32),c=u(n),h=u(o),d=u(r),p=u(a),f=u(s),g=l;(n&&"[object DataView]"!=g(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=g(new o)||r&&"[object Promise]"!=g(r.resolve())||a&&"[object Set]"!=g(new a)||s&&"[object WeakMap]"!=g(new s))&&(g=function(t){var e=l(t),i="[object Object]"==e?t.constructor:void 0,n=i?u(i):"";if(n)switch(n){case c:return"[object DataView]";case h:return"[object Map]";case d:return"[object Promise]";case p:return"[object Set]";case f:return"[object WeakMap]"}return e}),t.exports=g},function(t,e,i){var n=i(132);t.exports=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},function(t,i,n){var o,r,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};a=function(){"use strict";Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<i;){var r=e[o];if(t.call(n,r,o,e))return o;o++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<i;){var r=e[o];if(t.call(n,r,o,e))return r;o++}}});var t=function(t){this.table=t,this.blockHozScrollEvent=!1,this.headersElement=this.createHeadersElement(),this.element=this.createHeaderElement(),this.rowManager=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.element.insertBefore(this.headersElement,this.element.firstChild)};t.prototype.createHeadersElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-headers"),t},t.prototype.createHeaderElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-header"),this.table.options.headerVisible||t.classList.add("tabulator-header-hidden"),t},t.prototype.initialize=function(){},t.prototype.setRowManager=function(t){this.rowManager=t},t.prototype.getElement=function(){return this.element},t.prototype.getHeadersElement=function(){return this.headersElement},t.prototype.scrollHorizontal=function(t){var e=0,i=this.element.scrollWidth-this.table.element.clientWidth;this.element.scrollLeft=t,t>i?(e=t-i,this.element.style.marginLeft=-e+"px"):this.element.style.marginLeft=0,this.scrollLeft=t,this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.scrollHorizontal()},t.prototype.generateColumnsFromRowData=function(t){var e,i,n=[];if(t&&t.length){for(var o in e=t[0]){var r={field:o,title:o},a=e[o];switch(void 0===a?"undefined":s(a)){case"undefined":i="string";break;case"boolean":i="boolean";break;case"object":i=Array.isArray(a)?"array":"string";break;default:i=isNaN(a)||""===a?a.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?"alphanum":"string":"number"}r.sorter=i,n.push(r)}this.table.options.columns=n,this.setColumns(this.table.options.columns)}},t.prototype.setColumns=function(t,e){for(var i=this;i.headersElement.firstChild;)i.headersElement.removeChild(i.headersElement.firstChild);i.columns=[],i.columnsByIndex=[],i.columnsByField={},i.table.modExists("frozenColumns")&&i.table.modules.frozenColumns.reset(),t.forEach((function(t,e){i._addColumn(t)})),i._reIndexColumns(),i.table.options.responsiveLayout&&i.table.modExists("responsiveLayout",!0)&&i.table.modules.responsiveLayout.initialize(),i.redraw(!0)},t.prototype._addColumn=function(t,e,i){var o=new n(t,this),r=o.getElement(),a=i?this.findColumnIndex(i):i;if(i&&a>-1){var s=this.columns.indexOf(i.getTopColumn()),l=i.getElement();e?(this.columns.splice(s,0,o),l.parentNode.insertBefore(r,l)):(this.columns.splice(s+1,0,o),l.parentNode.insertBefore(r,l.nextSibling))}else e?(this.columns.unshift(o),this.headersElement.insertBefore(o.getElement(),this.headersElement.firstChild)):(this.columns.push(o),this.headersElement.appendChild(o.getElement())),o.columnRendered();return o},t.prototype.registerColumnField=function(t){t.definition.field&&(this.columnsByField[t.definition.field]=t)},t.prototype.registerColumnPosition=function(t){this.columnsByIndex.push(t)},t.prototype._reIndexColumns=function(){this.columnsByIndex=[],this.columns.forEach((function(t){t.reRegisterPosition()}))},t.prototype._verticalAlignHeaders=function(){var t=this,e=0;t.columns.forEach((function(t){var i;t.clearVerticalAlign(),(i=t.getHeight())>e&&(e=i)})),t.columns.forEach((function(i){i.verticalAlign(t.table.options.columnHeaderVertAlign,e)})),t.rowManager.adjustTableSize()},t.prototype.findColumn=function(t){return"object"!=(void 0===t?"undefined":s(t))?this.columnsByField[t]||!1:t instanceof n?t:t instanceof i?t._getSelf()||!1:"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&this.columns.find((function(e){return e.element===t}))||!1},t.prototype.getColumnByField=function(t){return this.columnsByField[t]},t.prototype.getColumnsByFieldRoot=function(t){var e=this,i=[];return Object.keys(this.columnsByField).forEach((function(n){n.split(".")[0]===t&&i.push(e.columnsByField[n])})),i},t.prototype.getColumnByIndex=function(t){return this.columnsByIndex[t]},t.prototype.getFirstVisibileColumn=function(t){return(t=this.columnsByIndex.findIndex((function(t){return t.visible})))>-1&&this.columnsByIndex[t]},t.prototype.getColumns=function(){return this.columns},t.prototype.findColumnIndex=function(t){return this.columnsByIndex.findIndex((function(e){return t===e}))},t.prototype.getRealColumns=function(){return this.columnsByIndex},t.prototype.traverse=function(t){this.columnsByIndex.forEach((function(e,i){t(e,i)}))},t.prototype.getDefinitions=function(t){var e=[];return this.columnsByIndex.forEach((function(i){(!t||t&&i.visible)&&e.push(i.getDefinition())})),e},t.prototype.getDefinitionTree=function(){var t=[];return this.columns.forEach((function(e){t.push(e.getDefinition(!0))})),t},t.prototype.getComponents=function(t){var e=[];return(t?this.columns:this.columnsByIndex).forEach((function(t){e.push(t.getComponent())})),e},t.prototype.getWidth=function(){var t=0;return this.columnsByIndex.forEach((function(e){e.visible&&(t+=e.getWidth())})),t},t.prototype.moveColumn=function(t,e,i){this.moveColumnActual(t,e,i),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),e.element.parentNode.insertBefore(t.element,e.element),i&&e.element.parentNode.insertBefore(e.element,t.element),this._verticalAlignHeaders(),this.table.rowManager.reinitialize()},t.prototype.moveColumnActual=function(t,e,i){t.parent.isGroup?this._moveColumnInArray(t.parent.columns,t,e,i):this._moveColumnInArray(this.columns,t,e,i),this._moveColumnInArray(this.columnsByIndex,t,e,i,!0),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.table.options.columnMoved&&this.table.options.columnMoved.call(this.table,t.getComponent(),this.table.columnManager.getComponents()),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns")},t.prototype._moveColumnInArray=function(t,e,i,n,o){var r,a=t.indexOf(e);a>-1&&(t.splice(a,1),(r=t.indexOf(i))>-1?n&&(r+=1):r=a,t.splice(r,0,e),o&&this.table.rowManager.rows.forEach((function(t){if(t.cells.length){var e=t.cells.splice(a,1)[0];t.cells.splice(r,0,e)}})))},t.prototype.scrollToColumn=function(t,e,i){var n=this,o=0,r=0,a=0,s=t.getElement();return new Promise((function(l,u){if(void 0===e&&(e=n.table.options.scrollToColumnPosition),void 0===i&&(i=n.table.options.scrollToColumnIfVisible),t.visible){switch(e){case"middle":case"center":a=-n.element.clientWidth/2;break;case"right":a=s.clientWidth-n.headersElement.clientWidth}if(!i&&(r=s.offsetLeft)>0&&r+s.offsetWidth<n.element.clientWidth)return!1;o=s.offsetLeft+n.element.scrollLeft+a,o=Math.max(Math.min(o,n.table.rowManager.element.scrollWidth-n.table.rowManager.element.clientWidth),0),n.table.rowManager.scrollHorizontal(o),n.scrollHorizontal(o),l()}else console.warn("Scroll Error - Column not visible"),u("Scroll Error - Column not visible")}))},t.prototype.generateCells=function(t){var e=[];return this.columnsByIndex.forEach((function(i){e.push(i.generateCell(t))})),e},t.prototype.getFlexBaseWidth=function(){var t=this,e=t.table.element.clientWidth,i=0;return t.rowManager.element.scrollHeight>t.rowManager.element.clientHeight&&(e-=t.rowManager.element.offsetWidth-t.rowManager.element.clientWidth),this.columnsByIndex.forEach((function(n){var o,r,a;n.visible&&(o=n.definition.width||0,r=void 0===n.minWidth?t.table.options.columnMinWidth:parseInt(n.minWidth),a="string"==typeof o?o.indexOf("%")>-1?e/100*parseInt(o):parseInt(o):o,i+=a>r?a:r)})),i},t.prototype.addColumn=function(t,e,i){var n=this;return new Promise((function(o,r){var a=n._addColumn(t,e,i);n._reIndexColumns(),n.table.options.responsiveLayout&&n.table.modExists("responsiveLayout",!0)&&n.table.modules.responsiveLayout.initialize(),n.table.modExists("columnCalcs")&&n.table.modules.columnCalcs.recalc(n.table.rowManager.activeRows),n.redraw(),"fitColumns"!=n.table.modules.layout.getMode()&&a.reinitializeWidth(),n._verticalAlignHeaders(),n.table.rowManager.reinitialize(),o(a)}))},t.prototype.deregisterColumn=function(t){var e,i=t.getField();i&&delete this.columnsByField[i],(e=this.columnsByIndex.indexOf(t))>-1&&this.columnsByIndex.splice(e,1),(e=this.columns.indexOf(t))>-1&&this.columns.splice(e,1),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.initialize(),this.redraw()},t.prototype.redraw=function(t){t&&(h.prototype.helpers.elVisible(this.element)&&this._verticalAlignHeaders(),this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),["fitColumns","fitDataStretch"].indexOf(this.table.modules.layout.getMode())>-1||t?this.table.modules.layout.layout():this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout(),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),t&&(this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.redraw()),this.table.footerManager.redraw()};var i=function(t){this._column=t,this.type="ColumnComponent"};i.prototype.getElement=function(){return this._column.getElement()},i.prototype.getDefinition=function(){return this._column.getDefinition()},i.prototype.getField=function(){return this._column.getField()},i.prototype.getCells=function(){var t=[];return this._column.cells.forEach((function(e){t.push(e.getComponent())})),t},i.prototype.getVisibility=function(){return this._column.visible},i.prototype.show=function(){this._column.isGroup?this._column.columns.forEach((function(t){t.show()})):this._column.show()},i.prototype.hide=function(){this._column.isGroup?this._column.columns.forEach((function(t){t.hide()})):this._column.hide()},i.prototype.toggle=function(){this._column.visible?this.hide():this.show()},i.prototype.delete=function(){return this._column.delete()},i.prototype.getSubColumns=function(){var t=[];return this._column.columns.length&&this._column.columns.forEach((function(e){t.push(e.getComponent())})),t},i.prototype.getParentColumn=function(){return this._column.parent instanceof n&&this._column.parent.getComponent()},i.prototype._getSelf=function(){return this._column},i.prototype.scrollTo=function(){return this._column.table.columnManager.scrollToColumn(this._column)},i.prototype.getTable=function(){return this._column.table},i.prototype.headerFilterFocus=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.setHeaderFilterFocus(this._column)},i.prototype.reloadHeaderFilter=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.reloadHeaderFilter(this._column)},i.prototype.getHeaderFilterValue=function(){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.getHeaderFilterValue(this._column)},i.prototype.setHeaderFilterValue=function(t){this._column.table.modExists("filter",!0)&&this._column.table.modules.filter.setHeaderFilterValue(this._column,t)},i.prototype.move=function(t,e){var i=this._column.table.columnManager.findColumn(t);i?this._column.table.columnManager.moveColumn(this._column,i,e):console.warn("Move Error - No matching column found:",i)},i.prototype.getNextColumn=function(){var t=this._column.nextColumn();return!!t&&t.getComponent()},i.prototype.getPrevColumn=function(){var t=this._column.prevColumn();return!!t&&t.getComponent()},i.prototype.updateDefinition=function(t){return this._column.updateDefinition(t)};var n=function t(e,i){var n=this;this.table=i.table,this.definition=e,this.parent=i,this.type="column",this.columns=[],this.cells=[],this.element=this.createElement(),this.contentElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.isGroup=!1,this.tooltip=!1,this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleFormatterRendered=!1,this.setField(this.definition.field),this.table.options.invalidOptionWarnings&&this.checkDefinition(),this.modules={},this.cellEvents={cellClick:!1,cellDblClick:!1,cellContext:!1,cellTap:!1,cellDblTap:!1,cellTapHold:!1,cellMouseEnter:!1,cellMouseLeave:!1,cellMouseOver:!1,cellMouseOut:!1,cellMouseMove:!1},this.width=null,this.widthStyled="",this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this._mapDepricatedFunctionality(),e.columns?(this.isGroup=!0,e.columns.forEach((function(e,i){var o=new t(e,n);n.attachColumn(o)})),n.checkColumnVisibility()):i.registerColumnField(this),e.rowHandle&&!1!==this.table.options.movableRows&&this.table.modExists("moveRow")&&this.table.modules.moveRow.setHandle(!0),this._buildHeader(),this.bindModuleColumns()};n.prototype.createElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-col"),t.setAttribute("role","columnheader"),t.setAttribute("aria-sort","none"),t},n.prototype.createGroupElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-col-group-cols"),t},n.prototype.checkDefinition=function(){var t=this;Object.keys(this.definition).forEach((function(e){-1===t.defaultOptionList.indexOf(e)&&console.warn("Invalid column definition option in '"+(t.field||t.definition.title)+"' column:",e)}))},n.prototype.setField=function(t){this.field=t,this.fieldStructure=t?this.table.options.nestedFieldSeparator?t.split(this.table.options.nestedFieldSeparator):[t]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData},n.prototype.registerColumnPosition=function(t){this.parent.registerColumnPosition(t)},n.prototype.registerColumnField=function(t){this.parent.registerColumnField(t)},n.prototype.reRegisterPosition=function(){this.isGroup?this.columns.forEach((function(t){t.reRegisterPosition()})):this.registerColumnPosition(this)},n.prototype._mapDepricatedFunctionality=function(){void 0!==this.definition.hideInHtml&&(this.definition.htmlOutput=!this.definition.hideInHtml,console.warn("hideInHtml column definition property is deprecated, you should now use htmlOutput")),void 0!==this.definition.align&&(this.definition.hozAlign=this.definition.align,console.warn("align column definition property is deprecated, you should now use hozAlign"))},n.prototype.setTooltip=function(){var t=this,e=t.definition,i=e.headerTooltip||!1===e.tooltip?e.headerTooltip:t.table.options.tooltipsHeader;i?!0===i?e.field?t.table.modules.localize.bind("columns|"+e.field,(function(i){t.element.setAttribute("title",i||e.title)})):t.element.setAttribute("title",e.title):("function"==typeof i&&!1===(i=i(t.getComponent()))&&(i=""),t.element.setAttribute("title",i)):t.element.setAttribute("title","")},n.prototype._buildHeader=function(){for(var t=this,e=t.definition;t.element.firstChild;)t.element.removeChild(t.element.firstChild);e.headerVertical&&(t.element.classList.add("tabulator-col-vertical"),"flip"===e.headerVertical&&t.element.classList.add("tabulator-col-vertical-flip")),t.contentElement=t._bindEvents(),t.contentElement=t._buildColumnHeaderContent(),t.element.appendChild(t.contentElement),t.isGroup?t._buildGroupHeader():t._buildColumnHeader(),t.setTooltip(),t.table.options.resizableColumns&&t.table.modExists("resizeColumns")&&t.table.modules.resizeColumns.initializeColumn("header",t,t.element),e.headerFilter&&t.table.modExists("filter")&&t.table.modExists("edit")&&(void 0!==e.headerFilterPlaceholder&&e.field&&t.table.modules.localize.setHeaderFilterColumnPlaceholder(e.field,e.headerFilterPlaceholder),t.table.modules.filter.initializeColumn(t)),t.table.modExists("frozenColumns")&&t.table.modules.frozenColumns.initializeColumn(t),t.table.options.movableColumns&&!t.isGroup&&t.table.modExists("moveColumn")&&t.table.modules.moveColumn.initializeColumn(t),(e.topCalc||e.bottomCalc)&&t.table.modExists("columnCalcs")&&t.table.modules.columnCalcs.initializeColumn(t),t.table.modExists("persistence")&&t.table.modules.persistence.config.columns&&t.table.modules.persistence.initializeColumn(t),t.element.addEventListener("mouseenter",(function(e){t.setTooltip()}))},n.prototype._bindEvents=function(){var t,e,i,n=this,o=n.definition;"function"==typeof o.headerClick&&n.element.addEventListener("click",(function(t){o.headerClick(t,n.getComponent())})),"function"==typeof o.headerDblClick&&n.element.addEventListener("dblclick",(function(t){o.headerDblClick(t,n.getComponent())})),"function"==typeof o.headerContext&&n.element.addEventListener("contextmenu",(function(t){o.headerContext(t,n.getComponent())})),"function"==typeof o.headerTap&&(i=!1,n.element.addEventListener("touchstart",(function(t){i=!0}),{passive:!0}),n.element.addEventListener("touchend",(function(t){i&&o.headerTap(t,n.getComponent()),i=!1}))),"function"==typeof o.headerDblTap&&(t=null,n.element.addEventListener("touchend",(function(e){t?(clearTimeout(t),t=null,o.headerDblTap(e,n.getComponent())):t=setTimeout((function(){clearTimeout(t),t=null}),300)}))),"function"==typeof o.headerTapHold&&(e=null,n.element.addEventListener("touchstart",(function(t){clearTimeout(e),e=setTimeout((function(){clearTimeout(e),e=null,i=!1,o.headerTapHold(t,n.getComponent())}),1e3)}),{passive:!0}),n.element.addEventListener("touchend",(function(t){clearTimeout(e),e=null}))),"function"==typeof o.cellClick&&(n.cellEvents.cellClick=o.cellClick),"function"==typeof o.cellDblClick&&(n.cellEvents.cellDblClick=o.cellDblClick),"function"==typeof o.cellContext&&(n.cellEvents.cellContext=o.cellContext),"function"==typeof o.cellMouseEnter&&(n.cellEvents.cellMouseEnter=o.cellMouseEnter),"function"==typeof o.cellMouseLeave&&(n.cellEvents.cellMouseLeave=o.cellMouseLeave),"function"==typeof o.cellMouseOver&&(n.cellEvents.cellMouseOver=o.cellMouseOver),"function"==typeof o.cellMouseOut&&(n.cellEvents.cellMouseOut=o.cellMouseOut),"function"==typeof o.cellMouseMove&&(n.cellEvents.cellMouseMove=o.cellMouseMove),"function"==typeof o.cellTap&&(n.cellEvents.cellTap=o.cellTap),"function"==typeof o.cellDblTap&&(n.cellEvents.cellDblTap=o.cellDblTap),"function"==typeof o.cellTapHold&&(n.cellEvents.cellTapHold=o.cellTapHold),"function"==typeof o.cellEdited&&(n.cellEvents.cellEdited=o.cellEdited),"function"==typeof o.cellEditing&&(n.cellEvents.cellEditing=o.cellEditing),"function"==typeof o.cellEditCancelled&&(n.cellEvents.cellEditCancelled=o.cellEditCancelled)},n.prototype._buildColumnHeader=function(){var t=this,e=t.definition,i=t.table;i.modExists("sort")&&i.modules.sort.initializeColumn(t,t.contentElement),(e.headerContextMenu||e.headerMenu)&&i.modExists("menu")&&i.modules.menu.initializeColumnHeader(t),i.modExists("format")&&i.modules.format.initializeColumn(t),void 0!==e.editor&&i.modExists("edit")&&i.modules.edit.initializeColumn(t),void 0!==e.validator&&i.modExists("validate")&&i.modules.validate.initializeColumn(t),i.modExists("mutator")&&i.modules.mutator.initializeColumn(t),i.modExists("accessor")&&i.modules.accessor.initializeColumn(t),s(i.options.responsiveLayout)&&i.modExists("responsiveLayout")&&i.modules.responsiveLayout.initializeColumn(t),void 0!==e.visible&&(e.visible?t.show(!0):t.hide(!0)),e.cssClass&&e.cssClass.split(" ").forEach((function(e){t.element.classList.add(e)})),e.field&&this.element.setAttribute("tabulator-field",e.field),t.setMinWidth(void 0===e.minWidth?t.table.options.columnMinWidth:parseInt(e.minWidth)),t.reinitializeWidth(),t.tooltip=t.definition.tooltip||!1===t.definition.tooltip?t.definition.tooltip:t.table.options.tooltips,t.hozAlign=void 0===t.definition.hozAlign?t.table.options.cellHozAlign:t.definition.hozAlign,t.vertAlign=void 0===t.definition.vertAlign?t.table.options.cellVertAlign:t.definition.vertAlign},n.prototype._buildColumnHeaderContent=function(){self.definition,self.table;var t=document.createElement("div");return t.classList.add("tabulator-col-content"),this.titleElement=this._buildColumnHeaderTitle(),t.appendChild(this.titleElement),t},n.prototype._buildColumnHeaderTitle=function(){var t=this,e=t.definition,i=t.table,n=document.createElement("div");if(n.classList.add("tabulator-col-title"),e.editableTitle){var o=document.createElement("input");o.classList.add("tabulator-title-editor"),o.addEventListener("click",(function(t){t.stopPropagation(),o.focus()})),o.addEventListener("change",(function(){e.title=o.value,i.options.columnTitleChanged.call(t.table,t.getComponent())})),n.appendChild(o),e.field?i.modules.localize.bind("columns|"+e.field,(function(t){o.value=t||e.title||"&nbsp;"})):o.value=e.title||"&nbsp;"}else e.field?i.modules.localize.bind("columns|"+e.field,(function(i){t._formatColumnHeaderTitle(n,i||e.title||"&nbsp;")})):t._formatColumnHeaderTitle(n,e.title||"&nbsp;");return n},n.prototype._formatColumnHeaderTitle=function(t,e){var i,n,o,r,a,l=this;if(this.definition.titleFormatter&&this.table.modExists("format"))switch(i=this.table.modules.format.getFormatter(this.definition.titleFormatter),a=function(t){l.titleFormatterRendered=t},r={getValue:function(){return e},getElement:function(){return t}},o="function"==typeof(o=this.definition.titleFormatterParams||{})?o():o,void 0===(n=i.call(this.table.modules.format,r,o,a))?"undefined":s(n)){case"object":n instanceof Node?t.appendChild(n):(t.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",n));break;case"undefined":case"null":t.innerHTML="";break;default:t.innerHTML=n}else t.innerHTML=e},n.prototype._buildGroupHeader=function(){var t=this;this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass&&this.definition.cssClass.split(" ").forEach((function(e){t.element.classList.add(e)})),this.element.appendChild(this.groupElement)},n.prototype._getFlatData=function(t){return t[this.field]},n.prototype._getNestedData=function(t){for(var e,i=t,n=this.fieldStructure,o=n.length,r=0;r<o&&(e=i=i[n[r]],i);r++);return e},n.prototype._setFlatData=function(t,e){this.field&&(t[this.field]=e)},n.prototype._setNestedData=function(t,e){for(var i=t,n=this.fieldStructure,o=n.length,r=0;r<o;r++)if(r==o-1)i[n[r]]=e;else{if(!i[n[r]]){if(void 0===e)break;i[n[r]]={}}i=i[n[r]]}},n.prototype.attachColumn=function(t){this.groupElement?(this.columns.push(t),this.groupElement.appendChild(t.getElement())):console.warn("Column Warning - Column being attached to another column instead of column group")},n.prototype.verticalAlign=function(t,e){var i=this.parent.isGroup?this.parent.getGroupElement().clientHeight:e||this.parent.getHeadersElement().clientHeight;this.element.style.height=i+"px",this.isGroup&&(this.groupElement.style.minHeight=i-this.contentElement.offsetHeight+"px"),this.isGroup||"top"===t||(this.element.style.paddingTop="bottom"===t?this.element.clientHeight-this.contentElement.offsetHeight+"px":(this.element.clientHeight-this.contentElement.offsetHeight)/2+"px"),this.columns.forEach((function(e){e.verticalAlign(t)}))},n.prototype.clearVerticalAlign=function(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach((function(t){t.clearVerticalAlign()}))},n.prototype.bindModuleColumns=function(){"rownum"==this.definition.formatter&&(this.table.rowManager.rowNumColumn=this)},n.prototype.getElement=function(){return this.element},n.prototype.getGroupElement=function(){return this.groupElement},n.prototype.getField=function(){return this.field},n.prototype.getFirstColumn=function(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this},n.prototype.getLastColumn=function(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this},n.prototype.getColumns=function(){return this.columns},n.prototype.getCells=function(){return this.cells},n.prototype.getTopColumn=function(){return this.parent.isGroup?this.parent.getTopColumn():this},n.prototype.getDefinition=function(t){var e=[];return this.isGroup&&t&&(this.columns.forEach((function(t){e.push(t.getDefinition(!0))})),this.definition.columns=e),this.definition},n.prototype.checkColumnVisibility=function(){var t=!1;this.columns.forEach((function(e){e.visible&&(t=!0)})),t?(this.show(),this.parent.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!1)):this.hide()},n.prototype.show=function(t,e){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(t){t.show()})),this.isGroup||null!==this.width||this.reinitializeWidth(),this.table.columnManager._verticalAlignHeaders(),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),!e&&this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.updateColumnVisibility(this,this.visible),t||this.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths())},n.prototype.hide=function(t,e){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager._verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach((function(t){t.hide()})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.columns&&this.table.modules.persistence.save("columns"),!e&&this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.updateColumnVisibility(this,this.visible),t||this.table.options.columnVisibilityChanged.call(this.table,this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths())},n.prototype.matchChildWidths=function(){var t=0;this.contentElement&&this.columns.length&&(this.columns.forEach((function(e){e.visible&&(t+=e.getWidth())})),this.contentElement.style.maxWidth=t-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())},n.prototype.setWidth=function(t){this.widthFixed=!0,this.setWidthActual(t)},n.prototype.setWidthActual=function(t){isNaN(t)&&(t=Math.floor(this.table.element.clientWidth/100*parseInt(t))),t=Math.max(this.minWidth,t),this.width=t,this.widthStyled=t?t+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach((function(t){t.setWidth()})),this.parent.isGroup&&this.parent.matchChildWidths(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()},n.prototype.checkCellHeights=function(){var t=[];this.cells.forEach((function(e){e.row.heightInitialized&&(null!==e.row.getElement().offsetParent?(t.push(e.row),e.row.clearCellHeight()):e.row.heightInitialized=!1)})),t.forEach((function(t){t.calcHeight()})),t.forEach((function(t){t.setCellHeight()}))},n.prototype.getWidth=function(){var t=0;return this.isGroup?this.columns.forEach((function(e){e.visible&&(t+=e.getWidth())})):t=this.width,t},n.prototype.getHeight=function(){return this.element.offsetHeight},n.prototype.setMinWidth=function(t){this.minWidth=t,this.minWidthStyled=t?t+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach((function(t){t.setMinWidth()}))},n.prototype.delete=function(){var t=this;return new Promise((function(e,i){t.isGroup&&t.columns.forEach((function(t){t.delete()}));for(var n=t.cells.length,o=0;o<n;o++)t.cells[0].delete();t.element.parentNode.removeChild(t.element),t.table.columnManager.deregisterColumn(t),e()}))},n.prototype.columnRendered=function(){this.titleFormatterRendered&&this.titleFormatterRendered()},n.prototype.generateCell=function(t){var e=new u(this,t);return this.cells.push(e),e},n.prototype.nextColumn=function(){var t=this.table.columnManager.findColumnIndex(this);return t>-1&&this._nextVisibleColumn(t+1)},n.prototype._nextVisibleColumn=function(t){var e=this.table.columnManager.getColumnByIndex(t);return!e||e.visible?e:this._nextVisibleColumn(t+1)},n.prototype.prevColumn=function(){var t=this.table.columnManager.findColumnIndex(this);return t>-1&&this._prevVisibleColumn(t-1)},n.prototype._prevVisibleColumn=function(t){var e=this.table.columnManager.getColumnByIndex(t);return!e||e.visible?e:this._prevVisibleColumn(t-1)},n.prototype.reinitializeWidth=function(t){this.widthFixed=!1,void 0===this.definition.width||t||this.setWidth(this.definition.width),this.table.modExists("filter")&&this.table.modules.filter.hideHeaderFilterElements(),this.fitToData(),this.table.modExists("filter")&&this.table.modules.filter.showHeaderFilterElements()},n.prototype.fitToData=function(){this.widthFixed||(this.element.style.width="",this.cells.forEach((function(t){t.clearWidth()})));var t=this.element.offsetWidth;this.width&&this.widthFixed||(this.cells.forEach((function(e){var i=e.getWidth();i>t&&(t=i)})),t&&this.setWidthActual(t+1))},n.prototype.updateDefinition=function(t){var e=this;return new Promise((function(i,n){var o;e.isGroup?(console.warn("Column Update Error - The updateDefintion function is only available on columns, not column groups"),n("Column Update Error - The updateDefintion function is only available on columns, not column groups")):(o=Object.assign({},e.getDefinition()),o=Object.assign(o,t),e.table.columnManager.addColumn(o,!1,e).then((function(t){o.field==e.field&&(e.field=!1),e.delete().then((function(){i(t.getComponent())})).catch((function(t){n(t)}))})).catch((function(t){n(t)})))}))},n.prototype.deleteCell=function(t){var e=this.cells.indexOf(t);e>-1&&this.cells.splice(e,1)},n.prototype.defaultOptionList=["title","field","columns","visible","align","hozAlign","vertAlign","width","minWidth","widthGrow","widthShrink","resizable","frozen","responsive","tooltip","cssClass","rowHandle","hideInHtml","print","htmlOutput","sorter","sorterParams","formatter","formatterParams","variableHeight","editable","editor","editorParams","validator","mutator","mutatorParams","mutatorData","mutatorDataParams","mutatorEdit","mutatorEditParams","mutatorClipboard","mutatorClipboardParams","accessor","accessorParams","accessorData","accessorDataParams","accessorDownload","accessorDownloadParams","accessorClipboard","accessorClipboardParams","accessorPrint","accessorPrintParams","accessorHtmlOutput","accessorHtmlOutputParams","clipboard","download","downloadTitle","topCalc","topCalcParams","topCalcFormatter","topCalcFormatterParams","bottomCalc","bottomCalcParams","bottomCalcFormatter","bottomCalcFormatterParams","cellClick","cellDblClick","cellContext","cellTap","cellDblTap","cellTapHold","cellMouseEnter","cellMouseLeave","cellMouseOver","cellMouseOut","cellMouseMove","cellEditing","cellEdited","cellEditCancelled","headerSort","headerSortStartingDir","headerSortTristate","headerClick","headerDblClick","headerContext","headerTap","headerDblTap","headerTapHold","headerTooltip","headerVertical","editableTitle","titleFormatter","titleFormatterParams","headerFilter","headerFilterPlaceholder","headerFilterParams","headerFilterEmptyCheck","headerFilterFunc","headerFilterFuncParams","headerFilterLiveFilter","print","headerContextMenu","headerMenu","contextMenu","formatterPrint","formatterPrintParams","formatterClipboard","formatterClipboardParams","formatterHtmlOutput","formatterHtmlOutputParams"],n.prototype.getComponent=function(){return new i(this)};var o=function(t){this.table=t,this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.columnManager=null,this.height=0,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[],this.rowNumColumn=!1,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRederInPosition=!1};o.prototype.createHolderElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-tableHolder"),t.setAttribute("tabindex",0),t},o.prototype.createTableElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-table"),t},o.prototype.getElement=function(){return this.element},o.prototype.getTableElement=function(){return this.tableElement},o.prototype.getRowPosition=function(t,e){return e?this.activeRows.indexOf(t):this.rows.indexOf(t)},o.prototype.setColumnManager=function(t){this.columnManager=t},o.prototype.initialize=function(){var t=this;t.setRenderMode(),t.element.appendChild(t.tableElement),t.firstRender=!0,t.element.addEventListener("scroll",(function(){var e=t.element.scrollLeft;t.scrollLeft!=e&&(t.columnManager.scrollHorizontal(e),t.table.options.groupBy&&t.table.modules.groupRows.scrollHeaders(e),t.table.modExists("columnCalcs")&&t.table.modules.columnCalcs.scrollHorizontal(e),t.table.options.scrollHorizontal(e)),t.scrollLeft=e})),"virtual"===this.renderMode&&t.element.addEventListener("scroll",(function(){var e=t.element.scrollTop,i=t.scrollTop>e;t.scrollTop!=e?(t.scrollTop=e,t.scrollVertical(i),"scroll"==t.table.options.ajaxProgressiveLoad&&t.table.modules.ajax.nextPage(t.element.scrollHeight-t.element.clientHeight-e),t.table.options.scrollVertical(e)):t.scrollTop=e}))},o.prototype.findRow=function(t){var e=this;return"object"!=(void 0===t?"undefined":s(t))?null!=t&&(e.rows.find((function(i){return i.data[e.table.options.index]==t}))||!1):t instanceof a?t:t instanceof r?t._getSelf()||!1:"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&e.rows.find((function(e){return e.element===t}))||!1},o.prototype.getRowFromDataObject=function(t){return this.rows.find((function(e){return e.data===t}))||!1},o.prototype.getRowFromPosition=function(t,e){return e?this.activeRows[t]:this.rows[t]},o.prototype.scrollToRow=function(t,e,i){var n,o=this,r=this.getDisplayRows().indexOf(t),a=t.getElement(),s=0;return new Promise((function(t,l){if(r>-1){if(void 0===e&&(e=o.table.options.scrollToRowPosition),void 0===i&&(i=o.table.options.scrollToRowIfVisible),"nearest"===e)switch(o.renderMode){case"classic":n=h.prototype.helpers.elOffset(a).top,e=Math.abs(o.element.scrollTop-n)>Math.abs(o.element.scrollTop+o.element.clientHeight-n)?"bottom":"top";break;case"virtual":e=Math.abs(o.vDomTop-r)>Math.abs(o.vDomBottom-r)?"bottom":"top"}if(!i&&h.prototype.helpers.elVisible(a)&&(s=h.prototype.helpers.elOffset(a).top-h.prototype.helpers.elOffset(o.element).top)>0&&s<o.element.clientHeight-a.offsetHeight)return!1;switch(o.renderMode){case"classic":o.element.scrollTop=h.prototype.helpers.elOffset(a).top-h.prototype.helpers.elOffset(o.element).top+o.element.scrollTop;break;case"virtual":o._virtualRenderFill(r,!0)}switch(e){case"middle":case"center":o.element.scrollHeight-o.element.scrollTop==o.element.clientHeight?o.element.scrollTop=o.element.scrollTop+(a.offsetTop-o.element.scrollTop)-(o.element.scrollHeight-a.offsetTop)/2:o.element.scrollTop=o.element.scrollTop-o.element.clientHeight/2;break;case"bottom":o.element.scrollHeight-o.element.scrollTop==o.element.clientHeight?o.element.scrollTop=o.element.scrollTop-(o.element.scrollHeight-a.offsetTop)+a.offsetHeight:o.element.scrollTop=o.element.scrollTop-o.element.clientHeight+a.offsetHeight}t()}else console.warn("Scroll Error - Row not visible"),l("Scroll Error - Row not visible")}))},o.prototype.setData=function(t,e,i){var n=this,o=this;return new Promise((function(r,a){e&&n.getDisplayRows().length?o.table.options.pagination?o._setDataActual(t,!0):n.reRenderInPosition((function(){o._setDataActual(t)})):(n.table.options.autoColumns&&i&&n.table.columnManager.generateColumnsFromRowData(t),n.resetScroll(),n._setDataActual(t)),r()}))},o.prototype._setDataActual=function(t,e){var i=this;i.table.options.dataLoading.call(this.table,t),this._wipeElements(),this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.clear(),Array.isArray(t)?(this.table.modExists("selectRow")&&this.table.modules.selectRow.clearSelectionData(),this.table.options.reactiveData&&this.table.modExists("reactiveData",!0)&&this.table.modules.reactiveData.watchData(t),t.forEach((function(t,e){if(t&&"object"===(void 0===t?"undefined":s(t))){var n=new a(t,i);i.rows.push(n)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",t)})),i.table.options.dataLoaded.call(this.table,t),i.refreshActiveData(!1,!1,e)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",void 0===t?"undefined":s(t),"\nData:     ",t)},o.prototype._wipeElements=function(){this.rows.forEach((function(t){t.wipe()})),this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.wipe(),this.rows=[]},o.prototype.deleteRow=function(t,e){var i=this.rows.indexOf(t),n=this.activeRows.indexOf(t);n>-1&&this.activeRows.splice(n,1),i>-1&&this.rows.splice(i,1),this.setActiveRows(this.activeRows),this.displayRowIterator((function(e){var i=e.indexOf(t);i>-1&&e.splice(i,1)})),e||this.reRenderInPosition(),this.regenerateRowNumbers(),this.table.options.rowDeleted.call(this.table,t.getComponent()),this.table.options.dataEdited.call(this.table,this.getData()),this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.updateGroupRows(!0):this.table.options.pagination&&this.table.modExists("page")?this.refreshActiveData(!1,!1,!0):this.table.options.pagination&&this.table.modExists("page")&&this.refreshActiveData("page")},o.prototype.addRow=function(t,e,i,n){var o=this.addRowActual(t,e,i,n);return this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("rowAdd",o,{data:t,pos:e,index:i}),o},o.prototype.addRows=function(t,e,i){var n=this,o=this,r=[];return new Promise((function(a,s){e=n.findAddRowPos(e),Array.isArray(t)||(t=[t]),t.length,(void 0===i&&e||void 0!==i&&!e)&&t.reverse(),t.forEach((function(t,n){var a=o.addRow(t,e,i,!0);r.push(a)})),n.table.options.groupBy&&n.table.modExists("groupRows")?n.table.modules.groupRows.updateGroupRows(!0):n.table.options.pagination&&n.table.modExists("page")?n.refreshActiveData(!1,!1,!0):n.reRenderInPosition(),n.table.modExists("columnCalcs")&&n.table.modules.columnCalcs.recalc(n.table.rowManager.activeRows),n.regenerateRowNumbers(),a(r)}))},o.prototype.findAddRowPos=function(t){return void 0===t&&(t=this.table.options.addRowPos),"pos"===t&&(t=!0),"bottom"===t&&(t=!1),t},o.prototype.addRowActual=function(t,e,i,n){var o,r,s=t instanceof a?t:new a(t||{},this),l=this.findAddRowPos(e),u=-1;if(!i&&this.table.options.pagination&&"page"==this.table.options.paginationAddRow&&(r=this.getDisplayRows(),l?r.length?i=r[0]:this.activeRows.length&&(i=this.activeRows[this.activeRows.length-1],l=!1):r.length&&(i=r[r.length-1],l=!(r.length<this.table.modules.page.getPageSize()))),void 0!==i&&(i=this.findRow(i)),this.table.options.groupBy&&this.table.modExists("groupRows")){this.table.modules.groupRows.assignRowToGroup(s);var c=s.getGroup().rows;c.length>1&&(!i||i&&-1==c.indexOf(i)?l?c[0]!==s&&(i=c[0],this._moveRowInArray(s.getGroup().rows,s,i,!l)):c[c.length-1]!==s&&(i=c[c.length-1],this._moveRowInArray(s.getGroup().rows,s,i,!l)):this._moveRowInArray(s.getGroup().rows,s,i,!l))}return i&&(u=this.rows.indexOf(i)),i&&u>-1?(o=this.activeRows.indexOf(i),this.displayRowIterator((function(t){var e=t.indexOf(i);e>-1&&t.splice(l?e:e+1,0,s)})),o>-1&&this.activeRows.splice(l?o:o+1,0,s),this.rows.splice(l?u:u+1,0,s)):l?(this.displayRowIterator((function(t){t.unshift(s)})),this.activeRows.unshift(s),this.rows.unshift(s)):(this.displayRowIterator((function(t){t.push(s)})),this.activeRows.push(s),this.rows.push(s)),this.setActiveRows(this.activeRows),this.table.options.rowAdded.call(this.table,s.getComponent()),this.table.options.dataEdited.call(this.table,this.getData()),n||this.reRenderInPosition(),s},o.prototype.moveRow=function(t,e,i){this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("rowMove",t,{posFrom:this.getRowPosition(t),posTo:this.getRowPosition(e),to:e,after:i}),this.moveRowActual(t,e,i),this.regenerateRowNumbers(),this.table.options.rowMoved.call(this.table,t.getComponent())},o.prototype.moveRowActual=function(t,e,i){var n=this;if(this._moveRowInArray(this.rows,t,e,i),this._moveRowInArray(this.activeRows,t,e,i),this.displayRowIterator((function(o){n._moveRowInArray(o,t,e,i)})),this.table.options.groupBy&&this.table.modExists("groupRows")){var o=e.getGroup(),r=t.getGroup();o===r?this._moveRowInArray(o.rows,t,e,i):(r&&r.removeRow(t),o.insertRow(t,e,i))}},o.prototype._moveRowInArray=function(t,e,i,n){var o,r,a;if(e!==i&&((o=t.indexOf(e))>-1&&(t.splice(o,1),(r=t.indexOf(i))>-1?n?t.splice(r+1,0,e):t.splice(r,0,e):t.splice(o,0,e)),t===this.getDisplayRows())){a=r>o?r:o+1;for(var s=o<r?o:r;s<=a;s++)t[s]&&this.styleRow(t[s],s)}},o.prototype.clearData=function(){this.setData([])},o.prototype.getRowIndex=function(t){return this.findRowIndex(t,this.rows)},o.prototype.getDisplayRowIndex=function(t){var e=this.getDisplayRows().indexOf(t);return e>-1&&e},o.prototype.nextDisplayRow=function(t,e){var i=this.getDisplayRowIndex(t),n=!1;return!1!==i&&i<this.displayRowsCount-1&&(n=this.getDisplayRows()[i+1]),!n||n instanceof a&&"row"==n.type?n:this.nextDisplayRow(n,e)},o.prototype.prevDisplayRow=function(t,e){var i=this.getDisplayRowIndex(t),n=!1;return i&&(n=this.getDisplayRows()[i-1]),!n||n instanceof a&&"row"==n.type?n:this.prevDisplayRow(n,e)},o.prototype.findRowIndex=function(t,e){var i;return!!((t=this.findRow(t))&&(i=e.indexOf(t))>-1)&&i},o.prototype.getData=function(t,e){var i=[];return this.getRows(t).forEach((function(t){"row"==t.type&&i.push(t.getData(e||"data"))})),i},o.prototype.getComponents=function(t){var e=[];return this.getRows(t).forEach((function(t){e.push(t.getComponent())})),e},o.prototype.getDataCount=function(t){return this.getRows(t).length},o.prototype._genRemoteRequest=function(){var t=this,e=this.table,i=e.options,n={};if(e.modExists("page")){if(i.ajaxSorting){var o=this.table.modules.sort.getSort();o.forEach((function(t){delete t.column})),n[this.table.modules.page.paginationDataSentNames.sorters]=o}if(i.ajaxFiltering){var r=this.table.modules.filter.getFilters(!0,!0);n[this.table.modules.page.paginationDataSentNames.filters]=r}this.table.modules.ajax.setParams(n,!0)}e.modules.ajax.sendRequest().then((function(e){t._setDataActual(e,!0)})).catch((function(t){}))},o.prototype.filterRefresh=function(){var t=this.table,e=t.options,i=this.scrollLeft;e.ajaxFiltering?"remote"==e.pagination&&t.modExists("page")?(t.modules.page.reset(!0),t.modules.page.setPage(1).then((function(){})).catch((function(){}))):e.ajaxProgressiveLoad?t.modules.ajax.loadData().then((function(){})).catch((function(){})):this._genRemoteRequest():this.refreshActiveData("filter"),this.scrollHorizontal(i)},o.prototype.sorterRefresh=function(t){var e=this.table,i=this.table.options,n=this.scrollLeft;i.ajaxSorting?("remote"==i.pagination||i.progressiveLoad)&&e.modExists("page")?(e.modules.page.reset(!0),e.modules.page.setPage(1).then((function(){})).catch((function(){}))):i.ajaxProgressiveLoad?e.modules.ajax.loadData().then((function(){})).catch((function(){})):this._genRemoteRequest():this.refreshActiveData(t?"filter":"sort"),this.scrollHorizontal(n)},o.prototype.scrollHorizontal=function(t){this.scrollLeft=t,this.element.scrollLeft=t,this.table.options.groupBy&&this.table.modules.groupRows.scrollHeaders(t),this.table.modExists("columnCalcs")&&this.table.modules.columnCalcs.scrollHorizontal(t)},o.prototype.refreshActiveData=function(t,e,i){var n,o=this.table,r=["all","filter","sort","display","freeze","group","tree","page"];if(this.redrawBlock)(!this.redrawBlockRestoreConfig||r.indexOf(t)<r.indexOf(this.redrawBlockRestoreConfig.stage))&&(this.redrawBlockRestoreConfig={stage:t,skipStage:e,renderInPosition:i});else{switch(this.table.modExists("edit")&&this.table.modules.edit.cancelEdit(),t||(t="all"),o.options.selectable&&!o.options.selectablePersistence&&o.modExists("selectRow")&&o.modules.selectRow.deselectRows(),t){case"all":case"filter":e?e=!1:o.modExists("filter")?this.setActiveRows(o.modules.filter.filter(this.rows)):this.setActiveRows(this.rows.slice(0));case"sort":e?e=!1:o.modExists("sort")&&o.modules.sort.sort(this.activeRows),this.regenerateRowNumbers();case"display":this.resetDisplayRows();case"freeze":e?e=!1:this.table.modExists("frozenRows")&&o.modules.frozenRows.isFrozen()&&(o.modules.frozenRows.getDisplayIndex()||o.modules.frozenRows.setDisplayIndex(this.getNextDisplayIndex()),n=o.modules.frozenRows.getDisplayIndex(),!0!==(n=this.setDisplayRows(o.modules.frozenRows.getRows(this.getDisplayRows(n-1)),n))&&o.modules.frozenRows.setDisplayIndex(n));case"group":e?e=!1:o.options.groupBy&&o.modExists("groupRows")&&(o.modules.groupRows.getDisplayIndex()||o.modules.groupRows.setDisplayIndex(this.getNextDisplayIndex()),n=o.modules.groupRows.getDisplayIndex(),!0!==(n=this.setDisplayRows(o.modules.groupRows.getRows(this.getDisplayRows(n-1)),n))&&o.modules.groupRows.setDisplayIndex(n));case"tree":e?e=!1:o.options.dataTree&&o.modExists("dataTree")&&(o.modules.dataTree.getDisplayIndex()||o.modules.dataTree.setDisplayIndex(this.getNextDisplayIndex()),n=o.modules.dataTree.getDisplayIndex(),!0!==(n=this.setDisplayRows(o.modules.dataTree.getRows(this.getDisplayRows(n-1)),n))&&o.modules.dataTree.setDisplayIndex(n)),o.options.pagination&&o.modExists("page")&&!i&&"local"==o.modules.page.getMode()&&o.modules.page.reset();case"page":e?e=!1:o.options.pagination&&o.modExists("page")&&(o.modules.page.getDisplayIndex()||o.modules.page.setDisplayIndex(this.getNextDisplayIndex()),n=o.modules.page.getDisplayIndex(),"local"==o.modules.page.getMode()&&o.modules.page.setMaxRows(this.getDisplayRows(n-1).length),!0!==(n=this.setDisplayRows(o.modules.page.getRows(this.getDisplayRows(n-1)),n))&&o.modules.page.setDisplayIndex(n))}h.prototype.helpers.elVisible(this.element)&&(i?this.reRenderInPosition():(this.renderTable(),o.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0))),o.modExists("columnCalcs")&&o.modules.columnCalcs.recalc(this.activeRows)}},o.prototype.regenerateRowNumbers=function(){var t=this;this.rowNumColumn&&this.activeRows.forEach((function(e){var i=e.getCell(t.rowNumColumn);i&&i._generateContents()}))},o.prototype.setActiveRows=function(t){this.activeRows=t,this.activeRowsCount=this.activeRows.length},o.prototype.resetDisplayRows=function(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length,this.table.modExists("frozenRows")&&this.table.modules.frozenRows.setDisplayIndex(0),this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.setDisplayIndex(0),this.table.options.pagination&&this.table.modExists("page")&&this.table.modules.page.setDisplayIndex(0)},o.prototype.getNextDisplayIndex=function(){return this.displayRows.length},o.prototype.setDisplayRows=function(t,e){var i=!0;return e&&void 0!==this.displayRows[e]?(this.displayRows[e]=t,i=!0):(this.displayRows.push(t),i=e=this.displayRows.length-1),e==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length),i},o.prototype.getDisplayRows=function(t){return void 0===t?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[t]||[]},o.prototype.getVisibleRows=function(t){var e=this.element.scrollTop,i=this.element.clientHeight+e,n=!1,o=0,r=0,a=this.getDisplayRows();if(t){this.getDisplayRows();for(var s=this.vDomTop;s<=this.vDomBottom;s++)if(a[s])if(n){if(!(i-a[s].getElement().offsetTop>=0))break;r=s}else if(e-a[s].getElement().offsetTop>=0)o=s;else{if(n=!0,!(i-a[s].getElement().offsetTop>=0))break;r=s}}else o=this.vDomTop,r=this.vDomBottom;return a.slice(o,r+1)},o.prototype.displayRowIterator=function(t){this.displayRows.forEach(t),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length},o.prototype.getRows=function(t){var e;switch(t){case"active":e=this.activeRows;break;case"display":e=this.table.rowManager.getDisplayRows();break;case"visible":e=this.getVisibleRows(!0);break;default:e=this.rows}return e},o.prototype.reRenderInPosition=function(t){if("virtual"==this.getRenderMode())if(this.redrawBlock)t?t():this.redrawBlockRederInPosition=!0;else{for(var e=this.element.scrollTop,i=!1,n=!1,o=this.scrollLeft,r=this.getDisplayRows(),a=this.vDomTop;a<=this.vDomBottom;a++)if(r[a]){var s=e-r[a].getElement().offsetTop;if(!(!1===n||Math.abs(s)<n))break;n=s,i=a}t&&t(),this._virtualRenderFill(!1===i?this.displayRowsCount-1:i,!0,n||0),this.scrollHorizontal(o)}else this.renderTable(),t&&t()},o.prototype.setRenderMode=function(){this.table.options.virtualDom?(this.renderMode="virtual",this.table.element.clientHeight||this.table.options.height?this.fixedHeight=!0:this.fixedHeight=!1):this.renderMode="classic"},o.prototype.getRenderMode=function(){return this.renderMode},o.prototype.renderTable=function(){switch(this.table.options.renderStarted.call(this.table),this.element.scrollTop=0,this.renderMode){case"classic":this._simpleRender();break;case"virtual":this._virtualRenderFill()}this.firstRender&&(this.displayRowsCount?(this.firstRender=!1,this.table.modules.layout.layout()):this.renderEmptyScroll()),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout(),this.displayRowsCount||this.table.options.placeholder&&(this.table.options.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.table.options.placeholder),this.table.options.placeholder.style.width=this.table.columnManager.getWidth()+"px"),this.table.options.renderComplete.call(this.table)},o.prototype._simpleRender=function(){this._clearVirtualDom(),this.displayRowsCount?this.checkClassicModeGroupHeaderWidth():this.renderEmptyScroll()},o.prototype.checkClassicModeGroupHeaderWidth=function(){var t=this,e=this.tableElement,i=!0;t.getDisplayRows().forEach((function(n,o){t.styleRow(n,o),e.appendChild(n.getElement()),n.initialize(!0),"group"!==n.type&&(i=!1)})),e.style.minWidth=i?t.table.columnManager.getWidth()+"px":""},o.prototype.renderEmptyScroll=function(){this.table.options.placeholder?this.tableElement.style.display="none":(this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px",this.tableElement.style.minHeight="1px",this.tableElement.style.visibility="hidden")},o.prototype._clearVirtualDom=function(){var t=this.tableElement;for(this.table.options.placeholder&&this.table.options.placeholder.parentNode&&this.table.options.placeholder.parentNode.removeChild(this.table.options.placeholder);t.firstChild;)t.removeChild(t.firstChild);t.style.paddingTop="",t.style.paddingBottom="",t.style.minWidth="",t.style.minHeight="",t.style.display="",t.style.visibility="",this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0},o.prototype.styleRow=function(t,e){var i=t.getElement();e%2?(i.classList.add("tabulator-row-even"),i.classList.remove("tabulator-row-odd")):(i.classList.add("tabulator-row-odd"),i.classList.remove("tabulator-row-even"))},o.prototype._virtualRenderFill=function(t,e,i){var n=this.tableElement,o=this.element,r=0,a=0,s=0,l=0,u=!0,c=this.getDisplayRows();if(i=i||0,t=t||0){for(;n.firstChild;)n.removeChild(n.firstChild);var d=(this.displayRowsCount-t+1)*this.vDomRowHeight;d<this.height&&(t-=Math.ceil((this.height-d)/this.vDomRowHeight))<0&&(t=0),t-=r=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),t)}else this._clearVirtualDom();if(this.displayRowsCount&&h.prototype.helpers.elVisible(this.element)){for(this.vDomTop=t,this.vDomBottom=t-1;(a<=this.height+this.vDomWindowBuffer||l<this.vDomWindowMinTotalRows)&&this.vDomBottom<this.displayRowsCount-1;){var p,f=this.vDomBottom+1,g=c[f];this.styleRow(g,f),n.appendChild(g.getElement()),g.initialized?g.heightInitialized||g.normalizeHeight(!0):g.initialize(!0),p=g.getHeight(),l<r?s+=p:a+=p,p>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*p),"group"!==g.type&&(u=!1),this.vDomBottom++,l++}t?(this.vDomTopPad=e?this.vDomRowHeight*this.vDomTop+i:this.scrollTop-s,this.vDomBottomPad=this.vDomBottom==this.displayRowsCount-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-a-s,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((a+s)/l),this.vDomBottomPad=this.vDomRowHeight*(this.displayRowsCount-this.vDomBottom-1),this.vDomScrollHeight=s+a+this.vDomBottomPad-this.height),n.style.paddingTop=this.vDomTopPad+"px",n.style.paddingBottom=this.vDomBottomPad+"px",e&&(this.scrollTop=this.vDomTopPad+s+i-(this.element.scrollWidth>this.element.clientWidth?this.element.offsetHeight-this.element.clientHeight:0)),this.scrollTop=Math.min(this.scrollTop,this.element.scrollHeight-this.height),this.element.scrollWidth>this.element.offsetWidth&&e&&(this.scrollTop+=this.element.offsetHeight-this.element.clientHeight),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,o.scrollTop=this.scrollTop,n.style.minWidth=u?this.table.columnManager.getWidth()+"px":"",this.table.options.groupBy&&"fitDataFill"!=this.table.modules.layout.getMode()&&this.displayRowsCount==this.table.modules.groupRows.countGroups()&&(this.tableElement.style.minWidth=this.table.columnManager.getWidth())}else this.renderEmptyScroll();this.fixedHeight||this.adjustTableSize()},o.prototype.scrollVertical=function(t){var e=this.scrollTop-this.vDomScrollPosTop,i=this.scrollTop-this.vDomScrollPosBottom,n=2*this.vDomWindowBuffer;if(-e>n||i>n){var o=this.scrollLeft;this._virtualRenderFill(Math.floor(this.element.scrollTop/this.element.scrollHeight*this.displayRowsCount)),this.scrollHorizontal(o)}else t?(e<0&&this._addTopRow(-e),i<0&&this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer&&this._removeBottomRow(-i)):(e>=0&&this.scrollTop>this.vDomWindowBuffer&&this._removeTopRow(e),i>=0&&this._addBottomRow(i))},o.prototype._addTopRow=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.tableElement,n=this.getDisplayRows();if(this.vDomTop){var o=this.vDomTop-1,r=n[o],a=r.getHeight()||this.vDomRowHeight;t>=a&&(this.styleRow(r,o),i.insertBefore(r.getElement(),i.firstChild),r.initialized&&r.heightInitialized||(this.vDomTopNewRows.push(r),r.heightInitialized||r.clearCellHeight()),r.initialize(),this.vDomTopPad-=a,this.vDomTopPad<0&&(this.vDomTopPad=o*this.vDomRowHeight),o||(this.vDomTopPad=0),i.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=a,this.vDomTop--),t=-(this.scrollTop-this.vDomScrollPosTop),r.getHeight()>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*r.getHeight()),e<this.vDomMaxRenderChain&&this.vDomTop&&t>=(n[this.vDomTop-1].getHeight()||this.vDomRowHeight)?this._addTopRow(t,e+1):this._quickNormalizeRowHeight(this.vDomTopNewRows)}},o.prototype._removeTopRow=function(t){var e=this.tableElement,i=this.getDisplayRows()[this.vDomTop],n=i.getHeight()||this.vDomRowHeight;if(t>=n){var o=i.getElement();o.parentNode.removeChild(o),this.vDomTopPad+=n,e.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?n:n+this.vDomWindowBuffer,this.vDomTop++,t=this.scrollTop-this.vDomScrollPosTop,this._removeTopRow(t)}},o.prototype._addBottomRow=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.tableElement,n=this.getDisplayRows();if(this.vDomBottom<this.displayRowsCount-1){var o=this.vDomBottom+1,r=n[o],a=r.getHeight()||this.vDomRowHeight;t>=a&&(this.styleRow(r,o),i.appendChild(r.getElement()),r.initialized&&r.heightInitialized||(this.vDomBottomNewRows.push(r),r.heightInitialized||r.clearCellHeight()),r.initialize(),this.vDomBottomPad-=a,(this.vDomBottomPad<0||o==this.displayRowsCount-1)&&(this.vDomBottomPad=0),i.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=a,this.vDomBottom++),t=this.scrollTop-this.vDomScrollPosBottom,r.getHeight()>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*r.getHeight()),e<this.vDomMaxRenderChain&&this.vDomBottom<this.displayRowsCount-1&&t>=(n[this.vDomBottom+1].getHeight()||this.vDomRowHeight)?this._addBottomRow(t,e+1):this._quickNormalizeRowHeight(this.vDomBottomNewRows)}},o.prototype._removeBottomRow=function(t){var e=this.tableElement,i=this.getDisplayRows()[this.vDomBottom],n=i.getHeight()||this.vDomRowHeight;if(t>=n){var o=i.getElement();o.parentNode&&o.parentNode.removeChild(o),this.vDomBottomPad+=n,this.vDomBottomPad<0&&(this.vDomBottomPad=0),e.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=n,this.vDomBottom--,t=-(this.scrollTop-this.vDomScrollPosBottom),this._removeBottomRow(t)}},o.prototype._quickNormalizeRowHeight=function(t){t.forEach((function(t){t.calcHeight()})),t.forEach((function(t){t.setCellHeight()})),t.length=0},o.prototype.normalizeHeight=function(){this.activeRows.forEach((function(t){t.normalizeHeight()}))},o.prototype.adjustTableSize=function(){var t,e=this.element.clientHeight;if("virtual"===this.renderMode){var i=this.columnManager.getElement().offsetHeight+(this.table.footerManager&&!this.table.footerManager.external?this.table.footerManager.getElement().offsetHeight:0);this.fixedHeight?(this.element.style.minHeight="calc(100% - "+i+"px)",this.element.style.height="calc(100% - "+i+"px)",this.element.style.maxHeight="calc(100% - "+i+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-i+"px",this.element.scrollTop=this.scrollTop),this.height=this.element.clientHeight,this.vDomWindowBuffer=this.table.options.virtualDomBuffer||this.height,this.fixedHeight||e==this.element.clientHeight||((t=this.table.modExists("resizeTable"))&&!this.table.modules.resizeTable.autoResize||!t)&&this.redraw()}},o.prototype.reinitialize=function(){this.rows.forEach((function(t){t.reinitialize()}))},o.prototype.blockRedraw=function(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1},o.prototype.restoreRedraw=function(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.stage,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRederInPosition&&this.reRenderInPosition(),this.redrawBlockRederInPosition=!1},o.prototype.redraw=function(t){var e=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,t?this.renderTable():("classic"==this.renderMode?this.table.options.groupBy?this.refreshActiveData("group",!1,!1):this._simpleRender():(this.reRenderInPosition(),this.scrollHorizontal(e)),this.displayRowsCount||this.table.options.placeholder&&this.getElement().appendChild(this.table.options.placeholder))},o.prototype.resetScroll=function(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var t=document.createEvent("Event");t.initEvent("scroll",!1,!0),this.element.dispatchEvent(t)}else this.element.dispatchEvent(new Event("scroll"))};var r=function(t){this._row=t};r.prototype.getData=function(t){return this._row.getData(t)},r.prototype.getElement=function(){return this._row.getElement()},r.prototype.getCells=function(){var t=[];return this._row.getCells().forEach((function(e){t.push(e.getComponent())})),t},r.prototype.getCell=function(t){var e=this._row.getCell(t);return!!e&&e.getComponent()},r.prototype.getIndex=function(){return this._row.getData("data")[this._row.table.options.index]},r.prototype.getPosition=function(t){return this._row.table.rowManager.getRowPosition(this._row,t)},r.prototype.delete=function(){return this._row.delete()},r.prototype.scrollTo=function(){return this._row.table.rowManager.scrollToRow(this._row)},r.prototype.pageTo=function(){if(this._row.table.modExists("page",!0))return this._row.table.modules.page.setPageToRow(this._row)},r.prototype.move=function(t,e){this._row.moveToRow(t,e)},r.prototype.update=function(t){return this._row.updateData(t)},r.prototype.normalizeHeight=function(){this._row.normalizeHeight(!0)},r.prototype.select=function(){this._row.table.modules.selectRow.selectRows(this._row)},r.prototype.deselect=function(){this._row.table.modules.selectRow.deselectRows(this._row)},r.prototype.toggleSelect=function(){this._row.table.modules.selectRow.toggleRow(this._row)},r.prototype.isSelected=function(){return this._row.table.modules.selectRow.isRowSelected(this._row)},r.prototype._getSelf=function(){return this._row},r.prototype.freeze=function(){this._row.table.modExists("frozenRows",!0)&&this._row.table.modules.frozenRows.freezeRow(this._row)},r.prototype.unfreeze=function(){this._row.table.modExists("frozenRows",!0)&&this._row.table.modules.frozenRows.unfreezeRow(this._row)},r.prototype.treeCollapse=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.collapseRow(this._row)},r.prototype.treeExpand=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.expandRow(this._row)},r.prototype.treeToggle=function(){this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.toggleRow(this._row)},r.prototype.getTreeParent=function(){return!!this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.getTreeParent(this._row)},r.prototype.getTreeChildren=function(){return!!this._row.table.modExists("dataTree",!0)&&this._row.table.modules.dataTree.getTreeChildren(this._row)},r.prototype.reformat=function(){return this._row.reinitialize()},r.prototype.getGroup=function(){return this._row.getGroup().getComponent()},r.prototype.getTable=function(){return this._row.table},r.prototype.getNextRow=function(){var t=this._row.nextRow();return t?t.getComponent():t},r.prototype.getPrevRow=function(){var t=this._row.prevRow();return t?t.getComponent():t};var a=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"row";this.table=e.table,this.parent=e,this.data={},this.type=i,this.element=this.createElement(),this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.setData(t),this.generateElement()};a.prototype.createElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-row"),t.setAttribute("role","row"),t},a.prototype.getElement=function(){return this.element},a.prototype.detachElement=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},a.prototype.generateElement=function(){var t,e,i,n=this;!1!==n.table.options.selectable&&n.table.modExists("selectRow")&&n.table.modules.selectRow.initializeRow(this),!1!==n.table.options.movableRows&&n.table.modExists("moveRow")&&n.table.modules.moveRow.initializeRow(this),!1!==n.table.options.dataTree&&n.table.modExists("dataTree")&&n.table.modules.dataTree.initializeRow(this),"collapse"===n.table.options.responsiveLayout&&n.table.modExists("responsiveLayout")&&n.table.modules.responsiveLayout.initializeRow(this),n.table.options.rowContextMenu&&this.table.modExists("menu")&&n.table.modules.menu.initializeRow(this),n.table.options.rowClick&&n.element.addEventListener("click",(function(t){n.table.options.rowClick(t,n.getComponent())})),n.table.options.rowDblClick&&n.element.addEventListener("dblclick",(function(t){n.table.options.rowDblClick(t,n.getComponent())})),n.table.options.rowContext&&n.element.addEventListener("contextmenu",(function(t){n.table.options.rowContext(t,n.getComponent())})),n.table.options.rowMouseEnter&&n.element.addEventListener("mouseenter",(function(t){n.table.options.rowMouseEnter(t,n.getComponent())})),n.table.options.rowMouseLeave&&n.element.addEventListener("mouseleave",(function(t){n.table.options.rowMouseLeave(t,n.getComponent())})),n.table.options.rowMouseOver&&n.element.addEventListener("mouseover",(function(t){n.table.options.rowMouseOver(t,n.getComponent())})),n.table.options.rowMouseOut&&n.element.addEventListener("mouseout",(function(t){n.table.options.rowMouseOut(t,n.getComponent())})),n.table.options.rowMouseMove&&n.element.addEventListener("mousemove",(function(t){n.table.options.rowMouseMove(t,n.getComponent())})),n.table.options.rowTap&&(i=!1,n.element.addEventListener("touchstart",(function(t){i=!0}),{passive:!0}),n.element.addEventListener("touchend",(function(t){i&&n.table.options.rowTap(t,n.getComponent()),i=!1}))),n.table.options.rowDblTap&&(t=null,n.element.addEventListener("touchend",(function(e){t?(clearTimeout(t),t=null,n.table.options.rowDblTap(e,n.getComponent())):t=setTimeout((function(){clearTimeout(t),t=null}),300)}))),n.table.options.rowTapHold&&(e=null,n.element.addEventListener("touchstart",(function(t){clearTimeout(e),e=setTimeout((function(){clearTimeout(e),e=null,i=!1,n.table.options.rowTapHold(t,n.getComponent())}),1e3)}),{passive:!0}),n.element.addEventListener("touchend",(function(t){clearTimeout(e),e=null})))},a.prototype.generateCells=function(){this.cells=this.table.columnManager.generateCells(this)},a.prototype.initialize=function(t){var e=this;if(!e.initialized||t){for(e.deleteCells();e.element.firstChild;)e.element.removeChild(e.element.firstChild);this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layoutRow(this),this.generateCells(),e.cells.forEach((function(t){e.element.appendChild(t.getElement()),t.cellRendered()})),t&&e.normalizeHeight(),e.table.options.dataTree&&e.table.modExists("dataTree")&&e.table.modules.dataTree.layoutRow(this),"collapse"===e.table.options.responsiveLayout&&e.table.modExists("responsiveLayout")&&e.table.modules.responsiveLayout.layoutRow(this),e.table.options.rowFormatter&&e.table.options.rowFormatter(e.getComponent()),e.table.options.resizableRows&&e.table.modExists("resizeRows")&&e.table.modules.resizeRows.initializeRow(e),e.initialized=!0}},a.prototype.reinitializeHeight=function(){this.heightInitialized=!1,null!==this.element.offsetParent&&this.normalizeHeight(!0)},a.prototype.reinitialize=function(){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),null!==this.element.offsetParent&&this.initialize(!0)},a.prototype.calcHeight=function(t){var e=0,i=this.table.options.resizableRows?this.element.clientHeight:0;this.cells.forEach((function(t){var i=t.getHeight();i>e&&(e=i)})),this.height=t?Math.max(e,i):this.manualHeight?this.height:Math.max(e,i),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight},a.prototype.setCellHeight=function(){this.cells.forEach((function(t){t.setHeight()})),this.heightInitialized=!0},a.prototype.clearCellHeight=function(){this.cells.forEach((function(t){t.clearHeight()}))},a.prototype.normalizeHeight=function(t){t&&this.clearCellHeight(),this.calcHeight(t),this.setCellHeight()},a.prototype.setHeight=function(t,e){(this.height!=t||e)&&(this.manualHeight=!0,this.height=t,this.heightStyled=t?t+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)},a.prototype.getHeight=function(){return this.outerHeight},a.prototype.getWidth=function(){return this.element.offsetWidth},a.prototype.deleteCell=function(t){var e=this.cells.indexOf(t);e>-1&&this.cells.splice(e,1)},a.prototype.setData=function(t){this.table.modExists("mutator")&&(t=this.table.modules.mutator.transformRow(t,"data")),this.data=t,this.table.options.reactiveData&&this.table.modExists("reactiveData",!0)&&this.table.modules.reactiveData.watchRow(this)},a.prototype.updateData=function(t){var e,i=this,n=h.prototype.helpers.elVisible(this.element),o={};return new Promise((function(r,a){for(var s in"string"==typeof t&&(t=JSON.parse(t)),i.table.options.reactiveData&&i.table.modExists("reactiveData",!0)&&i.table.modules.reactiveData.block(),i.table.modExists("mutator")?(o=Object.assign(o,i.data),o=Object.assign(o,t),e=i.table.modules.mutator.transformRow(o,"data",t)):e=t,e)i.data[s]=e[s];for(var s in i.table.options.reactiveData&&i.table.modExists("reactiveData",!0)&&i.table.modules.reactiveData.unblock(),t)i.table.columnManager.getColumnsByFieldRoot(s).forEach((function(t){var o=i.getCell(t.getField());if(o){var r=t.getFieldValue(e);o.getValue()!=r&&(o.setValueProcessData(r),n&&o.cellRendered())}}));n?(i.normalizeHeight(),i.table.options.rowFormatter&&i.table.options.rowFormatter(i.getComponent())):(i.initialized=!1,i.height=0,i.heightStyled=""),!1!==i.table.options.dataTree&&i.table.modExists("dataTree")&&i.table.modules.dataTree.redrawNeeded(t)&&(i.table.modules.dataTree.initializeRow(i),i.table.modules.dataTree.layoutRow(i),i.table.rowManager.refreshActiveData("tree",!1,!0)),i.table.options.rowUpdated.call(i.table,i.getComponent()),r()}))},a.prototype.getData=function(t){return t?this.table.modExists("accessor")?this.table.modules.accessor.transformRow(this.data,t):void 0:this.data},a.prototype.getCell=function(t){return t=this.table.columnManager.findColumn(t),this.cells.find((function(e){return e.column===t}))},a.prototype.getCellIndex=function(t){return this.cells.findIndex((function(e){return e===t}))},a.prototype.findNextEditableCell=function(t){var e=!1;if(t<this.cells.length-1)for(var i=t+1;i<this.cells.length;i++){var n=this.cells[i];if(n.column.modules.edit&&h.prototype.helpers.elVisible(n.getElement())){var o=!0;if("function"==typeof n.column.modules.edit.check&&(o=n.column.modules.edit.check(n.getComponent())),o){e=n;break}}}return e},a.prototype.findPrevEditableCell=function(t){var e=!1;if(t>0)for(var i=t-1;i>=0;i--){var n=this.cells[i],o=!0;if(n.column.modules.edit&&h.prototype.helpers.elVisible(n.getElement())&&("function"==typeof n.column.modules.edit.check&&(o=n.column.modules.edit.check(n.getComponent())),o)){e=n;break}}return e},a.prototype.getCells=function(){return this.cells},a.prototype.nextRow=function(){return this.table.rowManager.nextDisplayRow(this,!0)||!1},a.prototype.prevRow=function(){return this.table.rowManager.prevDisplayRow(this,!0)||!1},a.prototype.moveToRow=function(t,e){var i=this.table.rowManager.findRow(t);i?(this.table.rowManager.moveRowActual(this,i,!e),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",t)},a.prototype.delete=function(){var t=this;return new Promise((function(e,i){var n,o;t.table.options.history&&t.table.modExists("history")&&(t.table.options.groupBy&&t.table.modExists("groupRows")?(n=(o=t.getGroup().rows).indexOf(t))&&(n=o[n-1]):(n=t.table.rowManager.getRowIndex(t))&&(n=t.table.rowManager.rows[n-1]),t.table.modules.history.action("rowDelete",t,{data:t.getData(),pos:!n,index:n})),t.deleteActual(),e()}))},a.prototype.deleteActual=function(t){this.table.rowManager.getRowIndex(this),this.table.modExists("selectRow")&&this.table.modules.selectRow._deselectRow(this,!0),this.table.options.reactiveData&&this.table.modExists("reactiveData",!0),this.modules.group&&this.modules.group.removeRow(this),this.table.rowManager.deleteRow(this,t),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.table.modExists("columnCalcs")&&(this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.columnCalcs.recalcRowGroup(this):this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows))},a.prototype.deleteCells=function(){for(var t=this.cells.length,e=0;e<t;e++)this.cells[0].delete()},a.prototype.wipe=function(){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element=!1,this.modules={},this.element.parentNode&&this.element.parentNode.removeChild(this.element)},a.prototype.getGroup=function(){return this.modules.group||!1},a.prototype.getComponent=function(){return new r(this)};var l=function(t){this._cell=t};l.prototype.getValue=function(){return this._cell.getValue()},l.prototype.getOldValue=function(){return this._cell.getOldValue()},l.prototype.getElement=function(){return this._cell.getElement()},l.prototype.getRow=function(){return this._cell.row.getComponent()},l.prototype.getData=function(){return this._cell.row.getData()},l.prototype.getField=function(){return this._cell.column.getField()},l.prototype.getColumn=function(){return this._cell.column.getComponent()},l.prototype.setValue=function(t,e){void 0===e&&(e=!0),this._cell.setValue(t,e)},l.prototype.restoreOldValue=function(){this._cell.setValueActual(this._cell.getOldValue())},l.prototype.edit=function(t){return this._cell.edit(t)},l.prototype.cancelEdit=function(){this._cell.cancelEdit()},l.prototype.nav=function(){return this._cell.nav()},l.prototype.checkHeight=function(){this._cell.checkHeight()},l.prototype.getTable=function(){return this._cell.table},l.prototype._getSelf=function(){return this._cell};var u=function(t,e){this.table=t.table,this.column=t,this.row=e,this.element=null,this.value=null,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.build()};u.prototype.build=function(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data))},u.prototype.generateElement=function(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.element=this.element},u.prototype._configureCell=function(){var t=this,e=t.column.cellEvents,i=t.element,n=this.column.getField();i.style.textAlign=t.column.hozAlign,t.column.vertAlign&&(i.style.display="inline-flex",i.style.alignItems={top:"flex-start",bottom:"flex-end",middle:"center"}[t.column.vertAlign]||"",t.column.hozAlign&&(i.style.justifyContent={left:"flex-start",right:"flex-end",center:"center"}[t.column.hozAlign]||"")),n&&i.setAttribute("tabulator-field",n),t.column.definition.cssClass&&t.column.definition.cssClass.split(" ").forEach((function(t){i.classList.add(t)})),"hover"===this.table.options.tooltipGenerationMode&&i.addEventListener("mouseenter",(function(e){t._generateTooltip()})),t._bindClickEvents(e),t._bindTouchEvents(e),t._bindMouseEvents(e),t.column.modules.edit&&t.table.modules.edit.bindEditor(t),t.column.definition.rowHandle&&!1!==t.table.options.movableRows&&t.table.modExists("moveRow")&&t.table.modules.moveRow.initializeCell(t),t.column.visible||t.hide()},u.prototype._bindClickEvents=function(t){var e=this,i=e.element;(t.cellClick||e.table.options.cellClick)&&i.addEventListener("click",(function(i){var n=e.getComponent();t.cellClick&&t.cellClick.call(e.table,i,n),e.table.options.cellClick&&e.table.options.cellClick.call(e.table,i,n)})),(t.cellDblClick||this.table.options.cellDblClick)&&i.addEventListener("dblclick",(function(i){var n=e.getComponent();t.cellDblClick&&t.cellDblClick.call(e.table,i,n),e.table.options.cellDblClick&&e.table.options.cellDblClick.call(e.table,i,n)})),(t.cellContext||this.table.options.cellContext)&&i.addEventListener("contextmenu",(function(i){var n=e.getComponent();t.cellContext&&t.cellContext.call(e.table,i,n),e.table.options.cellContext&&e.table.options.cellContext.call(e.table,i,n)}))},u.prototype._bindMouseEvents=function(t){var e=this,i=e.element;(t.cellMouseEnter||e.table.options.cellMouseEnter)&&i.addEventListener("mouseenter",(function(i){var n=e.getComponent();t.cellMouseEnter&&t.cellMouseEnter.call(e.table,i,n),e.table.options.cellMouseEnter&&e.table.options.cellMouseEnter.call(e.table,i,n)})),(t.cellMouseLeave||e.table.options.cellMouseLeave)&&i.addEventListener("mouseleave",(function(i){var n=e.getComponent();t.cellMouseLeave&&t.cellMouseLeave.call(e.table,i,n),e.table.options.cellMouseLeave&&e.table.options.cellMouseLeave.call(e.table,i,n)})),(t.cellMouseOver||e.table.options.cellMouseOver)&&i.addEventListener("mouseover",(function(i){var n=e.getComponent();t.cellMouseOver&&t.cellMouseOver.call(e.table,i,n),e.table.options.cellMouseOver&&e.table.options.cellMouseOver.call(e.table,i,n)})),(t.cellMouseOut||e.table.options.cellMouseOut)&&i.addEventListener("mouseout",(function(i){var n=e.getComponent();t.cellMouseOut&&t.cellMouseOut.call(e.table,i,n),e.table.options.cellMouseOut&&e.table.options.cellMouseOut.call(e.table,i,n)})),(t.cellMouseMove||e.table.options.cellMouseMove)&&i.addEventListener("mousemove",(function(i){var n=e.getComponent();t.cellMouseMove&&t.cellMouseMove.call(e.table,i,n),e.table.options.cellMouseMove&&e.table.options.cellMouseMove.call(e.table,i,n)}))},u.prototype._bindTouchEvents=function(t){var e,i,n,o=this,r=o.element;(t.cellTap||this.table.options.cellTap)&&(n=!1,r.addEventListener("touchstart",(function(t){n=!0}),{passive:!0}),r.addEventListener("touchend",(function(e){if(n){var i=o.getComponent();t.cellTap&&t.cellTap.call(o.table,e,i),o.table.options.cellTap&&o.table.options.cellTap.call(o.table,e,i)}n=!1}))),(t.cellDblTap||this.table.options.cellDblTap)&&(e=null,r.addEventListener("touchend",(function(i){if(e){clearTimeout(e),e=null;var n=o.getComponent();t.cellDblTap&&t.cellDblTap.call(o.table,i,n),o.table.options.cellDblTap&&o.table.options.cellDblTap.call(o.table,i,n)}else e=setTimeout((function(){clearTimeout(e),e=null}),300)}))),(t.cellTapHold||this.table.options.cellTapHold)&&(i=null,r.addEventListener("touchstart",(function(e){clearTimeout(i),i=setTimeout((function(){clearTimeout(i),i=null,n=!1;var r=o.getComponent();t.cellTapHold&&t.cellTapHold.call(o.table,e,r),o.table.options.cellTapHold&&o.table.options.cellTapHold.call(o.table,e,r)}),1e3)}),{passive:!0}),r.addEventListener("touchend",(function(t){clearTimeout(i),i=null})))},u.prototype._generateContents=function(){var t;switch(void 0===(t=this.table.modExists("format")?this.table.modules.format.formatValue(this):this.element.innerHTML=this.value)?"undefined":s(t)){case"object":if(t instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(t)}else this.element.innerHTML="",null!=t&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",t);break;case"undefined":case"null":this.element.innerHTML="";break;default:this.element.innerHTML=t}},u.prototype.cellRendered=function(){this.table.modExists("format")&&this.table.modules.format.cellRendered&&this.table.modules.format.cellRendered(this)},u.prototype._generateTooltip=function(){var t=this.column.tooltip;t?(!0===t?t=this.value:"function"==typeof t&&!1===(t=t(this.getComponent()))&&(t=""),void 0===t&&(t=""),this.element.setAttribute("title",t)):this.element.setAttribute("title","")},u.prototype.getElement=function(){return this.element},u.prototype.getValue=function(){return this.value},u.prototype.getOldValue=function(){return this.oldValue},u.prototype.setValue=function(t,e){var i;this.setValueProcessData(t,e)&&(this.table.options.history&&this.table.modExists("history")&&this.table.modules.history.action("cellEdit",this,{oldValue:this.oldValue,newValue:this.value}),i=this.getComponent(),this.column.cellEvents.cellEdited&&this.column.cellEvents.cellEdited.call(this.table,i),this.table.options.cellEdited.call(this.table,i),this.table.options.dataEdited.call(this.table,this.table.rowManager.getData()))},u.prototype.setValueProcessData=function(t,e){var i=!1;return this.value!=t&&(i=!0,e&&this.column.modules.mutate&&(t=this.table.modules.mutator.transformCell(this,t))),this.setValueActual(t),i&&this.table.modExists("columnCalcs")&&(this.column.definition.topCalc||this.column.definition.bottomCalc)&&(this.table.options.groupBy&&this.table.modExists("groupRows")?("table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs||this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows),"table"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.recalcRowGroup(this.row)):this.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows)),i},u.prototype.setValueActual=function(t){this.oldValue=this.value,this.value=t,this.table.options.reactiveData&&this.table.modExists("reactiveData")&&this.table.modules.reactiveData.block(),this.column.setFieldValue(this.row.data,t),this.table.options.reactiveData&&this.table.modExists("reactiveData")&&this.table.modules.reactiveData.unblock(),this._generateContents(),this._generateTooltip(),this.table.options.resizableColumns&&this.table.modExists("resizeColumns")&&this.table.modules.resizeColumns.initializeColumn("cell",this.column,this.element),this.column.definition.contextMenu&&this.table.modExists("menu")&&this.table.modules.menu.initializeCell(this),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layoutElement(this.element,this.column)},u.prototype.setWidth=function(){this.width=this.column.width,this.element.style.width=this.column.widthStyled},u.prototype.clearWidth=function(){this.width="",this.element.style.width=""},u.prototype.getWidth=function(){return this.width||this.element.offsetWidth},u.prototype.setMinWidth=function(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled},u.prototype.checkHeight=function(){this.row.reinitializeHeight()},u.prototype.clearHeight=function(){this.element.style.height="",this.height=null},u.prototype.setHeight=function(){this.height=this.row.height,this.element.style.height=this.row.heightStyled},u.prototype.getHeight=function(){return this.height||this.element.offsetHeight},u.prototype.show=function(){this.element.style.display=""},u.prototype.hide=function(){this.element.style.display="none"},u.prototype.edit=function(t){if(this.table.modExists("edit",!0))return this.table.modules.edit.editCell(this,t)},u.prototype.cancelEdit=function(){if(this.table.modExists("edit",!0)){var t=this.table.modules.edit.getCurrentCell();t&&t._getSelf()===this?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}},u.prototype.delete=function(){this.table.rowManager.redrawBlock||this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}},u.prototype.nav=function(){var t=this,e=!1,i=this.row.getCellIndex(this);return{next:function(){var e,i=this.right();return!!i||!(!(e=t.table.rowManager.nextDisplayRow(t.row,!0))||!(i=e.findNextEditableCell(-1)))&&(i.edit(),!0)},prev:function(){var e,i=this.left();return!!i||!(!(e=t.table.rowManager.prevDisplayRow(t.row,!0))||!(i=e.findPrevEditableCell(e.cells.length)))&&(i.edit(),!0)},left:function(){return!!(e=t.row.findPrevEditableCell(i))&&(e.edit(),!0)},right:function(){return!!(e=t.row.findNextEditableCell(i))&&(e.edit(),!0)},up:function(){var e=t.table.rowManager.prevDisplayRow(t.row,!0);e&&e.cells[i].edit()},down:function(){var e=t.table.rowManager.nextDisplayRow(t.row,!0);e&&e.cells[i].edit()}}},u.prototype.getIndex=function(){this.row.getCellIndex(this)},u.prototype.getComponent=function(){return new l(this)};var c=function(t){this.table=t,this.active=!1,this.element=this.createElement(),this.external=!1,this.links=[],this._initialize()};c.prototype.createElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-footer"),t},c.prototype._initialize=function(t){if(this.table.options.footerElement)switch(s(this.table.options.footerElement)){case"string":"<"===this.table.options.footerElement[0]?this.element.innerHTML=this.table.options.footerElement:(this.external=!0,this.element=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement}},c.prototype.getElement=function(){return this.element},c.prototype.append=function(t,e){this.activate(e),this.element.appendChild(t),this.table.rowManager.adjustTableSize()},c.prototype.prepend=function(t,e){this.activate(e),this.element.insertBefore(t,this.element.firstChild),this.table.rowManager.adjustTableSize()},c.prototype.remove=function(t){t.parentNode.removeChild(t),this.deactivate()},c.prototype.deactivate=function(t){this.element.firstChild&&!t||(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)},c.prototype.activate=function(t){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display="")),t&&this.links.push(t)},c.prototype.redraw=function(){this.links.forEach((function(t){t.footerRedraw()}))};var h=function t(e,i){this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.modules={},this.initializeElement(e),this.initializeOptions(i||{}),this._create(),t.prototype.comms.register(this)};h.prototype.defaultOptions={height:!1,minHeight:!1,maxHeight:!1,layout:"fitData",layoutColumnsOnNewData:!1,columnMinWidth:40,columnHeaderVertAlign:"top",columnVertAlign:!1,resizableColumns:!0,resizableRows:!1,autoResize:!0,columns:[],cellHozAlign:"",cellVertAlign:"",data:[],autoColumns:!1,reactiveData:!1,nestedFieldSeparator:".",tooltips:!1,tooltipsHeader:!1,tooltipGenerationMode:"load",initialSort:!1,initialFilter:!1,initialHeaderFilter:!1,columnHeaderSortMulti:!0,sortOrderReverse:!1,headerSort:!0,headerSortTristate:!1,footerElement:!1,index:"id",keybindings:[],tabEndNewRow:!1,invalidOptionWarnings:!0,clipboard:!1,clipboardCopyStyled:!0,clipboardCopyConfig:!1,clipboardCopyFormatter:!1,clipboardCopyRowRange:"active",clipboardPasteParser:"table",clipboardPasteAction:"insert",clipboardCopied:function(){},clipboardPasted:function(){},clipboardPasteError:function(){},downloadDataFormatter:!1,downloadReady:function(t,e){return e},downloadComplete:!1,downloadConfig:!1,dataTree:!1,dataTreeElementColumn:!1,dataTreeBranchElement:!0,dataTreeChildIndent:9,dataTreeChildField:"_children",dataTreeCollapseElement:!1,dataTreeExpandElement:!1,dataTreeStartExpanded:!1,dataTreeRowExpanded:function(){},dataTreeRowCollapsed:function(){},dataTreeChildColumnCalcs:!1,dataTreeSelectPropagate:!1,printAsHtml:!1,printFormatter:!1,printHeader:!1,printFooter:!1,printCopyStyle:!0,printStyled:!0,printVisibleRows:!0,printRowRange:"visible",printConfig:{},addRowPos:"bottom",selectable:"highlight",selectableRangeMode:"drag",selectableRollingSelection:!0,selectablePersistence:!0,selectableCheck:function(t,e){return!0},headerFilterLiveFilterDelay:300,headerFilterPlaceholder:!1,headerVisible:!0,history:!1,locale:!1,langs:{},virtualDom:!0,virtualDomBuffer:0,persistentLayout:!1,persistentSort:!1,persistentFilter:!1,persistenceID:"",persistenceMode:!0,persistenceReaderFunc:!1,persistenceWriterFunc:!1,persistence:!1,responsiveLayout:!1,responsiveLayoutCollapseStartOpen:!0,responsiveLayoutCollapseUseFormatters:!0,responsiveLayoutCollapseFormatter:!1,pagination:!1,paginationSize:!1,paginationInitialPage:1,paginationButtonCount:5,paginationSizeSelector:!1,paginationElement:!1,paginationDataSent:{},paginationDataReceived:{},paginationAddRow:"page",ajaxURL:!1,ajaxURLGenerator:!1,ajaxParams:{},ajaxConfig:"get",ajaxContentType:"form",ajaxRequestFunc:!1,ajaxLoader:!0,ajaxLoaderLoading:!1,ajaxLoaderError:!1,ajaxFiltering:!1,ajaxSorting:!1,ajaxProgressiveLoad:!1,ajaxProgressiveLoadDelay:0,ajaxProgressiveLoadScrollMargin:0,groupBy:!1,groupStartOpen:!0,groupValues:!1,groupHeader:!1,htmlOutputConfig:!1,movableColumns:!1,movableRows:!1,movableRowsConnectedTables:!1,movableRowsSender:!1,movableRowsReceiver:"insert",movableRowsSendingStart:function(){},movableRowsSent:function(){},movableRowsSentFailed:function(){},movableRowsSendingStop:function(){},movableRowsReceivingStart:function(){},movableRowsReceived:function(){},movableRowsReceivedFailed:function(){},movableRowsReceivingStop:function(){},scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,placeholder:!1,tableBuilding:function(){},tableBuilt:function(){},renderStarted:function(){},renderComplete:function(){},rowClick:!1,rowDblClick:!1,rowContext:!1,rowTap:!1,rowDblTap:!1,rowTapHold:!1,rowMouseEnter:!1,rowMouseLeave:!1,rowMouseOver:!1,rowMouseOut:!1,rowMouseMove:!1,rowContextMenu:!1,rowAdded:function(){},rowDeleted:function(){},rowMoved:function(){},rowUpdated:function(){},rowSelectionChanged:function(){},rowSelected:function(){},rowDeselected:function(){},rowResized:function(){},cellClick:!1,cellDblClick:!1,cellContext:!1,cellTap:!1,cellDblTap:!1,cellTapHold:!1,cellMouseEnter:!1,cellMouseLeave:!1,cellMouseOver:!1,cellMouseOut:!1,cellMouseMove:!1,cellEditing:function(){},cellEdited:function(){},cellEditCancelled:function(){},columnMoved:!1,columnResized:function(){},columnTitleChanged:function(){},columnVisibilityChanged:function(){},htmlImporting:function(){},htmlImported:function(){},dataLoading:function(){},dataLoaded:function(){},dataEdited:function(){},ajaxRequesting:function(){},ajaxResponse:!1,ajaxError:function(){},dataFiltering:!1,dataFiltered:!1,dataSorting:function(){},dataSorted:function(){},groupToggleElement:"arrow",groupClosedShowCalcs:!1,dataGrouping:function(){},dataGrouped:!1,groupVisibilityChanged:function(){},groupClick:!1,groupDblClick:!1,groupContext:!1,groupTap:!1,groupDblTap:!1,groupTapHold:!1,columnCalcs:!0,pageLoaded:function(){},localized:function(){},validationFailed:function(){},historyUndo:function(){},historyRedo:function(){},scrollHorizontal:function(){},scrollVertical:function(){}},h.prototype.initializeOptions=function(t){if(!1!==t.invalidOptionWarnings)for(var e in t)void 0===this.defaultOptions[e]&&console.warn("Invalid table constructor option:",e);for(var e in this.defaultOptions)e in t?this.options[e]=t[e]:Array.isArray(this.defaultOptions[e])?this.options[e]=[]:"object"===s(this.defaultOptions[e])&&null!==this.defaultOptions[e]?this.options[e]={}:this.options[e]=this.defaultOptions[e]},h.prototype.initializeElement=function(t){return"undefined"!=typeof HTMLElement&&t instanceof HTMLElement?(this.element=t,!0):"string"==typeof t?(this.element=document.querySelector(t),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",t),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",t),!1)},h.prototype._mapDepricatedFunctionality=function(){(this.options.persistentLayout||this.options.persistentSort||this.options.persistentFilter)&&(this.options.persistence||(this.options.persistence={})),void 0!==this.options.clipboardCopyHeader&&(this.options.columnHeaders=this.options.clipboardCopyHeader,console.warn("DEPRECATION WARNING - clipboardCopyHeader option has been deprecated, please use the columnHeaders property on the clipboardCopyConfig option")),!0!==this.options.printVisibleRows&&(console.warn("printVisibleRows option is deprecated, you should now use the printRowRange option"),this.options.persistence.printRowRange="active"),!0!==this.options.printCopyStyle&&(console.warn("printCopyStyle option is deprecated, you should now use the printStyled option"),this.options.persistence.printStyled=this.options.printCopyStyle),this.options.persistentLayout&&(console.warn("persistentLayout option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.columns&&(this.options.persistence.columns=!0)),this.options.persistentSort&&(console.warn("persistentSort option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.sort&&(this.options.persistence.sort=!0)),this.options.persistentFilter&&(console.warn("persistentFilter option is deprecated, you should now use the persistence option"),!0!==this.options.persistence&&void 0===this.options.persistence.filter&&(this.options.persistence.filter=!0)),this.options.columnVertAlign&&(console.warn("columnVertAlign option is deprecated, you should now use the columnHeaderVertAlign option"),this.options.columnHeaderVertAlign=this.options.columnVertAlign)},h.prototype._clearSelection=function(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")},h.prototype._create=function(){this._clearObjectPointers(),this._mapDepricatedFunctionality(),this.bindModules(),"TABLE"===this.element.tagName&&this.modExists("htmlTableImport",!0)&&this.modules.htmlTableImport.parseTable(),this.columnManager=new t(this),this.rowManager=new o(this),this.footerManager=new c(this),this.columnManager.setRowManager(this.rowManager),this.rowManager.setColumnManager(this.columnManager),this._buildElement(),this._loadInitialData()},h.prototype._clearObjectPointers=function(){this.options.columns=this.options.columns.slice(0),this.options.reactiveData||(this.options.data=this.options.data.slice(0))},h.prototype._buildElement=function(){var t=this,e=this.element,i=this.modules,n=this.options;for(n.tableBuilding.call(this),e.classList.add("tabulator"),e.setAttribute("role","grid");e.firstChild;)e.removeChild(e.firstChild);for(var o in n.height&&(n.height=isNaN(n.height)?n.height:n.height+"px",e.style.height=n.height),!1!==n.minHeight&&(n.minHeight=isNaN(n.minHeight)?n.minHeight:n.minHeight+"px",e.style.minHeight=n.minHeight),!1!==n.maxHeight&&(n.maxHeight=isNaN(n.maxHeight)?n.maxHeight:n.maxHeight+"px",e.style.maxHeight=n.maxHeight),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modExists("layout",!0)&&i.layout.initialize(n.layout),!1!==n.headerFilterPlaceholder&&i.localize.setHeaderFilterPlaceholder(n.headerFilterPlaceholder),n.langs)i.localize.installLang(o,n.langs[o]);if(i.localize.setLocale(n.locale),"string"==typeof n.placeholder){var r=document.createElement("div");r.classList.add("tabulator-placeholder");var a=document.createElement("span");a.innerHTML=n.placeholder,r.appendChild(a),n.placeholder=r}if(e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),n.footerElement&&this.footerManager.activate(),n.persistence&&this.modExists("persistence",!0)&&i.persistence.initialize(),n.persistence&&this.modExists("persistence",!0)&&i.persistence.config.columns&&(n.columns=i.persistence.load("columns",n.columns)),n.movableRows&&this.modExists("moveRow")&&i.moveRow.initialize(),n.autoColumns&&this.options.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modExists("columnCalcs")&&i.columnCalcs.initialize(),this.columnManager.setColumns(n.columns),n.dataTree&&this.modExists("dataTree",!0)&&i.dataTree.initialize(),this.modExists("frozenRows")&&this.modules.frozenRows.initialize(),(n.persistence&&this.modExists("persistence",!0)&&i.persistence.config.sort||n.initialSort)&&this.modExists("sort",!0)){var s=[];n.persistence&&this.modExists("persistence",!0)&&i.persistence.config.sort?!1===(s=i.persistence.load("sort"))&&n.initialSort&&(s=n.initialSort):n.initialSort&&(s=n.initialSort),i.sort.setSort(s)}if((n.persistence&&this.modExists("persistence",!0)&&i.persistence.config.filter||n.initialFilter)&&this.modExists("filter",!0)){var l=[];n.persistence&&this.modExists("persistence",!0)&&i.persistence.config.filter?!1===(l=i.persistence.load("filter"))&&n.initialFilter&&(l=n.initialFilter):n.initialFilter&&(l=n.initialFilter),i.filter.setFilter(l)}n.initialHeaderFilter&&this.modExists("filter",!0)&&n.initialHeaderFilter.forEach((function(e){var n=t.columnManager.findColumn(e.field);if(!n)return console.warn("Column Filter Error - No matching column found:",e.field),!1;i.filter.setHeaderFilterValue(n,e.value)})),this.modExists("ajax")&&i.ajax.initialize(),n.pagination&&this.modExists("page",!0)&&i.page.initialize(),n.groupBy&&this.modExists("groupRows",!0)&&i.groupRows.initialize(),this.modExists("keybindings")&&i.keybindings.initialize(),this.modExists("selectRow")&&i.selectRow.clearSelectionData(!0),n.autoResize&&this.modExists("resizeTable")&&i.resizeTable.initialize(),this.modExists("clipboard")&&i.clipboard.initialize(),n.printAsHtml&&this.modExists("print")&&i.print.initialize(),n.tableBuilt.call(this)},h.prototype._loadInitialData=function(){var t=this;if(t.options.pagination&&t.modExists("page"))if(t.modules.page.reset(!0,!0),"local"==t.options.pagination){if(t.options.data.length)t.rowManager.setData(t.options.data,!1,!0);else{if((t.options.ajaxURL||t.options.ajaxURLGenerator)&&t.modExists("ajax"))return void t.modules.ajax.loadData(!1,!0).then((function(){})).catch((function(){t.options.paginationInitialPage&&t.modules.page.setPage(t.options.paginationInitialPage)}));t.rowManager.setData(t.options.data,!1,!0)}t.options.paginationInitialPage&&t.modules.page.setPage(t.options.paginationInitialPage)}else t.options.ajaxURL?t.modules.page.setPage(t.options.paginationInitialPage).then((function(){})).catch((function(){})):t.rowManager.setData([],!1,!0);else t.options.data.length?t.rowManager.setData(t.options.data):(t.options.ajaxURL||t.options.ajaxURLGenerator)&&t.modExists("ajax")?t.modules.ajax.loadData(!1,!0).then((function(){})).catch((function(){})):t.rowManager.setData(t.options.data,!1,!0)},h.prototype.destroy=function(){var t=this.element;for(h.prototype.comms.deregister(this),this.options.reactiveData&&this.modExists("reactiveData",!0)&&this.modules.reactiveData.unwatchData(),this.rowManager.rows.forEach((function(t){t.wipe()})),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[],this.options.autoResize&&this.modExists("resizeTable")&&this.modules.resizeTable.clearBindings(),this.modExists("keybindings")&&this.modules.keybindings.clearBindings();t.firstChild;)t.removeChild(t.firstChild);t.classList.remove("tabulator")},h.prototype._detectBrowser=function(){var t=navigator.userAgent||navigator.vendor||window.opera;t.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):t.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):t.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},h.prototype.blockRedraw=function(){return this.rowManager.blockRedraw()},h.prototype.restoreRedraw=function(){return this.rowManager.restoreRedraw()},h.prototype.setDataFromLocalFile=function(t){var e=this;return new Promise((function(i,n){var o=document.createElement("input");o.type="file",o.accept=t||".json,application/json",o.addEventListener("change",(function(t){var r,a=o.files[0],s=new FileReader;s.readAsText(a),s.onload=function(t){try{r=JSON.parse(s.result)}catch(t){return console.warn("File Load Error - File contents is invalid JSON",t),void n(t)}e._setData(r).then((function(t){i(t)})).catch((function(t){i(t)}))},s.onerror=function(t){console.warn("File Load Error - Unable to read file"),n()}})),o.click()}))},h.prototype.setData=function(t,e,i){return this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this._setData(t,e,i,!1,!0)},h.prototype._setData=function(t,e,i,n,o){return"string"!=typeof t?t?this.rowManager.setData(t,n,o):this.modExists("ajax")&&(this.modules.ajax.getUrl||this.options.ajaxURLGenerator)?"remote"==this.options.pagination&&this.modExists("page",!0)?(this.modules.page.reset(!0,!0),this.modules.page.setPage(1)):this.modules.ajax.loadData(n,o):this.rowManager.setData([],n,o):0==t.indexOf("{")||0==t.indexOf("[")?this.rowManager.setData(JSON.parse(t),n,o):this.modExists("ajax",!0)?(e&&this.modules.ajax.setParams(e),i&&this.modules.ajax.setConfig(i),this.modules.ajax.setUrl(t),"remote"==this.options.pagination&&this.modExists("page",!0)?(this.modules.page.reset(!0,!0),this.modules.page.setPage(1)):this.modules.ajax.loadData(n,o)):void 0},h.prototype.clearData=function(){this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this.rowManager.clearData()},h.prototype.getData=function(t){return!0===t&&(console.warn("passing a boolean to the getData function is deprecated, you should now pass the string 'active'"),t="active"),this.rowManager.getData(t)},h.prototype.getDataCount=function(t){return!0===t&&(console.warn("passing a boolean to the getDataCount function is deprecated, you should now pass the string 'active'"),t="active"),this.rowManager.getDataCount(t)},h.prototype.searchRows=function(t,e,i){if(this.modExists("filter",!0))return this.modules.filter.search("rows",t,e,i)},h.prototype.searchData=function(t,e,i){if(this.modExists("filter",!0))return this.modules.filter.search("data",t,e,i)},h.prototype.getHtml=function(t,e,i){if(this.modExists("export",!0))return this.modules.export.getHtml(t,e,i)},h.prototype.print=function(t,e,i){if(this.modExists("print",!0))return this.modules.print.printFullscreen(t,e,i)},h.prototype.getAjaxUrl=function(){if(this.modExists("ajax",!0))return this.modules.ajax.getUrl()},h.prototype.replaceData=function(t,e,i){return this.modExists("ajax")&&this.modules.ajax.blockActiveRequest(),this._setData(t,e,i,!0)},h.prototype.updateData=function(t){var e=this,i=this,n=0;return new Promise((function(o,r){e.modExists("ajax")&&e.modules.ajax.blockActiveRequest(),"string"==typeof t&&(t=JSON.parse(t)),t?t.forEach((function(t){var e=i.rowManager.findRow(t[i.options.index]);e&&(n++,e.updateData(t).then((function(){--n||o()})))})):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))}))},h.prototype.addData=function(t,e,i){var n=this;return new Promise((function(o,r){n.modExists("ajax")&&n.modules.ajax.blockActiveRequest(),"string"==typeof t&&(t=JSON.parse(t)),t?n.rowManager.addRows(t,e,i).then((function(t){var e=[];t.forEach((function(t){e.push(t.getComponent())})),o(e)})):(console.warn("Update Error - No data provided"),r("Update Error - No data provided"))}))},h.prototype.updateOrAddData=function(t){var e=this,i=this,n=[],o=0;return new Promise((function(r,a){e.modExists("ajax")&&e.modules.ajax.blockActiveRequest(),"string"==typeof t&&(t=JSON.parse(t)),t?t.forEach((function(t){var e=i.rowManager.findRow(t[i.options.index]);o++,e?e.updateData(t).then((function(){o--,n.push(e.getComponent()),o||r(n)})):i.rowManager.addRows(t).then((function(t){o--,n.push(t[0].getComponent()),o||r(n)}))})):(console.warn("Update Error - No data provided"),a("Update Error - No data provided"))}))},h.prototype.getRow=function(t){var e=this.rowManager.findRow(t);return e?e.getComponent():(console.warn("Find Error - No matching row found:",t),!1)},h.prototype.getRowFromPosition=function(t,e){var i=this.rowManager.getRowFromPosition(t,e);return i?i.getComponent():(console.warn("Find Error - No matching row found:",t),!1)},h.prototype.deleteRow=function(t){var e=this;return new Promise((function(i,n){var o=e,r=0,a=0,s=[];function l(){++r==t.length&&a&&(o.rowManager.reRenderInPosition(),i())}Array.isArray(t)||(t=[t]),t.forEach((function(t){var i=e.rowManager.findRow(t,!0);i?s.push(i):(console.warn("Delete Error - No matching row found:",t),n("Delete Error - No matching row found"),l())})),s.sort((function(t,i){return e.rowManager.rows.indexOf(t)>e.rowManager.rows.indexOf(i)?1:-1})),s.forEach((function(t){t.delete().then((function(){a++,l()})).catch((function(t){l(),n(t)}))}))}))},h.prototype.addRow=function(t,e,i){var n=this;return new Promise((function(o,r){"string"==typeof t&&(t=JSON.parse(t)),n.rowManager.addRows(t,e,i).then((function(t){n.modExists("columnCalcs")&&n.modules.columnCalcs.recalc(n.rowManager.activeRows),o(t[0].getComponent())}))}))},h.prototype.updateOrAddRow=function(t,e){var i=this;return new Promise((function(n,o){var r=i.rowManager.findRow(t);"string"==typeof e&&(e=JSON.parse(e)),r?r.updateData(e).then((function(){i.modExists("columnCalcs")&&i.modules.columnCalcs.recalc(i.rowManager.activeRows),n(r.getComponent())})).catch((function(t){o(t)})):r=i.rowManager.addRows(e).then((function(t){i.modExists("columnCalcs")&&i.modules.columnCalcs.recalc(i.rowManager.activeRows),n(t[0].getComponent())})).catch((function(t){o(t)}))}))},h.prototype.updateRow=function(t,e){var i=this;return new Promise((function(n,o){var r=i.rowManager.findRow(t);"string"==typeof e&&(e=JSON.parse(e)),r?r.updateData(e).then((function(){n(r.getComponent())})).catch((function(t){o(t)})):(console.warn("Update Error - No matching row found:",t),o("Update Error - No matching row found"))}))},h.prototype.scrollToRow=function(t,e,i){var n=this;return new Promise((function(o,r){var a=n.rowManager.findRow(t);a?n.rowManager.scrollToRow(a,e,i).then((function(){o()})).catch((function(t){r(t)})):(console.warn("Scroll Error - No matching row found:",t),r("Scroll Error - No matching row found"))}))},h.prototype.moveRow=function(t,e,i){var n=this.rowManager.findRow(t);n?n.moveToRow(e,i):console.warn("Move Error - No matching row found:",t)},h.prototype.getRows=function(t){return!0===t&&(console.warn("passing a boolean to the getRows function is deprecated, you should now pass the string 'active'"),t="active"),this.rowManager.getComponents(t)},h.prototype.getRowPosition=function(t,e){var i=this.rowManager.findRow(t);return i?this.rowManager.getRowPosition(i,e):(console.warn("Position Error - No matching row found:",t),!1)},h.prototype.copyToClipboard=function(t){this.modExists("clipboard",!0)&&this.modules.clipboard.copy(t)},h.prototype.setColumns=function(t){this.columnManager.setColumns(t)},h.prototype.getColumns=function(t){return this.columnManager.getComponents(t)},h.prototype.getColumn=function(t){var e=this.columnManager.findColumn(t);return e?e.getComponent():(console.warn("Find Error - No matching column found:",t),!1)},h.prototype.getColumnDefinitions=function(){return this.columnManager.getDefinitionTree()},h.prototype.getColumnLayout=function(){if(this.modExists("persistence",!0))return this.modules.persistence.parseColumns(this.columnManager.getColumns())},h.prototype.setColumnLayout=function(t){return!!this.modExists("persistence",!0)&&(this.columnManager.setColumns(this.modules.persistence.mergeDefinition(this.options.columns,t)),!0)},h.prototype.showColumn=function(t){var e=this.columnManager.findColumn(t);if(!e)return console.warn("Column Show Error - No matching column found:",t),!1;e.show(),this.options.responsiveLayout&&this.modExists("responsiveLayout",!0)&&this.modules.responsiveLayout.update()},h.prototype.hideColumn=function(t){var e=this.columnManager.findColumn(t);if(!e)return console.warn("Column Hide Error - No matching column found:",t),!1;e.hide(),this.options.responsiveLayout&&this.modExists("responsiveLayout",!0)&&this.modules.responsiveLayout.update()},h.prototype.toggleColumn=function(t){var e=this.columnManager.findColumn(t);if(!e)return console.warn("Column Visibility Toggle Error - No matching column found:",t),!1;e.visible?e.hide():e.show()},h.prototype.addColumn=function(t,e,i){var n=this;return new Promise((function(o,r){var a=n.columnManager.findColumn(i);n.columnManager.addColumn(t,e,a).then((function(t){o(t.getComponent())})).catch((function(t){r(t)}))}))},h.prototype.deleteColumn=function(t){var e=this;return new Promise((function(i,n){var o=e.columnManager.findColumn(t);o?o.delete().then((function(){i()})).catch((function(t){n(t)})):(console.warn("Column Delete Error - No matching column found:",t),n())}))},h.prototype.updateColumnDefinition=function(t,e){var i=this;return new Promise((function(n,o){var r=i.columnManager.findColumn(t);r?r.updateDefinition(e).then((function(t){n(t)})).catch((function(t){o(t)})):(console.warn("Column Update Error - No matching column found:",t),o())}))},h.prototype.moveColumn=function(t,e,i){var n=this.columnManager.findColumn(t),o=this.columnManager.findColumn(e);n?o?this.columnManager.moveColumn(n,o,i):console.warn("Move Error - No matching column found:",o):console.warn("Move Error - No matching column found:",t)},h.prototype.scrollToColumn=function(t,e,i){var n=this;return new Promise((function(o,r){var a=n.columnManager.findColumn(t);a?n.columnManager.scrollToColumn(a,e,i).then((function(){o()})).catch((function(t){r(t)})):(console.warn("Scroll Error - No matching column found:",t),r("Scroll Error - No matching column found"))}))},h.prototype.setLocale=function(t){this.modules.localize.setLocale(t)},h.prototype.getLocale=function(){return this.modules.localize.getLocale()},h.prototype.getLang=function(t){return this.modules.localize.getLang(t)},h.prototype.redraw=function(t){this.columnManager.redraw(t),this.rowManager.redraw(t)},h.prototype.setHeight=function(t){"classic"!==this.rowManager.renderMode?(this.options.height=isNaN(t)?t:t+"px",this.element.style.height=this.options.height,this.rowManager.setRenderMode(),this.rowManager.redraw()):console.warn("setHeight function is not available in classic render mode")},h.prototype.setSort=function(t,e){this.modExists("sort",!0)&&(this.modules.sort.setSort(t,e),this.rowManager.sorterRefresh())},h.prototype.getSorters=function(){if(this.modExists("sort",!0))return this.modules.sort.getSort()},h.prototype.clearSort=function(){this.modExists("sort",!0)&&(this.modules.sort.clear(),this.rowManager.sorterRefresh())},h.prototype.setFilter=function(t,e,i){this.modExists("filter",!0)&&(this.modules.filter.setFilter(t,e,i),this.rowManager.filterRefresh())},h.prototype.addFilter=function(t,e,i){this.modExists("filter",!0)&&(this.modules.filter.addFilter(t,e,i),this.rowManager.filterRefresh())},h.prototype.getFilters=function(t){if(this.modExists("filter",!0))return this.modules.filter.getFilters(t)},h.prototype.setHeaderFilterFocus=function(t){if(this.modExists("filter",!0)){var e=this.columnManager.findColumn(t);if(!e)return console.warn("Column Filter Focus Error - No matching column found:",t),!1;this.modules.filter.setHeaderFilterFocus(e)}},h.prototype.getHeaderFilterValue=function(t){if(this.modExists("filter",!0)){var e=this.columnManager.findColumn(t);if(e)return this.modules.filter.getHeaderFilterValue(e);console.warn("Column Filter Error - No matching column found:",t)}},h.prototype.setHeaderFilterValue=function(t,e){if(this.modExists("filter",!0)){var i=this.columnManager.findColumn(t);if(!i)return console.warn("Column Filter Error - No matching column found:",t),!1;this.modules.filter.setHeaderFilterValue(i,e)}},h.prototype.getHeaderFilters=function(){if(this.modExists("filter",!0))return this.modules.filter.getHeaderFilters()},h.prototype.removeFilter=function(t,e,i){this.modExists("filter",!0)&&(this.modules.filter.removeFilter(t,e,i),this.rowManager.filterRefresh())},h.prototype.clearFilter=function(t){this.modExists("filter",!0)&&(this.modules.filter.clearFilter(t),this.rowManager.filterRefresh())},h.prototype.clearHeaderFilter=function(){this.modExists("filter",!0)&&(this.modules.filter.clearHeaderFilter(),this.rowManager.filterRefresh())},h.prototype.selectRow=function(t){this.modExists("selectRow",!0)&&(!0===t&&(console.warn("passing a boolean to the selectRowselectRow function is deprecated, you should now pass the string 'active'"),t="active"),this.modules.selectRow.selectRows(t))},h.prototype.deselectRow=function(t){this.modExists("selectRow",!0)&&this.modules.selectRow.deselectRows(t)},h.prototype.toggleSelectRow=function(t){this.modExists("selectRow",!0)&&this.modules.selectRow.toggleRow(t)},h.prototype.getSelectedRows=function(){if(this.modExists("selectRow",!0))return this.modules.selectRow.getSelectedRows()},h.prototype.getSelectedData=function(){if(this.modExists("selectRow",!0))return this.modules.selectRow.getSelectedData()},h.prototype.setMaxPage=function(t){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.setMaxPage(t)},h.prototype.setPage=function(t){return this.options.pagination&&this.modExists("page")?this.modules.page.setPage(t):new Promise((function(t,e){e()}))},h.prototype.setPageToRow=function(t){var e=this;return new Promise((function(i,n){e.options.pagination&&e.modExists("page")&&(t=e.rowManager.findRow(t))?e.modules.page.setPageToRow(t).then((function(){i()})).catch((function(){n()})):n()}))},h.prototype.setPageSize=function(t){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.setPageSize(t),this.modules.page.setPage(1).then((function(){})).catch((function(){}))},h.prototype.getPageSize=function(){if(this.options.pagination&&this.modExists("page",!0))return this.modules.page.getPageSize()},h.prototype.previousPage=function(){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.previousPage()},h.prototype.nextPage=function(){if(!this.options.pagination||!this.modExists("page"))return!1;this.modules.page.nextPage()},h.prototype.getPage=function(){return!(!this.options.pagination||!this.modExists("page"))&&this.modules.page.getPage()},h.prototype.getPageMax=function(){return!(!this.options.pagination||!this.modExists("page"))&&this.modules.page.getPageMax()},h.prototype.setGroupBy=function(t){if(!this.modExists("groupRows",!0))return!1;this.options.groupBy=t,this.modules.groupRows.initialize(),this.rowManager.refreshActiveData("display"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")},h.prototype.setGroupStartOpen=function(t){if(!this.modExists("groupRows",!0))return!1;this.options.groupStartOpen=t,this.modules.groupRows.initialize(),this.options.groupBy?(this.rowManager.refreshActiveData("group"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")):console.warn("Grouping Update - cant refresh view, no groups have been set")},h.prototype.setGroupHeader=function(t){if(!this.modExists("groupRows",!0))return!1;this.options.groupHeader=t,this.modules.groupRows.initialize(),this.options.groupBy?(this.rowManager.refreshActiveData("group"),this.options.persistence&&this.modExists("persistence",!0)&&this.modules.persistence.config.group&&this.modules.persistence.save("group")):console.warn("Grouping Update - cant refresh view, no groups have been set")},h.prototype.getGroups=function(t){return!!this.modExists("groupRows",!0)&&this.modules.groupRows.getGroups(!0)},h.prototype.getGroupedData=function(){if(this.modExists("groupRows",!0))return this.options.groupBy?this.modules.groupRows.getGroupedData():this.getData()},h.prototype.getCalcResults=function(){return!!this.modExists("columnCalcs",!0)&&this.modules.columnCalcs.getResults()},h.prototype.recalc=function(){this.modExists("columnCalcs",!0)&&this.modules.columnCalcs.recalcAll(this.rowManager.activeRows)},h.prototype.navigatePrev=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&t.nav().prev()},h.prototype.navigateNext=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&t.nav().next()},h.prototype.navigateLeft=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().left())},h.prototype.navigateRight=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().right())},h.prototype.navigateUp=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().up())},h.prototype.navigateDown=function(){var t=!1;return!(!this.modExists("edit",!0)||!(t=this.modules.edit.currentCell))&&(e.preventDefault(),t.nav().down())},h.prototype.undo=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.undo()},h.prototype.redo=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.redo()},h.prototype.getHistoryUndoSize=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.getHistoryUndoSize()},h.prototype.getHistoryRedoSize=function(){return!(!this.options.history||!this.modExists("history",!0))&&this.modules.history.getHistoryRedoSize()},h.prototype.download=function(t,e,i,n){this.modExists("download",!0)&&this.modules.download.download(t,e,i,n)},h.prototype.downloadToTab=function(t,e,i,n){this.modExists("download",!0)&&this.modules.download.download(t,e,i,n,!0)},h.prototype.tableComms=function(t,e,i,n){this.modules.comms.receive(t,e,i,n)},h.prototype.moduleBindings={},h.prototype.extendModule=function(t,e,i){if(h.prototype.moduleBindings[t]){var n=h.prototype.moduleBindings[t].prototype[e];if(n)if("object"==(void 0===i?"undefined":s(i)))for(var o in i)n[o]=i[o];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",e)}else console.warn("Module Error - module does not exist:",t)},h.prototype.registerModule=function(t,e){h.prototype.moduleBindings[t]=e},h.prototype.bindModules=function(){for(var t in this.modules={},h.prototype.moduleBindings)this.modules[t]=new h.prototype.moduleBindings[t](this)},h.prototype.modExists=function(t,e){return!!this.modules[t]||(e&&console.error("Tabulator Module Not Installed: "+t),!1)},h.prototype.helpers={elVisible:function(t){return!(t.offsetWidth<=0&&t.offsetHeight<=0)},elOffset:function(t){var e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset-document.documentElement.clientTop,left:e.left+window.pageXOffset-document.documentElement.clientLeft}},deepClone:function(t){var e=Array.isArray(t)?[]:{};for(var i in t)null!=t[i]&&"object"===s(t[i])?t[i]instanceof Date?e[i]=new Date(t[i]):e[i]=this.deepClone(t[i]):e[i]=t[i];return e}},h.prototype.comms={tables:[],register:function(t){h.prototype.comms.tables.push(t)},deregister:function(t){var e=h.prototype.comms.tables.indexOf(t);e>-1&&h.prototype.comms.tables.splice(e,1)},lookupTable:function(t,e){var i,n,o=[];if("string"==typeof t){if((i=document.querySelectorAll(t)).length)for(var r=0;r<i.length;r++)(n=h.prototype.comms.matchElement(i[r]))&&o.push(n)}else"undefined"!=typeof HTMLElement&&t instanceof HTMLElement||t instanceof h?(n=h.prototype.comms.matchElement(t))&&o.push(n):Array.isArray(t)?t.forEach((function(t){o=o.concat(h.prototype.comms.lookupTable(t))})):e||console.warn("Table Connection Error - Invalid Selector",t);return o},matchElement:function(t){return h.prototype.comms.tables.find((function(e){return t instanceof h?e===t:e.element===t}))}},h.prototype.findTable=function(t){var e=h.prototype.comms.lookupTable(t,!0);return!(Array.isArray(e)&&!e.length)&&e};var d=function(t){this.table=t,this.mode=null};d.prototype.initialize=function(t){this.modes[t]?this.mode=t:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+t),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)},d.prototype.getMode=function(){return this.mode},d.prototype.layout=function(){this.modes[this.mode].call(this,this.table.columnManager.columnsByIndex)},d.prototype.modes={fitData:function(t){t.forEach((function(t){t.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:function(t){t.forEach((function(t){t.reinitializeWidth()})),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataStretch:function(t){var e=this,i=0,n=this.table.rowManager.element.clientWidth,o=0,r=!1;t.forEach((function(t,n){t.widthFixed||t.reinitializeWidth(),(e.table.options.responsiveLayout?t.modules.responsive.visible:t.visible)&&(r=t),t.visible&&(i+=t.getWidth())})),r?(o=n-i+r.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(r.setWidth(0),this.table.modules.responsiveLayout.update()),o>0?r.setWidth(o):r.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function(t){var e,i,n=this.table.element.clientWidth,o=0,r=0,a=0,s=[],l=[],u=0,c=0;function h(t){return"string"==typeof t?t.indexOf("%")>-1?n/100*parseInt(t):parseInt(t):t}function d(t,e,i,n){var o=[],r=0,a=0,s=0,l=0,u=0,c=[];function p(t){return i*(t.column.definition.widthGrow||1)}function f(t){return h(t.width)-i*(t.column.definition.widthShrink||0)}return t.forEach((function(t,e){var i=n?f(t):p(t);t.column.minWidth>=i?o.push(t):(c.push(t),u+=n?t.column.definition.widthShrink||1:t.column.definition.widthGrow||1)})),o.length?(o.forEach((function(t){r+=n?t.width-t.column.minWidth:t.column.minWidth,t.width=t.column.minWidth})),l=(a=e-r)-(s=u?Math.floor(a/u):a)*u,l+=d(c,a,s,n)):(l=u?e-Math.floor(e/u)*u:e,c.forEach((function(t){t.width=n?f(t):p(t)}))),l}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(n-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),t.forEach((function(t){var e,i,n;t.visible&&(e=t.definition.width,i=parseInt(t.minWidth),e?(n=h(e),o+=n>i?n:i,t.definition.widthShrink&&(l.push({column:t,width:n>i?n:i}),u+=t.definition.widthShrink)):(s.push({column:t,width:0}),a+=t.definition.widthGrow||1))})),r=n-o,e=Math.floor(r/a),c=d(s,r,e,!1),s.length&&c>0&&(s[s.length-1].width+=+c),s.forEach((function(t){r-=t.width})),(i=Math.abs(c)+r)>0&&u&&(c=d(l,i,Math.floor(i/u),!0)),l.length&&(l[l.length-1].width-=c),s.forEach((function(t){t.column.setWidth(t.width)})),l.forEach((function(t){t.column.setWidth(t.width)}))}},h.prototype.registerModule("layout",d);var p=function(t){this.table=t,this.locale="default",this.lang=!1,this.bindings={}};p.prototype.setHeaderFilterPlaceholder=function(t){this.langs.default.headerFilters.default=t},p.prototype.setHeaderFilterColumnPlaceholder=function(t,e){this.langs.default.headerFilters.columns[t]=e,this.lang&&!this.lang.headerFilters.columns[t]&&(this.lang.headerFilters.columns[t]=e)},p.prototype.installLang=function(t,e){this.langs[t]?this._setLangProp(this.langs[t],e):this.langs[t]=e},p.prototype._setLangProp=function(t,e){for(var i in e)t[i]&&"object"==s(t[i])?this._setLangProp(t[i],e[i]):t[i]=e[i]},p.prototype.setLocale=function(t){if(!0===(t=t||"default")&&navigator.language&&(t=navigator.language.toLowerCase()),t&&!this.langs[t]){var e=t.split("-")[0];this.langs[e]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",t,e),t=e):(console.warn("Localization Error - Matching locale not found, using default: ",t),t="default")}this.locale=t,this.lang=h.prototype.helpers.deepClone(this.langs.default||{}),"default"!=t&&function t(e,i){for(var n in e)"object"==s(e[n])?(i[n]||(i[n]={}),t(e[n],i[n])):i[n]=e[n]}(this.langs[t],this.lang),this.table.options.localized.call(this.table,this.locale,this.lang),this._executeBindings()},p.prototype.getLocale=function(t){return self.locale},p.prototype.getLang=function(t){return t?this.langs[t]:this.lang},p.prototype.getText=function(t,e){var i=(t=e?t+"|"+e:t).split("|");return this._getLangElement(i,this.locale)||""},p.prototype._getLangElement=function(t,e){var i=this.lang;return t.forEach((function(t){var e;i&&(e=i[t],i=void 0!==e&&e)})),i},p.prototype.bind=function(t,e){this.bindings[t]||(this.bindings[t]=[]),this.bindings[t].push(e),e(this.getText(t),this.lang)},p.prototype._executeBindings=function(){var t=this,e=function(e){t.bindings[e].forEach((function(i){i(t.getText(e),t.lang)}))};for(var i in t.bindings)e(i)},p.prototype.langs={default:{groups:{item:"item",items:"items"},columns:{},ajax:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page"},headerFilters:{default:"filter column...",columns:{}}}},h.prototype.registerModule("localize",p);var f=function(t){this.table=t};f.prototype.getConnections=function(t){var e=this,i=[];return h.prototype.comms.lookupTable(t).forEach((function(t){e.table!==t&&i.push(t)})),i},f.prototype.send=function(t,e,i,n){var o=this,r=this.getConnections(t);r.forEach((function(t){t.tableComms(o.table.element,e,i,n)})),!r.length&&t&&console.warn("Table Connection Error - No tables matching selector found",t)},f.prototype.receive=function(t,e,i,n){if(this.table.modExists(e))return this.table.modules[e].commsReceived(t,i,n);console.warn("Inter-table Comms Error - no such module:",e)},h.prototype.registerModule("comms",f);var g=function(t){this.table=t,this.allowedTypes=["","data","download","clipboard","print","htmlOutput"]};g.prototype.initializeColumn=function(t){var e=this,i=!1,n={};this.allowedTypes.forEach((function(o){var r,a="accessor"+(o.charAt(0).toUpperCase()+o.slice(1));t.definition[a]&&(r=e.lookupAccessor(t.definition[a]))&&(i=!0,n[a]={accessor:r,params:t.definition[a+"Params"]||{}})})),i&&(t.modules.accessor=n)},g.prototype.lookupAccessor=function(t){var e=!1;switch(void 0===t?"undefined":s(t)){case"string":this.accessors[t]?e=this.accessors[t]:console.warn("Accessor Error - No such accessor found, ignoring: ",t);break;case"function":e=t}return e},g.prototype.transformRow=function(t,e){var i="accessor"+(e.charAt(0).toUpperCase()+e.slice(1)),n=h.prototype.helpers.deepClone(t||{});return this.table.columnManager.traverse((function(t){var o,r,a,s;t.modules.accessor&&(r=t.modules.accessor[i]||t.modules.accessor.accessor||!1)&&"undefined"!=(o=t.getFieldValue(n))&&(s=t.getComponent(),a="function"==typeof r.params?r.params(o,n,e,s):r.params,t.setFieldValue(n,r.accessor(o,n,e,a,s)))})),n},g.prototype.accessors={},h.prototype.registerModule("accessor",g);var m=function(t){this.table=t,this.config=!1,this.url="",this.urlGenerator=!1,this.params=!1,this.loaderElement=this.createLoaderElement(),this.msgElement=this.createMsgElement(),this.loadingElement=!1,this.errorElement=!1,this.loaderPromise=!1,this.progressiveLoad=!1,this.loading=!1,this.requestOrder=0};m.prototype.initialize=function(){var t;this.loaderElement.appendChild(this.msgElement),this.table.options.ajaxLoaderLoading&&("string"==typeof this.table.options.ajaxLoaderLoading?((t=document.createElement("template")).innerHTML=this.table.options.ajaxLoaderLoading.trim(),this.loadingElement=t.content.firstChild):this.loadingElement=this.table.options.ajaxLoaderLoading),this.loaderPromise=this.table.options.ajaxRequestFunc||this.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||this.defaultURLGenerator,this.table.options.ajaxLoaderError&&("string"==typeof this.table.options.ajaxLoaderError?((t=document.createElement("template")).innerHTML=this.table.options.ajaxLoaderError.trim(),this.errorElement=t.content.firstChild):this.errorElement=this.table.options.ajaxLoaderError),this.table.options.ajaxParams&&this.setParams(this.table.options.ajaxParams),this.table.options.ajaxConfig&&this.setConfig(this.table.options.ajaxConfig),this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.table.options.ajaxProgressiveLoad&&(this.table.options.pagination?(this.progressiveLoad=!1,console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time")):this.table.modExists("page")?(this.progressiveLoad=this.table.options.ajaxProgressiveLoad,this.table.modules.page.initializeProgressive(this.progressiveLoad)):console.error("Pagination plugin is required for progressive ajax loading"))},m.prototype.createLoaderElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-loader"),t},m.prototype.createMsgElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-loader-msg"),t.setAttribute("role","alert"),t},m.prototype.setParams=function(t,e){if(e)for(var i in this.params=this.params||{},t)this.params[i]=t[i];else this.params=t},m.prototype.getParams=function(){return this.params||{}},m.prototype.setConfig=function(t){if(this._loadDefaultConfig(),"string"==typeof t)this.config.method=t;else for(var e in t)this.config[e]=t[e]},m.prototype._loadDefaultConfig=function(t){if(!this.config||t)for(var e in this.config={},this.defaultConfig)this.config[e]=this.defaultConfig[e]},m.prototype.setUrl=function(t){this.url=t},m.prototype.getUrl=function(){return this.url},m.prototype.loadData=function(t,e){return this.progressiveLoad?this._loadDataProgressive():this._loadDataStandard(t,e)},m.prototype.nextPage=function(t){this.loading||t<(this.table.options.ajaxProgressiveLoadScrollMargin||2*this.table.rowManager.getElement().clientHeight)&&this.table.modules.page.nextPage().then((function(){})).catch((function(){}))},m.prototype.blockActiveRequest=function(){this.requestOrder++},m.prototype._loadDataProgressive=function(){return this.table.rowManager.setData([]),this.table.modules.page.setPage(1)},m.prototype._loadDataStandard=function(t,e){var i=this;return new Promise((function(n,o){i.sendRequest(t).then((function(r){i.table.rowManager.setData(r,t,e).then((function(){n()})).catch((function(t){o(t)}))})).catch((function(t){o(t)}))}))},m.prototype.generateParamsList=function(t,e){var i=this,n=[];if(e=e||"",Array.isArray(t))t.forEach((function(t,o){n=n.concat(i.generateParamsList(t,e?e+"["+o+"]":o))}));else if("object"===(void 0===t?"undefined":s(t)))for(var o in t)n=n.concat(i.generateParamsList(t[o],e?e+"["+o+"]":o));else n.push({key:e,value:t});return n},m.prototype.serializeParams=function(t){var e=this.generateParamsList(t),i=[];return e.forEach((function(t){i.push(encodeURIComponent(t.key)+"="+encodeURIComponent(t.value))})),i.join("&")},m.prototype.sendRequest=function(t){var e,i=this,n=this,o=n.url;return n.requestOrder++,e=n.requestOrder,n._loadDefaultConfig(),new Promise((function(r,a){!1!==n.table.options.ajaxRequesting.call(i.table,n.url,n.params)?(n.loading=!0,t||n.showLoader(),i.loaderPromise(o,n.config,n.params).then((function(t){e===n.requestOrder?(n.table.options.ajaxResponse&&(t=n.table.options.ajaxResponse.call(n.table,n.url,n.params,t)),r(t),n.hideLoader(),n.loading=!1):console.warn("Ajax Response Blocked - An active ajax request was blocked by an attempt to change table data while the request was being made")})).catch((function(t){console.error("Ajax Load Error: ",t),n.table.options.ajaxError.call(n.table,t),n.showError(),setTimeout((function(){n.hideLoader()}),3e3),n.loading=!1,a()}))):a()}))},m.prototype.showLoader=function(){if("function"==typeof this.table.options.ajaxLoader?this.table.options.ajaxLoader():this.table.options.ajaxLoader){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-error"),this.msgElement.classList.add("tabulator-loading"),this.loadingElement?this.msgElement.appendChild(this.loadingElement):this.msgElement.innerHTML=this.table.modules.localize.getText("ajax|loading"),this.table.element.appendChild(this.loaderElement)}},m.prototype.showError=function(){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-loading"),this.msgElement.classList.add("tabulator-error"),this.errorElement?this.msgElement.appendChild(this.errorElement):this.msgElement.innerHTML=this.table.modules.localize.getText("ajax|error"),this.table.element.appendChild(this.loaderElement)},m.prototype.hideLoader=function(){this.loaderElement.parentNode&&this.loaderElement.parentNode.removeChild(this.loaderElement)},m.prototype.defaultConfig={method:"GET"},m.prototype.defaultURLGenerator=function(t,e,i){return t&&i&&Object.keys(i).length&&(e.method&&"get"!=e.method.toLowerCase()||(e.method="get",t+=(t.includes("?")?"&":"?")+this.serializeParams(i))),t},m.prototype.defaultLoaderPromise=function(t,e,i){var n,o=this;return new Promise((function(r,a){if(t=o.urlGenerator(t,e,i),"GET"!=e.method.toUpperCase())if(n="object"===s(o.table.options.ajaxContentType)?o.table.options.ajaxContentType:o.contentTypeFormatters[o.table.options.ajaxContentType]){for(var l in n.headers)e.headers||(e.headers={}),void 0===e.headers[l]&&(e.headers[l]=n.headers[l]);e.body=n.body.call(o,t,e,i)}else console.warn("Ajax Error - Invalid ajaxContentType value:",o.table.options.ajaxContentType);t?(void 0===e.headers&&(e.headers={}),void 0===e.headers.Accept&&(e.headers.Accept="application/json"),void 0===e.headers["X-Requested-With"]&&(e.headers["X-Requested-With"]="XMLHttpRequest"),void 0===e.mode&&(e.mode="cors"),"cors"==e.mode?(void 0===e.headers["Access-Control-Allow-Origin"]&&(e.headers["Access-Control-Allow-Origin"]=window.location.origin),void 0===e.credentials&&(e.credentials="same-origin")):void 0===e.credentials&&(e.credentials="include"),fetch(t,e).then((function(t){t.ok?t.json().then((function(t){r(t)})).catch((function(t){a(t),console.warn("Ajax Load Error - Invalid JSON returned",t)})):(console.error("Ajax Load Error - Connection Error: "+t.status,t.statusText),a(t))})).catch((function(t){console.error("Ajax Load Error - Connection Error: ",t),a(t)}))):(console.warn("Ajax Load Error - No URL Set"),r([]))}))},m.prototype.contentTypeFormatters={json:{headers:{"Content-Type":"application/json"},body:function(t,e,i){return JSON.stringify(i)}},form:{headers:{},body:function(t,e,i){var n=this.generateParamsList(i),o=new FormData;return n.forEach((function(t){o.append(t.key,t.value)})),o}}},h.prototype.registerModule("ajax",m);var v=function(t){this.table=t,this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.initialize()};v.prototype.createElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-calcs-holder"),t},v.prototype.initialize=function(){this.genColumn=new n({field:"value"},this)},v.prototype.registerColumnField=function(){},v.prototype.initializeColumn=function(t){var e=t.definition,i={topCalcParams:e.topCalcParams||{},botCalcParams:e.bottomCalcParams||{}};if(e.topCalc){switch(s(e.topCalc)){case"string":this.calculations[e.topCalc]?i.topCalc=this.calculations[e.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",e.topCalc);break;case"function":i.topCalc=e.topCalc}i.topCalc&&(t.modules.columnCalcs=i,this.topCalcs.push(t),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(e.bottomCalc){switch(s(e.bottomCalc)){case"string":this.calculations[e.bottomCalc]?i.botCalc=this.calculations[e.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",e.bottomCalc);break;case"function":i.botCalc=e.bottomCalc}i.botCalc&&(t.modules.columnCalcs=i,this.botCalcs.push(t),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}},v.prototype.removeCalcs=function(){var t=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),t=!0),this.botInitialized&&(this.botInitialized=!1,this.table.footerManager.remove(this.botElement),t=!0),t&&this.table.rowManager.adjustTableSize()},v.prototype.initializeTopRow=function(){this.topInitialized||(this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)},v.prototype.initializeBottomRow=function(){this.botInitialized||(this.table.footerManager.prepend(this.botElement),this.botInitialized=!0)},v.prototype.scrollHorizontal=function(t){this.table.columnManager.getElement().scrollWidth,this.table.element.clientWidth,this.botInitialized&&(this.botRow.getElement().style.marginLeft=-t+"px")},v.prototype.recalc=function(t){var e;if(this.topInitialized||this.botInitialized){if(this.rowsToData(t),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),e=this.generateRow("top",this.rowsToData(t)),this.topRow=e;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(e.getElement()),e.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),e=this.generateRow("bottom",this.rowsToData(t)),this.botRow=e;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(e.getElement()),e.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}},v.prototype.recalcRowGroup=function(t){this.recalcGroup(this.table.modules.groupRows.getRowGroup(t))},v.prototype.recalcAll=function(){var t=this;(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalc(this.table.rowManager.activeRows),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs&&table.modules.groupRows.getChildGroups().forEach((function(e){t.recalcGroup(e)})))},v.prototype.recalcGroup=function(t){var e,i;t&&t.calcs&&(t.calcs.bottom&&(e=this.rowsToData(t.rows),i=this.generateRowData("bottom",e),t.calcs.bottom.updateData(i),t.calcs.bottom.reinitialize()),t.calcs.top&&(e=this.rowsToData(t.rows),i=this.generateRowData("top",e),t.calcs.top.updateData(i),t.calcs.top.reinitialize()))},v.prototype.generateTopRow=function(t){return this.generateRow("top",this.rowsToData(t))},v.prototype.generateBottomRow=function(t){return this.generateRow("bottom",this.rowsToData(t))},v.prototype.rowsToData=function(t){var e=this,i=[];return t.forEach((function(t){if(i.push(t.getData()),e.table.options.dataTree&&e.table.options.dataTreeChildColumnCalcs&&t.modules.dataTree.open){var n=e.rowsToData(e.table.modules.dataTree.getFilteredTreeChildren(t));i=i.concat(n)}})),i},v.prototype.generateRow=function(t,e){var i,n=this,o=this.generateRowData(t,e);return n.table.modExists("mutator")&&n.table.modules.mutator.disable(),i=new a(o,this,"calc"),n.table.modExists("mutator")&&n.table.modules.mutator.enable(),i.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+t),i.generateCells=function(){var e=[];n.table.columnManager.columnsByIndex.forEach((function(o){n.genColumn.setField(o.getField()),n.genColumn.hozAlign=o.hozAlign,o.definition[t+"CalcFormatter"]&&n.table.modExists("format")?n.genColumn.modules.format={formatter:n.table.modules.format.getFormatter(o.definition[t+"CalcFormatter"]),params:o.definition[t+"CalcFormatterParams"]}:n.genColumn.modules.format={formatter:n.table.modules.format.getFormatter("plaintext"),params:{}},n.genColumn.definition.cssClass=o.definition.cssClass;var r=new u(n.genColumn,i);r.column=o,r.setWidth(),o.cells.push(r),e.push(r),o.visible||r.hide()})),this.cells=e},i},v.prototype.generateRowData=function(t,e){var i,n,o={},r="top"==t?this.topCalcs:this.botCalcs,a="top"==t?"topCalc":"botCalc";return r.forEach((function(t){var r=[];t.modules.columnCalcs&&t.modules.columnCalcs[a]&&(e.forEach((function(e){r.push(t.getFieldValue(e))})),n=a+"Params",i="function"==typeof t.modules.columnCalcs[n]?t.modules.columnCalcs[n](r,e):t.modules.columnCalcs[n],t.setFieldValue(o,t.modules.columnCalcs[a](r,e,i)))})),o},v.prototype.hasTopCalcs=function(){return!!this.topCalcs.length},v.prototype.hasBottomCalcs=function(){return!!this.botCalcs.length},v.prototype.redraw=function(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)},v.prototype.getResults=function(){var t=this,e={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach((function(i){e[i.getKey()]=t.getGroupResults(i)})):e={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},e},v.prototype.getGroupResults=function(t){var e=this,i=t._getSelf(),n=t.getSubGroups(),o={};return n.forEach((function(t){o[t.getKey()]=e.getGroupResults(t)})),{top:i.calcs.top?i.calcs.top.getData():{},bottom:i.calcs.bottom?i.calcs.bottom.getData():{},groups:o}},v.prototype.calculations={avg:function(t,e,i){var n=0,o=void 0!==i.precision?i.precision:2;return t.length&&(n=t.reduce((function(t,e){return t+(e=Number(e))})),n/=t.length,n=!1!==o?n.toFixed(o):n),parseFloat(n).toString()},max:function(t,e,i){var n=null,o=void 0!==i.precision&&i.precision;return t.forEach((function(t){((t=Number(t))>n||null===n)&&(n=t)})),null!==n?!1!==o?n.toFixed(o):n:""},min:function(t,e,i){var n=null,o=void 0!==i.precision&&i.precision;return t.forEach((function(t){((t=Number(t))<n||null===n)&&(n=t)})),null!==n?!1!==o?n.toFixed(o):n:""},sum:function(t,e,i){var n=0,o=void 0!==i.precision&&i.precision;return t.length&&t.forEach((function(t){t=Number(t),n+=isNaN(t)?0:Number(t)})),!1!==o?n.toFixed(o):n},concat:function(t,e,i){var n=0;return t.length&&(n=t.reduce((function(t,e){return String(t)+String(e)}))),n},count:function(t,e,i){var n=0;return t.length&&t.forEach((function(t){t&&n++})),n}},h.prototype.registerModule("columnCalcs",v);var y=function(t){this.table=t,this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0};y.prototype.initialize=function(){var t=this;this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,!0!==this.mode&&"copy"!==this.mode||this.table.element.addEventListener("copy",(function(e){var i,n;t.blocked||(e.preventDefault(),t.customSelection?(i=t.customSelection,t.table.options.clipboardCopyFormatter&&(i=t.table.options.clipboardCopyFormatter("plain",i))):(i=(n=t.table.modules.export.getHtml(t.rowRange,t.table.options.clipboardCopyStyled,t.table.options.clipboardCopyConfig,"clipboard"))?t.generatePlainContent(n):"",t.table.options.clipboardCopyFormatter&&(i=t.table.options.clipboardCopyFormatter("plain",i),n=t.table.options.clipboardCopyFormatter("html",n))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",i):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",i),n&&e.clipboardData.setData("text/html",n)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",i),n&&e.originalEvent.clipboardData.setData("text/html",n)),t.table.options.clipboardCopied.call(t.table,i,n),t.reset())})),!0!==this.mode&&"paste"!==this.mode||this.table.element.addEventListener("paste",(function(e){t.paste(e)})),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction)},y.prototype.reset=function(){this.blocked=!1,this.originalSelectionText=""},y.prototype.generatePlainContent=function(t){var e=[],i=document.createElement("div");i.innerHTML=t;var n=i.getElementsByTagName("table")[0];return Array.prototype.slice.call(n.getElementsByTagName("tr")).forEach((function(t){var i=[],n=Array.prototype.slice.call(t.getElementsByTagName("th")),o=Array.prototype.slice.call(t.getElementsByTagName("td"));(o=o.concat(n)).forEach((function(t){var e=t.innerHTML;e="&nbsp;"==e?"":e,i.push(e)})),e.push(i.join("\t"))})),e.join("\n")},y.prototype.copy=function(t,e){var i,n;this.blocked=!1,this.customSelection=!1,!0!==this.mode&&"copy"!==this.mode||(this.rowRange=t||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((t=document.createRange()).selectNodeContents(this.table.element),(i=window.getSelection()).toString()&&e&&(this.customSelection=i.toString()),i.removeAllRanges(),i.addRange(t)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((n=document.body.createTextRange()).moveToElementText(this.table.element),n.select()),document.execCommand("copy"),i&&i.removeAllRanges())},y.prototype.setPasteAction=function(t){switch(void 0===t?"undefined":s(t)){case"string":this.pasteAction=this.pasteActions[t],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",t);break;case"function":this.pasteAction=t}},y.prototype.setPasteParser=function(t){switch(void 0===t?"undefined":s(t)){case"string":this.pasteParser=this.pasteParsers[t],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",t);break;case"function":this.pasteParser=t}},y.prototype.paste=function(t){var e,i,n;this.checkPaseOrigin(t)&&(e=this.getPasteData(t),(i=this.pasteParser.call(this,e))?(t.preventDefault(),this.table.modExists("mutator")&&(i=this.mutateData(i)),n=this.pasteAction.call(this,i),this.table.options.clipboardPasted.call(this.table,e,i,n)):this.table.options.clipboardPasteError.call(this.table,e))},y.prototype.mutateData=function(t){var e=this,i=[];return Array.isArray(t)?t.forEach((function(t){i.push(e.table.modules.mutator.transformRow(t,"clipboard"))})):i=t,i},y.prototype.checkPaseOrigin=function(t){var e=!0;return("DIV"!=t.target.tagName||this.table.modules.edit.currentCell)&&(e=!1),e},y.prototype.getPasteData=function(t){var e;return window.clipboardData&&window.clipboardData.getData?e=window.clipboardData.getData("Text"):t.clipboardData&&t.clipboardData.getData?e=t.clipboardData.getData("text/plain"):t.originalEvent&&t.originalEvent.clipboardData.getData&&(e=t.originalEvent.clipboardData.getData("text/plain")),e},y.prototype.pasteParsers={table:function(t){var e=[],i=!0,n=this.table.columnManager.columns,o=[],r=[];return(t=t.split("\n")).forEach((function(t){e.push(t.split("\t"))})),!(!e.length||1===e.length&&e[0].length<2)&&(e[0].forEach((function(t){var e=n.find((function(e){return t&&e.definition.title&&t.trim()&&e.definition.title.trim()===t.trim()}));e?o.push(e):i=!1})),i||(i=!0,o=[],e[0].forEach((function(t){var e=n.find((function(e){return t&&e.field&&t.trim()&&e.field.trim()===t.trim()}));e?o.push(e):i=!1})),i||(o=this.table.columnManager.columnsByIndex)),i&&e.shift(),e.forEach((function(t){var e={};t.forEach((function(t,i){o[i]&&(e[o[i].field]=t)})),r.push(e)})),r)}},y.prototype.pasteActions={replace:function(t){return this.table.setData(t)},update:function(t){return this.table.updateOrAddData(t)},insert:function(t){return this.table.addData(t)}},h.prototype.registerModule("clipboard",y);var b=function(t){this.table=t,this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.displayIndex=0};b.prototype.initialize=function(){var t=null,e=this.table.columnManager.getFirstVisibileColumn(),i=this.table.options;switch(this.field=i.dataTreeChildField,this.indent=i.dataTreeChildIndent,this.elementField=i.dataTreeElementColumn||!!e&&e.field,i.dataTreeBranchElement&&(!0===i.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof i.dataTreeBranchElement?((t=document.createElement("div")).innerHTML=i.dataTreeBranchElement,this.branchEl=t.firstChild):this.branchEl=i.dataTreeBranchElement),i.dataTreeCollapseElement?"string"==typeof i.dataTreeCollapseElement?((t=document.createElement("div")).innerHTML=i.dataTreeCollapseElement,this.collapseEl=t.firstChild):this.collapseEl=i.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),i.dataTreeExpandElement?"string"==typeof i.dataTreeExpandElement?((t=document.createElement("div")).innerHTML=i.dataTreeExpandElement,this.expandEl=t.firstChild):this.expandEl=i.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),s(i.dataTreeStartExpanded)){case"boolean":this.startOpen=function(t,e){return i.dataTreeStartExpanded};break;case"function":this.startOpen=i.dataTreeStartExpanded;break;default:this.startOpen=function(t,e){return i.dataTreeStartExpanded[e]}}},b.prototype.initializeRow=function(t){var e=t.getData()[this.field],i=Array.isArray(e),n=i||!i&&"object"===(void 0===e?"undefined":s(e))&&null!==e;!n&&t.modules.dataTree&&t.modules.dataTree.branchEl&&t.modules.dataTree.branchEl.parentNode.removeChild(t.modules.dataTree.branchEl),!n&&t.modules.dataTree&&t.modules.dataTree.controlEl&&t.modules.dataTree.controlEl.parentNode.removeChild(t.modules.dataTree.controlEl),t.modules.dataTree={index:0,open:!!n&&(t.modules.dataTree?t.modules.dataTree.open:this.startOpen(t.getComponent(),0)),controlEl:!(!t.modules.dataTree||!n)&&t.modules.dataTree.controlEl,branchEl:!(!t.modules.dataTree||!n)&&t.modules.dataTree.branchEl,parent:!1,children:n}},b.prototype.layoutRow=function(t){var e=(this.elementField?t.getCell(this.elementField):t.getCells()[0]).getElement(),i=t.modules.dataTree;i.branchEl&&(i.branchEl.parentNode.removeChild(i.branchEl),i.branchEl=!1),i.controlEl&&(i.controlEl.parentNode.removeChild(i.controlEl),i.controlEl=!1),this.generateControlElement(t,e),t.element.classList.add("tabulator-tree-level-"+i.index),i.index&&(this.branchEl?(i.branchEl=this.branchEl.cloneNode(!0),e.insertBefore(i.branchEl,e.firstChild),i.branchEl.style.marginLeft=(i.branchEl.offsetWidth+i.branchEl.style.marginRight)*(i.index-1)+i.index*this.indent+"px"):e.style.paddingLeft=parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-left"))+i.index*this.indent+"px")},b.prototype.generateControlElement=function(t,e){var i=this,n=t.modules.dataTree,o=(e=e||t.getCells()[0].getElement(),n.controlEl);!1!==n.children&&(n.open?(n.controlEl=this.collapseEl.cloneNode(!0),n.controlEl.addEventListener("click",(function(e){e.stopPropagation(),i.collapseRow(t)}))):(n.controlEl=this.expandEl.cloneNode(!0),n.controlEl.addEventListener("click",(function(e){e.stopPropagation(),i.expandRow(t)}))),n.controlEl.addEventListener("mousedown",(function(t){t.stopPropagation()})),o&&o.parentNode===e?o.parentNode.replaceChild(n.controlEl,o):e.insertBefore(n.controlEl,e.firstChild))},b.prototype.setDisplayIndex=function(t){this.displayIndex=t},b.prototype.getDisplayIndex=function(){return this.displayIndex},b.prototype.getRows=function(t){var e=this,i=[];return t.forEach((function(t,n){var o;i.push(t),t instanceof a&&((o=t.modules.dataTree.children).index||!1===o.children||e.getChildren(t).forEach((function(t){i.push(t)})))})),i},b.prototype.getChildren=function(t){var e=this,i=t.modules.dataTree,n=[],o=[];return!1!==i.children&&i.open&&(Array.isArray(i.children)||(i.children=this.generateChildren(t)),n=this.table.modExists("filter")?this.table.modules.filter.filter(i.children):i.children,this.table.modExists("sort")&&this.table.modules.sort.sort(n),n.forEach((function(t){o.push(t),e.getChildren(t).forEach((function(t){o.push(t)}))}))),o},b.prototype.generateChildren=function(t){var e=this,i=[],n=t.getData()[this.field];return Array.isArray(n)||(n=[n]),n.forEach((function(n){var o=new a(n||{},e.table.rowManager);o.modules.dataTree.index=t.modules.dataTree.index+1,o.modules.dataTree.parent=t,o.modules.dataTree.children&&(o.modules.dataTree.open=e.startOpen(o.getComponent(),o.modules.dataTree.index)),i.push(o)})),i},b.prototype.expandRow=function(t,e){var i=t.modules.dataTree;!1!==i.children&&(i.open=!0,t.reinitialize(),this.table.rowManager.refreshActiveData("tree",!1,!0),this.table.options.dataTreeRowExpanded(t.getComponent(),t.modules.dataTree.index))},b.prototype.collapseRow=function(t){var e=t.modules.dataTree;!1!==e.children&&(e.open=!1,t.reinitialize(),this.table.rowManager.refreshActiveData("tree",!1,!0),this.table.options.dataTreeRowCollapsed(t.getComponent(),t.modules.dataTree.index))},b.prototype.toggleRow=function(t){var e=t.modules.dataTree;!1!==e.children&&(e.open?this.collapseRow(t):this.expandRow(t))},b.prototype.getTreeParent=function(t){return!!t.modules.dataTree.parent&&t.modules.dataTree.parent.getComponent()},b.prototype.getFilteredTreeChildren=function(t){var e=t.modules.dataTree,i=[];return e.children&&(Array.isArray(e.children)||(e.children=this.generateChildren(t)),(this.table.modExists("filter")?this.table.modules.filter.filter(e.children):e.children).forEach((function(t){t instanceof a&&i.push(t)}))),i},b.prototype.getTreeChildren=function(t){var e=t.modules.dataTree,i=[];return e.children&&(Array.isArray(e.children)||(e.children=this.generateChildren(t)),e.children.forEach((function(t){t instanceof a&&i.push(t.getComponent())}))),i},b.prototype.checkForRestyle=function(t){t.row.cells.indexOf(t)||!1!==t.row.modules.dataTree.children&&t.row.reinitialize()},b.prototype.getChildField=function(){return this.field},b.prototype.redrawNeeded=function(t){return!!this.field&&void 0!==t[this.field]||!!this.elementField&&void 0!==t[this.elementField]},h.prototype.registerModule("dataTree",b);var w=function(t){this.table=t,this.fields={},this.columnsByIndex=[],this.columnsByField={},this.config={},this.active=!1};w.prototype.download=function(t,e,i,n,o){var r=this,a=!1;this.processConfig(),this.active=n,"function"==typeof t?a=t:r.downloaders[t]?a=r.downloaders[t]:console.warn("Download Error - No such download type found: ",t),this.processColumns(),a&&a.call(this,r.processDefinitions(),r.processData(n||"active"),i||{},(function(i,n){o?!0===o?r.triggerDownload(i,n,t,e,!0):o(i):r.triggerDownload(i,n,t,e)}),this.config)},w.prototype.processConfig=function(){var t={columnGroups:!0,rowGroups:!0,columnCalcs:!0,dataTree:!0};if(this.table.options.downloadConfig)for(var e in this.table.options.downloadConfig)t[e]=this.table.options.downloadConfig[e];this.config.rowGroups=t.rowGroups&&this.table.options.groupBy&&this.table.modExists("groupRows"),t.columnGroups&&this.table.columnManager.columns.length!=this.table.columnManager.columnsByIndex.length&&(this.config.columnGroups=!0),t.columnCalcs&&this.table.modExists("columnCalcs")&&(this.config.columnCalcs=!0),t.dataTree&&this.table.options.dataTree&&this.table.modExists("dataTree")&&(this.config.dataTree=!0)},w.prototype.processColumns=function(){var t=this;t.columnsByIndex=[],t.columnsByField={},t.table.columnManager.columnsByIndex.forEach((function(e){e.field&&!1!==e.definition.download&&(e.visible||!e.visible&&e.definition.download)&&(t.columnsByIndex.push(e),t.columnsByField[e.field]=e)}))},w.prototype.processDefinitions=function(){var t=this,e=[];return this.config.columnGroups?t.table.columnManager.columns.forEach((function(i){var n=t.processColumnGroup(i);n&&e.push(n)})):t.columnsByIndex.forEach((function(i){!1!==i.download&&e.push(t.processDefinition(i))})),e},w.prototype.processColumnGroup=function(t){var e=this,i=t.columns,n=0,o=this.processDefinition(t),r={type:"group",title:o.title,depth:1};if(i.length){if(r.subGroups=[],r.width=0,i.forEach((function(t){var i=e.processColumnGroup(t);i.depth>n&&(n=i.depth),i&&(r.width+=i.width,r.subGroups.push(i))})),r.depth+=n,!r.width)return!1}else{if(!t.field||!1===t.definition.download||!(t.visible||!t.visible&&t.definition.download))return!1;r.width=1,r.definition=o}return r},w.prototype.processDefinition=function(t){var e={};for(var i in t.definition)e[i]=t.definition[i];return void 0!==t.definition.downloadTitle&&(e.title=t.definition.downloadTitle),e},w.prototype.processData=function(t){var e=this,i=[],n=[],o=!1,r={};return this.config.rowGroups?("visible"==t?(o=this.table.rowManager.getRows(t)).forEach((function(t){if("row"==t.type){var e=t.getGroup();-1===n.indexOf(e)&&n.push(e)}})):n=this.table.modules.groupRows.getGroups(),n.forEach((function(t){i.push(e.processGroupData(t,o))}))):(this.config.dataTree&&(t=t="display"),i=this.table.rowManager.getData(t,"download")),this.config.columnCalcs&&(r=this.table.getCalcResults(),i={calcs:r,data:i}),"function"==typeof this.table.options.downloadDataFormatter&&(i=this.table.options.downloadDataFormatter(i)),i},w.prototype.processGroupData=function(t,e){var i=this,n=t.getSubGroups(),o={type:"group",key:t.key};return n.length?(o.subGroups=[],n.forEach((function(t){o.subGroups.push(i.processGroupData(t,e))}))):e?(o.rows=[],t.rows.forEach((function(t){e.indexOf(t)>-1&&o.rows.push(t.getData("download"))}))):o.rows=t.getData(!0,"download"),o},w.prototype.triggerDownload=function(t,e,i,n,o){var r=document.createElement("a"),a=new Blob([t],{type:e});n=n||"Tabulator."+("function"==typeof i?"txt":i),(a=this.table.options.downloadReady.call(this.table,t,a))&&(o?window.open(window.URL.createObjectURL(a)):navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(a,n):(r.setAttribute("href",window.URL.createObjectURL(a)),r.setAttribute("download",n),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)),this.table.options.downloadComplete&&this.table.options.downloadComplete())},w.prototype.getFieldValue=function(t,e){var i=this.columnsByField[t];return!!i&&i.getFieldValue(e)},w.prototype.commsReceived=function(t,e,i){switch(e){case"intercept":this.download(i.type,"",i.options,i.active,i.intercept)}},w.prototype.downloaders={csv:function(t,e,i,n,o){var r,a,l=this,u=[],c=[],h=i&&i.delimiter?i.delimiter:",";function d(t){t.forEach((function(t){var e=[];c.forEach((function(i){var n=l.getFieldValue(i,t);switch(void 0===n?"undefined":s(n)){case"object":n=JSON.stringify(n);break;case"undefined":case"null":n="";break;default:n=n}e.push('"'+String(n).split('"').join('""')+'"')})),r.push(e.join(h))}))}o.columnGroups?(console.warn("Download Warning - CSV downloader cannot process column groups"),t.forEach((function(t){!function t(e,i){e.subGroups?e.subGroups.forEach((function(e){t(e,i+1)})):(u.push('"'+String(e.title).split('"').join('""')+'"'),c.push(e.definition.field))}(t,0)}))):t.forEach((function(t){u.push('"'+String(t.title).split('"').join('""')+'"'),c.push(t.field)})),r=[u.join(h)],o.columnCalcs&&(console.warn("Download Warning - CSV downloader cannot process column calculations"),e=e.data),o.rowGroups?(console.warn("Download Warning - CSV downloader cannot process row groups"),e.forEach((function(t){!function t(e){e.subGroups?e.subGroups.forEach((function(e){t(e)})):d(e.rows)}(t)}))):d(e),a=r.join("\n"),i.bom&&(a="\ufeff"+a),n(a,"text/csv")},json:function(t,e,i,n,o){o.columnCalcs&&(console.warn("Download Warning - CSV downloader cannot process column calculations"),e=e.data),n(JSON.stringify(e,null,"\t"),"application/json")},pdf:function(t,e,i,n,o){var r=this,a=[],l=[],u=[],c={},h=1,d={},p=i.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},f=i.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},g=i.jsPDF||{},m=i&&i.title?i.title:"";if(o.columnCalcs&&(c=e.calcs,e=e.data),g.orientation||(g.orientation=i.orientation||"landscape"),g.unit||(g.unit="pt"),o.columnGroups){t.forEach((function(t){t.depth>h&&(h=t.depth)}));for(var v=0;v<h;v++)l.push([]);t.forEach((function(t){!function t(e,i){var n=e.width,o=1,r={content:e.title||""};if(e.subGroups?(e.subGroups.forEach((function(e){t(e,i+1)})),o=1):(a.push(e.definition.field),o=h-i),r.rowSpan=o,l[i].push(r),n--,o>1)for(var s=i+1;s<h;s++)l[s].push("");for(s=0;s<n;s++)l[i].push("")}(t,0)}))}else t.forEach((function(t){t.field&&(l.push(t.title||""),a.push(t.field))})),l=[l];function y(t){switch(void 0===t?"undefined":s(t)){case"object":t=JSON.stringify(t);break;case"undefined":case"null":t="";break;default:t=t}return t}function b(t){t.forEach((function(t){u.push(w(t))}))}function w(t,e){var i=[];return a.forEach((function(n){var o=r.getFieldValue(n,t);o=y(o),e?i.push({content:o,styles:e}):i.push(o)})),i}function _(t,e,i){var n=t[e];n&&(i&&(n=n[i]),Object.keys(n).length&&u.push(w(n,f)))}o.rowGroups?e.forEach((function(t){!function t(e,i){var n=[];n.push({content:y(e.key),colSpan:a.length,styles:p}),u.push(n),e.subGroups?e.subGroups.forEach((function(n){t(n,i[e.key]&&i[e.key].groups||{})})):(o.columnCalcs&&_(i,e.key,"top"),b(e.rows),o.columnCalcs&&_(i,e.key,"bottom"))}(t,c)})):(o.columnCalcs&&_(c,"top"),b(e),o.columnCalcs&&_(c,"bottom"));var x=new jsPDF(g);i&&i.autoTable&&(d="function"==typeof i.autoTable?i.autoTable(x)||{}:i.autoTable),m&&(d.addPageContent=function(t){x.text(m,40,30)}),d.head=l,d.body=u,x.autoTable(d),i&&i.documentProcessing&&i.documentProcessing(x),n(x.output("arraybuffer"),"application/pdf")},xlsx:function(t,e,i,n,o){var r=this,a=i.sheetName||"Sheet1",l=XLSX.utils.book_new(),u={},c=[],h=[],d=[];function p(){var i=[],n=[],a=[];function l(t,e){var o;void 0===i[e]&&(i[e]=[]),void 0===h[e]&&(h[e]=[]),t.width>1&&h[e].push({type:"hoz",start:i[e].length,end:i[e].length+t.width-1}),i[e].push(t.title),t.subGroups?t.subGroups.forEach((function(t){l(t,e+1)})):(n.push(t.definition.field),n.length,o=0,i.forEach((function(t){var e=t.length;e>o&&(o=e)})),i.forEach((function(t){var e=t.length;if(e<o)for(var i=e;i<o;i++)t.push("")})),h[e].push({type:"vert",start:n.length-1}))}function p(t){t.forEach((function(t){a.push(f(t))}))}function f(t){var e=[];return n.forEach((function(i){var n=r.getFieldValue(i,t);e.push(n instanceof Date||"object"!==(void 0===n?"undefined":s(n))?n:JSON.stringify(n))})),e}function g(t,e,i){var n=t[e];n&&(i&&(n=n[i]),Object.keys(n).length&&(d.push(a.length),a.push(f(n))))}return o.columnGroups?(t.forEach((function(t){l(t,0)})),i.forEach((function(t){a.push(t)}))):(t.forEach((function(t){i.push(t.title),n.push(t.field)})),a.push(i)),o.rowGroups?e.forEach((function(t){!function t(e,i){var n=[];n.push(e.key),c.push(a.length),a.push(n),e.subGroups?e.subGroups.forEach((function(n){t(n,i[e.key]&&i[e.key].groups||{})})):(o.columnCalcs&&g(i,e.key,"top"),p(e.rows),o.columnCalcs&&g(i,e.key,"bottom"))}(t,u)})):(o.columnCalcs&&g(u,"top"),p(e),o.columnCalcs&&g(u,"bottom")),function(){var t={},e={s:{c:0,r:0},e:{c:n.length,r:a.length}};XLSX.utils.sheet_add_aoa(t,a),t["!ref"]=XLSX.utils.encode_range(e);var o=function(){var t=[];return c.forEach((function(e){t.push({s:{r:e,c:0},e:{r:e,c:n.length-1}})})),h.forEach((function(e,n){e.forEach((function(e){"hoz"===e.type?t.push({s:{r:n,c:e.start},e:{r:n,c:e.end}}):n!=i.length-1&&t.push({s:{r:n,c:e.start},e:{r:i.length-1,c:e.start}})}))})),t}();return o.length&&(t["!merges"]=o),t}()}if(l.SheetNames=[],l.Sheets={},o.columnCalcs&&(u=e.calcs,e=e.data),i.sheetOnly)n(p());else{if(i.sheets)for(var f in i.sheets)!0===i.sheets[f]?(l.SheetNames.push(f),l.Sheets[f]=p()):(l.SheetNames.push(f),this.table.modules.comms.send(i.sheets[f],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:r.active,intercept:function(t){l.Sheets[f]=t}}));else l.SheetNames.push(a),l.Sheets[a]=p();i.documentProcessing&&(l=i.documentProcessing(l)),n(function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n!=t.length;++n)i[n]=255&t.charCodeAt(n);return e}(XLSX.write(l,{bookType:"xlsx",bookSST:!0,type:"binary"})),"application/octet-stream")}},html:function(t,e,i,n,o){this.table.modExists("export",!0)&&n(this.table.modules.export.getHtml(!0,i.style,o),"text/html")}},h.prototype.registerModule("download",w);var _=function(t){this.table=t,this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1};_.prototype.initializeColumn=function(t){var e={editor:!1,blocked:!1,check:t.definition.editable,params:t.definition.editorParams||{}};switch(s(t.definition.editor)){case"string":"tick"===t.definition.editor&&(t.definition.editor="tickCross",console.warn("DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor")),this.editors[t.definition.editor]?e.editor=this.editors[t.definition.editor]:console.warn("Editor Error - No such editor found: ",t.definition.editor);break;case"function":e.editor=t.definition.editor;break;case"boolean":!0===t.definition.editor&&("function"!=typeof t.definition.formatter?("tick"===t.definition.formatter&&(t.definition.formatter="tickCross",console.warn("DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor")),this.editors[t.definition.formatter]?e.editor=this.editors[t.definition.formatter]:e.editor=this.editors.input):console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter))}e.editor&&(t.modules.edit=e)},_.prototype.getCurrentCell=function(){return!!this.currentCell&&this.currentCell.getComponent()},_.prototype.clearEditor=function(){var t,e=this.currentCell;if(this.invalidEdit=!1,e){for(this.currentCell=!1,(t=e.getElement()).classList.remove("tabulator-validation-fail"),t.classList.remove("tabulator-editing");t.firstChild;)t.removeChild(t.firstChild);e.row.getElement().classList.remove("tabulator-row-editing")}},_.prototype.cancelEdit=function(){if(this.currentCell){var t=this.currentCell,e=this.currentCell.getComponent();this.clearEditor(),t.setValueActual(t.getValue()),t.column.cellEvents.cellEditCancelled&&t.column.cellEvents.cellEditCancelled.call(this.table,e),this.table.options.cellEditCancelled.call(this.table,e)}},_.prototype.bindEditor=function(t){var e=this,i=t.getElement();i.setAttribute("tabindex",0),i.addEventListener("click",(function(t){i.classList.contains("tabulator-editing")||i.focus()})),i.addEventListener("mousedown",(function(t){e.mouseClick=!0})),i.addEventListener("focus",(function(i){e.recursionBlock||e.edit(t,i,!1)}))},_.prototype.focusCellNoEvent=function(t,e){this.recursionBlock=!0,e&&"ie"===this.table.browser||t.getElement().focus(),this.recursionBlock=!1},_.prototype.editCell=function(t,e){this.focusCellNoEvent(t),this.edit(t,!1,e)},_.prototype.edit=function(t,e,i){var n,o,r,a=this,l=!0,u=function(){},c=t.getElement();if(!this.currentCell){if(t.column.modules.edit.blocked)return this.mouseClick=!1,c.blur(),!1;switch(e&&e.stopPropagation(),s(t.column.modules.edit.check)){case"function":l=t.column.modules.edit.check(t.getComponent());break;case"boolean":l=t.column.modules.edit.check}if(l||i){if(a.cancelEdit(),a.currentCell=t,o=t.getComponent(),this.mouseClick&&(this.mouseClick=!1,t.column.cellEvents.cellClick&&t.column.cellEvents.cellClick.call(this.table,e,o)),t.column.cellEvents.cellEditing&&t.column.cellEvents.cellEditing.call(this.table,o),a.table.options.cellEditing.call(this.table,o),r="function"==typeof t.column.modules.edit.params?t.column.modules.edit.params(o):t.column.modules.edit.params,!1===(n=t.column.modules.edit.editor.call(a,o,(function(t){u=t}),(function(e){if(a.currentCell===t){var i=!0;return t.column.modules.validate&&a.table.modExists("validate")&&(i=a.table.modules.validate.validate(t.column.modules.validate,t.getComponent(),e)),!0===i?(a.clearEditor(),t.setValue(e,!0),a.table.options.dataTree&&a.table.modExists("dataTree")&&a.table.modules.dataTree.checkForRestyle(t),!0):(a.invalidEdit=!0,c.classList.add("tabulator-validation-fail"),a.focusCellNoEvent(t,!0),u(),a.table.options.validationFailed.call(a.table,t.getComponent(),e,i),!1)}}),(function(){a.currentCell===t&&(a.cancelEdit(),a.table.options.dataTree&&a.table.modExists("dataTree")&&a.table.modules.dataTree.checkForRestyle(t))}),r)))return c.blur(),!1;if(!(n instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",n),c.blur(),!1;for(c.classList.add("tabulator-editing"),t.row.getElement().classList.add("tabulator-row-editing");c.firstChild;)c.removeChild(c.firstChild);c.appendChild(n),u();for(var h=c.children,d=0;d<h.length;d++)h[d].addEventListener("click",(function(t){t.stopPropagation()}));return!0}return this.mouseClick=!1,c.blur(),!1}this.invalidEdit||this.cancelEdit()},_.prototype.maskInput=function(t,e){var i=e.mask,n=void 0!==e.maskLetterChar?e.maskLetterChar:"A",o=void 0!==e.maskNumberChar?e.maskNumberChar:"9",r=void 0!==e.maskWildcardChar?e.maskWildcardChar:"*";function a(e){var s=i[e];void 0!==s&&s!==r&&s!==n&&s!==o&&(t.value=t.value+""+s,a(e+1))}t.addEventListener("keydown",(function(e){var a=t.value.length,s=e.key;if(e.keyCode>46){if(a>=i.length)return e.preventDefault(),e.stopPropagation(),!1;switch(i[a]){case n:if(s.toUpperCase()==s.toLowerCase())return e.preventDefault(),e.stopPropagation(),!1;break;case o:if(isNaN(s))return e.preventDefault(),e.stopPropagation(),!1;break;case r:break;default:if(s!==i[a])return e.preventDefault(),e.stopPropagation(),!1}}})),t.addEventListener("keyup",(function(i){i.keyCode>46&&e.maskAutoFill&&a(t.value.length)})),t.placeholder||(t.placeholder=i),e.maskAutoFill&&a(t.value.length)},_.prototype.editors={input:function(t,e,i,n,o){var r=t.getValue(),a=document.createElement("input");if(a.setAttribute("type",o.search?"search":"text"),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",o.elementAttributes&&"object"==s(o.elementAttributes))for(var l in o.elementAttributes)"+"==l.charAt(0)?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+o.elementAttributes["+"+l])):a.setAttribute(l,o.elementAttributes[l]);function u(t){null==r&&""!==a.value||a.value!==r?i(a.value)&&(r=a.value):n()}return a.value=void 0!==r?r:"",e((function(){a.focus(),a.style.height="100%"})),a.addEventListener("change",u),a.addEventListener("blur",u),a.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:u();break;case 27:n()}})),o.mask&&this.table.modules.edit.maskInput(a,o),a},textarea:function(t,e,i,n,o){var r=t.getValue(),a=o.verticalNavigation||"hybrid",l=String(null!=r?r:""),u=((l.match(/(?:\r\n|\r|\n)/g)||[]).length,document.createElement("textarea")),c=0;if(u.style.display="block",u.style.padding="2px",u.style.height="100%",u.style.width="100%",u.style.boxSizing="border-box",u.style.whiteSpace="pre-wrap",u.style.resize="none",o.elementAttributes&&"object"==s(o.elementAttributes))for(var h in o.elementAttributes)"+"==h.charAt(0)?(h=h.slice(1),u.setAttribute(h,u.getAttribute(h)+o.elementAttributes["+"+h])):u.setAttribute(h,o.elementAttributes[h]);function d(e){null==r&&""!==u.value||u.value!==r?(i(u.value)&&(r=u.value),setTimeout((function(){t.getRow().normalizeHeight()}),300)):n()}return u.value=l,e((function(){u.focus(),u.style.height="100%"})),u.addEventListener("change",d),u.addEventListener("blur",d),u.addEventListener("keyup",(function(){u.style.height="";var e=u.scrollHeight;u.style.height=e+"px",e!=c&&(c=e,t.getRow().normalizeHeight())})),u.addEventListener("keydown",(function(t){switch(t.keyCode){case 27:n();break;case 38:("editor"==a||"hybrid"==a&&u.selectionStart)&&(t.stopImmediatePropagation(),t.stopPropagation());break;case 40:("editor"==a||"hybrid"==a&&u.selectionStart!==u.value.length)&&(t.stopImmediatePropagation(),t.stopPropagation())}})),o.mask&&this.table.modules.edit.maskInput(u,o),u},number:function(t,e,i,n,o){var r=t.getValue(),a=o.verticalNavigation||"editor",l=document.createElement("input");if(l.setAttribute("type","number"),void 0!==o.max&&l.setAttribute("max",o.max),void 0!==o.min&&l.setAttribute("min",o.min),void 0!==o.step&&l.setAttribute("step",o.step),l.style.padding="4px",l.style.width="100%",l.style.boxSizing="border-box",o.elementAttributes&&"object"==s(o.elementAttributes))for(var u in o.elementAttributes)"+"==u.charAt(0)?(u=u.slice(1),l.setAttribute(u,l.getAttribute(u)+o.elementAttributes["+"+u])):l.setAttribute(u,o.elementAttributes[u]);l.value=r;var c=function(t){h()};function h(){var t=l.value;isNaN(t)||""===t||(t=Number(t)),t!==r?i(t)&&(r=t):n()}return e((function(){l.removeEventListener("blur",c),l.focus(),l.style.height="100%",l.addEventListener("blur",c)})),l.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:h();break;case 27:n();break;case 38:case 40:"editor"==a&&(t.stopImmediatePropagation(),t.stopPropagation())}})),o.mask&&this.table.modules.edit.maskInput(l,o),l},range:function(t,e,i,n,o){var r=t.getValue(),a=document.createElement("input");if(a.setAttribute("type","range"),void 0!==o.max&&a.setAttribute("max",o.max),void 0!==o.min&&a.setAttribute("min",o.min),void 0!==o.step&&a.setAttribute("step",o.step),a.style.padding="4px",a.style.width="100%",a.style.boxSizing="border-box",o.elementAttributes&&"object"==s(o.elementAttributes))for(var l in o.elementAttributes)"+"==l.charAt(0)?(l=l.slice(1),a.setAttribute(l,a.getAttribute(l)+o.elementAttributes["+"+l])):a.setAttribute(l,o.elementAttributes[l]);function u(){var t=a.value;isNaN(t)||""===t||(t=Number(t)),t!=r?i(t)&&(r=t):n()}return a.value=r,e((function(){a.focus(),a.style.height="100%"})),a.addEventListener("blur",(function(t){u()})),a.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:case 9:u();break;case 27:n()}})),a},select:function(t,e,i,n,o){var r=this,a=t.getElement(),l=t.getValue(),u=o.verticalNavigation||"editor",c=void 0!==l||null===l?l:void 0!==o.defaultValue?o.defaultValue:"",d=document.createElement("input"),p=document.createElement("div"),f=[],g=[],m={},v=!0;function y(e){var i,n={},a=r.table.getData();return(i=e?r.table.columnManager.getColumnByField(e):t.getColumn()._getSelf())?(a.forEach((function(t){var e=i.getFieldValue(t);null!=e&&""!==e&&(n[e]=!0)})),n=o.sortValuesList?"asc"==o.sortValuesList?Object.keys(n).sort():Object.keys(n).sort().reverse():Object.keys(n)):console.warn("unable to find matching column to create select lookup list:",e),n}function b(e,i){var n=[],r=[];function a(t){return(t={label:o.listItemFormatter?o.listItemFormatter(t.value,t.label):t.label,value:t.value,element:!1}).value!==i&&(isNaN(parseFloat(t.value))||isNaN(parseFloat(t.value))||parseFloat(t.value)!==parseFloat(i))||w(t),n.push(t),r.push(t),t}if("function"==typeof e&&(e=e(t)),Array.isArray(e))e.forEach((function(t){var e;"object"===(void 0===t?"undefined":s(t))?t.options?(e={label:t.label,group:!0,element:!1},r.push(e),t.options.forEach((function(t){a(t)}))):a(t):((e={label:o.listItemFormatter?o.listItemFormatter(t,t):t,value:t,element:!1}).value!==i&&(isNaN(parseFloat(e.value))||isNaN(parseFloat(e.value))||parseFloat(e.value)!==parseFloat(i))||w(e),n.push(e),r.push(e))}));else for(var l in e){var u={label:o.listItemFormatter?o.listItemFormatter(l,e[l]):e[l],value:l,element:!1};u.value!==i&&(isNaN(parseFloat(u.value))||isNaN(parseFloat(u.value))||parseFloat(u.value)!==parseFloat(i))||w(u),n.push(u),r.push(u)}f=n,g=r,function(){for(;p.firstChild;)p.removeChild(p.firstChild);g.forEach((function(t){var e=t.element;e||(t.group?((e=document.createElement("div")).classList.add("tabulator-edit-select-list-group"),e.tabIndex=0,e.innerHTML=""===t.label?"&nbsp;":t.label):((e=document.createElement("div")).classList.add("tabulator-edit-select-list-item"),e.tabIndex=0,e.innerHTML=""===t.label?"&nbsp;":t.label,e.addEventListener("click",(function(){w(t),_()})),t===m&&e.classList.add("active")),e.addEventListener("mousedown",(function(){v=!1,setTimeout((function(){v=!0}),10)})),t.element=e),p.appendChild(e)}))}()}function w(t){m&&m.element&&m.element.classList.remove("active"),m=t,d.value="&nbsp;"===t.label?"":t.label,t.element&&t.element.classList.add("active")}function _(){C(),l!==m.value?(l=m.value,i(m.value)):n()}function x(){C(),n()}function C(){p.parentNode&&p.parentNode.removeChild(p),r.table.rowManager.element.removeEventListener("scroll",x)}if(this.table.rowManager.element.addEventListener("scroll",x),(Array.isArray(o)||!Array.isArray(o)&&"object"===(void 0===o?"undefined":s(o))&&!o.values)&&(console.warn("DEPRECATION WANRING - values for the select editor must now be passed into the values property of the editorParams object, not as the editorParams object"),o={values:o}),d.setAttribute("type","text"),d.style.padding="4px",d.style.width="100%",d.style.boxSizing="border-box",d.style.cursor="default",d.readOnly=0!=this.currentCell,o.elementAttributes&&"object"==s(o.elementAttributes))for(var E in o.elementAttributes)"+"==E.charAt(0)?(E=E.slice(1),d.setAttribute(E,d.getAttribute(E)+o.elementAttributes["+"+E])):d.setAttribute(E,o.elementAttributes[E]);return d.value=void 0!==l||null===l?l:"",d.addEventListener("keydown",(function(t){var e;switch(t.keyCode){case 38:e=f.indexOf(m),("editor"==u||"hybrid"==u&&e)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e>0&&w(f[e-1]));break;case 40:e=f.indexOf(m),("editor"==u||"hybrid"==u&&e<f.length-1)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e<f.length-1&&w(-1==e?f[0]:f[e+1]));break;case 37:case 39:t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault();break;case 13:_();break;case 27:x()}})),d.addEventListener("blur",(function(t){v&&x()})),d.addEventListener("focus",(function(t){!function(){if(!p.parentNode){!0===o.values?b(y(),c):"string"==typeof o.values?b(y(o.values),c):b(o.values||[],c);var t=h.prototype.helpers.elOffset(a);p.style.minWidth=a.offsetWidth+"px",p.style.top=t.top+a.offsetHeight+"px",p.style.left=t.left+"px",document.body.appendChild(p)}}()})),(p=document.createElement("div")).classList.add("tabulator-edit-select-list"),e((function(){d.style.height="100%",d.focus()})),d},autocomplete:function(t,e,i,n,o){var r=this,a=t.getElement(),l=t.getValue(),u=o.verticalNavigation||"editor",c=void 0!==l||null===l?l:void 0!==o.defaultValue?o.defaultValue:"",d=document.createElement("input"),p=document.createElement("div"),f=[],g=!1,m=!0;if(this.table.rowManager.element.addEventListener("scroll",M),d.setAttribute("type","search"),d.style.padding="4px",d.style.width="100%",d.style.boxSizing="border-box",o.elementAttributes&&"object"==s(o.elementAttributes))for(var v in o.elementAttributes)"+"==v.charAt(0)?(v=v.slice(1),d.setAttribute(v,d.getAttribute(v)+o.elementAttributes["+"+v])):d.setAttribute(v,o.elementAttributes[v]);function y(e){var i,n={},a=r.table.getData();return(i=e?r.table.columnManager.getColumnByField(e):t.getColumn()._getSelf())?(a.forEach((function(t){var e=i.getFieldValue(t);null!=e&&""!==e&&(n[e]=!0)})),n=o.sortValuesList?"asc"==o.sortValuesList?Object.keys(n).sort():Object.keys(n).sort().reverse():Object.keys(n)):console.warn("unable to find matching column to create autocomplete lookup list:",e),n}function b(t,e){var i,n,r=[];i=!0===o.values?y():"string"==typeof o.values?y(o.values):o.values||[],o.searchFunc?(r=o.searchFunc(t,i))instanceof Promise?(w(void 0!==o.searchingPlaceholder?o.searchingPlaceholder:"Searching..."),r.then((function(t){C(_(t),e)})).catch((function(t){console.err("error in autocomplete search promise:",t)}))):C(_(r),e):(n=_(i),""===t?o.showListOnEmpty&&(r=n):n.forEach((function(e){null===e.value&&void 0===e.value||(String(e.value).toLowerCase().indexOf(String(t).toLowerCase())>-1||String(e.title).toLowerCase().indexOf(String(t).toLowerCase())>-1)&&r.push(e)})),C(r,e))}function w(t){var e=document.createElement("div");x(),!1!==t&&(e.classList.add("tabulator-edit-select-list-notice"),e.tabIndex=0,t instanceof Node?e.appendChild(t):e.innerHTML=t,p.appendChild(e))}function _(t){var e=[];if(Array.isArray(t))t.forEach((function(t){var i={title:o.listItemFormatter?o.listItemFormatter(t,t):t,value:t};e.push(i)}));else for(var i in t){var n={title:o.listItemFormatter?o.listItemFormatter(i,t[i]):t[i],value:i};e.push(n)}return e}function x(){for(;p.firstChild;)p.removeChild(p.firstChild)}function C(t,e){t.length?function(t,e){var i=!1;x(),(f=t).forEach((function(t){var n=t.element;n||((n=document.createElement("div")).classList.add("tabulator-edit-select-list-item"),n.tabIndex=0,n.innerHTML=t.title,n.addEventListener("click",(function(){k(t),E()})),n.addEventListener("mousedown",(function(){m=!1,setTimeout((function(){m=!0}),10)})),t.element=n,e&&t.value==l&&(d.value=t.title,t.element.classList.add("active"),i=!0),t===g&&(t.element.classList.add("active"),i=!0)),p.appendChild(n)})),i||k(!1)}(t,e):o.emptyPlaceholder&&w(o.emptyPlaceholder)}function E(){S(),g?l!==g.value?(l=g.value,d.value=g.title,i(g.value)):n():o.freetext||o.allowEmpty&&""===d.value?(l=d.value,i(d.value)):n()}function k(t,e){g&&g.element&&g.element.classList.remove("active"),g=t,t&&t.element&&t.element.classList.add("active")}function S(){p.parentNode&&p.parentNode.removeChild(p),r.table.rowManager.element.removeEventListener("scroll",M)}function M(){S(),n()}return p.classList.add("tabulator-edit-select-list"),d.addEventListener("keydown",(function(t){var e;switch(t.keyCode){case 38:e=f.indexOf(g),("editor"==u||"hybrid"==u&&e)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),k(e>0&&f[e-1]));break;case 40:e=f.indexOf(g),("editor"==u||"hybrid"==u&&e<f.length-1)&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),e<f.length-1&&k(-1==e?f[0]:f[e+1]));break;case 37:case 39:t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault();break;case 13:E();break;case 27:M();break;case 36:case 35:t.stopImmediatePropagation()}})),d.addEventListener("keyup",(function(t){switch(t.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:b(d.value)}})),d.addEventListener("search",(function(t){b(d.value)})),d.addEventListener("blur",(function(t){m&&E()})),d.addEventListener("focus",(function(t){var e=c;!function(){if(!p.parentNode){for(;p.firstChild;)p.removeChild(p.firstChild);var t=h.prototype.helpers.elOffset(a);p.style.minWidth=a.offsetWidth+"px",p.style.top=t.top+a.offsetHeight+"px",p.style.left=t.left+"px",document.body.appendChild(p)}}(),d.value=e,b(e,!0)})),e((function(){d.style.height="100%",d.focus()})),o.mask&&this.table.modules.edit.maskInput(d,o),d},star:function(t,e,i,n,o){var r=this,a=t.getElement(),l=t.getValue(),u=a.getElementsByTagName("svg").length||5,c=a.getElementsByTagName("svg")[0]?a.getElementsByTagName("svg")[0].getAttribute("width"):14,h=[],d=document.createElement("div"),p=document.createElementNS("http://www.w3.org/2000/svg","svg");function f(t){h.forEach((function(e,i){i<t?("ie"==r.table.browser?e.setAttribute("class","tabulator-star-active"):e.classList.replace("tabulator-star-inactive","tabulator-star-active"),e.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==r.table.browser?e.setAttribute("class","tabulator-star-inactive"):e.classList.replace("tabulator-star-active","tabulator-star-inactive"),e.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')}))}function g(t){var e=document.createElement("span"),n=p.cloneNode(!0);h.push(n),e.addEventListener("mouseenter",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),f(t)})),e.addEventListener("mousemove",(function(t){t.stopPropagation(),t.stopImmediatePropagation()})),e.addEventListener("click",(function(e){e.stopPropagation(),e.stopImmediatePropagation(),i(t)})),e.appendChild(n),d.appendChild(e)}function m(t){l=t,f(t)}if(a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",d.style.verticalAlign="middle",d.style.display="inline-block",d.style.padding="4px",p.setAttribute("width",c),p.setAttribute("height",c),p.setAttribute("viewBox","0 0 512 512"),p.setAttribute("xml:space","preserve"),p.style.padding="0 1px",o.elementAttributes&&"object"==s(o.elementAttributes))for(var v in o.elementAttributes)"+"==v.charAt(0)?(v=v.slice(1),d.setAttribute(v,d.getAttribute(v)+o.elementAttributes["+"+v])):d.setAttribute(v,o.elementAttributes[v]);for(var y=1;y<=u;y++)g(y);return f(l=Math.min(parseInt(l),u)),d.addEventListener("mousemove",(function(t){f(0)})),d.addEventListener("click",(function(t){i(0)})),a.addEventListener("blur",(function(t){n()})),a.addEventListener("keydown",(function(t){switch(t.keyCode){case 39:m(l+1);break;case 37:m(l-1);break;case 13:i(l);break;case 27:n()}})),d},progress:function(t,e,i,n,o){var r,a,l=t.getElement(),u=void 0===o.max?l.getElementsByTagName("div")[0].getAttribute("max")||100:o.max,c=void 0===o.min?l.getElementsByTagName("div")[0].getAttribute("min")||0:o.min,h=(u-c)/100,d=t.getValue()||0,p=document.createElement("div"),f=document.createElement("div");function g(){var t=h*Math.round(f.offsetWidth/(l.clientWidth/100))+c;i(t),l.setAttribute("aria-valuenow",t),l.setAttribute("aria-label",d)}if(p.style.position="absolute",p.style.right="0",p.style.top="0",p.style.bottom="0",p.style.width="5px",p.classList.add("tabulator-progress-handle"),f.style.display="inline-block",f.style.position="relative",f.style.height="100%",f.style.backgroundColor="#488CE9",f.style.maxWidth="100%",f.style.minWidth="0%",o.elementAttributes&&"object"==s(o.elementAttributes))for(var m in o.elementAttributes)"+"==m.charAt(0)?(m=m.slice(1),f.setAttribute(m,f.getAttribute(m)+o.elementAttributes["+"+m])):f.setAttribute(m,o.elementAttributes[m]);return l.style.padding="4px 4px",d=Math.min(parseFloat(d),u),d=Math.max(parseFloat(d),c),d=Math.round((d-c)/h),f.style.width=d+"%",l.setAttribute("aria-valuemin",c),l.setAttribute("aria-valuemax",u),f.appendChild(p),p.addEventListener("mousedown",(function(t){r=t.screenX,a=f.offsetWidth})),p.addEventListener("mouseover",(function(){p.style.cursor="ew-resize"})),l.addEventListener("mousemove",(function(t){r&&(f.style.width=a+t.screenX-r+"px")})),l.addEventListener("mouseup",(function(t){r&&(t.stopPropagation(),t.stopImmediatePropagation(),r=!1,a=!1,g())})),l.addEventListener("keydown",(function(t){switch(t.keyCode){case 39:f.style.width=f.clientWidth+l.clientWidth/100+"px";break;case 37:f.style.width=f.clientWidth-l.clientWidth/100+"px";break;case 13:g();break;case 27:n()}})),l.addEventListener("blur",(function(){n()})),f},tickCross:function(t,e,i,n,o){var r=t.getValue(),a=document.createElement("input"),l=o.tristate,u=void 0===o.indeterminateValue?null:o.indeterminateValue,c=!1;if(a.setAttribute("type","checkbox"),a.style.marginTop="5px",a.style.boxSizing="border-box",o.elementAttributes&&"object"==s(o.elementAttributes))for(var h in o.elementAttributes)"+"==h.charAt(0)?(h=h.slice(1),a.setAttribute(h,a.getAttribute(h)+o.elementAttributes["+"+h])):a.setAttribute(h,o.elementAttributes[h]);function d(t){return l?t?c?u:a.checked:a.checked&&!c?(a.checked=!1,a.indeterminate=!0,c=!0,u):(c=!1,a.checked):a.checked}return a.value=r,!l||void 0!==r&&r!==u&&""!==r||(c=!0,a.indeterminate=!0),"firefox"!=this.table.browser&&e((function(){a.focus()})),a.checked=!0===r||"true"===r||"True"===r||1===r,a.addEventListener("change",(function(t){i(d())})),a.addEventListener("blur",(function(t){i(d(!0))})),a.addEventListener("keydown",(function(t){13==t.keyCode&&i(d()),27==t.keyCode&&n()})),a}},h.prototype.registerModule("edit",_);var x=function(t){this.table=t,this.config={},this.cloneTableStyle=!0,this.colVisProp=""};x.prototype.genereateTable=function(t,e,i,n){this.cloneTableStyle=e,this.config=t||{},this.colVisProp=n;var o=document.createElement("table");return o.classList.add("tabulator-print-table"),!1!==this.config.columnHeaders&&o.appendChild(this.generateHeaderElements()),o.appendChild(this.generateBodyElements(this.rowLookup(i))),this.mapElementStyles(this.table.element,o,["border-top","border-left","border-right","border-bottom"]),o},x.prototype.rowLookup=function(t){var e=this,i=[];if("function"==typeof t)t.call(this.table).forEach((function(t){(t=e.table.rowManager.findRow(t))&&i.push(t)}));else switch(t){case!0:case"visible":i=this.table.rowManager.getVisibleRows(!0);break;case"all":i=this.table.rowManager.rows;break;case"selected":i=this.modules.selectRow.selectedRows;break;case"active":default:i=this.table.rowManager.getDisplayRows()}return Object.assign([],i)},x.prototype.generateColumnGroupHeaders=function(){var t=this,e=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach((function(i){var n=t.processColumnGroup(i);n&&e.push(n)})),e},x.prototype.processColumnGroup=function(t){var e=this,i=t.columns,n=0,o={title:t.definition.title,column:t,depth:1};if(i.length){if(o.subGroups=[],o.width=0,i.forEach((function(t){var i=e.processColumnGroup(t);i&&(o.width+=i.width,o.subGroups.push(i),i.depth>n&&(n=i.depth))})),o.depth+=n,!o.width)return!1}else{if(!this.columnVisCheck(t))return!1;o.width=1}return o},x.prototype.groupHeadersToRows=function(t){var e=[],i=0;return t.forEach((function(t){t.depth>i&&(i=t.depth)})),t.forEach((function(t){!function t(n,o){var r=i-o;void 0===e[o]&&(e[o]=[]),n.height=n.subGroups?1:r-n.depth+1,e[o].push(n),n.subGroups&&n.subGroups.forEach((function(e){t(e,o+1)}))}(t,0)})),e},x.prototype.generateHeaderElements=function(){var t=this,e=document.createElement("thead");return this.groupHeadersToRows(this.generateColumnGroupHeaders()).forEach((function(i){var n=document.createElement("tr");t.mapElementStyles(t.table.columnManager.getHeadersElement(),e,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),i.forEach((function(e){var i=document.createElement("th"),o=e.column.definition.cssClass?e.column.definition.cssClass.split(" "):[];i.colSpan=e.width,i.rowSpan=e.height,i.innerHTML=e.column.definition.title,t.cloneTableStyle&&(i.style.boxSizing="border-box"),o.forEach((function(t){i.classList.add(t)})),t.mapElementStyles(e.column.getElement(),i,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),t.mapElementStyles(e.column.contentElement,i,["padding-top","padding-left","padding-right","padding-bottom"]),e.column.visible?t.mapElementStyles(e.column.getElement(),i,["width"]):e.column.definition.width&&(i.style.width=e.column.definition.width+"px"),e.column.parent&&t.mapElementStyles(e.column.parent.groupElement,i,["border-top"]),n.appendChild(i)})),e.appendChild(n)})),e},x.prototype.generateBodyElements=function(t){},x.prototype.generateBodyElements=function(t){var e,i,n,o,r,a,l,u,c,h,d=this;h=null!==(h=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))])?h:this.table.options.rowFormatter,this.cloneTableStyle&&window.getComputedStyle&&(e=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),i=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),n=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),o=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),a=this.table.element.getElementsByClassName("tabulator-group")[0],o&&(l=o.getElementsByClassName("tabulator-cell"),r=l[0],l[l.length-1]));var p=document.createElement("tbody"),f=[];return!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&t.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&t.push(this.table.modules.columnCalcs.botRow)),this.table.columnManager.columnsByIndex.forEach((function(t){d.columnVisCheck(t)&&f.push(t)})),this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(c=this.table.modules.dataTree.elementField),(t=t.filter((function(t){switch(t.type){case"group":return!1!==d.config.rowGroups;case"calc":return!1!==d.config.columnCalcs}return!0}))).length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),t.forEach((function(t,o){var l=t.getData(d.colVisProp),g=document.createElement("tr");switch(g.classList.add("tabulator-print-table-row"),t.type){case"group":var m=document.createElement("td");m.colSpan=f.length,m.innerHTML=t.key,g.classList.add("tabulator-print-table-group"),d.mapElementStyles(a,g,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),d.mapElementStyles(a,m,["padding-top","padding-left","padding-right","padding-bottom"]),g.appendChild(m);break;case"calc":g.classList.add("tabulator-print-table-calcs");case"row":if(d.table.options.dataTree&&!1===d.config.dataTree&&t.modules.dataTree.parent)return;if(f.forEach((function(e,i){var n=document.createElement("td"),o=e.getFieldValue(l),a={modules:{},getValue:function(){return o},getField:function(){return e.definition.field},getElement:function(){return n},getColumn:function(){return e.getComponent()},getData:function(){return l},getRow:function(){return t.getComponent()},getComponent:function(){return a},column:e};if((e.definition.cssClass?e.definition.cssClass.split(" "):[]).forEach((function(t){n.classList.add(t)})),d.table.modExists("format")&&!1!==d.config.formatCells)o=d.table.modules.format.formatExportValue(a,d.colVisProp);else switch(void 0===o?"undefined":s(o)){case"object":o=JSON.stringify(o);break;case"undefined":case"null":o="";break;default:o=o}o instanceof Node?n.appendChild(o):n.innerHTML=o,r&&(d.mapElementStyles(r,n,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size"]),e.definition.align&&(n.style.textAlign=e.definition.align)),d.table.options.dataTree&&!1!==d.config.dataTree&&(c&&c==e.field||!c&&0==i)&&(t.modules.dataTree.controlEl&&n.insertBefore(t.modules.dataTree.controlEl.cloneNode(!0),n.firstChild),t.modules.dataTree.branchEl&&n.insertBefore(t.modules.dataTree.branchEl.cloneNode(!0),n.firstChild)),g.appendChild(n),a.modules.format&&a.modules.format.renderedCallback&&a.modules.format.renderedCallback()})),u="calc"==t.type?n:o%2&&i?i:e,d.mapElementStyles(u,g,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),h&&!1!==d.config.formatCells){var v=t.getComponent();v.getElement=function(){return g},h(v)}}p.appendChild(g)})),p},x.prototype.columnVisCheck=function(t){return!1!==t.definition[this.colVisProp]&&(t.visible||!t.visible&&t.definition[this.colVisProp])},x.prototype.getHtml=function(t,e,i,n){var o=document.createElement("div");return o.appendChild(this.genereateTable(i||this.table.options.htmlOutputConfig,e,t,n||"htmlOutput")),o.innerHTML},x.prototype.mapElementStyles=function(t,e,i){if(this.cloneTableStyle&&t&&e){var n={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var o=window.getComputedStyle(t);i.forEach((function(t){e.style[n[t]]=o.getPropertyValue(t)}))}}},h.prototype.registerModule("export",x);var C=function(t){this.table=t,this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1};C.prototype.initializeColumn=function(t,e){var i=this,n=t.getField();t.modules.filter={success:function(e){var o,r="input"==t.modules.filter.tagType&&"text"==t.modules.filter.attrType||"textarea"==t.modules.filter.tagType?"partial":"match",a="",l="";if(void 0===t.modules.filter.prevSuccess||t.modules.filter.prevSuccess!==e){if(t.modules.filter.prevSuccess=e,t.modules.filter.emptyFunc(e))delete i.headerFilters[n];else{switch(t.modules.filter.value=e,s(t.definition.headerFilterFunc)){case"string":i.filters[t.definition.headerFilterFunc]?(a=t.definition.headerFilterFunc,o=function(n){var o=t.definition.headerFilterFuncParams||{},r=t.getFieldValue(n);return o="function"==typeof o?o(e,r,n):o,i.filters[t.definition.headerFilterFunc](e,r,n,o)}):console.warn("Header Filter Error - Matching filter function not found: ",t.definition.headerFilterFunc);break;case"function":a=o=function(i){var n=t.definition.headerFilterFuncParams||{},o=t.getFieldValue(i);return n="function"==typeof n?n(e,o,i):n,t.definition.headerFilterFunc(e,o,i,n)}}if(!o)switch(r){case"partial":o=function(i){var n=t.getFieldValue(i);return null!=n&&String(n).toLowerCase().indexOf(String(e).toLowerCase())>-1},a="like";break;default:o=function(i){return t.getFieldValue(i)==e},a="="}i.headerFilters[n]={value:e,func:o,type:a}}l=JSON.stringify(i.headerFilters),i.prevHeaderFilterChangeCheck!==l&&(i.prevHeaderFilterChangeCheck=l,i.changed=!0,i.table.rowManager.filterRefresh())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(t)},C.prototype.generateHeaderFilterElement=function(t,e,i){var n,o,r,a,l,u,c,h=this,d=this,p=t.modules.filter.success,f=t.getField();if(t.modules.filter.headerElement&&t.modules.filter.headerElement.parentNode&&t.contentElement.removeChild(t.modules.filter.headerElement.parentNode),f){switch(t.modules.filter.emptyFunc=t.definition.headerFilterEmptyCheck||function(t){return!t&&"0"!==t},(n=document.createElement("div")).classList.add("tabulator-header-filter"),s(t.definition.headerFilter)){case"string":d.table.modules.edit.editors[t.definition.headerFilter]?(o=d.table.modules.edit.editors[t.definition.headerFilter],"tick"!==t.definition.headerFilter&&"tickCross"!==t.definition.headerFilter||t.definition.headerFilterEmptyCheck||(t.modules.filter.emptyFunc=function(t){return!0!==t&&!1!==t})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",t.definition.editor);break;case"function":o=t.definition.headerFilter;break;case"boolean":t.modules.edit&&t.modules.edit.editor?o=t.modules.edit.editor:t.definition.formatter&&d.table.modules.edit.editors[t.definition.formatter]?(o=d.table.modules.edit.editors[t.definition.formatter],"tick"!==t.definition.formatter&&"tickCross"!==t.definition.formatter||t.definition.headerFilterEmptyCheck||(t.modules.filter.emptyFunc=function(t){return!0!==t&&!1!==t})):o=d.table.modules.edit.editors.input}if(o){if(a={getValue:function(){return void 0!==e?e:""},getField:function(){return t.definition.field},getElement:function(){return n},getColumn:function(){return t.getComponent()},getRow:function(){return{normalizeHeight:function(){}}}},c="function"==typeof(c=t.definition.headerFilterParams||{})?c.call(d.table):c,!(r=o.call(this.table.modules.edit,a,(function(){}),p,(function(){}),c)))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor returned a value of false");if(!(r instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+f+" column, editor should return an instance of Node, the editor returned:",r);f?d.table.modules.localize.bind("headerFilters|columns|"+t.definition.field,(function(t){r.setAttribute("placeholder",void 0!==t&&t?t:d.table.modules.localize.getText("headerFilters|default"))})):d.table.modules.localize.bind("headerFilters|default",(function(t){r.setAttribute("placeholder",void 0!==d.column.definition.headerFilterPlaceholder&&d.column.definition.headerFilterPlaceholder?d.column.definition.headerFilterPlaceholder:t)})),r.addEventListener("click",(function(t){t.stopPropagation(),r.focus()})),r.addEventListener("focus",(function(t){var e=h.table.columnManager.element.scrollLeft;e!==h.table.rowManager.element.scrollLeft&&(h.table.rowManager.scrollHorizontal(e),h.table.columnManager.scrollHorizontal(e))})),l=!1,u=function(t){l&&clearTimeout(l),l=setTimeout((function(){p(r.value)}),d.table.options.headerFilterLiveFilterDelay)},t.modules.filter.headerElement=r,t.modules.filter.attrType=r.hasAttribute("type")?r.getAttribute("type").toLowerCase():"",t.modules.filter.tagType=r.tagName.toLowerCase(),!1!==t.definition.headerFilterLiveFilter&&("autocomplete"!==t.definition.headerFilter&&"tickCross"!==t.definition.headerFilter&&("autocomplete"!==t.definition.editor&&"tickCross"!==t.definition.editor||!0!==t.definition.headerFilter)&&(r.addEventListener("keyup",u),r.addEventListener("search",u),"number"==t.modules.filter.attrType&&r.addEventListener("change",(function(t){p(r.value)})),"text"==t.modules.filter.attrType&&"ie"!==this.table.browser&&r.setAttribute("type","search")),"input"!=t.modules.filter.tagType&&"select"!=t.modules.filter.tagType&&"textarea"!=t.modules.filter.tagType||r.addEventListener("mousedown",(function(t){t.stopPropagation()}))),n.appendChild(r),t.contentElement.appendChild(n),i||d.headerFilterColumns.push(t)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",t.definition.title)},C.prototype.hideHeaderFilterElements=function(){this.headerFilterColumns.forEach((function(t){t.modules.filter&&t.modules.filter.headerElement&&(t.modules.filter.headerElement.style.display="none")}))},C.prototype.showHeaderFilterElements=function(){this.headerFilterColumns.forEach((function(t){t.modules.filter&&t.modules.filter.headerElement&&(t.modules.filter.headerElement.style.display="")}))},C.prototype.setHeaderFilterFocus=function(t){t.modules.filter&&t.modules.filter.headerElement?t.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",t.getField())},C.prototype.getHeaderFilterValue=function(t){if(t.modules.filter&&t.modules.filter.headerElement)return t.modules.filter.headerElement.value;console.warn("Column Filter Error - No header filter set on column:",t.getField())},C.prototype.setHeaderFilterValue=function(t,e){t&&(t.modules.filter&&t.modules.filter.headerElement?(this.generateHeaderFilterElement(t,e,!0),t.modules.filter.success(e)):console.warn("Column Filter Error - No header filter set on column:",t.getField()))},C.prototype.reloadHeaderFilter=function(t){t&&(t.modules.filter&&t.modules.filter.headerElement?this.generateHeaderFilterElement(t,t.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",t.getField()))},C.prototype.hasChanged=function(){var t=this.changed;return this.changed=!1,t},C.prototype.setFilter=function(t,e,i){this.filterList=[],Array.isArray(t)||(t=[{field:t,type:e,value:i}]),this.addFilter(t)},C.prototype.addFilter=function(t,e,i){var n=this;Array.isArray(t)||(t=[{field:t,type:e,value:i}]),t.forEach((function(t){(t=n.findFilter(t))&&(n.filterList.push(t),n.changed=!0)})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},C.prototype.findFilter=function(t){var e,i=this;if(Array.isArray(t))return this.findSubFilters(t);var n=!1;return"function"==typeof t.field?n=function(e){return t.field(e,t.type||{})}:i.filters[t.type]?n=(e=i.table.columnManager.getColumnByField(t.field))?function(n){return i.filters[t.type](t.value,e.getFieldValue(n))}:function(e){return i.filters[t.type](t.value,e[t.field])}:console.warn("Filter Error - No such filter type found, ignoring: ",t.type),t.func=n,!!t.func&&t},C.prototype.findSubFilters=function(t){var e=this,i=[];return t.forEach((function(t){(t=e.findFilter(t))&&i.push(t)})),!!i.length&&i},C.prototype.getFilters=function(t,e){var i=[];return t&&(i=this.getHeaderFilters()),e&&i.forEach((function(t){"function"==typeof t.type&&(t.type="function")})),i=i.concat(this.filtersToArray(this.filterList,e))},C.prototype.filtersToArray=function(t,e){var i=this,n=[];return t.forEach((function(t){var o;Array.isArray(t)?n.push(i.filtersToArray(t,e)):(o={field:t.field,type:t.type,value:t.value},e&&"function"==typeof o.type&&(o.type="function"),n.push(o))})),n},C.prototype.getHeaderFilters=function(){var t=[];for(var e in this.headerFilters)t.push({field:e,type:this.headerFilters[e].type,value:this.headerFilters[e].value});return t},C.prototype.removeFilter=function(t,e,i){var n=this;Array.isArray(t)||(t=[{field:t,type:e,value:i}]),t.forEach((function(t){var e=-1;(e="object"==s(t.field)?n.filterList.findIndex((function(e){return t===e})):n.filterList.findIndex((function(e){return t.field===e.field&&t.type===e.type&&t.value===e.value})))>-1?(n.filterList.splice(e,1),n.changed=!0):console.warn("Filter Error - No matching filter type found, ignoring: ",t.type)})),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},C.prototype.clearFilter=function(t){this.filterList=[],t&&this.clearHeaderFilter(),this.changed=!0,this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.filter&&this.table.modules.persistence.save("filter")},C.prototype.clearHeaderFilter=function(){var t=this;this.headerFilters={},t.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach((function(e){e.modules.filter.value=null,e.modules.filter.prevSuccess=void 0,t.reloadHeaderFilter(e)})),this.changed=!0},C.prototype.search=function(t,e,i,n){var o=this,r=[],a=[];return Array.isArray(e)||(e=[{field:e,type:i,value:n}]),e.forEach((function(t){(t=o.findFilter(t))&&a.push(t)})),this.table.rowManager.rows.forEach((function(e){var i=!0;a.forEach((function(t){o.filterRecurse(t,e.getData())||(i=!1)})),i&&r.push("data"===t?e.getData("data"):e.getComponent())})),r},C.prototype.filter=function(t,e){var i=this,n=[],o=[];return i.table.options.dataFiltering&&i.table.options.dataFiltering.call(i.table,i.getFilters()),i.table.options.ajaxFiltering||!i.filterList.length&&!Object.keys(i.headerFilters).length?n=t.slice(0):t.forEach((function(t){i.filterRow(t)&&n.push(t)})),i.table.options.dataFiltered&&(n.forEach((function(t){o.push(t.getComponent())})),i.table.options.dataFiltered.call(i.table,i.getFilters(),o)),n},C.prototype.filterRow=function(t,e){var i=this,n=!0,o=t.getData();for(var r in i.filterList.forEach((function(t){i.filterRecurse(t,o)||(n=!1)})),i.headerFilters)i.headerFilters[r].func(o)||(n=!1);return n},C.prototype.filterRecurse=function(t,e){var i=this,n=!1;return Array.isArray(t)?t.forEach((function(t){i.filterRecurse(t,e)&&(n=!0)})):n=t.func(e),n},C.prototype.filters={"=":function(t,e,i,n){return e==t},"<":function(t,e,i,n){return e<t},"<=":function(t,e,i,n){return e<=t},">":function(t,e,i,n){return e>t},">=":function(t,e,i,n){return e>=t},"!=":function(t,e,i,n){return e!=t},regex:function(t,e,i,n){return"string"==typeof t&&(t=new RegExp(t)),t.test(e)},like:function(t,e,i,n){return null==t?e===t:null!=e&&String(e).toLowerCase().indexOf(t.toLowerCase())>-1},in:function(t,e,i,n){return Array.isArray(t)?t.indexOf(e)>-1:(console.warn("Filter Error - filter value is not an array:",t),!1)}},h.prototype.registerModule("filter",C);var E=function(t){this.table=t};E.prototype.initializeColumn=function(t){t.modules.format=this.lookupFormatter(t,""),void 0!==t.definition.formatterPrint&&(t.modules.format.print=this.lookupFormatter(t,"Print")),void 0!==t.definition.formatterClipboard&&(t.modules.format.clipboard=this.lookupFormatter(t,"Clipboard")),void 0!==t.definition.formatterHtmlOutput&&(t.modules.format.htmlOutput=this.lookupFormatter(t,"HtmlOutput"))},E.prototype.lookupFormatter=function(t,e){var i={params:t.definition["formatter"+e+"Params"]||{}},n=t.definition["formatter"+e];switch(void 0===n?"undefined":s(n)){case"string":"tick"===n&&(n="tickCross",void 0===i.params.crossElement&&(i.params.crossElement=!1),console.warn("DEPRECATION WARNING - the tick formatter has been deprecated, please use the tickCross formatter with the crossElement param set to false")),this.formatters[n]?i.formatter=this.formatters[n]:(console.warn("Formatter Error - No such formatter found: ",n),i.formatter=this.formatters.plaintext);break;case"function":i.formatter=n;break;default:i.formatter=this.formatters.plaintext}return i},E.prototype.cellRendered=function(t){t.modules.format&&t.modules.format.renderedCallback&&t.modules.format.renderedCallback()},E.prototype.formatValue=function(t){var e=t.getComponent(),i="function"==typeof t.column.modules.format.params?t.column.modules.format.params(e):t.column.modules.format.params;return t.column.modules.format.formatter.call(this,e,i,(function(e){t.modules.format||(t.modules.format={}),t.modules.format.renderedCallback=e}))},E.prototype.formatExportValue=function(t,e){var i,n=t.column.modules.format[e];return n?(i="function"==typeof n.params?n.params(component):n.params,n.formatter.call(this,t.getComponent(),i,(function(e){t.modules.format||(t.modules.format={}),t.modules.format.renderedCallback=e}))):this.formatValue(t)},E.prototype.sanitizeHTML=function(t){if(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(t).replace(/[&<>"'`=\/]/g,(function(t){return e[t]}))}return t},E.prototype.emptyToSpace=function(t){return null==t?"&nbsp;":t},E.prototype.getFormatter=function(t){switch(void 0===t?"undefined":s(t)){case"string":this.formatters[t]?t=this.formatters[t]:(console.warn("Formatter Error - No such formatter found: ",t),t=this.formatters.plaintext);break;case"function":t=t;break;default:t=this.formatters.plaintext}return t},E.prototype.formatters={plaintext:function(t,e,i){return this.emptyToSpace(this.sanitizeHTML(t.getValue()))},html:function(t,e,i){return t.getValue()},textarea:function(t,e,i){return t.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(t.getValue()))},money:function(t,e,i){var n,o,r,a,s=parseFloat(t.getValue()),l=e.decimal||".",u=e.thousand||",",c=e.symbol||"",h=!!e.symbolAfter,d=void 0!==e.precision?e.precision:2;if(isNaN(s))return this.emptyToSpace(this.sanitizeHTML(t.getValue()));for(n=!1!==d?s.toFixed(d):s,o=(n=String(n).split("."))[0],r=n.length>1?l+n[1]:"",a=/(\d+)(\d{3})/;a.test(o);)o=o.replace(a,"$1"+u+"$2");return h?o+r+c:c+o+r},link:function(t,e,i){var n=t.getValue(),o=e.urlPrefix||"",r=e.download,a=n,l=document.createElement("a");if(e.labelField&&(a=t.getData()[e.labelField]),e.label)switch(s(e.label)){case"string":a=e.label;break;case"function":a=e.label(t)}if(a){if(e.urlField&&(n=t.getData()[e.urlField]),e.url)switch(s(e.url)){case"string":n=e.url;break;case"function":n=e.url(t)}return l.setAttribute("href",o+n),e.target&&l.setAttribute("target",e.target),e.download&&(r="function"==typeof r?r(t):!0===r?"":r,l.setAttribute("download",r)),l.innerHTML=this.emptyToSpace(this.sanitizeHTML(a)),l}return"&nbsp;"},image:function(t,e,i){var n=document.createElement("img");switch(n.setAttribute("src",t.getValue()),s(e.height)){case"number":n.style.height=e.height+"px";break;case"string":n.style.height=e.height}switch(s(e.width)){case"number":n.style.width=e.width+"px";break;case"string":n.style.width=e.width}return n.addEventListener("load",(function(){t.getRow().normalizeHeight()})),n},tickCross:function(t,e,i){var n=t.getValue(),o=t.getElement(),r=e.allowEmpty,a=e.allowTruthy,s=void 0!==e.tickElement?e.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',l=void 0!==e.crossElement?e.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return a&&n||!0===n||"true"===n||"True"===n||1===n||"1"===n?(o.setAttribute("aria-checked",!0),s||""):!r||"null"!==n&&""!==n&&null!=n?(o.setAttribute("aria-checked",!1),l||""):(o.setAttribute("aria-checked","mixed"),"")},datetime:function(t,e,i){var n=e.inputFormat||"YYYY-MM-DD hh:mm:ss",o=e.outputFormat||"DD/MM/YYYY hh:mm:ss",r=void 0!==e.invalidPlaceholder?e.invalidPlaceholder:"",a=t.getValue(),s=moment(a,n);return s.isValid()?s.format(o):!0===r?a:"function"==typeof r?r(a):r},datetimediff:function(t,e,i){var n=e.inputFormat||"YYYY-MM-DD hh:mm:ss",o=void 0!==e.invalidPlaceholder?e.invalidPlaceholder:"",r=void 0!==e.suffix&&e.suffix,a=void 0!==e.unit?e.unit:void 0,s=void 0!==e.humanize&&e.humanize,l=void 0!==e.date?e.date:moment(),u=t.getValue(),c=moment(u,n);return c.isValid()?s?moment.duration(c.diff(l)).humanize(r):c.diff(l,a)+(r?" "+r:""):!0===o?u:"function"==typeof o?o(u):o},lookup:function(t,e,i){var n=t.getValue();return void 0===e[n]?(console.warn("Missing display value for "+n),n):e[n]},star:function(t,e,i){var n=t.getValue(),o=t.getElement(),r=e&&e.stars?e.stars:5,a=document.createElement("span"),s=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.verticalAlign="middle",s.setAttribute("width","14"),s.setAttribute("height","14"),s.setAttribute("viewBox","0 0 512 512"),s.setAttribute("xml:space","preserve"),s.style.padding="0 1px",n=n&&!isNaN(n)?parseInt(n):0,n=Math.max(0,Math.min(n,r));for(var l=1;l<=r;l++){var u=s.cloneNode(!0);u.innerHTML=l<=n?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',a.appendChild(u)}return o.style.whiteSpace="nowrap",o.style.overflow="hidden",o.style.textOverflow="ellipsis",o.setAttribute("aria-label",n),a},traffic:function(t,e,i){var n,o,r=this.sanitizeHTML(t.getValue())||0,a=document.createElement("span"),l=e&&e.max?e.max:100,u=e&&e.min?e.min:0,c=e&&void 0!==e.color?e.color:["red","orange","green"],h="#666666";if(!isNaN(r)&&void 0!==t.getValue()){switch(a.classList.add("tabulator-traffic-light"),o=parseFloat(r)<=l?parseFloat(r):l,o=parseFloat(o)>=u?parseFloat(o):u,n=(l-u)/100,o=Math.round((o-u)/n),void 0===c?"undefined":s(c)){case"string":h=c;break;case"function":h=c(r);break;case"object":if(Array.isArray(c)){var d=100/c.length,p=Math.floor(o/d);p=Math.min(p,c.length-1),h=c[p=Math.max(p,0)];break}}return a.style.backgroundColor=h,a}},progress:function(t,e,i){var n,o,r,a,u,c=this.sanitizeHTML(t.getValue())||0,h=t.getElement(),d=e&&e.max?e.max:100,p=e&&e.min?e.min:0,f=e&&e.legendAlign?e.legendAlign:"center";switch(o=parseFloat(c)<=d?parseFloat(c):d,o=parseFloat(o)>=p?parseFloat(o):p,n=(d-p)/100,o=Math.round((o-p)/n),s(e.color)){case"string":r=e.color;break;case"function":r=e.color(c);break;case"object":if(Array.isArray(e.color)){var g=100/e.color.length,m=Math.floor(o/g);m=Math.min(m,e.color.length-1),m=Math.max(m,0),r=e.color[m];break}default:r="#2DC214"}switch(s(e.legend)){case"string":a=e.legend;break;case"function":a=e.legend(c);break;case"boolean":a=c;break;default:a=!1}switch(s(e.legendColor)){case"string":u=e.legendColor;break;case"function":u=e.legendColor(c);break;case"object":Array.isArray(e.legendColor)&&(g=100/e.legendColor.length,m=Math.floor(o/g),m=Math.min(m,e.legendColor.length-1),m=Math.max(m,0),u=e.legendColor[m]);break;default:u="#000"}h.style.minWidth="30px",h.style.position="relative",h.setAttribute("aria-label",o);var v=document.createElement("div");if(v.style.display="inline-block",v.style.position="relative",v.style.width=o+"%",v.style.backgroundColor=r,v.style.height="100%",v.setAttribute("data-max",d),v.setAttribute("data-min",p),a){var y=document.createElement("div");y.style.position="absolute",y.style.top="4px",y.style.left=0,y.style.textAlign=f,y.style.width="100%",y.style.color=u,y.innerHTML=a}return i((function(){if(!(t instanceof l)){var e=document.createElement("div");e.style.position="absolute",e.style.top="4px",e.style.bottom="4px",e.style.left="4px",e.style.right="4px",h.appendChild(e),h=e}h.appendChild(v),a&&h.appendChild(y)})),""},color:function(t,e,i){return t.getElement().style.backgroundColor=this.sanitizeHTML(t.getValue()),""},buttonTick:function(t,e,i){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function(t,e,i){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function(t,e,i){return this.table.rowManager.activeRows.indexOf(t.getRow()._getSelf())+1},handle:function(t,e,i){return t.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function(t,e,i){var n=document.createElement("div"),o=t.getRow()._row.modules.responsiveLayout;function r(t){var e=o.element;o.open=t,e&&(o.open?(n.classList.add("open"),e.style.display=""):(n.classList.remove("open"),e.style.display="none"))}return n.classList.add("tabulator-responsive-collapse-toggle"),n.innerHTML="<span class='tabulator-responsive-collapse-toggle-open'>+</span><span class='tabulator-responsive-collapse-toggle-close'>-</span>",t.getElement().classList.add("tabulator-row-handle"),n.addEventListener("click",(function(t){t.stopImmediatePropagation(),r(!o.open)})),r(o.open),n},rowSelection:function(t){var e=this,i=document.createElement("input");if(i.type="checkbox",this.table.modExists("selectRow",!0))if(i.addEventListener("click",(function(t){t.stopPropagation()})),"function"==typeof t.getRow){var n=t.getRow();i.addEventListener("change",(function(t){n.toggleSelect()})),i.checked=n.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(n,i)}else i.addEventListener("change",(function(t){e.table.modules.selectRow.selectedRows.length?e.table.deselectRow():e.table.selectRow()})),this.table.modules.selectRow.registerHeaderSelectCheckbox(i);return i}},h.prototype.registerModule("format",E);var k=function(t){this.table=t,this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightPadding=0,this.initializationMode="left",this.active=!1,this.scrollEndTimer=!1};k.prototype.reset=function(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightMargin=0,this.active=!1,this.table.columnManager.headersElement.style.marginLeft=0,this.table.columnManager.element.style.paddingRight=0},k.prototype.initializeColumn=function(t){var e={margin:0,edge:!1};t.isGroup||(this.frozenCheck(t)?(e.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(t):this.rightColumns.unshift(t),this.active=!0,t.modules.frozen=e):this.initializationMode="right")},k.prototype.frozenCheck=function(t){return t.parent.isGroup&&t.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),t.parent.isGroup?this.frozenCheck(t.parent):t.definition.frozen},k.prototype.scrollHorizontal=function(){var t,e=this;this.active&&(clearTimeout(this.scrollEndTimer),this.scrollEndTimer=setTimeout((function(){e.layout()}),100),t=this.table.rowManager.getVisibleRows(),this.calcMargins(),this.layoutColumnPosition(),this.layoutCalcRows(),t.forEach((function(t){"row"===t.type&&e.layoutRow(t)})),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)},k.prototype.calcMargins=function(){this.leftMargin=this._calcSpace(this.leftColumns,this.leftColumns.length)+"px",this.table.columnManager.headersElement.style.marginLeft=this.leftMargin,this.rightMargin=this._calcSpace(this.rightColumns,this.rightColumns.length)+"px",this.table.columnManager.element.style.paddingRight=this.rightMargin,this.rightPadding=this.table.rowManager.element.clientWidth+this.table.columnManager.scrollLeft},k.prototype.layoutCalcRows=function(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow))},k.prototype.layoutColumnPosition=function(t){var e=this,i=[];this.leftColumns.forEach((function(n,o){if(n.modules.frozen.margin=e._calcSpace(e.leftColumns,o)+e.table.columnManager.scrollLeft+"px",o==e.leftColumns.length-1?n.modules.frozen.edge=!0:n.modules.frozen.edge=!1,n.parent.isGroup){var r=e.getColGroupParentElement(n);i.includes(r)||(e.layoutElement(r,n),i.push(r)),n.modules.frozen.edge&&r.classList.add("tabulator-frozen-"+n.modules.frozen.position)}else e.layoutElement(n.getElement(),n);t&&n.cells.forEach((function(t){e.layoutElement(t.getElement(),n)}))})),this.rightColumns.forEach((function(i,n){i.modules.frozen.margin=e.rightPadding-e._calcSpace(e.rightColumns,n+1)+"px",n==e.rightColumns.length-1?i.modules.frozen.edge=!0:i.modules.frozen.edge=!1,i.parent.isGroup?e.layoutElement(e.getColGroupParentElement(i),i):e.layoutElement(i.getElement(),i),t&&i.cells.forEach((function(t){e.layoutElement(t.getElement(),i)}))}))},k.prototype.getColGroupParentElement=function(t){return t.parent.isGroup?this.getColGroupParentElement(t.parent):t.getElement()},k.prototype.layout=function(){var t=this;t.active&&(this.calcMargins(),t.table.rowManager.getDisplayRows().forEach((function(e){"row"===e.type&&t.layoutRow(e)})),this.layoutCalcRows(),this.layoutColumnPosition(!0),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)},k.prototype.layoutRow=function(t){var e=this;t.getElement().style.paddingLeft=this.leftMargin,this.leftColumns.forEach((function(i){var n=t.getCell(i);n&&e.layoutElement(n.getElement(),i)})),this.rightColumns.forEach((function(i){var n=t.getCell(i);n&&e.layoutElement(n.getElement(),i)}))},k.prototype.layoutElement=function(t,e){e.modules.frozen&&(t.style.position="absolute",t.style.left=e.modules.frozen.margin,t.classList.add("tabulator-frozen"),e.modules.frozen.edge&&t.classList.add("tabulator-frozen-"+e.modules.frozen.position))},k.prototype._calcSpace=function(t,e){for(var i=0,n=0;n<e;n++)t[n].visible&&(i+=t[n].getWidth());return i},h.prototype.registerModule("frozenColumns",k);var S=function(t){this.table=t,this.topElement=document.createElement("div"),this.rows=[],this.displayIndex=0};S.prototype.initialize=function(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling)},S.prototype.setDisplayIndex=function(t){this.displayIndex=t},S.prototype.getDisplayIndex=function(){return this.displayIndex},S.prototype.isFrozen=function(){return!!this.rows.length},S.prototype.getRows=function(t){var e=t.slice(0);return this.rows.forEach((function(t){var i=e.indexOf(t);i>-1&&e.splice(i,1)})),e},S.prototype.freezeRow=function(t){t.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(t.modules.frozen=!0,this.topElement.appendChild(t.getElement()),t.initialize(),t.normalizeHeight(),this.table.rowManager.adjustTableSize(),this.rows.push(t),this.table.rowManager.refreshActiveData("display"),this.styleRows())},S.prototype.unfreezeRow=function(t){var e=this.rows.indexOf(t);if(t.modules.frozen){t.modules.frozen=!1;var i=t.getElement();i.parentNode.removeChild(i),this.table.rowManager.adjustTableSize(),this.rows.splice(e,1),this.table.rowManager.refreshActiveData("display"),this.rows.length&&this.styleRows()}else console.warn("Freeze Error - Row is already unfrozen")},S.prototype.styleRows=function(t){var e=this;this.rows.forEach((function(t,i){e.table.rowManager.styleRow(t,i)}))},h.prototype.registerModule("frozenRows",S);var M=function(t){this._group=t,this.type="GroupComponent"};M.prototype.getKey=function(){return this._group.key},M.prototype.getField=function(){return this._group.field},M.prototype.getElement=function(){return this._group.element},M.prototype.getRows=function(){return this._group.getRows(!0)},M.prototype.getSubGroups=function(){return this._group.getSubGroups(!0)},M.prototype.getParentGroup=function(){return!!this._group.parent&&this._group.parent.getComponent()},M.prototype.getVisibility=function(){return this._group.visible},M.prototype.show=function(){this._group.show()},M.prototype.hide=function(){this._group.hide()},M.prototype.toggle=function(){this._group.toggleVisibility()},M.prototype._getSelf=function(){return this._group},M.prototype.getTable=function(){return this._group.groupManager.table};var T=function(t,e,i,n,o,r,a){this.groupManager=t,this.parent=e,this.key=n,this.level=i,this.field=o,this.hasSubGroups=i<t.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=a,this.rows=[],this.groups=[],this.groupList=[],this.generator=r,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=a?a.visible:void 0!==t.startOpen[i]?t.startOpen[i]:t.startOpen[0],this.createElements(),this.addBindings(),this.createValueGroups()};T.prototype.wipe=function(){this.groupList.length?this.groupList.forEach((function(t){t.wipe()})):(this.element=!1,this.arrowElement=!1,this.elementContents=!1)},T.prototype.createElements=function(){var t=document.createElement("div");t.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(t),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)},T.prototype.createValueGroups=function(){var t=this,e=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]&&this.groupManager.allowedValues[e].forEach((function(i){t._createGroup(i,e)}))},T.prototype.addBindings=function(){var t,e,i,n=this;n.groupManager.table.options.groupClick&&n.element.addEventListener("click",(function(t){n.groupManager.table.options.groupClick.call(n.groupManager.table,t,n.getComponent())})),n.groupManager.table.options.groupDblClick&&n.element.addEventListener("dblclick",(function(t){n.groupManager.table.options.groupDblClick.call(n.groupManager.table,t,n.getComponent())})),n.groupManager.table.options.groupContext&&n.element.addEventListener("contextmenu",(function(t){n.groupManager.table.options.groupContext.call(n.groupManager.table,t,n.getComponent())})),n.groupManager.table.options.groupTap&&(i=!1,n.element.addEventListener("touchstart",(function(t){i=!0}),{passive:!0}),n.element.addEventListener("touchend",(function(t){i&&n.groupManager.table.options.groupTap(t,n.getComponent()),i=!1}))),n.groupManager.table.options.groupDblTap&&(t=null,n.element.addEventListener("touchend",(function(e){t?(clearTimeout(t),t=null,n.groupManager.table.options.groupDblTap(e,n.getComponent())):t=setTimeout((function(){clearTimeout(t),t=null}),300)}))),n.groupManager.table.options.groupTapHold&&(e=null,n.element.addEventListener("touchstart",(function(t){clearTimeout(e),e=setTimeout((function(){clearTimeout(e),e=null,i=!1,n.groupManager.table.options.groupTapHold(t,n.getComponent())}),1e3)}),{passive:!0}),n.element.addEventListener("touchend",(function(t){clearTimeout(e),e=null}))),n.groupManager.table.options.groupToggleElement&&("arrow"==n.groupManager.table.options.groupToggleElement?n.arrowElement:n.element).addEventListener("click",(function(t){t.stopPropagation(),t.stopImmediatePropagation(),n.toggleVisibility()}))},T.prototype._createGroup=function(t,e){var i=e+"_"+t,n=new T(this.groupManager,this,e,t,this.groupManager.groupIDLookups[e].field,this.groupManager.headerGenerator[e]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[i]);this.groups[i]=n,this.groupList.push(n)},T.prototype._addRowToGroup=function(t){var e=this.level+1;if(this.hasSubGroups){var i=this.groupManager.groupIDLookups[e].func(t.getData()),n=e+"_"+i;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]?this.groups[n]&&this.groups[n].addRow(t):(this.groups[n]||this._createGroup(i,e),this.groups[n].addRow(t))}},T.prototype._addRow=function(t){this.rows.push(t),t.modules.group=this},T.prototype.insertRow=function(t,e,i){var n=this.conformRowData({});t.updateData(n);var o=this.rows.indexOf(e);o>-1?i?this.rows.splice(o+1,0,t):this.rows.splice(o,0,t):i?this.rows.push(t):this.rows.unshift(t),t.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)},T.prototype.scrollHeader=function(t){this.arrowElement.style.marginLeft=t,this.groupList.forEach((function(e){e.scrollHeader(t)}))},T.prototype.getRowIndex=function(t){},T.prototype.conformRowData=function(t){return this.field?t[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(t=this.parent.conformRowData(t)),t},T.prototype.removeRow=function(t){var e=this.rows.indexOf(t),i=t.getElement();e>-1&&this.rows.splice(e,1),this.groupManager.table.options.groupValues||this.rows.length?(i.parentNode&&i.parentNode.removeChild(i),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))},T.prototype.removeGroup=function(t){var e,i=t.level+"_"+t.key;this.groups[i]&&(delete this.groups[i],(e=this.groupList.indexOf(t))>-1&&this.groupList.splice(e,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))},T.prototype.getHeadersAndRows=function(t){var e=[];return e.push(this),this._visSet(),this.visible?this.groupList.length?this.groupList.forEach((function(i){e=e.concat(i.getHeadersAndRows(t))})):(!t&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),e=e.concat(this.rows),!t&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))):this.groupList.length||"table"==this.groupManager.table.options.columnCalcs||this.groupManager.table.modExists("columnCalcs")&&(!t&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top))),!t&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom)))),e},T.prototype.getData=function(t,e){var i=[];return this._visSet(),(!t||t&&this.visible)&&this.rows.forEach((function(t){i.push(t.getData(e||"data"))})),i},T.prototype.getRowCount=function(){var t=0;return this.groupList.length?this.groupList.forEach((function(e){t+=e.getRowCount()})):t=this.rows.length,t},T.prototype.toggleVisibility=function(){this.visible?this.hide():this.show()},T.prototype.hide=function(){this.visible=!1,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination?this.groupManager.updateGroupRows(!0):(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach((function(t){t.getHeadersAndRows().forEach((function(t){t.detachElement()}))})):this.rows.forEach((function(t){var e=t.getElement();e.parentNode.removeChild(e)})),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()),this.groupManager.table.options.groupVisibilityChanged.call(this.table,this.getComponent(),!1)},T.prototype.show=function(){if(this.visible=!0,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var t=this.getElement();this.groupList.length?this.groupList.forEach((function(e){e.getHeadersAndRows().forEach((function(e){var i=e.getElement();t.parentNode.insertBefore(i,t.nextSibling),e.initialize(),t=i}))})):this.rows.forEach((function(e){var i=e.getElement();t.parentNode.insertBefore(i,t.nextSibling),e.initialize(),t=i})),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()}this.groupManager.table.options.groupVisibilityChanged.call(this.table,this.getComponent(),!0)},T.prototype._visSet=function(){var t=[];"function"==typeof this.visible&&(this.rows.forEach((function(e){t.push(e.getData())})),this.visible=this.visible(this.key,this.getRowCount(),t,this.getComponent()))},T.prototype.getRowGroup=function(t){var e=!1;return this.groupList.length?this.groupList.forEach((function(i){var n=i.getRowGroup(t);n&&(e=n)})):this.rows.find((function(e){return e===t}))&&(e=this),e},T.prototype.getSubGroups=function(t){var e=[];return this.groupList.forEach((function(i){e.push(t?i.getComponent():i)})),e},T.prototype.getRows=function(t){var e=[];return this.rows.forEach((function(i){e.push(t?i.getComponent():i)})),e},T.prototype.generateGroupHeaderContents=function(){var t=[];for(this.rows.forEach((function(e){t.push(e.getData())})),this.elementContents=this.generator(this.key,this.getRowCount(),t,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)},T.prototype.getElement=function(){this.addBindingsd=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var t=0;t<this.element.childNodes.length;++t)this.element.childNodes[t].parentNode.removeChild(this.element.childNodes[t]);return this.generateGroupHeaderContents(),this.element},T.prototype.detachElement=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},T.prototype.normalizeHeight=function(){this.setHeight(this.element.clientHeight)},T.prototype.initialize=function(t){this.initialized&&!t||(this.normalizeHeight(),this.initialized=!0)},T.prototype.reinitialize=function(){this.initialized=!1,this.height=0,h.prototype.helpers.elVisible(this.element)&&this.initialize(!0)},T.prototype.setHeight=function(t){this.height!=t&&(this.height=t,this.outerHeight=this.element.offsetHeight)},T.prototype.getHeight=function(){return this.outerHeight},T.prototype.getGroup=function(){return this},T.prototype.reinitializeHeight=function(){},T.prototype.calcHeight=function(){},T.prototype.setCellHeight=function(){},T.prototype.clearCellHeight=function(){},T.prototype.getComponent=function(){return new M(this)};var R=function(t){this.table=t,this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayIndex=0};R.prototype.initialize=function(){var t=this,e=t.table.options.groupBy,i=t.table.options.groupStartOpen,n=t.table.options.groupHeader;this.allowedValues=t.table.options.groupValues,Array.isArray(e)&&Array.isArray(n)&&e.length>n.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),t.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],t.table.modules.localize.bind("groups|item",(function(e,i){t.headerGenerator[0]=function(t,n,o){return(void 0===t?"":t)+"<span>("+n+" "+(1===n?e:i.groups.items)+")</span>"}})),this.groupIDLookups=[],Array.isArray(e)||e?this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs():this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs&&this.table.columnManager.getRealColumns().forEach((function(e){e.definition.topCalc&&t.table.modules.columnCalcs.initializeTopRow(),e.definition.bottomCalc&&t.table.modules.columnCalcs.initializeBottomRow()})),Array.isArray(e)||(e=[e]),e.forEach((function(e,i){var n,o;n="function"==typeof e?e:(o=t.table.columnManager.getColumnByField(e))?function(t){return o.getFieldValue(t)}:function(t){return t[e]},t.groupIDLookups.push({field:"function"!=typeof e&&e,func:n,values:!!t.allowedValues&&t.allowedValues[i]})})),i&&(Array.isArray(i)||(i=[i]),i.forEach((function(t){t="function"==typeof t?t:function(){return!0}})),t.startOpen=i),n&&(t.headerGenerator=Array.isArray(n)?n:[n]),this.initialized=!0},R.prototype.setDisplayIndex=function(t){this.displayIndex=t},R.prototype.getDisplayIndex=function(){return this.displayIndex},R.prototype.getRows=function(t){return this.groupIDLookups.length?(this.table.options.dataGrouping.call(this.table),this.generateGroups(t),this.table.options.dataGrouped&&this.table.options.dataGrouped.call(this.table,this.getGroups(!0)),this.updateGroupRows()):t.slice(0)},R.prototype.getGroups=function(t){var e=[];return this.groupList.forEach((function(i){e.push(t?i.getComponent():i)})),e},R.prototype.getChildGroups=function(t){var e=this,i=[];return t||(t=this),t.groupList.forEach((function(t){t.groupList.length?i=i.concat(e.getChildGroups(t)):i.push(t)})),i},R.prototype.wipe=function(){this.groupList.forEach((function(t){t.wipe()}))},R.prototype.pullGroupListData=function(t){var e=this,i=[];return t.forEach((function(t){var n={level:0,rowCount:0,headerContent:""},o=[];t.hasSubGroups?(o=e.pullGroupListData(t.groupList),n.level=t.level,n.rowCount=o.length-t.groupList.length,n.headerContent=t.generator(t.key,n.rowCount,t.rows,t),i.push(n),i=i.concat(o)):(n.level=t.level,n.headerContent=t.generator(t.key,t.rows.length,t.rows,t),n.rowCount=t.getRows().length,i.push(n),t.getRows().forEach((function(t){i.push(t.getData("data"))})))})),i},R.prototype.getGroupedData=function(){return this.pullGroupListData(this.groupList)},R.prototype.getRowGroup=function(t){var e=!1;return this.groupList.forEach((function(i){var n=i.getRowGroup(t);n&&(e=n)})),e},R.prototype.countGroups=function(){return this.groupList.length},R.prototype.generateGroups=function(t){var e=this,i=e.groups;e.groups={},e.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach((function(t){e.createGroup(t,0,i)})),t.forEach((function(t){e.assignRowToExistingGroup(t,i)}))):t.forEach((function(t){e.assignRowToGroup(t,i)}))},R.prototype.createGroup=function(t,e,i){var n,o=e+"_"+t;i=i||[],n=new T(this,!1,e,t,this.groupIDLookups[0].field,this.headerGenerator[0],i[o]),this.groups[o]=n,this.groupList.push(n)},R.prototype.assignRowToExistingGroup=function(t,e){var i="0_"+this.groupIDLookups[0].func(t.getData());this.groups[i]&&this.groups[i].addRow(t)},R.prototype.assignRowToGroup=function(t,e){var i=this.groupIDLookups[0].func(t.getData()),n=!this.groups["0_"+i];return n&&this.createGroup(i,0,e),this.groups["0_"+i].addRow(t),!n},R.prototype.updateGroupRows=function(t){var e=[];if(this.groupList.forEach((function(t){e=e.concat(t.getHeadersAndRows())})),t){var i=this.table.rowManager.setDisplayRows(e,this.getDisplayIndex());!0!==i&&this.setDisplayIndex(i),this.table.rowManager.refreshActiveData("group",!0,!0)}return e},R.prototype.scrollHeaders=function(t){t+="px",this.groupList.forEach((function(e){e.scrollHeader(t)}))},R.prototype.removeGroup=function(t){var e,i=t.level+"_"+t.key;this.groups[i]&&(delete this.groups[i],(e=this.groupList.indexOf(t))>-1&&this.groupList.splice(e,1))},h.prototype.registerModule("groupRows",R);var P=function(t){this.table=t,this.history=[],this.index=-1};P.prototype.clear=function(){this.history=[],this.index=-1},P.prototype.action=function(t,e,i){this.history=this.history.slice(0,this.index+1),this.history.push({type:t,component:e,data:i}),this.index++},P.prototype.getHistoryUndoSize=function(){return this.index+1},P.prototype.getHistoryRedoSize=function(){return this.history.length-(this.index+1)},P.prototype.undo=function(){if(this.index>-1){var t=this.history[this.index];return this.undoers[t.type].call(this,t),this.index--,this.table.options.historyUndo.call(this.table,t.type,t.component.getComponent(),t.data),!0}return console.warn("History Undo Error - No more history to undo"),!1},P.prototype.redo=function(){if(this.history.length-1>this.index){this.index++;var t=this.history[this.index];return this.redoers[t.type].call(this,t),this.table.options.historyRedo.call(this.table,t.type,t.component.getComponent(),t.data),!0}return console.warn("History Redo Error - No more history to redo"),!1},P.prototype.undoers={cellEdit:function(t){t.component.setValueProcessData(t.data.oldValue)},rowAdd:function(t){t.component.deleteActual()},rowDelete:function(t){var e=this.table.rowManager.addRowActual(t.data.data,t.data.pos,t.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(t.component,e)},rowMove:function(t){this.table.rowManager.moveRowActual(t.component,this.table.rowManager.rows[t.data.posFrom],!t.data.after),this.table.rowManager.redraw()}},P.prototype.redoers={cellEdit:function(t){t.component.setValueProcessData(t.data.newValue)},rowAdd:function(t){var e=this.table.rowManager.addRowActual(t.data.data,t.data.pos,t.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(t.component,e)},rowDelete:function(t){t.component.deleteActual()},rowMove:function(t){this.table.rowManager.moveRowActual(t.component,this.table.rowManager.rows[t.data.posTo],t.data.after),this.table.rowManager.redraw()}},P.prototype._rebindRow=function(t,e){this.history.forEach((function(i){if(i.component instanceof a)i.component===t&&(i.component=e);else if(i.component instanceof u&&i.component.row===t){var n=i.component.column.getField();n&&(i.component=e.getCell(n))}}))},h.prototype.registerModule("history",P);var D=function(t){this.table=t,this.fieldIndex=[],this.hasIndex=!1};D.prototype.parseTable=function(){var t=this.table.element,e=this.table.options,i=(e.columns,t.getElementsByTagName("th")),n=t.getElementsByTagName("tbody")[0],o=[];this.hasIndex=!1,this.table.options.htmlImporting.call(this.table),n=n?n.getElementsByTagName("tr"):[],this._extractOptions(t,e),i.length?this._extractHeaders(i,n):this._generateBlankHeaders(i,n);for(var r=0;r<n.length;r++){var a=n[r].getElementsByTagName("td"),l={};this.hasIndex||(l[e.index]=r);for(var u=0;u<a.length;u++){var c=a[u];void 0!==this.fieldIndex[u]&&(l[this.fieldIndex[u]]=c.innerHTML)}o.push(l)}var h=document.createElement("div"),d=t.attributes;for(var u in d)"object"==s(d[u])&&h.setAttribute(d[u].name,d[u].value);t.parentNode.replaceChild(h,t),e.data=o,this.table.options.htmlImported.call(this.table),this.table.element=h},D.prototype._extractOptions=function(t,e,i){var n=t.attributes,o=i?Object.assign([],i):Object.keys(e),r={};for(var a in o.forEach((function(t){r[t.toLowerCase()]=t})),n){var l,u=n[a];u&&"object"==(void 0===u?"undefined":s(u))&&u.name&&0===u.name.indexOf("tabulator-")&&(l=u.name.replace("tabulator-",""),void 0!==r[l]&&(e[r[l]]=this._attribValue(u.value)))}},D.prototype._attribValue=function(t){return"true"===t||"false"!==t&&t},D.prototype._findCol=function(t){return this.table.options.columns.find((function(e){return e.title===t}))||!1},D.prototype._extractHeaders=function(t,e){for(var i=0;i<t.length;i++){var o,r=t[i],a=!1,s=this._findCol(r.textContent);s?a=!0:s={title:r.textContent.trim()},s.field||(s.field=r.textContent.trim().toLowerCase().replace(" ","_")),(o=r.getAttribute("width"))&&!s.width&&(s.width=o),r.attributes,this._extractOptions(r,s,n.prototype.defaultOptionList),this.fieldIndex[i]=s.field,s.field==this.table.options.index&&(this.hasIndex=!0),a||this.table.options.columns.push(s)}},D.prototype._generateBlankHeaders=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o={title:"",field:"col"+i};this.fieldIndex[i]=o.field;var r=n.getAttribute("width");r&&(o.width=r),this.table.options.columns.push(o)}},h.prototype.registerModule("htmlTableImport",D);var L=function(t){this.table=t,this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1};L.prototype.initialize=function(){var t=this.table.options.keybindings,e={};if(this.watchKeys={},this.pressedKeys=[],!1!==t){for(var i in this.bindings)e[i]=this.bindings[i];if(Object.keys(t).length)for(var n in t)e[n]=t[n];this.mapBindings(e),this.bindEvents()}},L.prototype.mapBindings=function(t){var e=this,i=this,n=function(n){e.actions[n]?t[n]&&("object"!==s(t[n])&&(t[n]=[t[n]]),t[n].forEach((function(t){i.mapBinding(n,t)}))):console.warn("Key Binding Error - no such action:",n)};for(var o in t)n(o)},L.prototype.mapBinding=function(t,e){var i=this,n={action:this.actions[t],keys:[],ctrl:!1,shift:!1,meta:!1};e.toString().toLowerCase().split(" ").join("").split("+").forEach((function(t){switch(t){case"ctrl":n.ctrl=!0;break;case"shift":n.shift=!0;break;case"meta":n.meta=!0;break;default:t=parseInt(t),n.keys.push(t),i.watchKeys[t]||(i.watchKeys[t]=[]),i.watchKeys[t].push(n)}}))},L.prototype.bindEvents=function(){var t=this;this.keyupBinding=function(e){var i=e.keyCode,n=t.watchKeys[i];n&&(t.pressedKeys.push(i),n.forEach((function(i){t.checkBinding(e,i)})))},this.keydownBinding=function(e){var i=e.keyCode;if(t.watchKeys[i]){var n=t.pressedKeys.indexOf(i);n>-1&&t.pressedKeys.splice(n,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)},L.prototype.clearBindings=function(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)},L.prototype.checkBinding=function(t,e){var i=this,n=!0;return t.ctrlKey==e.ctrl&&t.shiftKey==e.shift&&t.metaKey==e.meta&&(e.keys.forEach((function(t){-1==i.pressedKeys.indexOf(t)&&(n=!1)})),n&&e.action.call(i,t),!0)},L.prototype.bindings={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:"ctrl + 90",redo:"ctrl + 89",copyToClipboard:"ctrl + 67"},L.prototype.actions={keyBlock:function(t){t.stopPropagation(),t.preventDefault()},scrollPageUp:function(t){var e=this.table.rowManager,i=e.scrollTop-e.height;e.element.scrollHeight,t.preventDefault(),e.displayRowsCount&&(i>=0?e.element.scrollTop=i:e.scrollToRow(e.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(t){var e=this.table.rowManager,i=e.scrollTop+e.height,n=e.element.scrollHeight;t.preventDefault(),e.displayRowsCount&&(i<=n?e.element.scrollTop=i:e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(t){var e=this.table.rowManager;t.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(t){var e=this.table.rowManager;t.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1]),this.table.element.focus()},navPrev:function(t){var e=!1;this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell)&&(t.preventDefault(),e.nav().prev())},navNext:function(t){var e,i=!1,n=this.table.options.tabEndNewRow;this.table.modExists("edit")&&(i=this.table.modules.edit.currentCell)&&(t.preventDefault(),(e=i.nav()).next()||n&&(i.getElement().firstChild.blur(),(n=!0===n?this.table.addRow({}):"function"==typeof n?this.table.addRow(n(i.row.getComponent())):this.table.addRow(n)).then((function(){setTimeout((function(){e.next()}))}))))},navLeft:function(t){var e=!1;this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell)&&(t.preventDefault(),e.nav().left())},navRight:function(t){var e=!1;this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell)&&(t.preventDefault(),e.nav().right())},navUp:function(t){var e=!1;this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell)&&(t.preventDefault(),e.nav().up())},navDown:function(t){var e=!1;this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell)&&(t.preventDefault(),e.nav().down())},undo:function(t){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(t.preventDefault(),this.table.modules.history.undo()))},redo:function(t){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(t.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(t){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},h.prototype.registerModule("keybindings",L);var F=function(t){this.table=t,this.menuEl=!1,this.blurEvent=this.hideMenu.bind(this)};F.prototype.initializeColumnHeader=function(t){var e,i=this;t.definition.headerContextMenu&&t.getElement().addEventListener("contextmenu",(function(e){var n="function"==typeof t.definition.headerContextMenu?t.definition.headerContextMenu():t.definition.headerContextMenu;e.preventDefault(),i.loadMenu(e,t,n)})),t.definition.headerMenu&&((e=document.createElement("span")).classList.add("tabulator-header-menu-button"),e.innerHTML="&vellip;",e.addEventListener("click",(function(e){var n="function"==typeof t.definition.headerMenu?t.definition.headerMenu():t.definition.headerMenu;e.stopPropagation(),e.preventDefault(),i.loadMenu(e,t,n)})),t.titleElement.insertBefore(e,t.titleElement.firstChild))},F.prototype.initializeCell=function(t){var e=this;t.getElement().addEventListener("contextmenu",(function(i){var n="function"==typeof t.column.definition.contextMenu?t.column.definition.contextMenu():t.column.definition.contextMenu;i.preventDefault(),e.loadMenu(i,t,n)}))},F.prototype.initializeRow=function(t){var e=this;t.getElement().addEventListener("contextmenu",(function(i){var n="function"==typeof e.table.options.rowContextMenu?e.table.options.rowContextMenu():e.table.options.rowContextMenu;i.preventDefault(),e.loadMenu(i,t,n)}))},F.prototype.loadMenu=function(t,e,i){var n=this,o=document.body.offsetHeight;i&&i.length&&(this.hideMenu(),this.menuEl=document.createElement("div"),this.menuEl.classList.add("tabulator-menu"),i.forEach((function(t){var i=document.createElement("div"),o=t.label,r=t.disabled;t.separator?i.classList.add("tabulator-menu-separator"):(i.classList.add("tabulator-menu-item"),"function"==typeof o&&(o=o(e.getComponent())),o instanceof Node?i.appendChild(o):i.innerHTML=o,"function"==typeof r&&(r=r(e.getComponent())),r?(i.classList.add("tabulator-menu-item-disabled"),i.addEventListener("click",(function(t){t.stopPropagation()}))):i.addEventListener("click",(function(i){n.hideMenu(),t.action(i,e.getComponent())}))),n.menuEl.appendChild(i)})),this.menuEl.style.top=t.pageY+"px",this.menuEl.style.left=t.pageX+"px",document.body.addEventListener("click",this.blurEvent),this.table.rowManager.element.addEventListener("scroll",this.blurEvent),setTimeout((function(){document.body.addEventListener("contextmenu",n.blurEvent)}),100),document.body.appendChild(this.menuEl),t.pageX+this.menuEl.offsetWidth>=document.body.offsetWidth&&(this.menuEl.style.left="",this.menuEl.style.right=document.body.offsetWidth-t.pageX+"px"),t.pageY+this.menuEl.offsetHeight>=o&&(this.menuEl.style.top="",this.menuEl.style.bottom=o-t.pageY+"px"))},F.prototype.hideMenu=function(){this.menuEl.parentNode&&this.menuEl.parentNode.removeChild(this.menuEl),this.blurEvent&&(document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent))},F.prototype.menus={},h.prototype.registerModule("menu",F);var O=function(t){this.table=t,this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this)};O.prototype.createPlaceholderElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-col"),t.classList.add("tabulator-col-placeholder"),t},O.prototype.initializeColumn=function(t){var e,i=this,n={};t.modules.frozen||(e=t.getElement(),n.mousemove=function(n){t.parent===i.moving.parent&&((i.touchMove?n.touches[0].pageX:n.pageX)-h.prototype.helpers.elOffset(e).left+i.table.columnManager.element.scrollLeft>t.getWidth()/2?i.toCol===t&&i.toColAfter||(e.parentNode.insertBefore(i.placeholderElement,e.nextSibling),i.moveColumn(t,!0)):(i.toCol!==t||i.toColAfter)&&(e.parentNode.insertBefore(i.placeholderElement,e),i.moveColumn(t,!1)))}.bind(i),e.addEventListener("mousedown",(function(e){i.touchMove=!1,1===e.which&&(i.checkTimeout=setTimeout((function(){i.startMove(e,t)}),i.checkPeriod))})),e.addEventListener("mouseup",(function(t){1===t.which&&i.checkTimeout&&clearTimeout(i.checkTimeout)})),i.bindTouchEvents(t)),t.modules.moveColumn=n},O.prototype.bindTouchEvents=function(t){var e,i,n,o,r,a,s=this,l=t.getElement(),u=!1;l.addEventListener("touchstart",(function(l){s.checkTimeout=setTimeout((function(){s.touchMove=!0,e=t.nextColumn(),n=e?e.getWidth()/2:0,i=t.prevColumn(),o=i?i.getWidth()/2:0,r=0,a=0,u=!1,s.startMove(l,t)}),s.checkPeriod)}),{passive:!0}),l.addEventListener("touchmove",(function(l){var c,h;s.moving&&(s.moveHover(l),u||(u=l.touches[0].pageX),(c=l.touches[0].pageX-u)>0?e&&c-r>n&&(h=e)!==t&&(u=l.touches[0].pageX,h.getElement().parentNode.insertBefore(s.placeholderElement,h.getElement().nextSibling),s.moveColumn(h,!0)):i&&-c-a>o&&(h=i)!==t&&(u=l.touches[0].pageX,h.getElement().parentNode.insertBefore(s.placeholderElement,h.getElement()),s.moveColumn(h,!1)),h&&(e=h.nextColumn(),r=n,n=e?e.getWidth()/2:0,i=h.prevColumn(),a=o,o=i?i.getWidth()/2:0))}),{passive:!0}),l.addEventListener("touchend",(function(t){s.checkTimeout&&clearTimeout(s.checkTimeout),s.moving&&s.endMove(t)}))},O.prototype.startMove=function(t,e){var i=e.getElement();this.moving=e,this.startX=(this.touchMove?t.touches[0].pageX:t.pageX)-h.prototype.helpers.elOffset(i).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=e.getWidth()+"px",this.placeholderElement.style.height=e.getHeight()+"px",i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.table.columnManager.getElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom="0",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(t)},O.prototype._bindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach((function(t){t.modules.moveColumn.mousemove&&t.getElement().addEventListener("mousemove",t.modules.moveColumn.mousemove)}))},O.prototype._unbindMouseMove=function(){this.table.columnManager.columnsByIndex.forEach((function(t){t.modules.moveColumn.mousemove&&t.getElement().removeEventListener("mousemove",t.modules.moveColumn.mousemove)}))},O.prototype.moveColumn=function(t,e){var i=this.moving.getCells();this.toCol=t,this.toColAfter=e,e?t.getCells().forEach((function(t,e){var n=t.getElement();n.parentNode.insertBefore(i[e].getElement(),n.nextSibling)})):t.getCells().forEach((function(t,e){var n=t.getElement();n.parentNode.insertBefore(i[e].getElement(),n)}))},O.prototype.endMove=function(t){(1===t.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))},O.prototype.moveHover=function(t){var e,i=this,n=i.table.columnManager.getElement(),o=n.scrollLeft,r=(i.touchMove?t.touches[0].pageX:t.pageX)-h.prototype.helpers.elOffset(n).left+o;i.hoverElement.style.left=r-i.startX+"px",r-o<i.autoScrollMargin&&(i.autoScrollTimeout||(i.autoScrollTimeout=setTimeout((function(){e=Math.max(0,o-5),i.table.rowManager.getElement().scrollLeft=e,i.autoScrollTimeout=!1}),1))),o+n.clientWidth-r<i.autoScrollMargin&&(i.autoScrollTimeout||(i.autoScrollTimeout=setTimeout((function(){e=Math.min(n.clientWidth,o+5),i.table.rowManager.getElement().scrollLeft=e,i.autoScrollTimeout=!1}),1)))},h.prototype.registerModule("moveColumn",O);var A=function(t){this.table=t,this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connections=[],this.connectedTable=!1,this.connectedRow=!1};A.prototype.createPlaceholderElement=function(){var t=document.createElement("div");return t.classList.add("tabulator-row"),t.classList.add("tabulator-row-placeholder"),t},A.prototype.initialize=function(t){this.connection=this.table.options.movableRowsConnectedTables},A.prototype.setHandle=function(t){this.hasHandle=t},A.prototype.initializeGroupHeader=function(t){var e=this,i={};i.mouseup=function(t){e.tableRowDrop(t,row)}.bind(e),i.mousemove=function(i){var n;i.pageY-h.prototype.helpers.elOffset(t.element).top+e.table.rowManager.element.scrollTop>t.getHeight()/2?e.toRow===t&&e.toRowAfter||((n=t.getElement()).parentNode.insertBefore(e.placeholderElement,n.nextSibling),e.moveRow(t,!0)):(e.toRow!==t||e.toRowAfter)&&(n=t.getElement()).previousSibling&&(n.parentNode.insertBefore(e.placeholderElement,n),e.moveRow(t,!1))}.bind(e),t.modules.moveRow=i},A.prototype.initializeRow=function(t){var e,i=this,n={};n.mouseup=function(e){i.tableRowDrop(e,t)}.bind(i),n.mousemove=function(e){var n;e.pageY-h.prototype.helpers.elOffset(t.element).top+i.table.rowManager.element.scrollTop>t.getHeight()/2?i.toRow===t&&i.toRowAfter||((n=t.getElement()).parentNode.insertBefore(i.placeholderElement,n.nextSibling),i.moveRow(t,!0)):(i.toRow!==t||i.toRowAfter)&&((n=t.getElement()).parentNode.insertBefore(i.placeholderElement,n),i.moveRow(t,!1))}.bind(i),this.hasHandle||((e=t.getElement()).addEventListener("mousedown",(function(e){1===e.which&&(i.checkTimeout=setTimeout((function(){i.startMove(e,t)}),i.checkPeriod))})),e.addEventListener("mouseup",(function(t){1===t.which&&i.checkTimeout&&clearTimeout(i.checkTimeout)})),this.bindTouchEvents(t,t.getElement())),t.modules.moveRow=n},A.prototype.initializeCell=function(t){var e=this,i=t.getElement();i.addEventListener("mousedown",(function(i){1===i.which&&(e.checkTimeout=setTimeout((function(){e.startMove(i,t.row)}),e.checkPeriod))})),i.addEventListener("mouseup",(function(t){1===t.which&&e.checkTimeout&&clearTimeout(e.checkTimeout)})),this.bindTouchEvents(t.row,t.getElement())},A.prototype.bindTouchEvents=function(t,e){var i,n,o,r,a,s,l=this,u=!1;e.addEventListener("touchstart",(function(e){l.checkTimeout=setTimeout((function(){l.touchMove=!0,i=t.nextRow(),o=i?i.getHeight()/2:0,n=t.prevRow(),r=n?n.getHeight()/2:0,a=0,s=0,u=!1,l.startMove(e,t)}),l.checkPeriod)}),{passive:!0}),this.moving,this.toRow,this.toRowAfter,e.addEventListener("touchmove",(function(e){var c,h;l.moving&&(e.preventDefault(),l.moveHover(e),u||(u=e.touches[0].pageY),(c=e.touches[0].pageY-u)>0?i&&c-a>o&&(h=i)!==t&&(u=e.touches[0].pageY,h.getElement().parentNode.insertBefore(l.placeholderElement,h.getElement().nextSibling),l.moveRow(h,!0)):n&&-c-s>r&&(h=n)!==t&&(u=e.touches[0].pageY,h.getElement().parentNode.insertBefore(l.placeholderElement,h.getElement()),l.moveRow(h,!1)),h&&(i=h.nextRow(),a=o,o=i?i.getHeight()/2:0,n=h.prevRow(),s=r,r=n?n.getHeight()/2:0))})),e.addEventListener("touchend",(function(t){l.checkTimeout&&clearTimeout(l.checkTimeout),l.moving&&(l.endMove(t),l.touchMove=!1)}))},A.prototype._bindMouseMove=function(){this.table.rowManager.getDisplayRows().forEach((function(t){"row"!==t.type&&"group"!==t.type||!t.modules.moveRow.mousemove||t.getElement().addEventListener("mousemove",t.modules.moveRow.mousemove)}))},A.prototype._unbindMouseMove=function(){this.table.rowManager.getDisplayRows().forEach((function(t){"row"!==t.type&&"group"!==t.type||!t.modules.moveRow.mousemove||t.getElement().removeEventListener("mousemove",t.modules.moveRow.mousemove)}))},A.prototype.startMove=function(t,e){var i=e.getElement();this.setStartPosition(t,e),this.moving=e,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=e.getWidth()+"px",this.placeholderElement.style.height=e.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(e)):(i.parentNode.insertBefore(this.placeholderElement,i),i.parentNode.removeChild(i)),this.hoverElement=i.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.moveHover(t)},A.prototype.setStartPosition=function(t,e){var i,n,o=this.touchMove?t.touches[0].pageX:t.pageX,r=this.touchMove?t.touches[0].pageY:t.pageY;i=e.getElement(),this.connection?(n=i.getBoundingClientRect(),this.startX=n.left-o+window.pageXOffset,this.startY=n.top-r+window.pageYOffset):this.startY=r-i.getBoundingClientRect().top},A.prototype.endMove=function(t){t&&1!==t.which&&!this.touchMove||(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow&&this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))},A.prototype.moveRow=function(t,e){this.toRow=t,this.toRowAfter=e},A.prototype.moveHover=function(t){this.connection?this.moveHoverConnections.call(this,t):this.moveHoverTable.call(this,t)},A.prototype.moveHoverTable=function(t){var e=this.table.rowManager.getElement(),i=e.scrollTop,n=(this.touchMove?t.touches[0].pageY:t.pageY)-e.getBoundingClientRect().top+i;this.hoverElement.style.top=n-this.startY+"px"},A.prototype.moveHoverConnections=function(t){this.hoverElement.style.left=this.startX+(this.touchMove?t.touches[0].pageX:t.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?t.touches[0].pageY:t.pageY)+"px"},A.prototype.connectToTables=function(t){var e=this.table.modules.comms.getConnections(this.connection);this.table.options.movableRowsSendingStart.call(this.table,e),this.table.modules.comms.send(this.connection,"moveRow","connect",{row:t})},A.prototype.disconnectFromTables=function(){var t=this.table.modules.comms.getConnections(this.connection);this.table.options.movableRowsSendingStop.call(this.table,t),this.table.modules.comms.send(this.connection,"moveRow","disconnect")},A.prototype.connect=function(t,e){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=t,this.connectedRow=e,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(t){"row"===t.type&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().addEventListener("mouseup",t.modules.moveRow.mouseup)})),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.table.options.movableRowsReceivingStart.call(this.table,e,t),!0)},A.prototype.disconnect=function(t){t===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach((function(t){"row"===t.type&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().removeEventListener("mouseup",t.modules.moveRow.mouseup)})),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.table.options.movableRowsReceivingStop.call(this.table,t)):console.warn("Move Row Error - trying to disconnect from non connected table")},A.prototype.dropComplete=function(t,e,i){var n=!1;if(i){switch(s(this.table.options.movableRowsSender)){case"string":n=this.senders[this.table.options.movableRowsSender];break;case"function":n=this.table.options.movableRowsSender}n?n.call(this,this.moving.getComponent(),e?e.getComponent():void 0,t):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.table.options.movableRowsSent.call(this.table,this.moving.getComponent(),e?e.getComponent():void 0,t)}else this.table.options.movableRowsSentFailed.call(this.table,this.moving.getComponent(),e?e.getComponent():void 0,t);this.endMove()},A.prototype.tableRowDrop=function(t,e){var i=!1,n=!1;switch(t.stopImmediatePropagation(),s(this.table.options.movableRowsReceiver)){case"string":i=this.receivers[this.table.options.movableRowsReceiver];break;case"function":i=this.table.options.movableRowsReceiver}i?n=i.call(this,this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),n?this.table.options.movableRowsReceived.call(this.table,this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable):this.table.options.movableRowsReceivedFailed.call(this.table,this.connectedRow.getComponent(),e?e.getComponent():void 0,this.connectedTable),this.table.modules.comms.send(this.connectedTable,"moveRow","dropcomplete",{row:e,success:n})},A.prototype.receivers={insert:function(t,e,i){return this.table.addRow(t.getData(),void 0,e),!0},add:function(t,e,i){return this.table.addRow(t.getData()),!0},update:function(t,e,i){return!!e&&(e.update(t.getData()),!0)},replace:function(t,e,i){return!!e&&(this.table.addRow(t.getData(),void 0,e),e.delete(),!0)}},A.prototype.senders={delete:function(t,e,i){t.delete()}},A.prototype.commsReceived=function(t,e,i){switch(e){case"connect":return this.connect(t,i.row);case"disconnect":return this.disconnect(t);case"dropcomplete":return this.dropComplete(t,i.row,i.success)}},h.prototype.registerModule("moveRow",A);var I=function(t){this.table=t,this.allowedTypes=["","data","edit","clipboard"],this.enabled=!0};I.prototype.initializeColumn=function(t){var e=this,i=!1,n={};this.allowedTypes.forEach((function(o){var r,a="mutator"+(o.charAt(0).toUpperCase()+o.slice(1));t.definition[a]&&(r=e.lookupMutator(t.definition[a]))&&(i=!0,n[a]={mutator:r,params:t.definition[a+"Params"]||{}})})),i&&(t.modules.mutate=n)},I.prototype.lookupMutator=function(t){var e=!1;switch(void 0===t?"undefined":s(t)){case"string":this.mutators[t]?e=this.mutators[t]:console.warn("Mutator Error - No such mutator found, ignoring: ",t);break;case"function":e=t}return e},I.prototype.transformRow=function(t,e,i){var n,o="mutator"+(e.charAt(0).toUpperCase()+e.slice(1));return this.enabled&&this.table.columnManager.traverse((function(r){var a,s,l;r.modules.mutate&&(a=r.modules.mutate[o]||r.modules.mutate.mutator||!1)&&(n=r.getFieldValue(void 0!==i?i:t),"data"!=e&&void 0===n||(l=r.getComponent(),s="function"==typeof a.params?a.params(n,t,e,l):a.params,r.setFieldValue(t,a.mutator(n,t,e,s,l))))})),t},I.prototype.transformCell=function(t,e){var i=t.column.modules.mutate.mutatorEdit||t.column.modules.mutate.mutator||!1,n={};return i?(n=Object.assign(n,t.row.getData()),t.column.setFieldValue(n,e),i.mutator(e,n,"edit",i.params,t.getComponent())):e},I.prototype.enable=function(){this.enabled=!0},I.prototype.disable=function(){this.enabled=!1},I.prototype.mutators={},h.prototype.registerModule("mutator",I);var j=function(t){this.table=t,this.mode="local",this.progressiveLoad=!1,this.size=0,this.page=1,this.count=5,this.max=1,this.displayIndex=0,this.initialLoad=!0,this.pageSizes=[],this.createElements()};j.prototype.createElements=function(){var t;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(t=document.createElement("button")).classList.add("tabulator-page"),t.setAttribute("type","button"),t.setAttribute("role","button"),t.setAttribute("aria-label",""),t.setAttribute("title",""),this.firstBut=t.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=t.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=t.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=t.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))},j.prototype.generatePageSizeSelectList=function(){var t=this,e=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))e=this.table.options.paginationSizeSelector,this.pageSizes=e,-1==this.pageSizes.indexOf(this.size)&&e.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){e=[];for(var i=1;i<5;i++)e.push(this.size*i);this.pageSizes=e}else e=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);e.forEach((function(e){var i=document.createElement("option");i.value=e,i.innerHTML=e,t.pageSizeSelect.appendChild(i)})),this.pageSizeSelect.value=this.size}},j.prototype.initialize=function(t){var e,i=this;for(var n in i.table.options.paginationDataSent)i.paginationDataSentNames[n]=i.table.options.paginationDataSent[n];for(var o in i.table.options.paginationDataReceived)i.paginationDataReceivedNames[o]=i.table.options.paginationDataReceived[o];i.table.modules.localize.bind("pagination|first",(function(t){i.firstBut.innerHTML=t})),i.table.modules.localize.bind("pagination|first_title",(function(t){i.firstBut.setAttribute("aria-label",t),i.firstBut.setAttribute("title",t)})),i.table.modules.localize.bind("pagination|prev",(function(t){i.prevBut.innerHTML=t})),i.table.modules.localize.bind("pagination|prev_title",(function(t){i.prevBut.setAttribute("aria-label",t),i.prevBut.setAttribute("title",t)})),i.table.modules.localize.bind("pagination|next",(function(t){i.nextBut.innerHTML=t})),i.table.modules.localize.bind("pagination|next_title",(function(t){i.nextBut.setAttribute("aria-label",t),i.nextBut.setAttribute("title",t)})),i.table.modules.localize.bind("pagination|last",(function(t){i.lastBut.innerHTML=t})),i.table.modules.localize.bind("pagination|last_title",(function(t){i.lastBut.setAttribute("aria-label",t),i.lastBut.setAttribute("title",t)})),i.firstBut.addEventListener("click",(function(){i.setPage(1)})),i.prevBut.addEventListener("click",(function(){i.previousPage()})),i.nextBut.addEventListener("click",(function(){i.nextPage().then((function(){})).catch((function(){}))})),i.lastBut.addEventListener("click",(function(){i.setPage(i.max)})),i.table.options.paginationElement&&(i.element=i.table.options.paginationElement),this.pageSizeSelect&&(e=document.createElement("label"),i.table.modules.localize.bind("pagination|page_size",(function(t){i.pageSizeSelect.setAttribute("aria-label",t),i.pageSizeSelect.setAttribute("title",t),e.innerHTML=t})),i.element.appendChild(e),i.element.appendChild(i.pageSizeSelect),i.pageSizeSelect.addEventListener("change",(function(t){i.setPageSize(i.pageSizeSelect.value),i.setPage(1).then((function(){})).catch((function(){}))}))),i.element.appendChild(i.firstBut),i.element.appendChild(i.prevBut),i.element.appendChild(i.pagesElement),i.element.appendChild(i.nextBut),i.element.appendChild(i.lastBut),i.table.options.paginationElement||t||i.table.footerManager.append(i.element,i),i.mode=i.table.options.pagination,i.size=i.table.options.paginationSize||Math.floor(i.table.rowManager.getElement().clientHeight/24),i.count=i.table.options.paginationButtonCount,i.generatePageSizeSelectList()},j.prototype.initializeProgressive=function(t){this.initialize(!0),this.mode="progressive_"+t,this.progressiveLoad=!0},j.prototype.setDisplayIndex=function(t){this.displayIndex=t},j.prototype.getDisplayIndex=function(){return this.displayIndex},j.prototype.setMaxRows=function(t){this.max=t?Math.ceil(t/this.size):1,this.page>this.max&&(this.page=this.max)},j.prototype.reset=function(t,e){return("local"==this.mode||t)&&(this.page=1),e&&(this.initialLoad=!0),!0},j.prototype.setMaxPage=function(t){t=parseInt(t),this.max=t||1,this.page>this.max&&(this.page=this.max,this.trigger())},j.prototype.setPage=function(t){var e=this,i=this;return new Promise((function(n,o){(t=parseInt(t))>0&&t<=e.max?(e.page=t,e.trigger().then((function(){n()})).catch((function(){o()})),i.table.options.persistence&&i.table.modExists("persistence",!0)&&i.table.modules.persistence.config.page&&i.table.modules.persistence.save("page")):(console.warn("Pagination Error - Requested page is out of range of 1 - "+e.max+":",t),o())}))},j.prototype.setPageToRow=function(t){var e=this;return new Promise((function(i,n){var o=e.table.rowManager.getDisplayRows(e.displayIndex-1).indexOf(t);if(o>-1){var r=Math.ceil((o+1)/e.size);e.setPage(r).then((function(){i()})).catch((function(){n()}))}else console.warn("Pagination Error - Requested row is not visible"),n()}))},j.prototype.setPageSize=function(t){(t=parseInt(t))>0&&(this.size=t),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.page&&this.table.modules.persistence.save("page")},j.prototype._setPageButtons=function(){for(var t=Math.floor((this.count-1)/2),e=Math.ceil((this.count-1)/2),i=this.max-this.page+t+1<this.count?this.max-this.count+1:Math.max(this.page-t,1),n=this.page<=e?Math.min(this.count,this.max):Math.min(this.page+e,this.max);this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(var o=i;o<=n;o++)o>0&&o<=this.max&&this.pagesElement.appendChild(this._generatePageButton(o));this.footerRedraw()},j.prototype._generatePageButton=function(t){var e=this,i=document.createElement("button");return i.classList.add("tabulator-page"),t==e.page&&i.classList.add("active"),i.setAttribute("type","button"),i.setAttribute("role","button"),i.setAttribute("aria-label","Show Page "+t),i.setAttribute("title","Show Page "+t),i.setAttribute("data-page",t),i.textContent=t,i.addEventListener("click",(function(i){e.setPage(t)})),i},j.prototype.previousPage=function(){var t=this;return new Promise((function(e,i){t.page>1?(t.page--,t.trigger().then((function(){e()})).catch((function(){i()})),t.table.options.persistence&&t.table.modExists("persistence",!0)&&t.table.modules.persistence.config.page&&t.table.modules.persistence.save("page")):(console.warn("Pagination Error - Previous page would be less than page 1:",0),i())}))},j.prototype.nextPage=function(){var t=this;return new Promise((function(e,i){t.page<t.max?(t.page++,t.trigger().then((function(){e()})).catch((function(){i()})),t.table.options.persistence&&t.table.modExists("persistence",!0)&&t.table.modules.persistence.config.page&&t.table.modules.persistence.save("page")):(t.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+t.max+":",t.max+1),i())}))},j.prototype.getPage=function(){return this.page},j.prototype.getPageMax=function(){return this.max},j.prototype.getPageSize=function(t){return this.size},j.prototype.getMode=function(){return this.mode},j.prototype.getRows=function(t){var e,i,n;if("local"==this.mode){e=[],n=(i=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(var o=i;o<n;o++)t[o]&&e.push(t[o]);return e}return this._setPageButtons(),t.slice(0)},j.prototype.trigger=function(){var t,e=this;return new Promise((function(i,n){switch(e.mode){case"local":t=e.table.rowManager.scrollLeft,e.table.rowManager.refreshActiveData("page"),e.table.rowManager.scrollHorizontal(t),e.table.options.pageLoaded.call(e.table,e.getPage()),i();break;case"remote":case"progressive_load":case"progressive_scroll":e.table.modules.ajax.blockActiveRequest(),e._getRemotePage().then((function(){i()})).catch((function(){n()}));break;default:console.warn("Pagination Error - no such pagination mode:",e.mode),n()}}))},j.prototype._getRemotePage=function(){var t,e,i=this,n=this;return new Promise((function(o,r){if(n.table.modExists("ajax",!0)||r(),t=h.prototype.helpers.deepClone(n.table.modules.ajax.getParams()||{}),(e=n.table.modules.ajax.getParams())[i.paginationDataSentNames.page]=n.page,i.size&&(e[i.paginationDataSentNames.size]=i.size),i.table.options.ajaxSorting&&i.table.modExists("sort")){var a=n.table.modules.sort.getSort();a.forEach((function(t){delete t.column})),e[i.paginationDataSentNames.sorters]=a}if(i.table.options.ajaxFiltering&&i.table.modExists("filter")){var s=n.table.modules.filter.getFilters(!0,!0);e[i.paginationDataSentNames.filters]=s}n.table.modules.ajax.setParams(e),n.table.modules.ajax.sendRequest(i.progressiveLoad).then((function(t){n._parseRemoteData(t),o()})).catch((function(t){r()})),n.table.modules.ajax.setParams(t)}))},j.prototype._parseRemoteData=function(t){var e,i,n=this;if(void 0===t[this.paginationDataReceivedNames.last_page]&&console.warn("Remote Pagination Error - Server response missing '"+this.paginationDataReceivedNames.last_page+"' property"),t[this.paginationDataReceivedNames.data]){if(this.max=parseInt(t[this.paginationDataReceivedNames.last_page])||1,this.progressiveLoad)switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(t[this.paginationDataReceivedNames.data],!1,this.initialLoad&&1==this.page):this.table.rowManager.addRows(t[this.paginationDataReceivedNames.data]),this.page<this.max&&setTimeout((function(){n.nextPage().then((function(){})).catch((function(){}))}),n.table.options.ajaxProgressiveLoadDelay);break;case"progressive_scroll":t=this.table.rowManager.getData().concat(t[this.paginationDataReceivedNames.data]),this.table.rowManager.setData(t,!0,this.initialLoad&&1==this.page),i=this.table.options.ajaxProgressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight,n.table.rowManager.element.scrollHeight<=n.table.rowManager.element.clientHeight+i&&n.nextPage().then((function(){})).catch((function(){}))}else e=this.table.rowManager.scrollLeft,this.table.rowManager.setData(t[this.paginationDataReceivedNames.data],!1,this.initialLoad&&1==this.page),this.table.rowManager.scrollHorizontal(e),this.table.columnManager.scrollHorizontal(e),this.table.options.pageLoaded.call(this.table,this.getPage());this.initialLoad=!1}else console.warn("Remote Pagination Error - Server response missing '"+this.paginationDataReceivedNames.data+"' property")},j.prototype.footerRedraw=function(){var t=this.table.footerManager.element;Math.ceil(t.clientWidth)-t.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(t.clientWidth)-t.scrollWidth<0&&(this.pagesElement.style.display="none"))},j.prototype.paginationDataSentNames={page:"page",size:"size",sorters:"sorters",filters:"filters"},j.prototype.paginationDataReceivedNames={current_page:"current_page",last_page:"last_page",data:"data"},h.prototype.registerModule("page",j);var z=function(t){this.table=t,this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1};z.prototype.localStorageTest=function(){var t="_tabulator_test";try{return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(t){return!1}},z.prototype.initialize=function(){var t,e=this.table.options.persistenceMode,i=this.table.options.persistenceID;this.mode=!0!==e?e:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:this.readers[this.table.options.persistenceReaderFunc]?this.readFunc=this.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):this.readers[this.mode]?this.readFunc=this.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:this.readers[this.table.options.persistenceWriterFunc]?this.writeFunc=this.readers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):this.writers[this.mode]?this.writeFunc=this.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(i||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(t=this.retreiveData("page"))&&(void 0===t.paginationSize||!0!==this.config.page&&!this.config.page.size||(this.table.options.paginationSize=t.paginationSize),void 0===t.paginationInitialPage||!0!==this.config.page&&!this.config.page.page||(this.table.options.paginationInitialPage=t.paginationInitialPage)),this.config.group&&(t=this.retreiveData("group"))&&(void 0===t.groupBy||!0!==this.config.group&&!this.config.group.groupBy||(this.table.options.groupBy=t.groupBy),void 0===t.groupStartOpen||!0!==this.config.group&&!this.config.group.groupStartOpen||(this.table.options.groupStartOpen=t.groupStartOpen),void 0===t.groupHeader||!0!==this.config.group&&!this.config.group.groupHeader||(this.table.options.groupHeader=t.groupHeader))},z.prototype.initializeColumn=function(t){var e,i=this;this.config.columns&&(this.defWatcherBlock=!0,e=t.getDefinition(),(!0===this.config.columns?Object.keys(e):this.config.columns).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t),o=e[t];n&&Object.defineProperty(e,t,{set:function(t){o=t,i.defWatcherBlock||i.save("columns"),n.set&&n.set(t)},get:function(){return n.get&&n.get(),o}})})),this.defWatcherBlock=!1)},z.prototype.load=function(t,e){var i=this.retreiveData(t);return e&&(i=i?this.mergeDefinition(e,i):e),i},z.prototype.retreiveData=function(t){return!!this.readFunc&&this.readFunc(this.id,t)},z.prototype.mergeDefinition=function(t,e){var i=this,n=[];return(e=e||[]).forEach((function(e,o){var r,a=i._findColumn(t,e);a&&(!0===i.config.columns||null==i.config.columns?(r=Object.keys(a)).push("width"):r=i.config.columns,r.forEach((function(t){void 0!==e[t]&&(a[t]=e[t])})),a.columns&&(a.columns=i.mergeDefinition(a.columns,e.columns)),n.push(a))})),t.forEach((function(t,o){i._findColumn(e,t)||(n.length>o?n.splice(o,0,t):n.push(t))})),n},z.prototype._findColumn=function(t,e){var i=e.columns?"group":e.field?"field":"object";return t.find((function(t){switch(i){case"group":return t.title===e.title&&t.columns.length===e.columns.length;case"field":return t.field===e.field;case"object":return t===e}}))},z.prototype.save=function(t){var e={};switch(t){case"columns":e=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":e=this.table.modules.filter.getFilters();break;case"sort":e=this.validateSorters(this.table.modules.sort.getSort());break;case"group":e=this.getGroupConfig();break;case"page":e=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,t,e)},z.prototype.validateSorters=function(t){return t.forEach((function(t){t.column=t.field,delete t.field})),t},z.prototype.getGroupConfig=function(){return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(data.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(data.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(data.groupHeader=this.table.options.groupHeader)),data},z.prototype.getPageConfig=function(){var t={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(t.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(t.paginationInitialPage=this.table.modules.page.getPage())),t},z.prototype.parseColumns=function(t){var e=this,i=[];return t.forEach((function(t){var n,o={},r=t.getDefinition();t.isGroup?(o.title=r.title,o.columns=e.parseColumns(t.getColumns())):(o.field=t.getField(),!0===e.config.columns||null==e.config.columns?(n=Object.keys(r)).push("width"):n=e.config.columns,n.forEach((function(e){switch(e){case"width":o.width=t.getWidth();break;case"visible":o.visible=t.visible;break;default:o[e]=r[e]}}))),i.push(o)})),i},z.prototype.readers={local:function(t,e){var i=localStorage.getItem(t+"-"+e);return!!i&&JSON.parse(i)},cookie:function(t,e){var i,n,o=document.cookie,r=t+"-"+e,a=o.indexOf(r+"=");return a>-1&&(o=o.substr(a),(i=o.indexOf(";"))>-1&&(o=o.substr(0,i)),n=o.replace(r+"=","")),!!n&&JSON.parse(n)}},z.prototype.writers={local:function(t,e,i){localStorage.setItem(t+"-"+e,JSON.stringify(i))},cookie:function(t,e,i){var n=new Date;n.setDate(n.getDate()+1e4),document.cookie=t+"-"+e+"="+JSON.stringify(i)+"; expires="+n.toUTCString()}},h.prototype.registerModule("persistence",z);var N=function(t){this.table=t,this.element=!1,this.manualBlock=!1};N.prototype.initialize=function(){window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))},N.prototype.replaceTable=function(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.genereateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))},N.prototype.cleanup=function(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")},N.prototype.printFullscreen=function(t,e,i){var n,o,r=window.scrollX,a=window.scrollY,s=document.createElement("div"),l=document.createElement("div"),u=this.table.modules.export.genereateTable(void 0!==i?i:this.table.options.printConfig,void 0!==e?e:this.table.options.printStyled,t,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(s.classList.add("tabulator-print-header"),"string"==typeof(n="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?s.innerHTML=n:s.appendChild(n),this.element.appendChild(s)),this.element.appendChild(u),this.table.options.printFooter&&(l.classList.add("tabulator-print-footer"),"string"==typeof(o="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?l.innerHTML=o:l.appendChild(o),this.element.appendChild(l)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,u),window.print(),this.cleanup(),window.scrollTo(r,a),this.manualBlock=!1},h.prototype.registerModule("print",N);var H=function(t){this.table=t,this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0};H.prototype.watchData=function(t){var e,i=this;this.currentVersion++,e=this.currentVersion,i.unwatchData(),i.data=t,i.origFuncs.push=t.push,Object.defineProperty(i.data,"push",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments);return i.blocked||e!==i.currentVersion||n.forEach((function(t){i.table.rowManager.addRowActual(t,!1)})),i.origFuncs.push.apply(t,arguments)}}),i.origFuncs.unshift=t.unshift,Object.defineProperty(i.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var n=Array.from(arguments);return i.blocked||e!==i.currentVersion||n.forEach((function(t){i.table.rowManager.addRowActual(t,!0)})),i.origFuncs.unshift.apply(t,arguments)}}),i.origFuncs.shift=t.shift,Object.defineProperty(i.data,"shift",{enumerable:!1,configurable:!0,value:function(){var n;return i.blocked||e!==i.currentVersion||i.data.length&&(n=i.table.rowManager.getRowFromDataObject(i.data[0]))&&n.deleteActual(),i.origFuncs.shift.call(t)}}),i.origFuncs.pop=t.pop,Object.defineProperty(i.data,"pop",{enumerable:!1,configurable:!0,value:function(){var n;return i.blocked||e!==i.currentVersion||i.data.length&&(n=i.table.rowManager.getRowFromDataObject(i.data[i.data.length-1]))&&n.deleteActual(),i.origFuncs.pop.call(t)}}),i.origFuncs.splice=t.splice,Object.defineProperty(i.data,"splice",{enumerable:!1,configurable:!0,value:function(){var n,o=Array.from(arguments),r=o[0]<0?t.length+o[0]:o[0],a=o[1],s=!!o[2]&&o.slice(2);if(!i.blocked&&e===i.currentVersion){if(s&&((n=!!t[r]&&i.table.rowManager.getRowFromDataObject(t[r]))?s.forEach((function(t){i.table.rowManager.addRowActual(t,!0,n,!0)})):(s=s.slice().reverse()).forEach((function(t){i.table.rowManager.addRowActual(t,!0,!1,!0)}))),0!==a){var l=t.slice(r,void 0===o[1]?o[1]:r+a);l.forEach((function(t,e){var n=i.table.rowManager.getRowFromDataObject(t);n&&n.deleteActual(e!==l.length-1)}))}(s||0!==a)&&i.table.rowManager.reRenderInPosition()}return i.origFuncs.splice.apply(t,arguments)}})},H.prototype.unwatchData=function(){if(!1!==this.data)for(var t in this.origFuncs)Object.defineProperty(this.data,t,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})},H.prototype.watchRow=function(t){var e=t.getData();for(var i in this.blocked=!0,e)this.watchKey(t,e,i);this.blocked=!1},H.prototype.watchKey=function(t,e,i){var n=this,o=Object.getOwnPropertyDescriptor(e,i),r=e[i],a=this.currentVersion;Object.defineProperty(e,i,{set:function(e){if(r=e,!n.blocked&&a===n.currentVersion){var s={};s[i]=e,t.updateData(s)}o.set&&o.set(e)},get:function(){return o.get&&o.get(),r}})},H.prototype.unwatchRow=function(t){var e=t.getData();for(var i in e)Object.defineProperty(e,i,{value:e[i]})},H.prototype.block=function(){this.blocked=!0},H.prototype.unblock=function(){this.blocked=!1},h.prototype.registerModule("reactiveData",H);var B=function(t){this.table=t,this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.handle=null,this.prevHandle=null};B.prototype.initializeColumn=function(t,e,i){var n=this,o=!1,r=this.table.options.resizableColumns;if("header"===t&&(o="textarea"==e.definition.formatter||e.definition.variableHeight,e.modules.resize={variableHeight:o}),!0===r||r==t){var a=document.createElement("div");a.className="tabulator-col-resize-handle";var s=document.createElement("div");s.className="tabulator-col-resize-handle prev",a.addEventListener("click",(function(t){t.stopPropagation()}));var l=function(t){var i=e.getLastColumn();i&&n._checkResizability(i)&&(n.startColumn=e,n._mouseDown(t,i,a))};a.addEventListener("mousedown",l),a.addEventListener("touchstart",l,{passive:!0}),a.addEventListener("dblclick",(function(t){var i=e.getLastColumn();i&&n._checkResizability(i)&&(t.stopPropagation(),i.reinitializeWidth(!0))})),s.addEventListener("click",(function(t){t.stopPropagation()}));var u=function(t){var i,o,r;(i=e.getFirstColumn())&&(r=(o=n.table.columnManager.findColumnIndex(i))>0&&n.table.columnManager.getColumnByIndex(o-1))&&n._checkResizability(r)&&(n.startColumn=e,n._mouseDown(t,r,s))};s.addEventListener("mousedown",u),s.addEventListener("touchstart",u,{passive:!0}),s.addEventListener("dblclick",(function(t){var i,o,r;(i=e.getFirstColumn())&&(r=(o=n.table.columnManager.findColumnIndex(i))>0&&n.table.columnManager.getColumnByIndex(o-1))&&n._checkResizability(r)&&(t.stopPropagation(),r.reinitializeWidth(!0))})),i.appendChild(a),i.appendChild(s)}},B.prototype._checkResizability=function(t){return void 0!==t.definition.resizable?t.definition.resizable:this.table.options.resizableColumns},B.prototype._mouseDown=function(t,e,i){var n=this;function o(t){e.setWidth(n.startWidth+((void 0===t.screenX?t.touches[0].screenX:t.screenX)-n.startX)),!n.table.browserSlow&&e.modules.resize&&e.modules.resize.variableHeight&&e.checkCellHeights()}function r(t){n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!1),n.table.browserSlow&&e.modules.resize&&e.modules.resize.variableHeight&&e.checkCellHeights(),document.body.removeEventListener("mouseup",r),document.body.removeEventListener("mousemove",o),i.removeEventListener("touchmove",o),i.removeEventListener("touchend",r),n.table.element.classList.remove("tabulator-block-select"),n.table.options.persistence&&n.table.modExists("persistence",!0)&&n.table.modules.persistence.config.columns&&n.table.modules.persistence.save("columns"),n.table.options.columnResized.call(n.table,e.getComponent())}n.table.element.classList.add("tabulator-block-select"),t.stopPropagation(),n.startColumn.modules.edit&&(n.startColumn.modules.edit.blocked=!0),n.startX=void 0===t.screenX?t.touches[0].screenX:t.screenX,n.startWidth=e.getWidth(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",r),i.addEventListener("touchmove",o,{passive:!0}),i.addEventListener("touchend",r)},h.prototype.registerModule("resizeColumns",B);var G=function(t){this.table=t,this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null};G.prototype.initializeRow=function(t){var e=this,i=t.getElement(),n=document.createElement("div");n.className="tabulator-row-resize-handle";var o=document.createElement("div");o.className="tabulator-row-resize-handle prev",n.addEventListener("click",(function(t){t.stopPropagation()}));var r=function(i){e.startRow=t,e._mouseDown(i,t,n)};n.addEventListener("mousedown",r),n.addEventListener("touchstart",r,{passive:!0}),o.addEventListener("click",(function(t){t.stopPropagation()}));var a=function(i){var n=e.table.rowManager.prevDisplayRow(t);n&&(e.startRow=n,e._mouseDown(i,n,o))};o.addEventListener("mousedown",a),o.addEventListener("touchstart",a,{passive:!0}),i.appendChild(n),i.appendChild(o)},G.prototype._mouseDown=function(t,e,i){var n=this;function o(t){e.setHeight(n.startHeight+((void 0===t.screenY?t.touches[0].screenY:t.screenY)-n.startY))}function r(t){document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",o),i.removeEventListener("touchmove",o),i.removeEventListener("touchend",r),n.table.element.classList.remove("tabulator-block-select"),n.table.options.rowResized.call(this.table,e.getComponent())}n.table.element.classList.add("tabulator-block-select"),t.stopPropagation(),n.startY=void 0===t.screenY?t.touches[0].screenY:t.screenY,n.startHeight=e.getHeight(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",r),i.addEventListener("touchmove",o,{passive:!0}),i.addEventListener("touchend",r)},h.prototype.registerModule("resizeRows",G);var V=function(t){this.table=t,this.binding=!1,this.observer=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1};V.prototype.initialize=function(t){var e,i=this,n=this.table;this.tableHeight=n.element.clientHeight,this.tableWidth=n.element.clientWidth,n.element.parentNode&&(this.containerHeight=n.element.parentNode.clientHeight,this.containerWidth=n.element.parentNode.clientWidth),"undefined"!=typeof ResizeObserver&&"virtual"===n.rowManager.getRenderMode()?(this.autoResize=!0,this.observer=new ResizeObserver((function(t){if(!n.browserMobile||n.browserMobile&&!n.modules.edit.currentCell){var e=Math.floor(t[0].contentRect.height),o=Math.floor(t[0].contentRect.width);i.tableHeight==e&&i.tableWidth==o||(i.tableHeight=e,i.tableWidth=o,n.element.parentNode&&(i.containerHeight=n.element.parentNode.clientHeight,i.containerWidth=n.element.parentNode.clientWidth),n.redraw())}})),this.observer.observe(n.element),e=window.getComputedStyle(n.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(e.getPropertyValue("max-height")||e.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver((function(t){if(!n.browserMobile||n.browserMobile&&!n.modules.edit.currentCell){var e=Math.floor(t[0].contentRect.height),o=Math.floor(t[0].contentRect.width);i.containerHeight==e&&i.containerWidth==o||(i.containerHeight=e,i.containerWidth=o,i.tableHeight=n.element.clientHeight,i.tableWidth=n.element.clientWidth,n.redraw()),n.redraw()}})),this.containerObserver.observe(this.table.element.parentNode))):(this.binding=function(){(!n.browserMobile||n.browserMobile&&!n.modules.edit.currentCell)&&n.redraw()},window.addEventListener("resize",this.binding))},V.prototype.clearBindings=function(t){this.binding&&window.removeEventListener("resize",this.binding),this.observer&&this.observer.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)},h.prototype.registerModule("resizeTable",V);var W=function(t){this.table=t,this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1};W.prototype.initialize=function(){var t=this,e=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach((function(i,n){i.modules.responsive&&i.modules.responsive.order&&i.modules.responsive.visible&&(i.modules.responsive.index=n,e.push(i),i.visible||"collapse"!==t.mode||t.hiddenColumns.push(i))})),e=(e=e.reverse()).sort((function(t,e){return e.modules.responsive.order-t.modules.responsive.order||e.modules.responsive.index-t.modules.responsive.index})),this.columns=e,"collapse"===this.mode&&this.generateCollapsedContent();var i=this.table.columnManager.columnsByIndex,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var r;if(n){if(o>=i.length)break;r=i[o++]}else{if((o=i.next()).done)break;r=o.value}var a=r;if("responsiveCollapse"==a.definition.formatter){this.collapseHandleColumn=a;break}}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())},W.prototype.initializeColumn=function(t){var e=t.getDefinition();t.modules.responsive={order:void 0===e.responsive?1:e.responsive,visible:!1!==e.visible}},W.prototype.initializeRow=function(t){var e;"calc"!==t.type&&((e=document.createElement("div")).classList.add("tabulator-responsive-collapse"),t.modules.responsiveLayout={element:e,open:this.collapseStartOpen},this.collapseStartOpen||(e.style.display="none"))},W.prototype.layoutRow=function(t){var e=t.getElement();t.modules.responsiveLayout&&(e.appendChild(t.modules.responsiveLayout.element),this.generateCollapsedRowContent(t))},W.prototype.updateColumnVisibility=function(t,e){t.modules.responsive&&(t.modules.responsive.visible=e,this.initialize())},W.prototype.hideColumn=function(t){var e=this.hiddenColumns.length;t.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(t),this.generateCollapsedContent(),this.collapseHandleColumn&&!e&&this.collapseHandleColumn.show())},W.prototype.showColumn=function(t){var e;t.show(!1,!0),t.setWidth(t.getWidth()),"collapse"===this.mode&&((e=this.hiddenColumns.indexOf(t))>-1&&this.hiddenColumns.splice(e,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())},W.prototype.update=function(){for(var t=!0;t;){var e="fitColumns"==this.table.modules.layout.getMode()?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),i=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-e;if(i<0){var n=this.columns[this.index];n?(this.hideColumn(n),this.index++):t=!1}else{var o=this.columns[this.index-1];o&&i>0&&i>=o.getWidth()?(this.showColumn(o),this.index--):t=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}},W.prototype.generateCollapsedContent=function(){var t=this;this.table.rowManager.getDisplayRows().forEach((function(e){t.generateCollapsedRowContent(e)}))},W.prototype.generateCollapsedRowContent=function(t){var e,i;if(t.modules.responsiveLayout){for(e=t.modules.responsiveLayout.element;e.firstChild;)e.removeChild(e.firstChild);(i=this.collapseFormatter(this.generateCollapsedRowData(t)))&&e.appendChild(i)}},W.prototype.generateCollapsedRowData=function(t){var e,i=this,n=t.getData(),o=[];return this.hiddenColumns.forEach((function(r){var a=r.getFieldValue(n);r.definition.title&&r.field&&(r.modules.format&&i.table.options.responsiveLayoutCollapseUseFormatters?(e={value:!1,data:{},getValue:function(){return a},getData:function(){return n},getElement:function(){return document.createElement("div")},getRow:function(){return t.getComponent()},getColumn:function(){return r.getComponent()}},o.push({title:r.definition.title,value:r.modules.format.formatter.call(i.table.modules.format,e,r.modules.format.params)})):o.push({title:r.definition.title,value:a}))})),o},W.prototype.formatCollapsedData=function(t){var e=document.createElement("table"),i="";return t.forEach((function(t){var e=document.createElement("div");t.value instanceof Node&&(e.appendChild(t.value),t.value=e.innerHTML),i+="<tr><td><strong>"+t.title+"</strong></td><td>"+t.value+"</td></tr>"})),e.innerHTML=i,Object.keys(t).length?e:""},h.prototype.registerModule("responsiveLayout",W);var q=function(t){this.table=t,this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null};q.prototype.clearSelectionData=function(t){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],t||this._rowSelectionChanged()},q.prototype.initializeRow=function(t){var e=this,i=t.getElement(),n=function t(){setTimeout((function(){e.selecting=!1}),50),document.body.removeEventListener("mouseup",t)};t.modules.select={selected:!1},e.table.options.selectableCheck.call(this.table,t.getComponent())?(i.classList.add("tabulator-selectable"),i.classList.remove("tabulator-unselectable"),e.table.options.selectable&&"highlight"!=e.table.options.selectable&&("click"===e.table.options.selectableRangeMode?i.addEventListener("click",(function(i){if(i.shiftKey){e.table._clearSelection(),e.lastClickedRow=e.lastClickedRow||t;var n=e.table.rowManager.getDisplayRowIndex(e.lastClickedRow),o=e.table.rowManager.getDisplayRowIndex(t),r=n<=o?n:o,a=n>=o?n:o,s=e.table.rowManager.getDisplayRows().slice(0).splice(r,a-r+1);i.ctrlKey||i.metaKey?(s.forEach((function(i){i!==e.lastClickedRow&&(!0===e.table.options.selectable||e.isRowSelected(t)||e.selectedRows.length<e.table.options.selectable)&&e.toggleRow(i)})),e.lastClickedRow=t):(e.deselectRows(void 0,!0),!0!==e.table.options.selectable&&s.length>e.table.options.selectable&&(s=s.slice(0,e.table.options.selectable)),e.selectRows(s)),e.table._clearSelection()}else i.ctrlKey||i.metaKey?(e.toggleRow(t),e.lastClickedRow=t):(e.deselectRows(void 0,!0),e.selectRows(t),e.lastClickedRow=t)})):(i.addEventListener("click",(function(i){e.table.modExists("edit")&&e.table.modules.edit.getCurrentCell()||e.table._clearSelection(),e.selecting||e.toggleRow(t)})),i.addEventListener("mousedown",(function(i){if(i.shiftKey)return e.table._clearSelection(),e.selecting=!0,e.selectPrev=[],document.body.addEventListener("mouseup",n),document.body.addEventListener("keyup",n),e.toggleRow(t),!1})),i.addEventListener("mouseenter",(function(i){e.selecting&&(e.table._clearSelection(),e.toggleRow(t),e.selectPrev[1]==t&&e.toggleRow(e.selectPrev[0]))})),i.addEventListener("mouseout",(function(i){e.selecting&&(e.table._clearSelection(),e.selectPrev.unshift(t))}))))):(i.classList.add("tabulator-unselectable"),i.classList.remove("tabulator-selectable"))},q.prototype.toggleRow=function(t){this.table.options.selectableCheck.call(this.table,t.getComponent())&&(t.modules.select&&t.modules.select.selected?this._deselectRow(t):this._selectRow(t))},q.prototype.selectRows=function(t){var e,i=this;switch(void 0===t?"undefined":s(t)){case"undefined":this.table.rowManager.rows.forEach((function(t){i._selectRow(t,!0,!0)})),this._rowSelectionChanged();break;case"string":(e=this.table.rowManager.findRow(t))?this._selectRow(e,!0,!0):this.table.rowManager.getRows(t).forEach((function(t){i._selectRow(t,!0,!0)})),this._rowSelectionChanged();break;default:Array.isArray(t)?(t.forEach((function(t){i._selectRow(t,!0,!0)})),this._rowSelectionChanged()):this._selectRow(t,!1,!0)}},q.prototype._selectRow=function(t,e,i){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!i&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var n=this.table.rowManager.findRow(t);n?-1==this.selectedRows.indexOf(n)&&(n.modules.select||(n.modules.select={}),n.modules.select.selected=!0,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!0),n.getElement().classList.add("tabulator-selected"),this.selectedRows.push(n),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!0),e||this.table.options.rowSelected.call(this.table,n.getComponent()),this._rowSelectionChanged(e)):e||console.warn("Selection Error - No such row found, ignoring selection:"+t)},q.prototype.isRowSelected=function(t){return-1!==this.selectedRows.indexOf(t)},q.prototype.deselectRows=function(t,e){var i,n=this;if(void 0===t){i=n.selectedRows.length;for(var o=0;o<i;o++)n._deselectRow(n.selectedRows[0],!0);n._rowSelectionChanged(e)}else Array.isArray(t)?(t.forEach((function(t){n._deselectRow(t,!0)})),n._rowSelectionChanged(e)):n._deselectRow(t,e)},q.prototype._deselectRow=function(t,e){var i,n=this.table.rowManager.findRow(t);n?(i=this.selectedRows.findIndex((function(t){return t==n})))>-1&&(n.modules.select||(n.modules.select={}),n.modules.select.selected=!1,n.modules.select.checkboxEl&&(n.modules.select.checkboxEl.checked=!1),n.getElement().classList.remove("tabulator-selected"),this.selectedRows.splice(i,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(n,!1),e||this.table.options.rowDeselected.call(this.table,n.getComponent()),this._rowSelectionChanged(e)):e||console.warn("Deselection Error - No such row found, ignoring selection:"+t)},q.prototype.getSelectedData=function(){var t=[];return this.selectedRows.forEach((function(e){t.push(e.getData())})),t},q.prototype.getSelectedRows=function(){var t=[];return this.selectedRows.forEach((function(e){t.push(e.getComponent())})),t},q.prototype._rowSelectionChanged=function(t){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),t||this.table.options.rowSelectionChanged.call(this.table,this.getSelectedData(),this.getSelectedRows())},q.prototype.registerRowSelectCheckbox=function(t,e){t._row.modules.select||(t._row.modules.select={}),t._row.modules.select.checkboxEl=e},q.prototype.registerHeaderSelectCheckbox=function(t){this.headerCheckboxElement=t},q.prototype.childRowSelection=function(t,e){var i=this.table.modules.dataTree.getChildren(t);if(e){var n=i,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(r>=n.length)break;a=n[r++]}else{if((r=n.next()).done)break;a=r.value}var s=a;this._selectRow(s,!0)}}else{var l=i,u=Array.isArray(l),c=0;for(l=u?l:l[Symbol.iterator]();;){var h;if(u){if(c>=l.length)break;h=l[c++]}else{if((c=l.next()).done)break;h=c.value}var d=h;this._deselectRow(d,!0)}}},h.prototype.registerModule("selectRow",q);var $=function(t){this.table=t,this.sortList=[],this.changed=!1};$.prototype.initializeColumn=function(t,e){var i,n,o=this,r=!1;switch(s(t.definition.sorter)){case"string":o.sorters[t.definition.sorter]?r=o.sorters[t.definition.sorter]:console.warn("Sort Error - No such sorter found: ",t.definition.sorter);break;case"function":r=t.definition.sorter}t.modules.sort={sorter:r,dir:"none",params:t.definition.sorterParams||{},startingDir:t.definition.headerSortStartingDir||"asc",tristate:void 0!==t.definition.headerSortTristate?t.definition.headerSortTristate:this.table.options.headerSortTristate},(void 0===t.definition.headerSort?!1!==this.table.options.headerSort:!1!==t.definition.headerSort)&&((i=t.getElement()).classList.add("tabulator-sortable"),(n=document.createElement("div")).classList.add("tabulator-arrow"),e.appendChild(n),i.addEventListener("click",(function(e){var i="",n=[],r=!1;if(t.modules.sort){if(t.modules.sort.tristate)i="none"==t.modules.sort.dir?t.modules.sort.startingDir:t.modules.sort.dir==t.modules.sort.startingDir?"asc"==t.modules.sort.dir?"desc":"asc":"none";else switch(t.modules.sort.dir){case"asc":i="desc";break;case"desc":i="asc";break;default:i=t.modules.sort.startingDir}o.table.options.columnHeaderSortMulti&&(e.shiftKey||e.ctrlKey)?((r=(n=o.getSort()).findIndex((function(e){return e.field===t.getField()})))>-1?(n[r].dir=i,r!=n.length-1&&(r=n.splice(r,1)[0],"none"!=i&&n.push(r))):"none"!=i&&n.push({column:t,dir:i}),o.setSort(n)):"none"==i?o.clear():o.setSort(t,i),o.table.rowManager.sorterRefresh(!o.sortList.length)}})))},$.prototype.hasChanged=function(){var t=this.changed;return this.changed=!1,t},$.prototype.getSort=function(){var t=[];return this.sortList.forEach((function(e){e.column&&t.push({column:e.column.getComponent(),field:e.column.getField(),dir:e.dir})})),t},$.prototype.setSort=function(t,e){var i=this,n=[];Array.isArray(t)||(t=[{column:t,dir:e}]),t.forEach((function(t){var e;(e=i.table.columnManager.findColumn(t.column))?(t.column=e,n.push(t),i.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",t.column)})),i.sortList=n,this.table.options.persistence&&this.table.modExists("persistence",!0)&&this.table.modules.persistence.config.sort&&this.table.modules.persistence.save("sort")},$.prototype.clear=function(){this.setSort([])},$.prototype.findSorter=function(t){var e,i=this.table.rowManager.activeRows[0],n="string";if(i&&(i=i.getData(),t.getField()))switch(void 0===(e=t.getFieldValue(i))?"undefined":s(e)){case"undefined":n="string";break;case"boolean":n="boolean";break;default:isNaN(e)||""===e?e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(n="alphanum"):n="number"}return this.sorters[n]},$.prototype.sort=function(t){var e,i=this;e=this.table.options.sortOrderReverse?i.sortList.slice().reverse():i.sortList,i.table.options.dataSorting&&i.table.options.dataSorting.call(i.table,i.getSort()),i.clearColumnHeaders(),i.table.options.ajaxSorting?e.forEach((function(t,e){i.setColumnHeader(t.column,t.dir)})):e.forEach((function(n,o){n.column&&n.column.modules.sort&&(n.column.modules.sort.sorter||(n.column.modules.sort.sorter=i.findSorter(n.column)),i._sortItem(t,n.column,n.dir,e,o)),i.setColumnHeader(n.column,n.dir)})),i.table.options.dataSorted&&i.table.options.dataSorted.call(i.table,i.getSort(),i.table.rowManager.getComponents("active"))},$.prototype.clearColumnHeaders=function(){this.table.columnManager.getRealColumns().forEach((function(t){t.modules.sort&&(t.modules.sort.dir="none",t.getElement().setAttribute("aria-sort","none"))}))},$.prototype.setColumnHeader=function(t,e){t.modules.sort.dir=e,t.getElement().setAttribute("aria-sort",e)},$.prototype._sortItem=function(t,e,i,n,o){var r=this,a="function"==typeof e.modules.sort.params?e.modules.sort.params(e.getComponent(),i):e.modules.sort.params;t.sort((function(t,s){var l=r._sortRow(t,s,e,i,a);if(0===l&&o)for(var u=o-1;u>=0&&0===(l=r._sortRow(t,s,n[u].column,n[u].dir,a));u--);return l}))},$.prototype._sortRow=function(t,e,i,n,o){var r,a,s="asc"==n?t:e,l="asc"==n?e:t;return t=void 0!==(t=i.getFieldValue(s.getData()))?t:"",e=void 0!==(e=i.getFieldValue(l.getData()))?e:"",r=s.getComponent(),a=l.getComponent(),i.modules.sort.sorter.call(this,t,e,r,a,i.getComponent(),n,o)},$.prototype.sorters={number:function(t,e,i,n,o,r,a){var s=a.alignEmptyValues,l=a.decimalSeparator||".",u=a.thousandSeparator||",",c=0;if(t=parseFloat(String(t).split(u).join("").split(l).join(".")),e=parseFloat(String(e).split(u).join("").split(l).join(".")),isNaN(t))c=isNaN(e)?0:-1;else{if(!isNaN(e))return t-e;c=1}return("top"===s&&"desc"===r||"bottom"===s&&"asc"===r)&&(c*=-1),c},string:function(t,e,i,n,o,r,a){var l,u=a.alignEmptyValues,c=0;if(t){if(e){switch(s(a.locale)){case"boolean":a.locale&&(l=this.table.modules.localize.getLocale());break;case"string":l=a.locale}return String(t).toLowerCase().localeCompare(String(e).toLowerCase(),l)}c=1}else c=e?-1:0;return("top"===u&&"desc"===r||"bottom"===u&&"asc"===r)&&(c*=-1),c},date:function(t,e,i,n,o,r,a){return a.format||(a.format="DD/MM/YYYY"),this.sorters.datetime.call(this,t,e,i,n,o,r,a)},time:function(t,e,i,n,o,r,a){return a.format||(a.format="hh:mm"),this.sorters.datetime.call(this,t,e,i,n,o,r,a)},datetime:function(t,e,i,n,o,r,a){var s=a.format||"DD/MM/YYYY hh:mm:ss",l=a.alignEmptyValues,u=0;if("undefined"!=typeof moment){if(t=moment(t,s),e=moment(e,s),t.isValid()){if(e.isValid())return t-e;u=1}else u=e.isValid()?-1:0;return("top"===l&&"desc"===r||"bottom"===l&&"asc"===r)&&(u*=-1),u}console.error("Sort Error - 'datetime' sorter is dependant on moment.js")},boolean:function(t,e,i,n,o,r,a){return(!0===t||"true"===t||"True"===t||1===t?1:0)-(!0===e||"true"===e||"True"===e||1===e?1:0)},array:function(t,e,i,n,o,r,a){var s=a.type||"length",l=a.alignEmptyValues,u=0;function c(t){switch(s){case"length":return t.length;case"sum":return t.reduce((function(t,e){return t+e}));case"max":return Math.max.apply(null,t);case"min":return Math.min.apply(null,t);case"avg":return t.reduce((function(t,e){return t+e}))/t.length}}if(Array.isArray(t)){if(Array.isArray(e))return(t?c(t):0)-(e?c(e):0);l=1}else l=Array.isArray(e)?-1:0;return("top"===l&&"desc"===r||"bottom"===l&&"asc"===r)&&(u*=-1),u},exists:function(t,e,i,n,o,r,a){return(void 0===t?0:1)-(void 0===e?0:1)},alphanum:function(t,e,i,n,o,r,a){var s,l,u,c,h,d=0,p=/(\d+)|(\D+)/g,f=/\d/,g=a.alignEmptyValues,m=0;if(t||0===t){if(e||0===e){if(isFinite(t)&&isFinite(e))return t-e;if((s=String(t).toLowerCase())===(l=String(e).toLowerCase()))return 0;if(!f.test(s)||!f.test(l))return s>l?1:-1;for(s=s.match(p),l=l.match(p),h=s.length>l.length?l.length:s.length;d<h;)if((u=s[d])!==(c=l[d++]))return isFinite(u)&&isFinite(c)?("0"===u.charAt(0)&&(u="."+u),"0"===c.charAt(0)&&(c="."+c),u-c):u>c?1:-1;return s.length>l.length}m=1}else m=e||0===e?-1:0;return("top"===g&&"desc"===r||"bottom"===g&&"asc"===r)&&(m*=-1),m}},h.prototype.registerModule("sort",$);var Y=function(t){this.table=t};return Y.prototype.initializeColumn=function(t){var e,i=this,n=[];t.definition.validator&&(Array.isArray(t.definition.validator)?t.definition.validator.forEach((function(t){(e=i._extractValidator(t))&&n.push(e)})):(e=this._extractValidator(t.definition.validator))&&n.push(e),t.modules.validate=!!n.length&&n)},Y.prototype._extractValidator=function(t){var e,i,n;switch(void 0===t?"undefined":s(t)){case"string":return(n=t.indexOf(":"))>-1?(e=t.substring(0,n),i=t.substring(n+1)):e=t,this._buildValidator(e,i);case"function":return this._buildValidator(t);case"object":return this._buildValidator(t.type,t.parameters)}},Y.prototype._buildValidator=function(t,e){var i="function"==typeof t?t:this.validators[t];return i?{type:"function"==typeof t?"function":t,func:i,params:e}:(console.warn("Validator Setup Error - No matching validator found:",t),!1)},Y.prototype.validate=function(t,e,i){var n=this,o=[];return t&&t.forEach((function(t){t.func.call(n,e,i,t.params)||o.push({type:t.type,parameters:t.params})})),!o.length||o},Y.prototype.validators={integer:function(t,e,i){return""===e||null==e||"number"==typeof(e=Number(e))&&isFinite(e)&&Math.floor(e)===e},float:function(t,e,i){return""===e||null==e||"number"==typeof(e=Number(e))&&isFinite(e)&&e%1!=0},numeric:function(t,e,i){return""===e||null==e||!isNaN(e)},string:function(t,e,i){return""===e||null==e||isNaN(e)},max:function(t,e,i){return""===e||null==e||parseFloat(e)<=i},min:function(t,e,i){return""===e||null==e||parseFloat(e)>=i},minLength:function(t,e,i){return""===e||null==e||String(e).length>=i},maxLength:function(t,e,i){return""===e||null==e||String(e).length<=i},in:function(t,e,i){return""===e||null==e||("string"==typeof i&&(i=i.split("|")),""===e||i.indexOf(e)>-1)},regex:function(t,e,i){return""===e||null==e||new RegExp(i).test(e)},unique:function(t,e,i){if(""===e||null==e)return!0;var n=!0,o=t.getData(),r=t.getColumn()._getSelf();return this.table.rowManager.rows.forEach((function(t){var i=t.getData();i!==o&&e==r.getFieldValue(i)&&(n=!1)})),n},required:function(t,e,i){return""!==e&&null!=e}},h.prototype.registerModule("validate",Y),h},"object"===s(i)&&void 0!==t?t.exports=a():void 0===(r="function"==typeof(o=a)?o.call(i,n,i,t):o)||(t.exports=r)},function(t,e,i){"use strict";var n=i(65);function o(t){this.message=t}o.prototype=new Error,o.prototype.name="InvalidTokenError",t.exports=function(t,e){if("string"!=typeof t)throw new o("Invalid token specified");var i=!0===(e=e||{}).header?0:1;try{return JSON.parse(n(t.split(".")[i]))}catch(t){throw new o("Invalid token specified: "+t.message)}},t.exports.InvalidTokenError=o},function(t,e,i){var n=i(72);t.exports=function(t){return n(t,5)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,i){var n=i(8),o=i(4);t.exports=function(t){if(!o(t))return!1;var e=n(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i(85))},function(t,e){var i=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,i){var n=i(34),o=i(29),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){var a=t[e];r.call(t,e)&&o(a,i)&&(void 0!==i||e in t)||n(t,e,i)}},function(t,e,i){var n=i(105);t.exports=function(t,e,i){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}},function(t,e,i){var n=i(107),o=i(108),r=i(18),a=i(36),s=i(111),l=i(112),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var i=r(t),c=!i&&o(t),h=!i&&!c&&a(t),d=!i&&!c&&!h&&l(t),p=i||c||h||d,f=p?n(t.length,String):[],g=f.length;for(var m in t)!e&&!u.call(t,m)||p&&("length"==m||h&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g))||f.push(m);return f}},function(t,e,i){(function(t){var n=i(0),o=i(110),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===r?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||o;t.exports=l}).call(this,i(19)(t))},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t,e){return function(i){return t(e(i))}}},function(t,e,i){var n=i(30),o=i(37);t.exports=function(t){return null!=t&&o(t.length)&&!n(t)}},function(t,e,i){var n=i(35),o=i(117),r=i(39);t.exports=function(t){return r(t)?n(t,!0):o(t)}},function(t,e){t.exports=function(){return[]}},function(t,e,i){var n=i(43),o=i(44),r=i(23),a=i(41),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)n(e,r(t)),t=o(t);return e}:a;t.exports=s},function(t,e){t.exports=function(t,e){for(var i=-1,n=e.length,o=t.length;++i<n;)t[o+i]=e[i];return t}},function(t,e,i){var n=i(38)(Object.getPrototypeOf,Object);t.exports=n},function(t,e,i){var n=i(43),o=i(18);t.exports=function(t,e,i){var r=e(t);return o(t)?r:n(r,i(t))}},function(t,e,i){
/* flatpickr v4.6.3, @license MIT */
t.exports=function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=function(){return(t=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},e=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],i={_disable:[],_enable:[],allowInput:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enable:[],enableSeconds:!1,enableTime:!1,errorHandler:function(t){return"undefined"!=typeof console&&console.warn(t)},getWeek:function(t){var e=new Date(t.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var i=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},n={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(t){var e=t%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},o=function(t){return("0"+t).slice(-2)},r=function(t){return!0===t?1:0};function a(t,e,i){var n;return void 0===i&&(i=!1),function(){var o=this,r=arguments;null!==n&&clearTimeout(n),n=window.setTimeout((function(){n=null,i||t.apply(o,r)}),e),i&&!n&&t.apply(o,r)}}var s=function(t){return t instanceof Array?t:[t]};function l(t,e,i){if(!0===i)return t.classList.add(e);t.classList.remove(e)}function u(t,e,i){var n=window.document.createElement(t);return e=e||"",i=i||"",n.className=e,void 0!==i&&(n.textContent=i),n}function c(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function h(t,e){var i=u("div","numInputWrapper"),n=u("input","numInput "+t),o=u("span","arrowUp"),r=u("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?n.type="number":(n.type="text",n.pattern="\\d*"),void 0!==e)for(var a in e)n.setAttribute(a,e[a]);return i.appendChild(n),i.appendChild(o),i.appendChild(r),i}var d=function(){},p=function(t,e,i){return i.months[e?"shorthand":"longhand"][t]},f={D:d,F:function(t,e,i){t.setMonth(i.months.longhand.indexOf(e))},G:function(t,e){t.setHours(parseFloat(e))},H:function(t,e){t.setHours(parseFloat(e))},J:function(t,e){t.setDate(parseFloat(e))},K:function(t,e,i){t.setHours(t.getHours()%12+12*r(new RegExp(i.amPM[1],"i").test(e)))},M:function(t,e,i){t.setMonth(i.months.shorthand.indexOf(e))},S:function(t,e){t.setSeconds(parseFloat(e))},U:function(t,e){return new Date(1e3*parseFloat(e))},W:function(t,e,i){var n=parseInt(e),o=new Date(t.getFullYear(),0,2+7*(n-1),0,0,0,0);return o.setDate(o.getDate()-o.getDay()+i.firstDayOfWeek),o},Y:function(t,e){t.setFullYear(parseFloat(e))},Z:function(t,e){return new Date(e)},d:function(t,e){t.setDate(parseFloat(e))},h:function(t,e){t.setHours(parseFloat(e))},i:function(t,e){t.setMinutes(parseFloat(e))},j:function(t,e){t.setDate(parseFloat(e))},l:d,m:function(t,e){t.setMonth(parseFloat(e)-1)},n:function(t,e){t.setMonth(parseFloat(e)-1)},s:function(t,e){t.setSeconds(parseFloat(e))},u:function(t,e){return new Date(parseFloat(e))},w:d,y:function(t,e){t.setFullYear(2e3+parseFloat(e))}},g={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},m={Z:function(t){return t.toISOString()},D:function(t,e,i){return e.weekdays.shorthand[m.w(t,e,i)]},F:function(t,e,i){return p(m.n(t,e,i)-1,!1,e)},G:function(t,e,i){return o(m.h(t,e,i))},H:function(t){return o(t.getHours())},J:function(t,e){return void 0!==e.ordinal?t.getDate()+e.ordinal(t.getDate()):t.getDate()},K:function(t,e){return e.amPM[r(t.getHours()>11)]},M:function(t,e){return p(t.getMonth(),!0,e)},S:function(t){return o(t.getSeconds())},U:function(t){return t.getTime()/1e3},W:function(t,e,i){return i.getWeek(t)},Y:function(t){return t.getFullYear()},d:function(t){return o(t.getDate())},h:function(t){return t.getHours()%12?t.getHours()%12:12},i:function(t){return o(t.getMinutes())},j:function(t){return t.getDate()},l:function(t,e){return e.weekdays.longhand[t.getDay()]},m:function(t){return o(t.getMonth()+1)},n:function(t){return t.getMonth()+1},s:function(t){return t.getSeconds()},u:function(t){return t.getTime()},w:function(t){return t.getDay()},y:function(t){return String(t.getFullYear()).substring(2)}},v=function(t){var e=t.config,o=void 0===e?i:e,r=t.l10n,a=void 0===r?n:r;return function(t,e,i){var n=i||a;return void 0!==o.formatDate?o.formatDate(t,e,n):e.split("").map((function(e,i,r){return m[e]&&"\\"!==r[i-1]?m[e](t,n,o):"\\"!==e?e:""})).join("")}},y=function(t){var e=t.config,o=void 0===e?i:e,r=t.l10n,a=void 0===r?n:r;return function(t,e,n,r){if(0===t||t){var s,l=r||a,u=t;if(t instanceof Date)s=new Date(t.getTime());else if("string"!=typeof t&&void 0!==t.toFixed)s=new Date(t);else if("string"==typeof t){var c=e||(o||i).dateFormat,h=String(t).trim();if("today"===h)s=new Date,n=!0;else if(/Z$/.test(h)||/GMT$/.test(h))s=new Date(t);else if(o&&o.parseDate)s=o.parseDate(t,c);else{s=o&&o.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);for(var d=void 0,p=[],m=0,v=0,y="";m<c.length;m++){var b=c[m],w="\\"===b,_="\\"===c[m-1]||w;if(g[b]&&!_){y+=g[b];var x=new RegExp(y).exec(t);x&&(d=!0)&&p["Y"!==b?"push":"unshift"]({fn:f[b],val:x[++v]})}else w||(y+=".");p.forEach((function(t){var e=t.fn,i=t.val;return s=e(s,i,l)||s}))}s=d?s:void 0}}if(s instanceof Date&&!isNaN(s.getTime()))return!0===n&&s.setHours(0,0,0,0),s;o.errorHandler(new Error("Invalid date provided: "+u))}}};function b(t,e,i){return void 0===i&&(i=!0),!1!==i?new Date(t.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):t.getTime()-e.getTime()}var w=864e5;function _(d,f){var m={config:t({},i,C.defaultConfig),l10n:n};function _(t){return t.bind(m)}function x(){var t=m.config;!1===t.weekNumbers&&1===t.showMonths||!0!==t.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==m.calendarContainer&&(m.calendarContainer.style.visibility="hidden",m.calendarContainer.style.display="block"),void 0!==m.daysContainer){var e=(m.days.offsetWidth+1)*t.showMonths;m.daysContainer.style.width=e+"px",m.calendarContainer.style.width=e+(void 0!==m.weekWrapper?m.weekWrapper.offsetWidth:0)+"px",m.calendarContainer.style.removeProperty("visibility"),m.calendarContainer.style.removeProperty("display")}}))}function E(t){0===m.selectedDates.length&&it(),void 0!==t&&"blur"!==t.type&&function(t){t.preventDefault();var e="keydown"===t.type,i=t.target;void 0!==m.amPM&&t.target===m.amPM&&(m.amPM.textContent=m.l10n.amPM[r(m.amPM.textContent===m.l10n.amPM[0])]);var n=parseFloat(i.getAttribute("min")),a=parseFloat(i.getAttribute("max")),s=parseFloat(i.getAttribute("step")),l=parseInt(i.value,10),u=t.delta||(e?38===t.which?1:-1:0),c=l+s*u;if(void 0!==i.value&&2===i.value.length){var h=i===m.hourElement,d=i===m.minuteElement;c<n?(c=a+c+r(!h)+(r(h)&&r(!m.amPM)),d&&A(void 0,-1,m.hourElement)):c>a&&(c=i===m.hourElement?c-a-r(!m.amPM):n,d&&A(void 0,1,m.hourElement)),m.amPM&&h&&(1===s?c+l===23:Math.abs(c-l)>s)&&(m.amPM.textContent=m.l10n.amPM[r(m.amPM.textContent===m.l10n.amPM[0])]),i.value=o(c)}}(t);var e=m._input.value;k(),vt(),m._input.value!==e&&m._debouncedChange()}function k(){if(void 0!==m.hourElement&&void 0!==m.minuteElement){var t,e,i=(parseInt(m.hourElement.value.slice(-2),10)||0)%24,n=(parseInt(m.minuteElement.value,10)||0)%60,o=void 0!==m.secondElement?(parseInt(m.secondElement.value,10)||0)%60:0;void 0!==m.amPM&&(t=i,e=m.amPM.textContent,i=t%12+12*r(e===m.l10n.amPM[1]));var a=void 0!==m.config.minTime||m.config.minDate&&m.minDateHasTime&&m.latestSelectedDateObj&&0===b(m.latestSelectedDateObj,m.config.minDate,!0);if(void 0!==m.config.maxTime||m.config.maxDate&&m.maxDateHasTime&&m.latestSelectedDateObj&&0===b(m.latestSelectedDateObj,m.config.maxDate,!0)){var s=void 0!==m.config.maxTime?m.config.maxTime:m.config.maxDate;(i=Math.min(i,s.getHours()))===s.getHours()&&(n=Math.min(n,s.getMinutes())),n===s.getMinutes()&&(o=Math.min(o,s.getSeconds()))}if(a){var l=void 0!==m.config.minTime?m.config.minTime:m.config.minDate;(i=Math.max(i,l.getHours()))===l.getHours()&&(n=Math.max(n,l.getMinutes())),n===l.getMinutes()&&(o=Math.max(o,l.getSeconds()))}T(i,n,o)}}function S(t){var e=t||m.latestSelectedDateObj;e&&T(e.getHours(),e.getMinutes(),e.getSeconds())}function M(){var t=m.config.defaultHour,e=m.config.defaultMinute,i=m.config.defaultSeconds;if(void 0!==m.config.minDate){var n=m.config.minDate.getHours(),o=m.config.minDate.getMinutes();(t=Math.max(t,n))===n&&(e=Math.max(o,e)),t===n&&e===o&&(i=m.config.minDate.getSeconds())}if(void 0!==m.config.maxDate){var r=m.config.maxDate.getHours(),a=m.config.maxDate.getMinutes();(t=Math.min(t,r))===r&&(e=Math.min(a,e)),t===r&&e===a&&(i=m.config.maxDate.getSeconds())}T(t,e,i)}function T(t,e,i){void 0!==m.latestSelectedDateObj&&m.latestSelectedDateObj.setHours(t%24,e,i||0,0),m.hourElement&&m.minuteElement&&!m.isMobile&&(m.hourElement.value=o(m.config.time_24hr?t:(12+t)%12+12*r(t%12==0)),m.minuteElement.value=o(e),void 0!==m.amPM&&(m.amPM.textContent=m.l10n.amPM[r(t>=12)]),void 0!==m.secondElement&&(m.secondElement.value=o(i)))}function R(t){var e=parseInt(t.target.value)+(t.delta||0);(e/1e3>1||"Enter"===t.key&&!/[^\d]/.test(e.toString()))&&K(e)}function P(t,e,i,n){return e instanceof Array?e.forEach((function(e){return P(t,e,i,n)})):t instanceof Array?t.forEach((function(t){return P(t,e,i,n)})):(t.addEventListener(e,i,n),void m._handlers.push({element:t,event:e,handler:i,options:n}))}function D(t){return function(e){1===e.which&&t(e)}}function L(){dt("onChange")}function F(t,e){var i=void 0!==t?m.parseDate(t):m.latestSelectedDateObj||(m.config.minDate&&m.config.minDate>m.now?m.config.minDate:m.config.maxDate&&m.config.maxDate<m.now?m.config.maxDate:m.now),n=m.currentYear,o=m.currentMonth;try{void 0!==i&&(m.currentYear=i.getFullYear(),m.currentMonth=i.getMonth())}catch(t){t.message="Invalid date supplied: "+i,m.config.errorHandler(t)}e&&m.currentYear!==n&&(dt("onYearChange"),G()),!e||m.currentYear===n&&m.currentMonth===o||dt("onMonthChange"),m.redraw()}function O(t){~t.target.className.indexOf("arrow")&&A(t,t.target.classList.contains("arrowUp")?1:-1)}function A(t,e,i){var n=t&&t.target,o=i||n&&n.parentNode&&n.parentNode.firstChild,r=pt("increment");r.delta=e,o&&o.dispatchEvent(r)}function I(t,e,i,n){var o=Z(e,!0),r=u("span","flatpickr-day "+t,e.getDate().toString());return r.dateObj=e,r.$i=n,r.setAttribute("aria-label",m.formatDate(e,m.config.ariaDateFormat)),-1===t.indexOf("hidden")&&0===b(e,m.now)&&(m.todayDateElem=r,r.classList.add("today"),r.setAttribute("aria-current","date")),o?(r.tabIndex=-1,ft(e)&&(r.classList.add("selected"),m.selectedDateElem=r,"range"===m.config.mode&&(l(r,"startRange",m.selectedDates[0]&&0===b(e,m.selectedDates[0],!0)),l(r,"endRange",m.selectedDates[1]&&0===b(e,m.selectedDates[1],!0)),"nextMonthDay"===t&&r.classList.add("inRange")))):r.classList.add("flatpickr-disabled"),"range"===m.config.mode&&function(t){return!("range"!==m.config.mode||m.selectedDates.length<2)&&b(t,m.selectedDates[0])>=0&&b(t,m.selectedDates[1])<=0}(e)&&!ft(e)&&r.classList.add("inRange"),m.weekNumbers&&1===m.config.showMonths&&"prevMonthDay"!==t&&i%7==1&&m.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+m.config.getWeek(e)+"</span>"),dt("onDayCreate",r),r}function j(t){t.focus(),"range"===m.config.mode&&tt(t)}function z(t){for(var e=t>0?0:m.config.showMonths-1,i=t>0?m.config.showMonths:-1,n=e;n!=i;n+=t)for(var o=m.daysContainer.children[n],r=t>0?0:o.children.length-1,a=t>0?o.children.length:-1,s=r;s!=a;s+=t){var l=o.children[s];if(-1===l.className.indexOf("hidden")&&Z(l.dateObj))return l}}function N(t,e){var i=J(document.activeElement||document.body),n=void 0!==t?t:i?document.activeElement:void 0!==m.selectedDateElem&&J(m.selectedDateElem)?m.selectedDateElem:void 0!==m.todayDateElem&&J(m.todayDateElem)?m.todayDateElem:z(e>0?1:-1);return void 0===n?m._input.focus():i?void function(t,e){for(var i=-1===t.className.indexOf("Month")?t.dateObj.getMonth():m.currentMonth,n=e>0?m.config.showMonths:-1,o=e>0?1:-1,r=i-m.currentMonth;r!=n;r+=o)for(var a=m.daysContainer.children[r],s=i-m.currentMonth===r?t.$i+e:e<0?a.children.length-1:0,l=a.children.length,u=s;u>=0&&u<l&&u!=(e>0?l:-1);u+=o){var c=a.children[u];if(-1===c.className.indexOf("hidden")&&Z(c.dateObj)&&Math.abs(t.$i-u)>=Math.abs(e))return j(c)}m.changeMonth(o),N(z(o),0)}(n,e):j(n)}function H(t,e){for(var i=(new Date(t,e,1).getDay()-m.l10n.firstDayOfWeek+7)%7,n=m.utils.getDaysInMonth((e-1+12)%12),o=m.utils.getDaysInMonth(e),r=window.document.createDocumentFragment(),a=m.config.showMonths>1,s=a?"prevMonthDay hidden":"prevMonthDay",l=a?"nextMonthDay hidden":"nextMonthDay",c=n+1-i,h=0;c<=n;c++,h++)r.appendChild(I(s,new Date(t,e-1,c),c,h));for(c=1;c<=o;c++,h++)r.appendChild(I("",new Date(t,e,c),c,h));for(var d=o+1;d<=42-i&&(1===m.config.showMonths||h%7!=0);d++,h++)r.appendChild(I(l,new Date(t,e+1,d%o),d,h));var p=u("div","dayContainer");return p.appendChild(r),p}function B(){if(void 0!==m.daysContainer){c(m.daysContainer),m.weekNumbers&&c(m.weekNumbers);for(var t=document.createDocumentFragment(),e=0;e<m.config.showMonths;e++){var i=new Date(m.currentYear,m.currentMonth,1);i.setMonth(m.currentMonth+e),t.appendChild(H(i.getFullYear(),i.getMonth()))}m.daysContainer.appendChild(t),m.days=m.daysContainer.firstChild,"range"===m.config.mode&&1===m.selectedDates.length&&tt()}}function G(){if(!(m.config.showMonths>1||"dropdown"!==m.config.monthSelectorType)){var t=function(t){return!(void 0!==m.config.minDate&&m.currentYear===m.config.minDate.getFullYear()&&t<m.config.minDate.getMonth()||void 0!==m.config.maxDate&&m.currentYear===m.config.maxDate.getFullYear()&&t>m.config.maxDate.getMonth())};m.monthsDropdownContainer.tabIndex=-1,m.monthsDropdownContainer.innerHTML="";for(var e=0;e<12;e++)if(t(e)){var i=u("option","flatpickr-monthDropdown-month");i.value=new Date(m.currentYear,e).getMonth().toString(),i.textContent=p(e,m.config.shorthandCurrentMonth,m.l10n),i.tabIndex=-1,m.currentMonth===e&&(i.selected=!0),m.monthsDropdownContainer.appendChild(i)}}}function V(){var t,e=u("div","flatpickr-month"),i=window.document.createDocumentFragment();m.config.showMonths>1||"static"===m.config.monthSelectorType?t=u("span","cur-month"):(m.monthsDropdownContainer=u("select","flatpickr-monthDropdown-months"),P(m.monthsDropdownContainer,"change",(function(t){var e=t.target,i=parseInt(e.value,10);m.changeMonth(i-m.currentMonth),dt("onMonthChange")})),G(),t=m.monthsDropdownContainer);var n=h("cur-year",{tabindex:"-1"}),o=n.getElementsByTagName("input")[0];o.setAttribute("aria-label",m.l10n.yearAriaLabel),m.config.minDate&&o.setAttribute("min",m.config.minDate.getFullYear().toString()),m.config.maxDate&&(o.setAttribute("max",m.config.maxDate.getFullYear().toString()),o.disabled=!!m.config.minDate&&m.config.minDate.getFullYear()===m.config.maxDate.getFullYear());var r=u("div","flatpickr-current-month");return r.appendChild(t),r.appendChild(n),i.appendChild(r),e.appendChild(i),{container:e,yearElement:o,monthElement:t}}function W(){c(m.monthNav),m.monthNav.appendChild(m.prevMonthNav),m.config.showMonths&&(m.yearElements=[],m.monthElements=[]);for(var t=m.config.showMonths;t--;){var e=V();m.yearElements.push(e.yearElement),m.monthElements.push(e.monthElement),m.monthNav.appendChild(e.container)}m.monthNav.appendChild(m.nextMonthNav)}function q(){m.weekdayContainer?c(m.weekdayContainer):m.weekdayContainer=u("div","flatpickr-weekdays");for(var t=m.config.showMonths;t--;){var e=u("div","flatpickr-weekdaycontainer");m.weekdayContainer.appendChild(e)}return $(),m.weekdayContainer}function $(){if(m.weekdayContainer){var t=m.l10n.firstDayOfWeek,e=m.l10n.weekdays.shorthand.slice();t>0&&t<e.length&&(e=e.splice(t,e.length).concat(e.splice(0,t)));for(var i=m.config.showMonths;i--;)m.weekdayContainer.children[i].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+e.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function Y(t,e){void 0===e&&(e=!0);var i=e?t:t-m.currentMonth;i<0&&!0===m._hidePrevMonthArrow||i>0&&!0===m._hideNextMonthArrow||(m.currentMonth+=i,(m.currentMonth<0||m.currentMonth>11)&&(m.currentYear+=m.currentMonth>11?1:-1,m.currentMonth=(m.currentMonth+12)%12,dt("onYearChange"),G()),B(),dt("onMonthChange"),gt())}function X(t){return!(!m.config.appendTo||!m.config.appendTo.contains(t))||m.calendarContainer.contains(t)}function U(t){if(m.isOpen&&!m.config.inline){var e="function"==typeof(a=t).composedPath?a.composedPath()[0]:a.target,i=X(e),n=e===m.input||e===m.altInput||m.element.contains(e)||t.path&&t.path.indexOf&&(~t.path.indexOf(m.input)||~t.path.indexOf(m.altInput)),o="blur"===t.type?n&&t.relatedTarget&&!X(t.relatedTarget):!n&&!i&&!X(t.relatedTarget),r=!m.config.ignoredFocusElements.some((function(t){return t.contains(e)}));o&&r&&(void 0!==m.timeContainer&&void 0!==m.minuteElement&&void 0!==m.hourElement&&E(),m.close(),"range"===m.config.mode&&1===m.selectedDates.length&&(m.clear(!1),m.redraw()))}var a}function K(t){if(!(!t||m.config.minDate&&t<m.config.minDate.getFullYear()||m.config.maxDate&&t>m.config.maxDate.getFullYear())){var e=t,i=m.currentYear!==e;m.currentYear=e||m.currentYear,m.config.maxDate&&m.currentYear===m.config.maxDate.getFullYear()?m.currentMonth=Math.min(m.config.maxDate.getMonth(),m.currentMonth):m.config.minDate&&m.currentYear===m.config.minDate.getFullYear()&&(m.currentMonth=Math.max(m.config.minDate.getMonth(),m.currentMonth)),i&&(m.redraw(),dt("onYearChange"),G())}}function Z(t,e){void 0===e&&(e=!0);var i=m.parseDate(t,void 0,e);if(m.config.minDate&&i&&b(i,m.config.minDate,void 0!==e?e:!m.minDateHasTime)<0||m.config.maxDate&&i&&b(i,m.config.maxDate,void 0!==e?e:!m.maxDateHasTime)>0)return!1;if(0===m.config.enable.length&&0===m.config.disable.length)return!0;if(void 0===i)return!1;for(var n=m.config.enable.length>0,o=n?m.config.enable:m.config.disable,r=0,a=void 0;r<o.length;r++){if("function"==typeof(a=o[r])&&a(i))return n;if(a instanceof Date&&void 0!==i&&a.getTime()===i.getTime())return n;if("string"==typeof a&&void 0!==i){var s=m.parseDate(a,void 0,!0);return s&&s.getTime()===i.getTime()?n:!n}if("object"==typeof a&&void 0!==i&&a.from&&a.to&&i.getTime()>=a.from.getTime()&&i.getTime()<=a.to.getTime())return n}return!n}function J(t){return void 0!==m.daysContainer&&-1===t.className.indexOf("hidden")&&m.daysContainer.contains(t)}function Q(t){var e=t.target===m._input,i=m.config.allowInput,n=m.isOpen&&(!i||!e),o=m.config.inline&&e&&!i;if(13===t.keyCode&&e){if(i)return m.setDate(m._input.value,!0,t.target===m.altInput?m.config.altFormat:m.config.dateFormat),t.target.blur();m.open()}else if(X(t.target)||n||o){var r=!!m.timeContainer&&m.timeContainer.contains(t.target);switch(t.keyCode){case 13:r?(t.preventDefault(),E(),st()):lt(t);break;case 27:t.preventDefault(),st();break;case 8:case 46:e&&!m.config.allowInput&&(t.preventDefault(),m.clear());break;case 37:case 39:if(r||e)m.hourElement&&m.hourElement.focus();else if(t.preventDefault(),void 0!==m.daysContainer&&(!1===i||document.activeElement&&J(document.activeElement))){var a=39===t.keyCode?1:-1;t.ctrlKey?(t.stopPropagation(),Y(a),N(z(1),0)):N(void 0,a)}break;case 38:case 40:t.preventDefault();var s=40===t.keyCode?1:-1;m.daysContainer&&void 0!==t.target.$i||t.target===m.input||t.target===m.altInput?t.ctrlKey?(t.stopPropagation(),K(m.currentYear-s),N(z(1),0)):r||N(void 0,7*s):t.target===m.currentYearElement?K(m.currentYear-s):m.config.enableTime&&(!r&&m.hourElement&&m.hourElement.focus(),E(t),m._debouncedChange());break;case 9:if(r){var l=[m.hourElement,m.minuteElement,m.secondElement,m.amPM].concat(m.pluginElements).filter((function(t){return t})),u=l.indexOf(t.target);if(-1!==u){var c=l[u+(t.shiftKey?-1:1)];t.preventDefault(),(c||m._input).focus()}}else!m.config.noCalendar&&m.daysContainer&&m.daysContainer.contains(t.target)&&t.shiftKey&&(t.preventDefault(),m._input.focus())}}if(void 0!==m.amPM&&t.target===m.amPM)switch(t.key){case m.l10n.amPM[0].charAt(0):case m.l10n.amPM[0].charAt(0).toLowerCase():m.amPM.textContent=m.l10n.amPM[0],k(),vt();break;case m.l10n.amPM[1].charAt(0):case m.l10n.amPM[1].charAt(0).toLowerCase():m.amPM.textContent=m.l10n.amPM[1],k(),vt()}(e||X(t.target))&&dt("onKeyDown",t)}function tt(t){if(1===m.selectedDates.length&&(!t||t.classList.contains("flatpickr-day")&&!t.classList.contains("flatpickr-disabled"))){for(var e=t?t.dateObj.getTime():m.days.firstElementChild.dateObj.getTime(),i=m.parseDate(m.selectedDates[0],void 0,!0).getTime(),n=Math.min(e,m.selectedDates[0].getTime()),o=Math.max(e,m.selectedDates[0].getTime()),r=!1,a=0,s=0,l=n;l<o;l+=w)Z(new Date(l),!0)||(r=r||l>n&&l<o,l<i&&(!a||l>a)?a=l:l>i&&(!s||l<s)&&(s=l));for(var u=0;u<m.config.showMonths;u++)for(var c=m.daysContainer.children[u],h=function(n,o){var l,u,h,d=c.children[n],p=d.dateObj.getTime(),f=a>0&&p<a||s>0&&p>s;return f?(d.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((function(t){d.classList.remove(t)})),"continue"):r&&!f?"continue":(["startRange","inRange","endRange","notAllowed"].forEach((function(t){d.classList.remove(t)})),void(void 0!==t&&(t.classList.add(e<=m.selectedDates[0].getTime()?"startRange":"endRange"),i<e&&p===i?d.classList.add("startRange"):i>e&&p===i&&d.classList.add("endRange"),p>=a&&(0===s||p<=s)&&(u=i,h=e,(l=p)>Math.min(u,h)&&l<Math.max(u,h))&&d.classList.add("inRange"))))},d=0,p=c.children.length;d<p;d++)h(d)}}function et(){!m.isOpen||m.config.static||m.config.inline||rt()}function it(){m.setDate(void 0!==m.config.minDate?new Date(m.config.minDate.getTime()):new Date,!0),M(),vt()}function nt(t){return function(e){var i=m.config["_"+t+"Date"]=m.parseDate(e,m.config.dateFormat),n=m.config["_"+("min"===t?"max":"min")+"Date"];void 0!==i&&(m["min"===t?"minDateHasTime":"maxDateHasTime"]=i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0),m.selectedDates&&(m.selectedDates=m.selectedDates.filter((function(t){return Z(t)})),m.selectedDates.length||"min"!==t||S(i),vt()),m.daysContainer&&(at(),void 0!==i?m.currentYearElement[t]=i.getFullYear().toString():m.currentYearElement.removeAttribute(t),m.currentYearElement.disabled=!!n&&void 0!==i&&n.getFullYear()===i.getFullYear())}}function ot(){"object"!=typeof m.config.locale&&void 0===C.l10ns[m.config.locale]&&m.config.errorHandler(new Error("flatpickr: invalid locale "+m.config.locale)),m.l10n=t({},C.l10ns.default,"object"==typeof m.config.locale?m.config.locale:"default"!==m.config.locale?C.l10ns[m.config.locale]:void 0),g.K="("+m.l10n.amPM[0]+"|"+m.l10n.amPM[1]+"|"+m.l10n.amPM[0].toLowerCase()+"|"+m.l10n.amPM[1].toLowerCase()+")",void 0===t({},f,JSON.parse(JSON.stringify(d.dataset||{}))).time_24hr&&void 0===C.defaultConfig.time_24hr&&(m.config.time_24hr=m.l10n.time_24hr),m.formatDate=v(m),m.parseDate=y({config:m.config,l10n:m.l10n})}function rt(t){if(void 0!==m.calendarContainer){dt("onPreCalendarPosition");var e=t||m._positionElement,i=Array.prototype.reduce.call(m.calendarContainer.children,(function(t,e){return t+e.offsetHeight}),0),n=m.calendarContainer.offsetWidth,o=m.config.position.split(" "),r=o[0],a=o.length>1?o[1]:null,s=e.getBoundingClientRect(),u=window.innerHeight-s.bottom,c="above"===r||"below"!==r&&u<i&&s.top>i,h=window.pageYOffset+s.top+(c?-i-2:e.offsetHeight+2);if(l(m.calendarContainer,"arrowTop",!c),l(m.calendarContainer,"arrowBottom",c),!m.config.inline){var d=window.pageXOffset+s.left-(null!=a&&"center"===a?(n-s.width)/2:0),p=window.document.body.offsetWidth-(window.pageXOffset+s.right),f=d+n>window.document.body.offsetWidth,g=p+n>window.document.body.offsetWidth;if(l(m.calendarContainer,"rightMost",f),!m.config.static)if(m.calendarContainer.style.top=h+"px",f)if(g){var v=document.styleSheets[0];if(void 0===v)return;var y=window.document.body.offsetWidth,b=Math.max(0,y/2-n/2),w=v.cssRules.length,_="{left:"+s.left+"px;right:auto;}";l(m.calendarContainer,"rightMost",!1),l(m.calendarContainer,"centerMost",!0),v.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+_,w),m.calendarContainer.style.left=b+"px",m.calendarContainer.style.right="auto"}else m.calendarContainer.style.left="auto",m.calendarContainer.style.right=p+"px";else m.calendarContainer.style.left=d+"px",m.calendarContainer.style.right="auto"}}}function at(){m.config.noCalendar||m.isMobile||(gt(),B())}function st(){m._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(m.close,0):m.close()}function lt(t){t.preventDefault(),t.stopPropagation();var e=function t(e,i){return i(e)?e:e.parentNode?t(e.parentNode,i):void 0}(t.target,(function(t){return t.classList&&t.classList.contains("flatpickr-day")&&!t.classList.contains("flatpickr-disabled")&&!t.classList.contains("notAllowed")}));if(void 0!==e){var i=e,n=m.latestSelectedDateObj=new Date(i.dateObj.getTime()),o=(n.getMonth()<m.currentMonth||n.getMonth()>m.currentMonth+m.config.showMonths-1)&&"range"!==m.config.mode;if(m.selectedDateElem=i,"single"===m.config.mode)m.selectedDates=[n];else if("multiple"===m.config.mode){var r=ft(n);r?m.selectedDates.splice(parseInt(r),1):m.selectedDates.push(n)}else"range"===m.config.mode&&(2===m.selectedDates.length&&m.clear(!1,!1),m.latestSelectedDateObj=n,m.selectedDates.push(n),0!==b(n,m.selectedDates[0],!0)&&m.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()})));if(k(),o){var a=m.currentYear!==n.getFullYear();m.currentYear=n.getFullYear(),m.currentMonth=n.getMonth(),a&&(dt("onYearChange"),G()),dt("onMonthChange")}if(gt(),B(),vt(),m.config.enableTime&&setTimeout((function(){return m.showTimeInput=!0}),50),o||"range"===m.config.mode||1!==m.config.showMonths?void 0!==m.selectedDateElem&&void 0===m.hourElement&&m.selectedDateElem&&m.selectedDateElem.focus():j(i),void 0!==m.hourElement&&void 0!==m.hourElement&&m.hourElement.focus(),m.config.closeOnSelect){var s="single"===m.config.mode&&!m.config.enableTime,l="range"===m.config.mode&&2===m.selectedDates.length&&!m.config.enableTime;(s||l)&&st()}L()}}m.parseDate=y({config:m.config,l10n:m.l10n}),m._handlers=[],m.pluginElements=[],m.loadedPlugins=[],m._bind=P,m._setHoursFromDate=S,m._positionCalendar=rt,m.changeMonth=Y,m.changeYear=K,m.clear=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0),m.input.value="",void 0!==m.altInput&&(m.altInput.value=""),void 0!==m.mobileInput&&(m.mobileInput.value=""),m.selectedDates=[],m.latestSelectedDateObj=void 0,!0===e&&(m.currentYear=m._initialDate.getFullYear(),m.currentMonth=m._initialDate.getMonth()),m.showTimeInput=!1,!0===m.config.enableTime&&M(),m.redraw(),t&&dt("onChange")},m.close=function(){m.isOpen=!1,m.isMobile||(void 0!==m.calendarContainer&&m.calendarContainer.classList.remove("open"),void 0!==m._input&&m._input.classList.remove("active")),dt("onClose")},m._createElement=u,m.destroy=function(){void 0!==m.config&&dt("onDestroy");for(var t=m._handlers.length;t--;){var e=m._handlers[t];e.element.removeEventListener(e.event,e.handler,e.options)}if(m._handlers=[],m.mobileInput)m.mobileInput.parentNode&&m.mobileInput.parentNode.removeChild(m.mobileInput),m.mobileInput=void 0;else if(m.calendarContainer&&m.calendarContainer.parentNode)if(m.config.static&&m.calendarContainer.parentNode){var i=m.calendarContainer.parentNode;if(i.lastChild&&i.removeChild(i.lastChild),i.parentNode){for(;i.firstChild;)i.parentNode.insertBefore(i.firstChild,i);i.parentNode.removeChild(i)}}else m.calendarContainer.parentNode.removeChild(m.calendarContainer);m.altInput&&(m.input.type="text",m.altInput.parentNode&&m.altInput.parentNode.removeChild(m.altInput),delete m.altInput),m.input&&(m.input.type=m.input._type,m.input.classList.remove("flatpickr-input"),m.input.removeAttribute("readonly"),m.input.value=""),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(t){try{delete m[t]}catch(t){}}))},m.isEnabled=Z,m.jumpToDate=F,m.open=function(t,e){if(void 0===e&&(e=m._positionElement),!0===m.isMobile)return t&&(t.preventDefault(),t.target&&t.target.blur()),void 0!==m.mobileInput&&(m.mobileInput.focus(),m.mobileInput.click()),void dt("onOpen");if(!m._input.disabled&&!m.config.inline){var i=m.isOpen;m.isOpen=!0,i||(m.calendarContainer.classList.add("open"),m._input.classList.add("active"),dt("onOpen"),rt(e)),!0===m.config.enableTime&&!0===m.config.noCalendar&&(0===m.selectedDates.length&&it(),!1!==m.config.allowInput||void 0!==t&&m.timeContainer.contains(t.relatedTarget)||setTimeout((function(){return m.hourElement.select()}),50))}},m.redraw=at,m.set=function(t,i){if(null!==t&&"object"==typeof t)for(var n in Object.assign(m.config,t),t)void 0!==ut[n]&&ut[n].forEach((function(t){return t()}));else m.config[t]=i,void 0!==ut[t]?ut[t].forEach((function(t){return t()})):e.indexOf(t)>-1&&(m.config[t]=s(i));m.redraw(),vt(!1)},m.setDate=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=m.config.dateFormat),0!==t&&!t||t instanceof Array&&0===t.length)return m.clear(e);ct(t,i),m.showTimeInput=m.selectedDates.length>0,m.latestSelectedDateObj=m.selectedDates[m.selectedDates.length-1],m.redraw(),F(),S(),0===m.selectedDates.length&&m.clear(!1),vt(e),e&&dt("onChange")},m.toggle=function(t){if(!0===m.isOpen)return m.close();m.open(t)};var ut={locale:[ot,$],showMonths:[W,x,q],minDate:[F],maxDate:[F]};function ct(t,e){var i=[];if(t instanceof Array)i=t.map((function(t){return m.parseDate(t,e)}));else if(t instanceof Date||"number"==typeof t)i=[m.parseDate(t,e)];else if("string"==typeof t)switch(m.config.mode){case"single":case"time":i=[m.parseDate(t,e)];break;case"multiple":i=t.split(m.config.conjunction).map((function(t){return m.parseDate(t,e)}));break;case"range":i=t.split(m.l10n.rangeSeparator).map((function(t){return m.parseDate(t,e)}))}else m.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(t)));m.selectedDates=i.filter((function(t){return t instanceof Date&&Z(t,!1)})),"range"===m.config.mode&&m.selectedDates.sort((function(t,e){return t.getTime()-e.getTime()}))}function ht(t){return t.slice().map((function(t){return"string"==typeof t||"number"==typeof t||t instanceof Date?m.parseDate(t,void 0,!0):t&&"object"==typeof t&&t.from&&t.to?{from:m.parseDate(t.from,void 0),to:m.parseDate(t.to,void 0)}:t})).filter((function(t){return t}))}function dt(t,e){if(void 0!==m.config){var i=m.config[t];if(void 0!==i&&i.length>0)for(var n=0;i[n]&&n<i.length;n++)i[n](m.selectedDates,m.input.value,m,e);"onChange"===t&&(m.input.dispatchEvent(pt("change")),m.input.dispatchEvent(pt("input")))}}function pt(t){var e=document.createEvent("Event");return e.initEvent(t,!0,!0),e}function ft(t){for(var e=0;e<m.selectedDates.length;e++)if(0===b(m.selectedDates[e],t))return""+e;return!1}function gt(){m.config.noCalendar||m.isMobile||!m.monthNav||(m.yearElements.forEach((function(t,e){var i=new Date(m.currentYear,m.currentMonth,1);i.setMonth(m.currentMonth+e),m.config.showMonths>1||"static"===m.config.monthSelectorType?m.monthElements[e].textContent=p(i.getMonth(),m.config.shorthandCurrentMonth,m.l10n)+" ":m.monthsDropdownContainer.value=i.getMonth().toString(),t.value=i.getFullYear().toString()})),m._hidePrevMonthArrow=void 0!==m.config.minDate&&(m.currentYear===m.config.minDate.getFullYear()?m.currentMonth<=m.config.minDate.getMonth():m.currentYear<m.config.minDate.getFullYear()),m._hideNextMonthArrow=void 0!==m.config.maxDate&&(m.currentYear===m.config.maxDate.getFullYear()?m.currentMonth+1>m.config.maxDate.getMonth():m.currentYear>m.config.maxDate.getFullYear()))}function mt(t){return m.selectedDates.map((function(e){return m.formatDate(e,t)})).filter((function(t,e,i){return"range"!==m.config.mode||m.config.enableTime||i.indexOf(t)===e})).join("range"!==m.config.mode?m.config.conjunction:m.l10n.rangeSeparator)}function vt(t){void 0===t&&(t=!0),void 0!==m.mobileInput&&m.mobileFormatStr&&(m.mobileInput.value=void 0!==m.latestSelectedDateObj?m.formatDate(m.latestSelectedDateObj,m.mobileFormatStr):""),m.input.value=mt(m.config.dateFormat),void 0!==m.altInput&&(m.altInput.value=mt(m.config.altFormat)),!1!==t&&dt("onValueUpdate")}function yt(t){var e=m.prevMonthNav.contains(t.target),i=m.nextMonthNav.contains(t.target);e||i?Y(e?-1:1):m.yearElements.indexOf(t.target)>=0?t.target.select():t.target.classList.contains("arrowUp")?m.changeYear(m.currentYear+1):t.target.classList.contains("arrowDown")&&m.changeYear(m.currentYear-1)}return function(){m.element=m.input=d,m.isOpen=!1,function(){var n=["wrap","weekNumbers","allowInput","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],o=t({},f,JSON.parse(JSON.stringify(d.dataset||{}))),r={};m.config.parseDate=o.parseDate,m.config.formatDate=o.formatDate,Object.defineProperty(m.config,"enable",{get:function(){return m.config._enable},set:function(t){m.config._enable=ht(t)}}),Object.defineProperty(m.config,"disable",{get:function(){return m.config._disable},set:function(t){m.config._disable=ht(t)}});var a="time"===o.mode;if(!o.dateFormat&&(o.enableTime||a)){var l=C.defaultConfig.dateFormat||i.dateFormat;r.dateFormat=o.noCalendar||a?"H:i"+(o.enableSeconds?":S":""):l+" H:i"+(o.enableSeconds?":S":"")}if(o.altInput&&(o.enableTime||a)&&!o.altFormat){var u=C.defaultConfig.altFormat||i.altFormat;r.altFormat=o.noCalendar||a?"h:i"+(o.enableSeconds?":S K":" K"):u+" h:i"+(o.enableSeconds?":S":"")+" K"}o.altInputClass||(m.config.altInputClass=m.input.className+" "+m.config.altInputClass),Object.defineProperty(m.config,"minDate",{get:function(){return m.config._minDate},set:nt("min")}),Object.defineProperty(m.config,"maxDate",{get:function(){return m.config._maxDate},set:nt("max")});var c=function(t){return function(e){m.config["min"===t?"_minTime":"_maxTime"]=m.parseDate(e,"H:i:S")}};Object.defineProperty(m.config,"minTime",{get:function(){return m.config._minTime},set:c("min")}),Object.defineProperty(m.config,"maxTime",{get:function(){return m.config._maxTime},set:c("max")}),"time"===o.mode&&(m.config.noCalendar=!0,m.config.enableTime=!0),Object.assign(m.config,r,o);for(var h=0;h<n.length;h++)m.config[n[h]]=!0===m.config[n[h]]||"true"===m.config[n[h]];for(e.filter((function(t){return void 0!==m.config[t]})).forEach((function(t){m.config[t]=s(m.config[t]||[]).map(_)})),m.isMobile=!m.config.disableMobile&&!m.config.inline&&"single"===m.config.mode&&!m.config.disable.length&&!m.config.enable.length&&!m.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),h=0;h<m.config.plugins.length;h++){var p=m.config.plugins[h](m)||{};for(var g in p)e.indexOf(g)>-1?m.config[g]=s(p[g]).map(_).concat(m.config[g]):void 0===o[g]&&(m.config[g]=p[g])}dt("onParseConfig")}(),ot(),m.input=m.config.wrap?d.querySelector("[data-input]"):d,m.input?(m.input._type=m.input.type,m.input.type="text",m.input.classList.add("flatpickr-input"),m._input=m.input,m.config.altInput&&(m.altInput=u(m.input.nodeName,m.config.altInputClass),m._input=m.altInput,m.altInput.placeholder=m.input.placeholder,m.altInput.disabled=m.input.disabled,m.altInput.required=m.input.required,m.altInput.tabIndex=m.input.tabIndex,m.altInput.type="text",m.input.setAttribute("type","hidden"),!m.config.static&&m.input.parentNode&&m.input.parentNode.insertBefore(m.altInput,m.input.nextSibling)),m.config.allowInput||m._input.setAttribute("readonly","readonly"),m._positionElement=m.config.positionElement||m._input):m.config.errorHandler(new Error("Invalid input element specified")),function(){m.selectedDates=[],m.now=m.parseDate(m.config.now)||new Date;var t=m.config.defaultDate||("INPUT"!==m.input.nodeName&&"TEXTAREA"!==m.input.nodeName||!m.input.placeholder||m.input.value!==m.input.placeholder?m.input.value:null);t&&ct(t,m.config.dateFormat),m._initialDate=m.selectedDates.length>0?m.selectedDates[0]:m.config.minDate&&m.config.minDate.getTime()>m.now.getTime()?m.config.minDate:m.config.maxDate&&m.config.maxDate.getTime()<m.now.getTime()?m.config.maxDate:m.now,m.currentYear=m._initialDate.getFullYear(),m.currentMonth=m._initialDate.getMonth(),m.selectedDates.length>0&&(m.latestSelectedDateObj=m.selectedDates[0]),void 0!==m.config.minTime&&(m.config.minTime=m.parseDate(m.config.minTime,"H:i")),void 0!==m.config.maxTime&&(m.config.maxTime=m.parseDate(m.config.maxTime,"H:i")),m.minDateHasTime=!!m.config.minDate&&(m.config.minDate.getHours()>0||m.config.minDate.getMinutes()>0||m.config.minDate.getSeconds()>0),m.maxDateHasTime=!!m.config.maxDate&&(m.config.maxDate.getHours()>0||m.config.maxDate.getMinutes()>0||m.config.maxDate.getSeconds()>0),Object.defineProperty(m,"showTimeInput",{get:function(){return m._showTimeInput},set:function(t){m._showTimeInput=t,m.calendarContainer&&l(m.calendarContainer,"showTimeInput",t),m.isOpen&&rt()}})}(),m.utils={getDaysInMonth:function(t,e){return void 0===t&&(t=m.currentMonth),void 0===e&&(e=m.currentYear),1===t&&(e%4==0&&e%100!=0||e%400==0)?29:m.l10n.daysInMonth[t]}},m.isMobile||function(){var t=window.document.createDocumentFragment();if(m.calendarContainer=u("div","flatpickr-calendar"),m.calendarContainer.tabIndex=-1,!m.config.noCalendar){if(t.appendChild((m.monthNav=u("div","flatpickr-months"),m.yearElements=[],m.monthElements=[],m.prevMonthNav=u("span","flatpickr-prev-month"),m.prevMonthNav.innerHTML=m.config.prevArrow,m.nextMonthNav=u("span","flatpickr-next-month"),m.nextMonthNav.innerHTML=m.config.nextArrow,W(),Object.defineProperty(m,"_hidePrevMonthArrow",{get:function(){return m.__hidePrevMonthArrow},set:function(t){m.__hidePrevMonthArrow!==t&&(l(m.prevMonthNav,"flatpickr-disabled",t),m.__hidePrevMonthArrow=t)}}),Object.defineProperty(m,"_hideNextMonthArrow",{get:function(){return m.__hideNextMonthArrow},set:function(t){m.__hideNextMonthArrow!==t&&(l(m.nextMonthNav,"flatpickr-disabled",t),m.__hideNextMonthArrow=t)}}),m.currentYearElement=m.yearElements[0],gt(),m.monthNav)),m.innerContainer=u("div","flatpickr-innerContainer"),m.config.weekNumbers){var e=function(){m.calendarContainer.classList.add("hasWeeks");var t=u("div","flatpickr-weekwrapper");t.appendChild(u("span","flatpickr-weekday",m.l10n.weekAbbreviation));var e=u("div","flatpickr-weeks");return t.appendChild(e),{weekWrapper:t,weekNumbers:e}}(),i=e.weekWrapper,n=e.weekNumbers;m.innerContainer.appendChild(i),m.weekNumbers=n,m.weekWrapper=i}m.rContainer=u("div","flatpickr-rContainer"),m.rContainer.appendChild(q()),m.daysContainer||(m.daysContainer=u("div","flatpickr-days"),m.daysContainer.tabIndex=-1),B(),m.rContainer.appendChild(m.daysContainer),m.innerContainer.appendChild(m.rContainer),t.appendChild(m.innerContainer)}m.config.enableTime&&t.appendChild(function(){m.calendarContainer.classList.add("hasTime"),m.config.noCalendar&&m.calendarContainer.classList.add("noCalendar"),m.timeContainer=u("div","flatpickr-time"),m.timeContainer.tabIndex=-1;var t=u("span","flatpickr-time-separator",":"),e=h("flatpickr-hour",{"aria-label":m.l10n.hourAriaLabel});m.hourElement=e.getElementsByTagName("input")[0];var i=h("flatpickr-minute",{"aria-label":m.l10n.minuteAriaLabel});if(m.minuteElement=i.getElementsByTagName("input")[0],m.hourElement.tabIndex=m.minuteElement.tabIndex=-1,m.hourElement.value=o(m.latestSelectedDateObj?m.latestSelectedDateObj.getHours():m.config.time_24hr?m.config.defaultHour:function(t){switch(t%24){case 0:case 12:return 12;default:return t%12}}(m.config.defaultHour)),m.minuteElement.value=o(m.latestSelectedDateObj?m.latestSelectedDateObj.getMinutes():m.config.defaultMinute),m.hourElement.setAttribute("step",m.config.hourIncrement.toString()),m.minuteElement.setAttribute("step",m.config.minuteIncrement.toString()),m.hourElement.setAttribute("min",m.config.time_24hr?"0":"1"),m.hourElement.setAttribute("max",m.config.time_24hr?"23":"12"),m.minuteElement.setAttribute("min","0"),m.minuteElement.setAttribute("max","59"),m.timeContainer.appendChild(e),m.timeContainer.appendChild(t),m.timeContainer.appendChild(i),m.config.time_24hr&&m.timeContainer.classList.add("time24hr"),m.config.enableSeconds){m.timeContainer.classList.add("hasSeconds");var n=h("flatpickr-second");m.secondElement=n.getElementsByTagName("input")[0],m.secondElement.value=o(m.latestSelectedDateObj?m.latestSelectedDateObj.getSeconds():m.config.defaultSeconds),m.secondElement.setAttribute("step",m.minuteElement.getAttribute("step")),m.secondElement.setAttribute("min","0"),m.secondElement.setAttribute("max","59"),m.timeContainer.appendChild(u("span","flatpickr-time-separator",":")),m.timeContainer.appendChild(n)}return m.config.time_24hr||(m.amPM=u("span","flatpickr-am-pm",m.l10n.amPM[r((m.latestSelectedDateObj?m.hourElement.value:m.config.defaultHour)>11)]),m.amPM.title=m.l10n.toggleTitle,m.amPM.tabIndex=-1,m.timeContainer.appendChild(m.amPM)),m.timeContainer}()),l(m.calendarContainer,"rangeMode","range"===m.config.mode),l(m.calendarContainer,"animate",!0===m.config.animate),l(m.calendarContainer,"multiMonth",m.config.showMonths>1),m.calendarContainer.appendChild(t);var a=void 0!==m.config.appendTo&&void 0!==m.config.appendTo.nodeType;if((m.config.inline||m.config.static)&&(m.calendarContainer.classList.add(m.config.inline?"inline":"static"),m.config.inline&&(!a&&m.element.parentNode?m.element.parentNode.insertBefore(m.calendarContainer,m._input.nextSibling):void 0!==m.config.appendTo&&m.config.appendTo.appendChild(m.calendarContainer)),m.config.static)){var s=u("div","flatpickr-wrapper");m.element.parentNode&&m.element.parentNode.insertBefore(s,m.element),s.appendChild(m.element),m.altInput&&s.appendChild(m.altInput),s.appendChild(m.calendarContainer)}m.config.static||m.config.inline||(void 0!==m.config.appendTo?m.config.appendTo:window.document.body).appendChild(m.calendarContainer)}(),function(){if(m.config.wrap&&["open","close","toggle","clear"].forEach((function(t){Array.prototype.forEach.call(m.element.querySelectorAll("[data-"+t+"]"),(function(e){return P(e,"click",m[t])}))})),m.isMobile)!function(){var t=m.config.enableTime?m.config.noCalendar?"time":"datetime-local":"date";m.mobileInput=u("input",m.input.className+" flatpickr-mobile"),m.mobileInput.step=m.input.getAttribute("step")||"any",m.mobileInput.tabIndex=1,m.mobileInput.type=t,m.mobileInput.disabled=m.input.disabled,m.mobileInput.required=m.input.required,m.mobileInput.placeholder=m.input.placeholder,m.mobileFormatStr="datetime-local"===t?"Y-m-d\\TH:i:S":"date"===t?"Y-m-d":"H:i:S",m.selectedDates.length>0&&(m.mobileInput.defaultValue=m.mobileInput.value=m.formatDate(m.selectedDates[0],m.mobileFormatStr)),m.config.minDate&&(m.mobileInput.min=m.formatDate(m.config.minDate,"Y-m-d")),m.config.maxDate&&(m.mobileInput.max=m.formatDate(m.config.maxDate,"Y-m-d")),m.input.type="hidden",void 0!==m.altInput&&(m.altInput.type="hidden");try{m.input.parentNode&&m.input.parentNode.insertBefore(m.mobileInput,m.input.nextSibling)}catch(t){}P(m.mobileInput,"change",(function(t){m.setDate(t.target.value,!1,m.mobileFormatStr),dt("onChange"),dt("onClose")}))}();else{var t=a(et,50);m._debouncedChange=a(L,300),m.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&P(m.daysContainer,"mouseover",(function(t){"range"===m.config.mode&&tt(t.target)})),P(window.document.body,"keydown",Q),m.config.inline||m.config.static||P(window,"resize",t),void 0!==window.ontouchstart?P(window.document,"touchstart",U):P(window.document,"mousedown",D(U)),P(window.document,"focus",U,{capture:!0}),!0===m.config.clickOpens&&(P(m._input,"focus",m.open),P(m._input,"mousedown",D(m.open))),void 0!==m.daysContainer&&(P(m.monthNav,"mousedown",D(yt)),P(m.monthNav,["keyup","increment"],R),P(m.daysContainer,"mousedown",D(lt))),void 0!==m.timeContainer&&void 0!==m.minuteElement&&void 0!==m.hourElement&&(P(m.timeContainer,["increment"],E),P(m.timeContainer,"blur",E,{capture:!0}),P(m.timeContainer,"mousedown",D(O)),P([m.hourElement,m.minuteElement],["focus","click"],(function(t){return t.target.select()})),void 0!==m.secondElement&&P(m.secondElement,"focus",(function(){return m.secondElement&&m.secondElement.select()})),void 0!==m.amPM&&P(m.amPM,"mousedown",D((function(t){E(t),L()}))))}}(),(m.selectedDates.length||m.config.noCalendar)&&(m.config.enableTime&&S(m.config.noCalendar?m.latestSelectedDateObj||m.config.minDate:void 0),vt(!1)),x(),m.showTimeInput=m.selectedDates.length>0||m.config.noCalendar;var n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!m.isMobile&&n&&rt(),dt("onReady")}(),m}function x(t,e){for(var i=Array.prototype.slice.call(t).filter((function(t){return t instanceof HTMLElement})),n=[],o=0;o<i.length;o++){var r=i[o];try{if(null!==r.getAttribute("data-fp-omit"))continue;void 0!==r._flatpickr&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=_(r,e||{}),n.push(r._flatpickr)}catch(t){console.error(t)}}return 1===n.length?n[0]:n}"function"!=typeof Object.assign&&(Object.assign=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!t)throw TypeError("Cannot convert undefined or null to object");for(var n=function(e){e&&Object.keys(e).forEach((function(i){return t[i]=e[i]}))},o=0,r=e;o<r.length;o++){var a=r[o];n(a)}return t}),"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return x(this,t)},HTMLElement.prototype.flatpickr=function(t){return x([this],t)});var C=function(t,e){return"string"==typeof t?x(window.document.querySelectorAll(t),e):t instanceof Node?x([t],e):x(t,e)};return C.defaultConfig={},C.l10ns={en:t({},n),default:t({},n)},C.localize=function(e){C.l10ns.default=t({},C.l10ns.default,e)},C.setDefaults=function(e){C.defaultConfig=t({},C.defaultConfig,e)},C.parseDate=y({}),C.formatDate=v({}),C.compareDates=b,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(t){return x(this,t)}),Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof t?parseInt(t,10):t))},"undefined"!=typeof window&&(window.flatpickr=C),C}()},function(t,e,i){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var o=n(i(148)),r=n(i(147)),a=n(i(146)),s=n(i(68)),l=i(69);function u(t){for(var e=function(t){if("FeatureCollection"!==t.type)return"Feature"!==t.type?l.featureCollection([l.feature(t)]):l.featureCollection([t]);return t}(t),i=r(e),n=!1,u=0;!n&&u<e.features.length;){var h,d=e.features[u].geometry,p=!1;if("Point"===d.type)i.geometry.coordinates[0]===d.coordinates[0]&&i.geometry.coordinates[1]===d.coordinates[1]&&(n=!0);else if("MultiPoint"===d.type){var f=!1;for(h=0;!f&&h<d.coordinates.length;)i.geometry.coordinates[0]===d.coordinates[h][0]&&i.geometry.coordinates[1]===d.coordinates[h][1]&&(n=!0,f=!0),h++}else if("LineString"===d.type)for(h=0;!p&&h<d.coordinates.length-1;)c(i.geometry.coordinates[0],i.geometry.coordinates[1],d.coordinates[h][0],d.coordinates[h][1],d.coordinates[h+1][0],d.coordinates[h+1][1])&&(p=!0,n=!0),h++;else if("MultiLineString"===d.type)for(var g=0;g<d.coordinates.length;){p=!1,h=0;for(var m=d.coordinates[g];!p&&h<m.length-1;)c(i.geometry.coordinates[0],i.geometry.coordinates[1],m[h][0],m[h][1],m[h+1][0],m[h+1][1])&&(p=!0,n=!0),h++;g++}else"Polygon"!==d.type&&"MultiPolygon"!==d.type||s(i,d)&&(n=!0);u++}if(n)return i;var v=l.featureCollection([]);for(u=0;u<e.features.length;u++)v.features=v.features.concat(o(e.features[u]).features);return l.point(a(i,v).geometry.coordinates)}function c(t,e,i,n,o,r){return Math.sqrt((o-i)*(o-i)+(r-n)*(r-n))===Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))+Math.sqrt((o-t)*(o-t)+(r-e)*(r-e))}t.exports=u,t.exports.default=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(70);function o(t,e,i,n,o,r,a,s){var l,u,c,h,d={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(l=(s-r)*(i-t)-(a-o)*(n-e))?null!==d.x&&null!==d.y&&d:(h=(i-t)*(u=e-r)-(n-e)*(c=t-o),u=((a-o)*u-(s-r)*c)/l,c=h/l,d.x=t+u*(i-t),d.y=e+u*(n-e),u>=0&&u<=1&&(d.onLine1=!0),c>=0&&c<=1&&(d.onLine2=!0),!(!d.onLine1||!d.onLine2)&&[d.x,d.y])}e.default=function(t){var e,i,r={type:"FeatureCollection",features:[]};if("LineString"===(i="Feature"===t.type?t.geometry:t).type)e=[i.coordinates];else if("MultiLineString"===i.type)e=i.coordinates;else if("MultiPolygon"===i.type)e=[].concat.apply([],i.coordinates);else{if("Polygon"!==i.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=i.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var i=0;i<t.length-1;i++)for(var a=i;a<e.length-1;a++){if(t===e){if(1===Math.abs(i-a))continue;if(0===i&&a===t.length-2&&t[i][0]===t[t.length-1][0]&&t[i][1]===t[t.length-1][1])continue}var s=o(t[i][0],t[i][1],t[i+1][0],t[i+1][1],e[a][0],e[a][1],e[a+1][0],e[a+1][1]);s&&r.features.push(n.point([s[0],s[1]]))}}))})),r}},function(t,e,i){"use strict";var n=i(1),o=i(71);function r(t){if(!t)throw new Error("geojson is required");var e=[];return n.flattenEach(t,(function(t){e.push(t)})),o.featureCollection(e)}t.exports=r,t.exports.default=r},function(t,e,i){"use strict";t.exports=o;var n=i(144);function o(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var r="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a(t){return t.type===o.Bytes?t.readVarint()+t.pos:t.pos+1}function s(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function l(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var o=i.pos-1;o>=t;o--)i.buf[o+n]=i.buf[o]}function u(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function c(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function h(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function d(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function p(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function f(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function g(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function m(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function v(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function y(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}o.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),o=n>>3,r=this.pos;this.type=7&n,t(o,e,this),this.pos===r&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=y(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=y(this.buf,this.pos)+4294967296*y(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=y(this.buf,this.pos)+4294967296*w(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,o,r=i.buf;if(o=r[i.pos++],n=(112&o)>>4,o<128)return s(t,n,e);if(o=r[i.pos++],n|=(127&o)<<3,o<128)return s(t,n,e);if(o=r[i.pos++],n|=(127&o)<<10,o<128)return s(t,n,e);if(o=r[i.pos++],n|=(127&o)<<17,o<128)return s(t,n,e);if(o=r[i.pos++],n|=(127&o)<<24,o<128)return s(t,n,e);if(o=r[i.pos++],n|=(1&o)<<31,o<128)return s(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&r?function(t,e,i){return r.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",o=e;for(;o<i;){var r,a,s,l=t[o],u=null,c=l>239?4:l>223?3:l>191?2:1;if(o+c>i)break;1===c?l<128&&(u=l):2===c?128==(192&(r=t[o+1]))&&(u=(31&l)<<6|63&r)<=127&&(u=null):3===c?(r=t[o+1],a=t[o+2],128==(192&r)&&128==(192&a)&&((u=(15&l)<<12|(63&r)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(r=t[o+1],a=t[o+2],s=t[o+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&r)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),o+=c}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==o.Bytes)return t.push(this.readVarint(e));var i=a(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==o.Bytes)return t.push(this.readSVarint());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==o.Bytes)return t.push(this.readBoolean());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==o.Bytes)return t.push(this.readFloat());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==o.Bytes)return t.push(this.readDouble());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==o.Bytes)return t.push(this.readFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==o.Bytes)return t.push(this.readSFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==o.Bytes)return t.push(this.readFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==o.Bytes)return t.push(this.readSFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===o.Varint)for(;this.buf[this.pos++]>127;);else if(e===o.Bytes)this.pos=this.readVarint()+this.pos;else if(e===o.Fixed32)this.pos+=4;else{if(e!==o.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,o,r=0;r<e.length;r++){if((n=e.charCodeAt(r))>55295&&n<57344){if(!o){n>56319||r+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):o=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,o=n;continue}n=o-55296<<10|n-56320|65536,o=null}else o&&(t[i++]=239,t[i++]=191,t[i++]=189,o=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&l(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),n.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),n.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&l(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,o.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,u,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writeBytesField:function(t,e){this.writeTag(t,o.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,o.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,o.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,o.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,o.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,o.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,o.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,o.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,o.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,o.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},,,,,,,,,,,,,function(t,e,i){t.exports=i(145)},function(t,e){if("undefined"==typeof moment){var i=new Error("Cannot find module 'moment'");throw i.code="MODULE_NOT_FOUND",i}t.exports=moment},function(t,e,i){var n=i(66);t.exports=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(t){return decodeURIComponent(n(t).replace(/(.)/g,(function(t,e){var i=e.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i})))}(e)}catch(t){return n(e)}}},function(t,e){function i(t){this.message=t}i.prototype=new Error,i.prototype.name="InvalidCharacterError",t.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new i("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,r=0,a=0,s="";o=e.charAt(a++);~o&&(n=r%4?64*n+o:o,r++%4)?s+=String.fromCharCode(255&n>>(-2*r&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s}},function(t,e,i){
/*!
 * chartjs-plugin-datalabels v0.7.0
 * https://chartjs-plugin-datalabels.netlify.com
 * (c) 2019 Chart.js Contributors
 * Released under the MIT license
 */
t.exports=function(t){"use strict";var e=(t=t&&t.hasOwnProperty("default")?t.default:t).helpers,i=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),n={toTextLines:function(t){var i,n=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?n.unshift.apply(n,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):e.isNullOrUndef(t)||n.unshift(""+i);return n},toFontString:function(t){return!t||e.isNullOrUndef(t.size)||e.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family},textSize:function(t,e,i){var n,o=[].concat(e),r=o.length,a=t.font,s=0;for(t.font=i.string,n=0;n<r;++n)s=Math.max(t.measureText(o[n]).width,s);return t.font=a,{height:r*i.lineHeight,width:s}},parseFont:function(i){var o=t.defaults.global,r=e.valueOrDefault(i.size,o.defaultFontSize),a={family:e.valueOrDefault(i.family,o.defaultFontFamily),lineHeight:e.options.toLineHeight(i.lineHeight,r),size:r,style:e.valueOrDefault(i.style,o.defaultFontStyle),weight:e.valueOrDefault(i.weight,null),string:""};return a.string=n.toFontString(a),a},bound:function(t,e,i){return Math.max(t,Math.min(e,i))},arrayDiff:function(t,e){var i,n,o,r,a=t.slice(),s=[];for(i=0,o=e.length;i<o;++i)r=e[i],-1===(n=a.indexOf(r))?s.push([r,1]):a.splice(n,1);for(i=0,o=a.length;i<o;++i)s.push([a[i],-1]);return s},rasterize:function(t){return Math.round(t*i)/i}};function o(t,e){var i=e.x,n=e.y;if(null===i)return{x:0,y:-1};if(null===n)return{x:1,y:0};var o=t.x-i,r=t.y-n,a=Math.sqrt(o*o+r*r);return{x:a?o/a:0,y:a?r/a:-1}}function r(t,e,i){var n=0;return t<i.left?n|=1:t>i.right&&(n|=2),e<i.top?n|=8:e>i.bottom&&(n|=4),n}function a(t,e){var i,n,o=e.anchor,a=t;return e.clamp&&(a=function(t,e){for(var i,n,o,a=t.x0,s=t.y0,l=t.x1,u=t.y1,c=r(a,s,e),h=r(l,u,e);c|h&&!(c&h);)8&(i=c||h)?(n=a+(l-a)*(e.top-s)/(u-s),o=e.top):4&i?(n=a+(l-a)*(e.bottom-s)/(u-s),o=e.bottom):2&i?(o=s+(u-s)*(e.right-a)/(l-a),n=e.right):1&i&&(o=s+(u-s)*(e.left-a)/(l-a),n=e.left),i===c?c=r(a=n,s=o,e):h=r(l=n,u=o,e);return{x0:a,x1:l,y0:s,y1:u}}(a,e.area)),"start"===o?(i=a.x0,n=a.y0):"end"===o?(i=a.x1,n=a.y1):(i=(a.x0+a.x1)/2,n=(a.y0+a.y1)/2),function(t,e,i,n,o){switch(o){case"center":i=n=0;break;case"bottom":i=0,n=1;break;case"right":i=1,n=0;break;case"left":i=-1,n=0;break;case"top":i=0,n=-1;break;case"start":i=-i,n=-n;break;case"end":break;default:o*=Math.PI/180,i=Math.cos(o),n=Math.sin(o)}return{x:t,y:e,vx:i,vy:n}}(i,n,t.vx,t.vy,e.align)}var s=function(t,e){var i=(t.startAngle+t.endAngle)/2,n=Math.cos(i),o=Math.sin(i),r=t.innerRadius,s=t.outerRadius;return a({x0:t.x+n*r,y0:t.y+o*r,x1:t.x+n*s,y1:t.y+o*s,vx:n,vy:o},e)},l=function(t,e){var i=o(t,e.origin),n=i.x*t.radius,r=i.y*t.radius;return a({x0:t.x-n,y0:t.y-r,x1:t.x+n,y1:t.y+r,vx:i.x,vy:i.y},e)},u=function(t,e){var i=o(t,e.origin),n=t.x,r=t.y,s=0,l=0;return t.horizontal?(n=Math.min(t.x,t.base),s=Math.abs(t.base-t.x)):(r=Math.min(t.y,t.base),l=Math.abs(t.base-t.y)),a({x0:n,y0:r+l,x1:n+s,y1:r,vx:i.x,vy:i.y},e)},c=function(t,e){var i=o(t,e.origin);return a({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},e)},h=t.helpers,d=n.rasterize;function p(t){var e=t._model.horizontal,i=t._scale||e&&t._xScale||t._yScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var n=i.getBasePixel();return e?{x:n,y:null}:{x:null,y:n}}function f(t,e,i){var n=t.shadowBlur,o=i.stroked,r=d(i.x),a=d(i.y),s=d(i.w);o&&t.strokeText(e,r,a,s),i.filled&&(n&&o&&(t.shadowBlur=0),t.fillText(e,r,a,s),n&&o&&(t.shadowBlur=n))}var g=function(t,e,i,n){var o=this;o._config=t,o._index=n,o._model=null,o._rects=null,o._ctx=e,o._el=i};h.extend(g.prototype,{_modelize:function(e,i,o,r){var a,d=this._index,f=h.options.resolve,g=n.parseFont(f([o.font,{}],r,d)),m=f([o.color,t.defaults.global.defaultFontColor],r,d);return{align:f([o.align,"center"],r,d),anchor:f([o.anchor,"center"],r,d),area:r.chart.chartArea,backgroundColor:f([o.backgroundColor,null],r,d),borderColor:f([o.borderColor,null],r,d),borderRadius:f([o.borderRadius,0],r,d),borderWidth:f([o.borderWidth,0],r,d),clamp:f([o.clamp,!1],r,d),clip:f([o.clip,!1],r,d),color:m,display:e,font:g,lines:i,offset:f([o.offset,0],r,d),opacity:f([o.opacity,1],r,d),origin:p(this._el),padding:h.options.toPadding(f([o.padding,0],r,d)),positioner:(a=this._el,a instanceof t.elements.Arc?s:a instanceof t.elements.Point?l:a instanceof t.elements.Rectangle?u:c),rotation:f([o.rotation,0],r,d)*(Math.PI/180),size:n.textSize(this._ctx,i,g),textAlign:f([o.textAlign,"start"],r,d),textShadowBlur:f([o.textShadowBlur,0],r,d),textShadowColor:f([o.textShadowColor,m],r,d),textStrokeColor:f([o.textStrokeColor,m],r,d),textStrokeWidth:f([o.textStrokeWidth,0],r,d)}},update:function(t){var e,i,o,r=this,a=null,s=null,l=r._index,u=r._config,c=h.options.resolve([u.display,!0],t,l);c&&(e=t.dataset.data[l],i=h.valueOrDefault(h.callback(u.formatter,[e,t]),e),(o=h.isNullOrUndef(i)?[]:n.toTextLines(i)).length&&(s=function(t){var e=t.borderWidth||0,i=t.padding,n=t.size.height,o=t.size.width,r=-o/2,a=-n/2;return{frame:{x:r-i.left-e,y:a-i.top-e,w:o+i.width+2*e,h:n+i.height+2*e},text:{x:r,y:a,w:o,h:n}}}(a=r._modelize(c,o,u,t)))),r._model=a,r._rects=s},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var i,o=t.ctx,r=this._model,a=this._rects;this.visible()&&(o.save(),r.clip&&(i=r.area,o.beginPath(),o.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),o.clip()),o.globalAlpha=n.bound(0,r.opacity,1),o.translate(d(e.x),d(e.y)),o.rotate(r.rotation),function(t,e,i){var n=i.backgroundColor,o=i.borderColor,r=i.borderWidth;(n||o&&r)&&(t.beginPath(),h.canvas.roundedRect(t,d(e.x)+r/2,d(e.y)+r/2,d(e.w)-r,d(e.h)-r,i.borderRadius),t.closePath(),n&&(t.fillStyle=n,t.fill()),o&&r&&(t.strokeStyle=o,t.lineWidth=r,t.lineJoin="miter",t.stroke()))}(o,a.frame,r),function(t,e,i,n){var o,r=n.textAlign,a=n.color,s=!!a,l=n.font,u=e.length,c=n.textStrokeColor,h=n.textStrokeWidth,d=c&&h;if(u&&(s||d))for(i=function(t,e,i){var n=i.lineHeight,o=t.w,r=t.x;return"center"===e?r+=o/2:"end"!==e&&"right"!==e||(r+=o),{h:n,w:o,x:r,y:t.y+n/2}}(i,r,l),t.font=l.string,t.textAlign=r,t.textBaseline="middle",t.shadowBlur=n.textShadowBlur,t.shadowColor=n.textShadowColor,s&&(t.fillStyle=a),d&&(t.lineJoin="round",t.lineWidth=h,t.strokeStyle=c),o=0,u=e.length;o<u;++o)f(t,e[o],{stroked:d,filled:s,w:i.w,x:i.x,y:i.y+i.h*o})}(o,r.lines,a.text,r),o.restore())}});var m=t.helpers,v=Number.MIN_SAFE_INTEGER||-9007199254740991,y=Number.MAX_SAFE_INTEGER||9007199254740991;function b(t,e,i){var n=Math.cos(i),o=Math.sin(i),r=e.x,a=e.y;return{x:r+n*(t.x-r)-o*(t.y-a),y:a+o*(t.x-r)+n*(t.y-a)}}function w(t,e){var i,n,o,r,a,s=y,l=v,u=e.origin;for(i=0;i<t.length;++i)o=(n=t[i]).x-u.x,r=n.y-u.y,a=e.vx*o+e.vy*r,s=Math.min(s,a),l=Math.max(l,a);return{min:s,max:l}}function _(t,e){var i=e.x-t.x,n=e.y-t.y,o=Math.sqrt(i*i+n*n);return{vx:(e.x-t.x)/o,vy:(e.y-t.y)/o,origin:t,ln:o}}var x=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function C(t,e,i){var n=e.positioner(t,e),o=n.vx,r=n.vy;if(!o&&!r)return{x:n.x,y:n.y};var a=i.w,s=i.h,l=e.rotation,u=Math.abs(a/2*Math.cos(l))+Math.abs(s/2*Math.sin(l)),c=Math.abs(a/2*Math.sin(l))+Math.abs(s/2*Math.cos(l)),h=1/Math.max(Math.abs(o),Math.abs(r));return u*=o*h,c*=r*h,u+=e.offset*o,c+=e.offset*r,{x:n.x+u,y:n.y+c}}m.extend(x.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,i){this._rotation=i,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this._rect;return!((t=b(t,this.center(),-this._rotation)).x<e.x-1||t.y<e.y-1||t.x>e.x+e.w+2||t.y>e.y+e.h+2)},intersects:function(t){var e,i,n,o=this._points(),r=t._points(),a=[_(o[0],o[1]),_(o[0],o[3])];for(this._rotation!==t._rotation&&a.push(_(r[0],r[1]),_(r[0],r[3])),e=0;e<a.length;++e)if(i=w(o,a[e]),n=w(r,a[e]),i.max<n.min||n.max<i.min)return!1;return!0},_points:function(){var t=this._rect,e=this._rotation,i=this.center();return[b({x:t.x,y:t.y},i,e),b({x:t.x+t.w,y:t.y},i,e),b({x:t.x+t.w,y:t.y+t.h},i,e),b({x:t.x,y:t.y+t.h},i,e)]}});var E={prepare:function(t){var e,i,n,o,r,a=[];for(e=0,n=t.length;e<n;++e)for(i=0,o=t[e].length;i<o;++i)r=t[e][i],a.push(r),r.$layout={_box:new x,_hidable:!1,_visible:!0,_set:e,_idx:i};return a.sort((function(t,e){var i=t.$layout,n=e.$layout;return i._idx===n._idx?n._set-i._set:n._idx-i._idx})),this.update(a),a},update:function(t){var e,i,n,o,r,a=!1;for(e=0,i=t.length;e<i;++e)o=(n=t[e]).model(),(r=n.$layout)._hidable=o&&"auto"===o.display,r._visible=n.visible(),a|=r._hidable;a&&function(t){var e,i,n,o,r,a;for(e=0,i=t.length;e<i;++e)(o=(n=t[e]).$layout)._visible&&(r=n.geometry(),a=C(n._el._model,n.model(),r),o._box.update(a,r,n.rotation()));!function(t,e){var i,n,o,r;for(i=t.length-1;i>=0;--i)for(o=t[i].$layout,n=i-1;n>=0&&o._visible;--n)(r=t[n].$layout)._visible&&o._box.intersects(r._box)&&e(o,r)}(t,(function(t,e){var i=t._hidable,n=e._hidable;i&&n||n?e._visible=!1:i&&(t._visible=!1)}))}(t)},lookup:function(t,e){var i,n;for(i=t.length-1;i>=0;--i)if((n=t[i].$layout)&&n._visible&&n._box.contains(e))return t[i];return null},draw:function(t,e){var i,n,o,r,a,s;for(i=0,n=e.length;i<n;++i)(r=(o=e[i]).$layout)._visible&&(a=o.geometry(),s=C(o._el._view,o.model(),a),r._box.update(s,a,o.rotation()),o.draw(t,s))}},k=t.helpers,S={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if(k.isNullOrUndef(t))return null;var e,i,n,o=t;if(k.isObject(t))if(k.isNullOrUndef(t.label))if(k.isNullOrUndef(t.r))for(o="",n=0,i=(e=Object.keys(t)).length;n<i;++n)o+=(0!==n?", ":"")+e[n]+": "+t[e[n]];else o=t.r;else o=t.label;return""+o},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},M=t.helpers,T="$datalabels";function R(t,e,i){if(e){var n,o=i.$context,r=i.$groups;e[r._set]&&(n=e[r._set][r._key])&&!0===M.callback(n,[o])&&(t[T]._dirty=!0,i.update(o))}}function P(t,e){var i,n,o=t[T],r=o._listeners;if(r.enter||r.leave){if("mousemove"===e.type)n=E.lookup(o._labels,e);else if("mouseout"!==e.type)return;i=o._hovered,o._hovered=n,function(t,e,i,n){var o,r;(i||n)&&(i?n?i!==n&&(r=o=!0):r=!0:o=!0,r&&R(t,e.leave,i),o&&R(t,e.enter,n))}(t,r,i,n)}}t.defaults.global.plugins.datalabels=S;var D={id:"datalabels",beforeInit:function(t){t[T]={_actives:[]}},beforeUpdate:function(t){var e=t[T];e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,i){var n,o,r,a,s,l,u,c,h=e.index,d=t[T],p=d._datasets[h]=[],f=t.isDatasetVisible(h),m=t.data.datasets[h],v=function(t,e){var i,n,o,r=t.datalabels,a=[];return!1===r?null:(!0===r&&(r={}),e=M.merge({},[e,r]),n=e.labels||{},o=Object.keys(n),delete e.labels,o.length?o.forEach((function(t){n[t]&&a.push(M.merge({},[e,n[t],{_key:t}]))})):a.push(e),i=a.reduce((function(t,e){return M.each(e.listeners||{},(function(i,n){t[n]=t[n]||{},t[n][e._key||"$default"]=i})),delete e.listeners,t}),{}),{labels:a,listeners:i})}(m,i),y=e.meta.data||[],b=t.ctx;for(b.save(),n=0,r=y.length;n<r;++n)if((u=y[n])[T]=[],f&&u&&!u.hidden&&!u._model.skip)for(o=0,a=v.labels.length;o<a;++o)l=(s=v.labels[o])._key,(c=new g(s,b,u,n)).$groups={_set:h,_key:l||"$default"},c.$context={active:!1,chart:t,dataIndex:n,dataset:m,datasetIndex:h},c.update(c.$context),u[T].push(c),p.push(c);b.restore(),M.merge(d._listeners,v.listeners,{merger:function(t,i,n){i[t]=i[t]||{},i[t][e.index]=n[t],d._listened=!0}})},afterUpdate:function(t,e){t[T]._labels=E.prepare(t[T]._datasets,e)},afterDatasetsDraw:function(t){E.draw(t,t[T]._labels)},beforeEvent:function(t,e){if(t[T]._listened)switch(e.type){case"mousemove":case"mouseout":P(t,e);break;case"click":!function(t,e){var i=t[T],n=i._listeners.click,o=n&&E.lookup(i._labels,e);o&&R(t,n,o)}(t,e)}},afterEvent:function(e){var i,o,r,a,s,l,u,c=e[T],h=c._actives,d=c._actives=e.lastActive||[],p=n.arrayDiff(h,d);for(i=0,o=p.length;i<o;++i)if((s=p[i])[1])for(r=0,a=(u=s[0][T]||[]).length;r<a;++r)(l=u[r]).$context.active=1===s[1],l.update(l.$context);(c._dirty||p.length)&&(E.update(c._labels),function(e){if(!e.animating){for(var i=t.animationService.animations,n=0,o=i.length;n<o;++n)if(i[n].chart===e)return;e.render({duration:1,lazy:!0})}}(e)),delete c._dirty}};return t.plugins.register(D),D}(i(14))},function(t,e,i){"use strict";i.r(e);var n=i(3);function o(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,r=e.length-1;o<e.length;r=o++){var a=e[o][0],s=e[o][1],l=e[r][0],u=e[r][1];if(t[1]*(a-l)+s*(l-t[0])+u*(t[0]-a)==0&&(a-t[0])*(l-t[0])<=0&&(s-t[1])*(u-t[1])<=0)return!i;s>t[1]!=u>t[1]&&t[0]<(l-a)*(t[1]-s)/(u-s)+a&&(n=!n)}return n}e.default=function(t,e,i){if("object"!=typeof(i=i||{}))throw new Error("options is invalid");var r=i.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var a=Object(n.a)(t),s=Object(n.b)(e),l=e.geometry?e.geometry.type:e.type,u=e.bbox;if(u&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(a,u))return!1;"Polygon"===l&&(s=[s]);for(var c=0,h=!1;c<s.length&&!h;c++)if(o(a,s[c][0],r)){for(var d=!1,p=1;p<s[c].length&&!d;)o(a,s[c][p],!r)&&(d=!0),p++;d||(h=!0)}return h}},function(t,e,i){"use strict";i.r(e),i.d(e,"earthRadius",(function(){return n})),i.d(e,"factors",(function(){return o})),i.d(e,"unitsFactors",(function(){return r})),i.d(e,"areaFactors",(function(){return a})),i.d(e,"feature",(function(){return s})),i.d(e,"geometry",(function(){return l})),i.d(e,"point",(function(){return u})),i.d(e,"points",(function(){return c})),i.d(e,"polygon",(function(){return h})),i.d(e,"polygons",(function(){return d})),i.d(e,"lineString",(function(){return p})),i.d(e,"lineStrings",(function(){return f})),i.d(e,"featureCollection",(function(){return g})),i.d(e,"multiLineString",(function(){return m})),i.d(e,"multiPoint",(function(){return v})),i.d(e,"multiPolygon",(function(){return y})),i.d(e,"geometryCollection",(function(){return b})),i.d(e,"round",(function(){return w})),i.d(e,"radiansToLength",(function(){return _})),i.d(e,"lengthToRadians",(function(){return x})),i.d(e,"lengthToDegrees",(function(){return C})),i.d(e,"bearingToAzimuth",(function(){return E})),i.d(e,"radiansToDegrees",(function(){return k})),i.d(e,"degreesToRadians",(function(){return S})),i.d(e,"convertLength",(function(){return M})),i.d(e,"convertArea",(function(){return T})),i.d(e,"isNumber",(function(){return R})),i.d(e,"isObject",(function(){return P})),i.d(e,"validateBBox",(function(){return D})),i.d(e,"validateId",(function(){return L})),i.d(e,"radians2degrees",(function(){return F})),i.d(e,"degrees2radians",(function(){return O})),i.d(e,"distanceToDegrees",(function(){return A})),i.d(e,"distanceToRadians",(function(){return I})),i.d(e,"radiansToDistance",(function(){return j})),i.d(e,"bearingToAngle",(function(){return z})),i.d(e,"convertDistance",(function(){return N}));var n=6371008.8,o={meters:n,metres:n,millimeters:1e3*n,millimetres:1e3*n,centimeters:100*n,centimetres:100*n,kilometers:n/1e3,kilometres:n/1e3,miles:n/1609.344,nauticalmiles:n/1852,inches:39.37*n,yards:n/1.0936,feet:3.28084*n,radians:1,degrees:n/111325},r={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/n,degrees:1/111325},a={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function s(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.bbox,o=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&D(n),o&&L(o);var r={type:"Feature"};return o&&(r.id=o),n&&(r.bbox=n),r.properties=e||{},r.geometry=t,r}function l(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n,o=i.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(o&&D(o),t){case"Point":n=u(e).geometry;break;case"LineString":n=p(e).geometry;break;case"Polygon":n=h(e).geometry;break;case"MultiPoint":n=v(e).geometry;break;case"MultiLineString":n=m(e).geometry;break;case"MultiPolygon":n=y(e).geometry;break;default:throw new Error(t+" is invalid")}return o&&(n.bbox=o),n}function u(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!R(t[0])||!R(t[1]))throw new Error("coordinates must contain numbers");return s({type:"Point",coordinates:t},e,i)}function c(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return u(t,e)})),i)}function h(t,e,i){if(!t)throw new Error("coordinates is required");for(var n=0;n<t.length;n++){var o=t[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var r=0;r<o[o.length-1].length;r++){if(0===n&&0===r&&!R(o[0][0])||!R(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][r]!==o[0][r])throw new Error("First and last Position are not equivalent.")}}return s({type:"Polygon",coordinates:t},e,i)}function d(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return h(t,e)})),i)}function p(t,e,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!R(t[0][1])||!R(t[0][1]))throw new Error("coordinates must contain numbers");return s({type:"LineString",coordinates:t},e,i)}function f(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return p(t,e)})),i)}function g(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");i&&D(i),n&&L(n);var o={type:"FeatureCollection"};return n&&(o.id=n),i&&(o.bbox=i),o.features=t,o}function m(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiLineString",coordinates:t},e,i)}function v(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiPoint",coordinates:t},e,i)}function y(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiPolygon",coordinates:t},e,i)}function b(t,e,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return s({type:"GeometryCollection",geometries:t},e,i)}function w(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i}function _(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=o[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t*i}function x(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=o[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t/i}function C(t,e){return k(x(t,e))}function E(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function k(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function S(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function M(t,e,i){if(null==t)throw new Error("length is required");if(!(t>=0))throw new Error("length must be a positive number");return _(x(t,e),i||"kilometers")}function T(t,e,i){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var n=a[e||"meters"];if(!n)throw new Error("invalid original units");var o=a[i||"kilometers"];if(!o)throw new Error("invalid final units");return t/n*o}function R(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function P(t){return!!t&&t.constructor===Object}function D(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!R(t))throw new Error("bbox must only contain numbers")}))}function L(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function F(){throw new Error("method has been renamed to `radiansToDegrees`")}function O(){throw new Error("method has been renamed to `degreesToRadians`")}function A(){throw new Error("method has been renamed to `lengthToDegrees`")}function I(){throw new Error("method has been renamed to `lengthToRadians`")}function j(){throw new Error("method has been renamed to `radiansToLength`")}function z(){throw new Error("method has been renamed to `bearingToAzimuth`")}function N(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,i){"use strict";function n(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function o(t,e,i){return void 0===i&&(i={}),n({type:"Point",coordinates:t},e,i)}function r(t,e,i){void 0===i&&(i={});for(var o=0,r=t;o<r.length;o++){var a=r[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function a(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function s(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function c(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function h(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t*n}function d(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t/n}function p(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,i){switch(void 0===i&&(i={}),t){case"Point":return o(e).geometry;case"LineString":return a(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=o,e.points=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return o(t,e)})),i)},e.polygon=r,e.polygons=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return r(t,e)})),i)},e.lineString=a,e.lineStrings=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return a(t,e)})),i)},e.featureCollection=s,e.multiLineString=l,e.multiPoint=u,e.multiPolygon=c,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},e.radiansToLength=h,e.lengthToRadians=d,e.lengthToDegrees=function(t,e){return p(d(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return h(d(t,e),i)},e.convertArea=function(t,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var o=e.areaFactors[i];if(!o)throw new Error("invalid original units");var r=e.areaFactors[n];if(!r)throw new Error("invalid final units");return t/o*r},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,i){"use strict";i.r(e),i.d(e,"earthRadius",(function(){return n})),i.d(e,"factors",(function(){return o})),i.d(e,"unitsFactors",(function(){return r})),i.d(e,"areaFactors",(function(){return a})),i.d(e,"feature",(function(){return s})),i.d(e,"geometry",(function(){return l})),i.d(e,"point",(function(){return u})),i.d(e,"points",(function(){return c})),i.d(e,"polygon",(function(){return h})),i.d(e,"polygons",(function(){return d})),i.d(e,"lineString",(function(){return p})),i.d(e,"lineStrings",(function(){return f})),i.d(e,"featureCollection",(function(){return g})),i.d(e,"multiLineString",(function(){return m})),i.d(e,"multiPoint",(function(){return v})),i.d(e,"multiPolygon",(function(){return y})),i.d(e,"geometryCollection",(function(){return b})),i.d(e,"round",(function(){return w})),i.d(e,"radiansToLength",(function(){return _})),i.d(e,"lengthToRadians",(function(){return x})),i.d(e,"lengthToDegrees",(function(){return C})),i.d(e,"bearingToAzimuth",(function(){return E})),i.d(e,"radiansToDegrees",(function(){return k})),i.d(e,"degreesToRadians",(function(){return S})),i.d(e,"convertLength",(function(){return M})),i.d(e,"convertArea",(function(){return T})),i.d(e,"isNumber",(function(){return R})),i.d(e,"isObject",(function(){return P})),i.d(e,"validateBBox",(function(){return D})),i.d(e,"validateId",(function(){return L})),i.d(e,"radians2degrees",(function(){return F})),i.d(e,"degrees2radians",(function(){return O})),i.d(e,"distanceToDegrees",(function(){return A})),i.d(e,"distanceToRadians",(function(){return I})),i.d(e,"radiansToDistance",(function(){return j})),i.d(e,"bearingToAngle",(function(){return z})),i.d(e,"convertDistance",(function(){return N}));var n=6371008.8,o={meters:n,metres:n,millimeters:1e3*n,millimetres:1e3*n,centimeters:100*n,centimetres:100*n,kilometers:n/1e3,kilometres:n/1e3,miles:n/1609.344,nauticalmiles:n/1852,inches:39.37*n,yards:n/1.0936,feet:3.28084*n,radians:1,degrees:n/111325},r={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/n,degrees:1/111325},a={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function s(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.bbox,o=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&D(n),o&&L(o);var r={type:"Feature"};return o&&(r.id=o),n&&(r.bbox=n),r.properties=e||{},r.geometry=t,r}function l(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n,o=i.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(o&&D(o),t){case"Point":n=u(e).geometry;break;case"LineString":n=p(e).geometry;break;case"Polygon":n=h(e).geometry;break;case"MultiPoint":n=v(e).geometry;break;case"MultiLineString":n=m(e).geometry;break;case"MultiPolygon":n=y(e).geometry;break;default:throw new Error(t+" is invalid")}return o&&(n.bbox=o),n}function u(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!R(t[0])||!R(t[1]))throw new Error("coordinates must contain numbers");return s({type:"Point",coordinates:t},e,i)}function c(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return u(t,e)})),i)}function h(t,e,i){if(!t)throw new Error("coordinates is required");for(var n=0;n<t.length;n++){var o=t[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var r=0;r<o[o.length-1].length;r++){if(0===n&&0===r&&!R(o[0][0])||!R(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][r]!==o[0][r])throw new Error("First and last Position are not equivalent.")}}return s({type:"Polygon",coordinates:t},e,i)}function d(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return h(t,e)})),i)}function p(t,e,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!R(t[0][1])||!R(t[0][1]))throw new Error("coordinates must contain numbers");return s({type:"LineString",coordinates:t},e,i)}function f(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return g(t.map((function(t){return p(t,e)})),i)}function g(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");i&&D(i),n&&L(n);var o={type:"FeatureCollection"};return n&&(o.id=n),i&&(o.bbox=i),o.features=t,o}function m(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiLineString",coordinates:t},e,i)}function v(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiPoint",coordinates:t},e,i)}function y(t,e,i){if(!t)throw new Error("coordinates is required");return s({type:"MultiPolygon",coordinates:t},e,i)}function b(t,e,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return s({type:"GeometryCollection",geometries:t},e,i)}function w(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i}function _(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=o[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t*i}function x(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=o[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t/i}function C(t,e){return k(x(t,e))}function E(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function k(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function S(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function M(t,e,i){if(null==t)throw new Error("length is required");if(!(t>=0))throw new Error("length must be a positive number");return _(x(t,e),i||"kilometers")}function T(t,e,i){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var n=a[e||"meters"];if(!n)throw new Error("invalid original units");var o=a[i||"kilometers"];if(!o)throw new Error("invalid final units");return t/n*o}function R(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function P(t){return!!t&&t.constructor===Object}function D(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!R(t))throw new Error("bbox must only contain numbers")}))}function L(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function F(){throw new Error("method has been renamed to `radiansToDegrees`")}function O(){throw new Error("method has been renamed to `degreesToRadians`")}function A(){throw new Error("method has been renamed to `lengthToDegrees`")}function I(){throw new Error("method has been renamed to `lengthToRadians`")}function j(){throw new Error("method has been renamed to `radiansToLength`")}function z(){throw new Error("method has been renamed to `bearingToAzimuth`")}function N(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,i){var n=i(73),o=i(104),r=i(33),a=i(106),s=i(116),l=i(119),u=i(120),c=i(121),h=i(123),d=i(124),p=i(125),f=i(24),g=i(130),m=i(131),v=i(137),y=i(18),b=i(36),w=i(139),_=i(4),x=i(141),C=i(17),E={};E["[object Arguments]"]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object DataView]"]=E["[object Boolean]"]=E["[object Date]"]=E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Map]"]=E["[object Number]"]=E["[object Object]"]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object Symbol]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Error]"]=E["[object Function]"]=E["[object WeakMap]"]=!1,t.exports=function t(e,i,k,S,M,T){var R,P=1&i,D=2&i,L=4&i;if(k&&(R=M?k(e,S,M,T):k(e)),void 0!==R)return R;if(!_(e))return e;var F=y(e);if(F){if(R=g(e),!P)return u(e,R)}else{var O=f(e),A="[object Function]"==O||"[object GeneratorFunction]"==O;if(b(e))return l(e,P);if("[object Object]"==O||"[object Arguments]"==O||A&&!M){if(R=D||A?{}:v(e),!P)return D?h(e,s(R,e)):c(e,a(R,e))}else{if(!E[O])return M?e:{};R=m(e,O,P)}}T||(T=new n);var I=T.get(e);if(I)return I;T.set(e,R),x(e)?e.forEach((function(n){R.add(t(n,i,k,n,e,T))})):w(e)&&e.forEach((function(n,o){R.set(o,t(n,i,k,o,e,T))}));var j=L?D?p:d:D?keysIn:C,z=F?void 0:j(e);return o(z||e,(function(n,o){z&&(n=e[o=n]),r(R,o,t(n,i,k,o,e,T))})),R}},function(t,e,i){var n=i(6),o=i(79),r=i(80),a=i(81),s=i(82),l=i(83);function u(t){var e=this.__data__=new n(t);this.size=e.size}u.prototype.clear=o,u.prototype.delete=r,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,i){var n=i(7),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=n(e,t);return!(i<0)&&(i==e.length-1?e.pop():o.call(e,i,1),--this.size,!0)}},function(t,e,i){var n=i(7);t.exports=function(t){var e=this.__data__,i=n(e,t);return i<0?void 0:e[i][1]}},function(t,e,i){var n=i(7);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,i){var n=i(7);t.exports=function(t,e){var i=this.__data__,o=n(i,t);return o<0?(++this.size,i.push([t,e])):i[o][1]=e,this}},function(t,e,i){var n=i(6);t.exports=function(){this.__data__=new n,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,i){var n=i(6),o=i(15),r=i(91);t.exports=function(t,e){var i=this.__data__;if(i instanceof n){var a=i.__data__;if(!o||a.length<199)return a.push([t,e]),this.size=++i.size,this;i=this.__data__=new r(a)}return i.set(t,e),this.size=i.size,this}},function(t,e,i){var n=i(30),o=i(88),r=i(4),a=i(32),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,h=u.hasOwnProperty,d=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!r(t)||o(t))&&(n(t)?d:s).test(a(t))}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(16),o=Object.prototype,r=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=r.call(t,s),i=t[s];try{t[s]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(e?t[s]=i:delete t[s]),o}},function(t,e){var i=Object.prototype.toString;t.exports=function(t){return i.call(t)}},function(t,e,i){var n,o=i(89),r=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!r&&r in t}},function(t,e,i){var n=i(0)["__core-js_shared__"];t.exports=n},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,i){var n=i(92),o=i(99),r=i(101),a=i(102),s=i(103);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(93),o=i(6),r=i(15);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(r||o),string:new n}}},function(t,e,i){var n=i(94),o=i(95),r=i(96),a=i(97),s=i(98);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=r,l.prototype.has=a,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(9);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,i){var n=i(9),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return o.call(e,t)?e[t]:void 0}},function(t,e,i){var n=i(9),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}},function(t,e,i){var n=i(9);t.exports=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=n&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,i){var n=i(10);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,i){var n=i(10);t.exports=function(t){return n(this,t).get(t)}},function(t,e,i){var n=i(10);t.exports=function(t){return n(this,t).has(t)}},function(t,e,i){var n=i(10);t.exports=function(t,e){var i=n(this,t),o=i.size;return i.set(t,e),this.size+=i.size==o?0:1,this}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}},function(t,e,i){var n=i(2),o=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e,i){var n=i(11),o=i(17);t.exports=function(t,e){return t&&n(e,o(e),t)}},function(t,e){t.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}},function(t,e,i){var n=i(109),o=i(5),r=Object.prototype,a=r.hasOwnProperty,s=r.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e,i){var n=i(8),o=i(5);t.exports=function(t){return o(t)&&"[object Arguments]"==n(t)}},function(t,e){t.exports=function(){return!1}},function(t,e){var i=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&i.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,i){var n=i(113),o=i(20),r=i(21),a=r&&r.isTypedArray,s=a?o(a):n;t.exports=s},function(t,e,i){var n=i(8),o=i(37),r=i(5),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return r(t)&&o(t.length)&&!!a[n(t)]}},function(t,e,i){var n=i(22),o=i(115),r=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return o(t);var e=[];for(var i in Object(t))r.call(t,i)&&"constructor"!=i&&e.push(i);return e}},function(t,e,i){var n=i(38)(Object.keys,Object);t.exports=n},function(t,e,i){var n=i(11),o=i(40);t.exports=function(t,e){return t&&n(e,o(e),t)}},function(t,e,i){var n=i(4),o=i(22),r=i(118),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return r(t);var e=o(t),i=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&i.push(s);return i}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}},function(t,e,i){(function(t){var n=i(0),o=e&&!e.nodeType&&e,r=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=r&&r.exports===o?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var i=t.length,n=s?s(i):new t.constructor(i);return t.copy(n),n}}).call(this,i(19)(t))},function(t,e){t.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}},function(t,e,i){var n=i(11),o=i(23);t.exports=function(t,e){return n(t,o(t),e)}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,o=0,r=[];++i<n;){var a=t[i];e(a,i,t)&&(r[o++]=a)}return r}},function(t,e,i){var n=i(11),o=i(42);t.exports=function(t,e){return n(t,o(t),e)}},function(t,e,i){var n=i(45),o=i(23),r=i(17);t.exports=function(t){return n(t,r,o)}},function(t,e,i){var n=i(45),o=i(42),r=i(40);t.exports=function(t){return n(t,r,o)}},function(t,e,i){var n=i(2)(i(0),"DataView");t.exports=n},function(t,e,i){var n=i(2)(i(0),"Promise");t.exports=n},function(t,e,i){var n=i(2)(i(0),"Set");t.exports=n},function(t,e,i){var n=i(2)(i(0),"WeakMap");t.exports=n},function(t,e){var i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},function(t,e,i){var n=i(25),o=i(133),r=i(134),a=i(135),s=i(136);t.exports=function(t,e,i){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return n(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return o(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,i);case"[object Map]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return r(t);case"[object Set]":return new l;case"[object Symbol]":return a(t)}}},function(t,e,i){var n=i(0).Uint8Array;t.exports=n},function(t,e,i){var n=i(25);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}},function(t,e){var i=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,i.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,i){var n=i(16),o=n?n.prototype:void 0,r=o?o.valueOf:void 0;t.exports=function(t){return r?Object(r.call(t)):{}}},function(t,e,i){var n=i(25);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}},function(t,e,i){var n=i(138),o=i(44),r=i(22);t.exports=function(t){return"function"!=typeof t.constructor||r(t)?{}:n(o(t))}},function(t,e,i){var n=i(4),o=Object.create,r=function(){function t(){}return function(e){if(!n(e))return{};if(o)return o(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=r},function(t,e,i){var n=i(140),o=i(20),r=i(21),a=r&&r.isMap,s=a?o(a):n;t.exports=s},function(t,e,i){var n=i(24),o=i(5);t.exports=function(t){return o(t)&&"[object Map]"==n(t)}},function(t,e,i){var n=i(142),o=i(20),r=i(21),a=r&&r.isSet,s=a?o(a):n;t.exports=s},function(t,e,i){var n=i(24),o=i(5);t.exports=function(t){return o(t)&&"[object Set]"==n(t)}},function(t,e){var i=null,n=null;function o(t,e,i){t.addEventListener(e,(function(t){var o=new MouseEvent(i,t);o.pointerId=1,o.isPrimary=!0,o.pointerType="mouse",o.width=1,o.height=1,o.tiltX=0,o.tiltY=0,"buttons"in t&&0!==t.buttons?o.pressure=.5:o.pressure=0;var r=t.target;null!==n&&(r=n,"mouseup"===e&&(n=null)),r.dispatchEvent(o),o.defaultPrevented&&t.preventDefault()}))}function r(t,e,n){t.addEventListener(e,(function(t){for(var o=t.changedTouches,r=o.length,a=0;a<r;a++){var s=new CustomEvent(n,{bubbles:!0,cancelable:!0});s.ctrlKey=t.ctrlKey,s.shiftKey=t.shiftKey,s.altKey=t.altKey,s.metaKey=t.metaKey;var l=o.item(a);s.clientX=l.clientX,s.clientY=l.clientY,s.screenX=l.screenX,s.screenY=l.screenY,s.pageX=l.pageX,s.pageY=l.pageY;var u=l.target.getBoundingClientRect();s.offsetX=l.clientX-u.left,s.offsetY=l.clientY-u.top,s.pointerId=1+l.identifier,s.button=0,s.buttons=1,s.movementX=0,s.movementY=0,s.region=null,s.relatedTarget=null,s.x=s.clientX,s.y=s.clientY,s.pointerType="touch",s.width=1,s.height=1,s.tiltX=0,s.tiltY=0,s.pressure=1,"touchstart"===e&&null===i&&(i=l.identifier),s.isPrimary=l.identifier===i,"touchend"===e&&s.isPrimary&&(i=null),t.target.dispatchEvent(s),s.defaultPrevented&&t.preventDefault()}}))}"PointerEvent"in window||(Element.prototype.setPointerCapture=Element.prototype.setCapture,Element.prototype.releasePointerCapture=Element.prototype.releaseCapture,"TouchEvent"in window||(o(document,"mousedown","pointerdown"),o(document,"mousemove","pointermove"),o(document,"mouseup","pointerup")),r(document,"touchstart","pointerdown"),r(document,"touchmove","pointermove"),r(document,"touchend","pointerup"))},function(t,e){e.read=function(t,e,i,n,o){var r,a,s=8*o-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?o-1:0,d=i?-1:1,p=t[e+h];for(h+=d,r=p&(1<<-c)-1,p>>=-c,c+=s;c>0;r=256*r+t[e+h],h+=d,c-=8);for(a=r&(1<<-c)-1,r>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=d,c-=8);if(0===r)r=1-u;else{if(r===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),r-=u}return(p?-1:1)*a*Math.pow(2,r-n)},e.write=function(t,e,i,n,o,r){var a,s,l,u=8*r-o-1,c=(1<<u)-1,h=c>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;t[i+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[i+p]=255&a,p+=f,a/=256,u-=8);t[i+p-f]|=128*g}},function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"svg_symbols",(function(){return p})),i.d(n,"paramString",(function(){return C})),i.d(n,"loadScript",(function(){return E})),i.d(n,"toggleExpanderParent",(function(){return k})),i.d(n,"copyToClipboard",(function(){return S})),i.d(n,"createElement",(function(){return M})),i.d(n,"dataURLtoBlob",(function(){return T})),i.d(n,"getCircularReplacer",(function(){return R})),i.d(n,"deepMerge",(function(){return P})),i.d(n,"compose",(function(){return Y})),i.d(n,"touch",(function(){return X})),i.d(n,"flatpickr",(function(){return A})),i.d(n,"formatDate",(function(){return j})),i.d(n,"formatDateTime",(function(){return z})),i.d(n,"meltDateStr",(function(){return I})),i.d(n,"wire",(function(){return h})),i.d(n,"bind",(function(){return s})),i.d(n,"Tabulator",(function(){return N})),i.d(n,"TabulatorFormatter",(function(){return H})),i.d(n,"Chroma",(function(){return d})),i.d(n,"Chart",(function(){return B})),i.d(n,"JWTDecode",(function(){return G})),i.d(n,"turf",(function(){return U})),i.d(n,"cloneDeep",(function(){return $}));var o={};i.r(o),i.d(o,"Circle",(function(){return eh})),i.d(o,"Geometry",(function(){return hn})),i.d(o,"GeometryCollection",(function(){return Do})),i.d(o,"LineString",(function(){return Bn})),i.d(o,"MultiLineString",(function(){return Vn})),i.d(o,"MultiPoint",(function(){return Yn})),i.d(o,"MultiPolygon",(function(){return fo})),i.d(o,"Point",(function(){return qn})),i.d(o,"Polygon",(function(){return so})),i.d(o,"LinearRing",(function(){return Zn}));
/*! (c) Andrea Giammarchi (ISC) */var r=function(t){
/*! (c) Andrea Giammarchi - ISC */var e={};try{e.WeakMap=WeakMap}catch(c){e.WeakMap=function(t,e){var i=e.defineProperty,n=e.hasOwnProperty,o=r.prototype;return o.delete=function(t){return this.has(t)&&delete t[this._]},o.get=function(t){return this.has(t)?t[this._]:void 0},o.has=function(t){return n.call(t,this._)},o.set=function(t,e){return i(t,this._,{configurable:!0,value:e}),this},r;function r(e){i(this,"_",{value:"_@ungap/weakmap"+t++}),e&&e.forEach(a,this)}function a(t){this.set(t[0],t[1])}}(Math.random(),Object)}var i=e.WeakMap,n={};
/*! (c) Andrea Giammarchi - ISC */try{n.WeakSet=WeakSet}catch(c){!function(t,e){var i=o.prototype;function o(){e(this,"_",{value:"_@ungap/weakmap"+t++})}i.add=function(t){return this.has(t)||e(t,this._,{value:!0,configurable:!0}),this},i.has=function(t){return this.hasOwnProperty.call(t,this._)},i.delete=function(t){return this.has(t)&&delete t[this._]},n.WeakSet=o}(Math.random(),Object.defineProperty)}function o(t,e,i,n,o,r){for(var a=("selectedIndex"in e),s=a;n<o;){var l=t(i[n],1);if(e.insertBefore(l,r),a&&s&&l.selected){s=!s;var u=e.selectedIndex;e.selectedIndex=u<0?n:h.call(e.querySelectorAll("option"),l)}n++}}function r(t,e){return t==e}function a(t){return t}function s(t,e,i,n,o,r,a){var s=r-o;if(s<1)return-1;for(;s<=i-e;){for(var l=e,u=o;l<i&&u<r&&a(t[l],n[u]);)l++,u++;if(u===r)return e;e=l+1}return-1}function l(t,e,i,n,o){return i<n?t(e[i],0):0<i?t(e[i-1],-0).nextSibling:o}function u(t,e,i,n){for(;i<n;)p(t(e[i++],-1))}var c=n.WeakSet,h=[].indexOf,d=function(t,e,i){for(var n=1,o=e;n<o;){var r=(n+o)/2>>>0;i<t[r]?o=r:n=1+r}return n},p=function(t){return(t.remove||function(){var t=this.parentNode;t&&t.removeChild(this)}
/*! (c) 2018 Andrea Giammarchi (ISC) */).call(t)};function f(t,e,i,n){for(var c=(n=n||{}).compare||r,h=n.node||a,p=null==n.before?null:h(n.before,0),f=e.length,g=f,m=0,v=i.length,y=0;m<g&&y<v&&c(e[m],i[y]);)m++,y++;for(;m<g&&y<v&&c(e[g-1],i[v-1]);)g--,v--;var b=m===g,w=y===v;if(b&&w)return i;if(b&&y<v)return o(h,t,i,y,v,l(h,e,m,f,p)),i;if(w&&m<g)return u(h,e,m,g),i;var _=g-m,x=v-y,C=-1;if(_<x){if(-1<(C=s(i,y,v,e,m,g,c)))return o(h,t,i,y,C,h(e[m],0)),o(h,t,i,C+_,v,l(h,e,g,f,p)),i}else if(x<_&&-1<(C=s(e,m,g,i,y,v,c)))return u(h,e,m,C),u(h,e,C+x,g),i;return _<2||x<2?(o(h,t,i,y,v,h(e[m],0)),u(h,e,m,g)):_==x&&function(t,e,i,n,o,r){for(;n<o&&r(i[n],t[e-1]);)n++,e--;return 0===e}(i,v,e,m,g,c)?o(h,t,i,y,v,l(h,e,g,f,p)):function(t,e,i,n,r,a,s,l,c,h,p,f,g){!function(t,e,i,n,r,a,s,l,c){for(var h=[],d=t.length,p=s,f=0;f<d;)switch(t[f++]){case 0:r++,p++;break;case 1:h.push(n[r]),o(e,i,n,r++,r,p<l?e(a[p],0):c);break;case-1:p++}for(f=0;f<d;)switch(t[f++]){case 0:s++;break;case-1:-1<h.indexOf(a[s])?s++:u(e,a,s++,s)}}(function(t,e,i,n,o,r,a){var s,l,u,c,h,d,p,f=i+r,g=[];t:for(s=0;s<=f;s++){if(50<s)return null;for(p=s-1,h=s?g[s-1]:[0,0],d=g[s]=[],l=-s;l<=s;l+=2){for(u=(c=l===-s||l!==s&&h[p+l-1]<h[p+l+1]?h[p+l+1]:h[p+l-1]+1)-l;c<r&&u<i&&a(n[o+c],t[e+u]);)c++,u++;if(c===r&&u===i)break t;d[s+l]=c}}var m=Array(s/2+f/2),v=m.length-1;for(s=g.length-1;0<=s;s--){for(;0<c&&0<u&&a(n[o+c-1],t[e+u-1]);)m[v--]=0,c--,u--;if(!s)break;p=s-1,h=s?g[s-1]:[0,0],(l=c-u)==-s||l!==s&&h[p+l-1]<h[p+l+1]?(u--,m[v--]=1):(c--,m[v--]=-1)}return m}(i,n,a,s,l,h,f)||function(t,e,i,n,o,r,a,s){var l=0,u=n<s?n:s,c=Array(u++),h=Array(u);h[0]=-1;for(var p=1;p<u;p++)h[p]=a;for(var f=o.slice(r,a),g=e;g<i;g++){var m=f.indexOf(t[g]);if(-1<m){var v=m+r;-1<(l=d(h,u,v))&&(h[l]=v,c[l]={newi:g,oldi:v,prev:c[l-1]})}}for(l=--u,--a;h[l]>a;)--l;u=s+n-l;var y=Array(u),b=c[l];for(--i;b;){for(var w=b.newi,_=b.oldi;w<i;)y[--u]=1,--i;for(;_<a;)y[--u]=-1,--a;y[--u]=0,--i,--a,b=b.prev}for(;e<=i;)y[--u]=1,--i;for(;r<=a;)y[--u]=-1,--a;return y}(i,n,r,a,s,l,c,h),t,e,i,n,s,l,p,g)}(h,t,i,y,v,x,e,m,g,_,f,c,p),i}var g={};
/*! (c) Andrea Giammarchi - ISC */function m(e,i){i=i||{};var n=t.createEvent("CustomEvent");return n.initCustomEvent(e,!!i.bubbles,!!i.cancelable,i.detail),n}g.CustomEvent="function"==typeof CustomEvent?CustomEvent:(m["prototype"]=new m("").constructor.prototype,m);var v=g.CustomEvent,y={};
/*! (c) Andrea Giammarchi - ISC */try{y.Map=Map}catch(c){y.Map=function(){var t=0,e=[],i=[];return{delete:function(o){var r=n(o);return r&&(e.splice(t,1),i.splice(t,1)),r},forEach:function(t,n){e.forEach((function(e,o){t.call(n,i[o],e,this)}),this)},get:function(e){return n(e)?i[t]:void 0},has:function(t){return n(t)},set:function(o,r){return i[n(o)?t:e.push(o)-1]=r,this}};function n(i){return-1<(t=e.indexOf(i))}}}var b=y.Map;function w(){return this}function _(t,e){var i="_"+t+"$";return{get:function(){return this[i]||x(this,i,e.call(this,t))},set:function(t){x(this,i,t)}}}var x=function(t,e,i){return Object.defineProperty(t,e,{configurable:!0,value:"function"==typeof i?function(){return t._wire$=i.apply(this,arguments)}:i})[e]};Object.defineProperties(w.prototype,{ELEMENT_NODE:{value:1},nodeType:{value:-1}});var C,E,k,S,M,T,R={},P={},D=[],L=P.hasOwnProperty,F=0,O={attributes:R,define:function(t,e){t.indexOf("-")<0?(t in P||(F=D.push(t)),P[t]=e):R[t]=e},invoke:function(t,e){for(var i=0;i<F;i++){var n=D[i];if(L.call(t,n))return P[n](t[n],e)}}},A=Array.isArray||(E=(C={}.toString).call([]),function(t){return C.call(t)===E}),I=(k=t,S="fragment",T="content"in z(M="template")?function(t){var e=z(M);return e.innerHTML=t,e.content}:function(t){var e=z(S),i=z(M),n=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(t)){var o=RegExp.$1;i.innerHTML="<table>"+t+"</table>",n=i.querySelectorAll(o)}else i.innerHTML=t,n=i.childNodes;return j(e,n),e},function(t,e){return("svg"===e?function(t){var e=z(S),i=z("div");return i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t+"</svg>",j(e,i.firstChild.childNodes),e}:T)(t)});function j(t,e){for(var i=e.length;i--;)t.appendChild(e[0])}function z(t){return t===S?k.createDocumentFragment():k.createElementNS("http://www.w3.org/1999/xhtml",t)}
/*! (c) Andrea Giammarchi - ISC */var N,H,B,G,V,W,q,$,Y,X=(H="appendChild",B="cloneNode",G="createTextNode",W=(V="importNode")in(N=t),(q=N.createDocumentFragment())[H](N[G]("g")),q[H](N[G]("")),(W?N[V](q,!0):q[B](!0)).childNodes.length<2?function t(e,i){for(var n=e[B](),o=e.childNodes||[],r=o.length,a=0;i&&a<r;a++)n[H](t(o[a],i));return n}:W?N[V]:function(t,e){return t[B](!!e)}),U="".trim||function(){return String(this).replace(/^\s+|\s+/g,"")},K="-"+Math.random().toFixed(6)+"%",Z=!1;try{$=t.createElement("template"),Y="tabindex","content"in $&&($.innerHTML="<p "+Y+'="'+K+'"></p>',$.content.childNodes[0].getAttribute(Y)==K)||(K="_dt: "+K.slice(1,-1)+";",Z=!0)}catch(c){}var J="\x3c!--"+K+"--\x3e",Q=/^(?:style|textarea)$/i,tt=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,et=" \\f\\n\\r\\t",it="[^"+et+"\\/>\"'=]+",nt="["+et+"]+"+it,ot="<([A-Za-z]+[A-Za-z0-9:._-]*)((?:",rt="(?:\\s*=\\s*(?:'[^']*?'|\"[^\"]*?\"|<[^>]*?>|"+it.replace("\\/","")+"))?)",at=new RegExp(ot+nt+rt+"+)(["+et+"]*/?>)","g"),st=new RegExp(ot+nt+rt+"*)(["+et+"]*/>)","g"),lt=new RegExp("("+nt+"\\s*=\\s*)(['\"]?)"+J+"\\2","gi");function ut(t,e,i,n){return"<"+e+i.replace(lt,ct)+n}function ct(t,e,i){return e+(i||'"')+K+(i||'"')}function ht(t,e,i){return tt.test(e)?t:"<"+e+i+"></"+e+">"}var dt=Z?function(t,e){var i=e.join(" ");return e.slice.call(t,0).sort((function(t,e){return i.indexOf(t.name)<=i.indexOf(e.name)?-1:1}))}:function(t,e){return e.slice.call(t,0)};function pt(t,e){for(var i=e.length,n=0;n<i;)t=t.childNodes[e[n++]];return t}function ft(e,i,n,o){for(var r=e.attributes,a=[],s=[],l=dt(r,n),u=l.length,c=0;c<u;){var h,d=l[c++],p=d.value===K;if(p||1<(h=d.value.split(J)).length){var f=d.name;if(a.indexOf(f)<0){a.push(f);var g=n.shift().replace(p?/^(?:|[\S\s]*?\s)(\S+?)\s*=\s*('|")?$/:new RegExp("^(?:|[\\S\\s]*?\\s)("+f+")\\s*=\\s*('|\")[\\S\\s]*","i"),"$1"),m=r[g]||r[g.toLowerCase()];if(p)i.push(gt(m,o,g,null));else{for(var v=h.length-2;v--;)n.shift();i.push(gt(m,o,g,h))}}s.push(d)}}for(var y=((c=0)<(u=s.length)&&Z&&!("ownerSVGElement"in e));c<u;){var b=s[c++];y&&(b.value=""),e.removeAttribute(b.name)}var w=e.nodeName;if(/^script$/i.test(w)){var _=t.createElement(w);for(u=r.length,c=0;c<u;)_.setAttributeNode(r[c++].cloneNode(!0));_.textContent=e.textContent,e.parentNode.replaceChild(_,e)}}function gt(t,e,i,n){return{type:"attr",node:t,path:e,name:i,sparse:n}}function mt(t,e){return{type:"text",node:t,path:e}}var vt,yt=(vt=new i,{get:function(t){return vt.get(t)},set:function(t,e){return vt.set(t,e),e}});function bt(t,e){var i=(t.convert||
/*! (c) Andrea Giammarchi - ISC */
function(t){return t.join(J).replace(st,ht).replace(at,ut)})(e),n=t.transform;n&&(i=n(i));var o=I(i,t.type);_t(o);var r=[];return function t(e,i,n,o){for(var r=e.childNodes,a=r.length,s=0;s<a;){var l=r[s];switch(l.nodeType){case 1:var u=o.concat(s);ft(l,i,n,u),t(l,i,n,u);break;case 8:var c=l.textContent;if(c===K)n.shift(),i.push(Q.test(e.nodeName)?mt(e,o):{type:"any",node:l,path:o.concat(s)});else switch(c.slice(0,2)){case"/*":if("*/"!==c.slice(-2))break;case"":e.removeChild(l),s--,a--}break;case 3:Q.test(e.nodeName)&&U.call(l.textContent)===J&&(n.shift(),i.push(mt(e,o)))}s++}}(o,r,e.slice(0),[]),{content:o,updates:function(i){for(var n=[],o=r.length,a=0,s=0;a<o;){var l=r[a++],u=pt(i,l.path);switch(l.type){case"any":n.push({fn:t.any(u,[]),sparse:!1});break;case"attr":var c=l.sparse,h=t.attribute(u,l.name,l.node);null===c?n.push({fn:h,sparse:!1}):(s+=c.length-2,n.push({fn:h,sparse:!0,values:c}));break;case"text":n.push({fn:t.text(u),sparse:!1}),u.textContent=""}}return o+=s,function(){var t=arguments.length;if(o!==t-1)throw new Error(t-1+" values instead of "+o+"\n"+e.join("${value}"));for(var r=1,a=1;r<t;){var s=n[r-a];if(s.sparse){var l=s.values,u=l[0],c=1,h=l.length;for(a+=h-2;c<h;)u+=arguments[r++]+l[c++];s.fn(u)}else s.fn(arguments[r++])}return i}}}}var wt=[];function _t(t){for(var e=t.childNodes,i=e.length;i--;){var n=e[i];1!==n.nodeType&&0===U.call(n.textContent).length&&t.removeChild(n)}}
/*! (c) Andrea Giammarchi - ISC */var xt,Ct,Et=(xt=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,Ct=/([^A-Z])([A-Z]+)/g,function(t,e){return"ownerSVGElement"in t?function(t,e){var i;return(i=e?e.cloneNode(!0):(t.setAttribute("style","--hyper:style;"),t.getAttributeNode("style"))).value="",t.setAttributeNode(i),St(i,!0)}(t,e):St(t.style,!1)});
/*! (c) Andrea Giammarchi - ISC */function kt(t,e,i){return e+"-"+i.toLowerCase()}function St(t,e){var i,n;return function(o){var r,a,s,l;switch(typeof o){case"object":if(o){if("object"===i){if(!e&&n!==o)for(a in n)a in o||(t[a]="")}else e?t.value="":t.cssText="";for(a in r=e?{}:t,o)s="number"!=typeof(l=o[a])||xt.test(a)?l:l+"px",!e&&/^--/.test(a)?r.setProperty(a,s):r[a]=s;i="object",e?t.value=function(t){var e,i=[];for(e in t)i.push(e.replace(Ct,kt),":",t[e],";");return i.join("")}(n=r):n=o;break}default:n!=o&&(i="string",n=o,e?t.value=o||"":t.cssText=o||"")}}}var Mt,Tt,Rt=(Mt=[].slice,(Tt=Pt.prototype).ELEMENT_NODE=1,Tt.nodeType=111,Tt.remove=function(t){var e=this.childNodes,i=this.firstChild,n=this.lastChild;if(this._=null,t&&2===e.length)n.parentNode.removeChild(n);else{var o=this.ownerDocument.createRange();o.setStartBefore(t?e[1]:i),o.setEndAfter(n),o.deleteContents()}return i},Tt.valueOf=function(t){var e=this._,i=null==e;if(i&&(e=this._=this.ownerDocument.createDocumentFragment()),i||t)for(var n=this.childNodes,o=0,r=n.length;o<r;o++)e.appendChild(n[o]);return e},Pt);function Pt(t){var e=this.childNodes=Mt.call(t,0);this.firstChild=e[0],this.lastChild=e[e.length-1],this.ownerDocument=e[0].ownerDocument,this._=null}function Dt(t){return{html:t}}function Lt(t,e){switch(t.nodeType){case Gt:return 1/e<0?e?t.remove(!0):t.lastChild:e?t.valueOf(!0):t.firstChild;case Bt:return Lt(t.render(),e);default:return t}}function Ft(t,e){e(t.placeholder),"text"in t?Promise.resolve(t.text).then(String).then(e):"any"in t?Promise.resolve(t.any).then(e):"html"in t?Promise.resolve(t.html).then(Dt).then(e):Promise.resolve(O.invoke(t,e)).then(e)}function Ot(t){return null!=t&&"then"in t}var At,It,jt,zt,Nt,Ht="ownerSVGElement",Bt=w.prototype.nodeType,Gt=Rt.prototype.nodeType,Vt=(It=(At={Event:v,WeakSet:c}).Event,jt=At.WeakSet,zt=!0,Nt=null,function(t){return zt&&(zt=!zt,Nt=new jt,function(t){var e=new jt,i=new jt;try{new MutationObserver(a).observe(t,{subtree:!0,childList:!0})}catch(e){var n=0,o=[],r=function(t){o.push(t),clearTimeout(n),n=setTimeout((function(){a(o.splice(n=0,o.length))}),0)};t.addEventListener("DOMNodeRemoved",(function(t){r({addedNodes:[],removedNodes:[t.target]})}),!0),t.addEventListener("DOMNodeInserted",(function(t){r({addedNodes:[t.target],removedNodes:[]})}),!0)}function a(t){for(var n,o=t.length,r=0;r<o;r++)s((n=t[r]).removedNodes,"disconnected",i,e),s(n.addedNodes,"connected",e,i)}function s(t,e,i,n){for(var o,r=new It(e),a=t.length,s=0;s<a;1===(o=t[s++]).nodeType&&l(o,r,e,i,n));}function l(t,e,i,n,o){Nt.has(t)&&!n.has(t)&&(o.delete(t),n.add(t),t.dispatchEvent(e));for(var r=t.children||[],a=r.length,s=0;s<a;l(r[s++],e,i,n,o));}}(t.ownerDocument)),Nt.add(t),t}),Wt=/^(?:form|list)$/i,qt=[].slice;function $t(e){return this.type=e,function(e){var i=wt,n=_t;return function(o){var r,a,s;return i!==o&&(r=e,a=i=o,s=yt.get(a)||yt.set(a,bt(r,a)),n=s.updates(X.call(t,s.content,!0))),n.apply(null,arguments)}}(this)}var Yt=!($t.prototype={attribute:function(t,e,i){var n,o=Ht in t;if("style"===e)return Et(t,i,o);if("."===e.slice(0,1))return a=t,s=e.slice(1),o?function(t){try{a[s]=t}catch(e){a.setAttribute(s,t)}}:function(t){a[s]=t};if(/^on/.test(e)){var r=e.slice(2);return"connected"===r||"disconnected"===r?Vt(t):e.toLowerCase()in t&&(r=r.toLowerCase()),function(e){n!==e&&(n&&t.removeEventListener(r,n,!1),(n=e)&&t.addEventListener(r,e,!1))}}if("data"===e||!o&&e in t&&!Wt.test(e))return function(i){n!==i&&(n=i,t[e]!==i&&null==i?(t[e]="",t.removeAttribute(e)):t[e]=i)};if(e in O.attributes)return function(i){var o=O.attributes[e](t,i);n!==o&&(null==(n=o)?t.removeAttribute(e):t.setAttribute(e,o))};var a,s,l=!1,u=i.cloneNode(!0);return function(e){n!==e&&(n=e,u.value!==e&&(null==e?(l&&(l=!1,t.removeAttributeNode(u)),u.value=e):(u.value=e,l||(l=!0,t.setAttributeNode(u)))))}},any:function(t,e){var i,n={node:Lt,before:t},o=Ht in t?"svg":"html",r=!1;return function a(s){switch(typeof s){case"string":case"number":case"boolean":r?i!==s&&(i=s,e[0].textContent=s):(r=!0,i=s,e=f(t.parentNode,e,[(l=s,t.ownerDocument.createTextNode(l))],n));break;case"function":a(s(t));break;case"object":case"undefined":if(null==s){r=!1,e=f(t.parentNode,e,[],n);break}default:if(r=!1,A(i=s))if(0===s.length)e.length&&(e=f(t.parentNode,e,[],n));else switch(typeof s[0]){case"string":case"number":case"boolean":a({html:s});break;case"object":if(A(s[0])&&(s=s.concat.apply([],s)),Ot(s[0])){Promise.all(s).then(a);break}default:e=f(t.parentNode,e,s,n)}else"ELEMENT_NODE"in s?e=f(t.parentNode,e,11===s.nodeType?qt.call(s.childNodes):[s],n):Ot(s)?s.then(a):"placeholder"in s?Ft(s,a):"text"in s?a(String(s.text)):"any"in s?a(s.any):"html"in s?e=f(t.parentNode,e,qt.call(I([].concat(s.html).join(""),o).childNodes),n):a("length"in s?qt.call(s):O.invoke(s,a))}var l}},text:function(t){var e;return function i(n){if(e!==n){var o=typeof(e=n);"object"==o&&n?Ot(n)?n.then(i):"placeholder"in n?Ft(n,i):i("text"in n?String(n.text):"any"in n?n.any:"html"in n?[].concat(n.html).join(""):"length"in n?qt.call(n).join(""):O.invoke(n,i)):"function"==o?i(n(t)):t.textContent=null==n?"":n}}}}),Xt=function(e){var n,o=(n=(t.defaultView.navigator||{}).userAgent,/(Firefox|Safari)\/(\d+)/.test(n)&&!/(Chrom[eium]+|Android)\/(\d+)/.test(n)),r=!("raw"in e)||e.propertyIsEnumerable("raw")||!Object.isFrozen(e.raw);if(o||r){var a={},s=function(t){for(var e=".",i=0;i<t.length;i++)e+=t[i].length+"."+t[i];return a[e]||(a[e]=t)};if(r)Xt=s;else{var l=new i;Xt=function(t){return l.get(t)||(i=s(e=t),l.set(e,i),i);var e,i}}}else Yt=!0;return Ut(e)};function Ut(t){return Yt?t:Xt(t)}function Kt(t){for(var e=arguments.length,i=[Ut(t)],n=1;n<e;)i.push(arguments[n++]);return i}var Zt=new i,Jt=function(t){var e,i,n;return function(){var o=Kt.apply(null,arguments);return n!==o[0]?(n=o[0],i=new $t(t),e=te(i.apply(i,o))):i.apply(i,o),e}},Qt=function(t,e){var i=e.indexOf(":"),n=Zt.get(t),o=e;return-1<i&&(o=e.slice(i+1),e=e.slice(0,i)||"html"),n||Zt.set(t,n={}),n[o]||(n[o]=Jt(e))},te=function(t){var e=t.childNodes,i=e.length;return 1===i?e[0]:i?new Rt(e):t},ee=new i;function ie(){var t=ee.get(this),e=Kt.apply(null,arguments);return t&&t.template===e[0]?t.tagger.apply(null,e):function(t){var e=new $t(Ht in this?"svg":"html");ee.set(this,{tagger:e,template:t}),this.textContent="",this.appendChild(e.apply(null,arguments))}
/*! (c) Andrea Giammarchi (ISC) */.apply(this,e),this}var ne,oe,re,ae,se=O.define,le=$t.prototype;function ue(t){return arguments.length<2?null==t?Jt("html"):"string"==typeof t?ue.wire(null,t):"raw"in t?Jt("html")(t):"nodeType"in t?ue.bind(t):Qt(t,"html"):("raw"in t?Jt("html"):ue.wire).apply(null,arguments)}return ue.Component=w,ue.bind=function(t){return ie.bind(t)},ue.define=se,ue.diff=f,(ue.hyper=ue).observe=Vt,ue.tagger=le,ue.wire=function(t,e){return null==t?Jt(e||"html"):Qt(t,e||"html")},ue._={WeakMap:i,WeakSet:c},ne=Jt,oe=new i,re=Object.create,ae=function(t,e){var i={w:null,p:null};return e.set(t,i),i},Object.defineProperties(w,{for:{configurable:!0,value:function(t,e){return function(t,e,n,o){var r,a,s,l=e.get(t)||ae(t,e);switch(typeof o){case"object":case"function":var u=l.w||(l.w=new i);return u.get(o)||(r=u,a=o,s=new t(n),r.set(a,s),s);default:var c=l.p||(l.p=re(null));return c[o]||(c[o]=new t(n))}}(this,oe.get(t)||(n=t,o=new b,oe.set(n,o),o),t,null==e?"default":e);var n,o}}}),Object.defineProperties(w.prototype,{handleEvent:{value:function(t){var e=t.currentTarget;this["getAttribute"in e&&e.getAttribute("data-call")||"on"+t.type](t)}},html:_("html",ne),svg:_("svg",ne),state:_("state",(function(){return this.defaultState})),defaultState:{get:function(){return{}}},dispatch:{value:function(t,e){var i=this._wire$;if(i){var n=new v(t,{bubbles:!0,cancelable:!0,detail:e});return n.component=this,(i.dispatchEvent?i:i.firstChild).dispatchEvent(n)}return!1}},setState:{value:function(t,e){var i=this.state,n="function"==typeof t?t.call(this,i):t;for(var o in n)i[o]=n[o];return!1!==e&&this.render(),this}}}),ue}(document);const{Component:a,bind:s,define:l,diff:u,hyper:c,wire:h}=r;var d=i(12),p=t=>{if(t.svg)return t.svg;const e={dot:g(t),target:m(t),triangle:v(t),square:y(t),semiCircle:b(t),markerLetter:w(t),markerColor:_(t),geo:x()};return t.type?e[t.type]:g({color:"#666"})};const f=new XMLSerializer;function g(t){const e=h()`
  <svg width=866 height=1000 viewBox='0 0 866 1000' xmlns='http://www.w3.org/2000/svg'>`;return e.appendChild(h(null,"svg")`
  <circle cx=466 cy=532 r=395 fill=${d(t.fillColor||"#fff").darken()}>`),e.appendChild(h(null,"svg")`
  <circle cx=400 cy=468 r=395 fill=${t.fillColor||"#fff"}>`),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function m(t){const e=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let i=h(null,"svg")`
  <circle cx=540 cy=540 fill='#333' opacity=0.4>`;i.setAttribute("r",400),e.appendChild(i);let n=h(null,"svg")`<circle cx=500 cy=500 fill=${t.fillColor||"#FFF"}>`;return n.setAttribute("r",400),e.appendChild(n),t.layers?(Object.entries(t.layers).forEach(t=>{const i=h(null,"svg")`<circle cx=500 cy=500 fill=${t[1]}>`;i.setAttribute("r",400*parseFloat(t[0])),e.appendChild(i)}),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))):"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function v(t){const e=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let i="M0,-19.618873042551414L16.990442448471224,9.809436521275707L-16.990442448471224,9.809436521275707Z",n=h(null,"svg")`<path fill='#333' opacity=0.4>`;n.setAttribute("d",i),n.setAttribute("transform","translate(540 520) rotate(180) scale(-20, -20)"),e.appendChild(n);let o=h(null,"svg")`<path fill=${t.fillColor||"#FFF"}>`;return o.setAttribute("d",i),o.setAttribute("transform","translate(500 500) rotate(180) scale(-20, -20)"),e.appendChild(o),t.layers?(Object.entries(t.layers).map(t=>{const n=h(null,"svg")`<path fill=${t[1]}>`;n.setAttribute("d",i),n.setAttribute("transform",`translate(500 500) rotate(180) scale(${-20*t[0]}, ${-20*t[0]})`),e.appendChild(n)}),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))):"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function y(t){let e=1e3,i=800;const n=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;let o=h(null,"svg")`<rect fill='#333' opacity=0.3 >`;o.setAttribute("width",i),o.setAttribute("height",i),o.setAttribute("x",110),o.setAttribute("y",110),n.appendChild(o);let r=h(null,"svg")`<rect fill=${t.fillColor||"#FFF"}>`;return r.setAttribute("width",i),r.setAttribute("height",i),r.setAttribute("x",100),r.setAttribute("y",100),n.appendChild(r),t.layers?(Object.entries(t.layers).map(t=>{const o=h(null,"svg")`<rect fill=${t[1]}>`;o.setAttribute("width",t[0]*i),o.setAttribute("height",t[0]*i),o.setAttribute("x",(e-t[0]*i)/2),o.setAttribute("y",(e-t[0]*i)/2),n.appendChild(o)}),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(n))):"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(n))}function b(t){const e=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>
    <defs>
      <clipPath id="cut-off-shade">
        <rect x="0" y="0" width="1000" height="710"/>
      </clipPath>
      <clipPath id="cut-off">
        <rect x="0" y="0" width="1000" height="700"/>
      </clipPath>
    </defs>
    <circle cx="510" cy="710" r="400" fill="#333" opacity="0.3" clip-path="url(#cut-off-shade)"/>
  </svg>`;return e.appendChild(h(null,"svg")`
  <circle cx=500 cy=700 r=400 fill=${t.fillColor} clip-path='url(#cut-off)'>`),t.layers&&Object.entries(t.layers).map(t=>{const i=h(null,"svg")`<circle cx=500 cy=700 fill=${t[1]} clip-path='url(#cut-off)'>`;i.setAttribute("r",parseInt(400*parseFloat(t[0]))),e.appendChild(i)}),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function w(t){const e=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;return e.appendChild(h(null,"svg")`
  <path style="opacity: 0.5;" fill=${t.color}
    d="M570,20C370,20,210,180,210,380C210,460,230,520,280,610C380,780,570,1000,570,1000C570,1000,760,780,860,610C910,520,930,460,930,380C930,180,770,20,570,20Z"/>`),e.appendChild(h(null,"svg")`
  <path fill=${t.color}
    d="M500,20C300,20,140,180,140,380C140,440,160,520,210,610C310,780,500,1000,500,1000C500,1000,690,780,790,610C840,520,860,460,860,380C860,180,700,20,500,20Z"/>`),e.appendChild(h(null,"svg")`
  <circle cx=500 cy=360 r=250 opacity=0.8 fill="rgb(255, 255, 255)"/>`),e.appendChild(h(null,"svg")`
  <text x=500 y=500 style="text-anchor: middle; font-weight: 600; font-size: 470px; font-family: sans-serif; fill: rgb(85, 85, 85);">
    ${t.letter}`),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function _(t){const e=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;return e.appendChild(h(null,"svg")`
  <path style="opacity: 0.5;" fill=${t.colorMarker}
    d="M570,20C370,20,210,180,210,380C210,460,230,520,280,610C380,780,570,1000,570,1000C570,1000,760,780,860,610C910,520,930,460,930,380C930,180,770,20,570,20Z"/>`),e.appendChild(h(null,"svg")`
  <path fill=${t.colorMarker}
    d="M500,20C300,20,140,180,140,380C140,440,160,520,210,610C310,780,500,1000,500,1000C500,1000,690,780,790,610C840,520,860,460,860,380C860,180,700,20,500,20Z"/>`),e.appendChild(h(null,"svg")`
  <circle cx=500 cy=360 r=250 opacity=0.8 fill="rgb(255, 255, 255)"/>`),e.appendChild(h(null,"svg")`
  <circle cx=500 cy=360 r=180 opacity=0.8 fill=${t.colorDot}/>`),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(e))}function x(){const t=h()`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>`;t.appendChild(h(null,"svg")`
  <circle cx=500 cy=500 r=350 stroke='#1F964D' opacity=0.8 stroke-width=75 fill=none>`),t.appendChild(h(null,"svg")`
  <circle cx=500 cy=500 r=200 fill='#1F964D' opacity=0.8>`);let e=h(null,"svg")`
  <path stroke='#1F964D' opacity=0.8 stroke-width=75>`;return e.setAttribute("d","M500,150L500,0M500,850L500,1000M0,500L150,500M850,500L1000,500"),t.appendChild(e),"data:image/svg+xml,"+encodeURIComponent(f.serializeToString(t))}var C=t=>Object.entries(t).filter(t=>0===t[1]||!!t[1]).filter(t=>"{}"!==t[1]).filter(t=>t[1].length>0||"object"!=typeof t[1]).map(t=>encodeURI(`${t[0]}=${t[1]}`)).join("&");function E(t){return new Promise((e,i)=>{const n=Object.assign(document.createElement("script"),{src:t,onerror:()=>i(console.error("failed:"+t)),onload:()=>e(console.log("loaded:"+t))});document.head.appendChild(n)})}function k(t,e){const i=t.closest(".expandable");if(i){if(i.classList.contains("expanded"))return i.classList.remove("expanded");e&&[...i.parentElement.children].forEach(t=>{t.classList.remove("expanded")}),i.classList.add("expanded")}}function S(t){let e=_xyz.utils.wire()`<textarea style="visibility=none;">`;e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()}function M(t){let e=document.createElement(t.tag);return t.options&&Object.keys(t.options).forEach(i=>{t.options[i]&&(e[i]=t.options[i])}),t.style&&Object.keys(t.style).forEach(i=>e.style[i]=t.style[i]),t.appendTo&&t.appendTo.appendChild(e),t.eventListener&&e.addEventListener(t.eventListener.event,t.eventListener.funct),e}function T(t){if(-1==t.indexOf(";base64,")){let e=t.split(","),i=e[0].split(":")[1],n=e[1];return new Blob([n],{type:i})}let e=t.split(";base64,"),i=e[0].split(":")[1],n=window.atob(e[1]),o=new Uint8Array(n.length);for(let t=0;t<n.length;++t)o[t]=n.charCodeAt(t);return new Blob([o],{type:i})}const R=()=>{const t=new WeakSet;return(e,i)=>{if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return i}};function P(t,e,i){var n=Array.isArray(e),o=(i||{arrayMerge:F}).arrayMerge||F;return n?Array.isArray(t)?o(t,e,i):L(e,i):function(t,e,i){var n={};D(t)&&Object.keys(t).forEach((function(e){n[e]=L(t[e],i)}));return Object.keys(e).forEach((function(o){D(e[o])&&t[o]?n[o]=P(t[o],e[o],i):n[o]=L(e[o],i)})),n}(t,e,i)}function D(t){return t&&"object"==typeof t&&"[object RegExp]"!==Object.prototype.toString.call(t)&&"[object Date]"!==Object.prototype.toString.call(t)}function L(t,e){var i;return e&&!0===e.clone&&D(t)?P((i=t,Array.isArray(i)?[]:{}),t,e):t}function F(t,e,i){var n=t.slice();return e.forEach((function(e,o){void 0===n[o]?n[o]=L(e,i):D(e)?n[o]=P(t[o],e,i):-1===t.indexOf(e)&&n.push(L(e,i))})),n}var O=i(46);function A(t){return O(t.element,{defaultDate:t.value,enableTime:t.enableTime||!1,time_24hr:!0,dateFormat:t.enableTime?"j M Y H:i":"j M Y",onClose:(e,i,n)=>{t.callback(i)}})}function I(t){return Math.round(new Date(t).getTime()/1e3)}function j(t){if(!t)return;if(t=parseInt(t)?t:t.getValue(),isNaN(parseInt(t)))return" ";let e=new Date(1e3*t),i=e.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],o=e.getDate();e.getDay();return`${o} ${n} ${i}`}function z(t){if(!t)return;if(t=parseInt(t)?t:t.getValue(),isNaN(parseInt(t)))return" ";let e=j(t),i=new Date(1e3*t),n="0"+i.getHours(),o="0"+i.getMinutes();i.getSeconds();return`${e}, ${n.substr(-2)}:${o.substr(-2)}`}var N=i(26);const H={red:(t,e,i)=>{t.getElement().style.backgroundColor="red"},colour:(t,e,i)=>{t.getElement().style.backgroundColor=e.colour},conditional:(t,e,i)=>{if(t.getValue())return e[`${t.getValue()}`]?void(t.getElement().style.backgroundColor=e[`${t.getValue()}`]):t.getValue()}};var B=i(14),G=i(27),V=(i(67),i(47)),W=i(48),q=i(49),$=i(28);const Y=(...t)=>e=>t.forEach(t=>t(e)),X=()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,U={pointOnFeature:V,kinks:W.default,flatten:q};var K=t=>({fetchLocales:async function(){const e=await fetch(t.host+"/api/workspace/get/locales");t.workspace.locales=await e.json()},getLocales:function(e){const i=new XMLHttpRequest;i.open("GET",t.host+"/api/workspace/get/locales"),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{if(200!==i.target.status)return console.error("Failed to retrieve workspace from XYZ host!");t.workspace.locales=i.target.response,function(e){t.locale=t.locale||t.hooks&&t.hooks.current.locale||t.workspace.locales[0];const i=new XMLHttpRequest;i.open("GET",t.host+"/api/workspace/get/locale?"+t.utils.paramString({locale:t.locale})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{if(200!==i.target.status)return console.error("Failed to retrieve workspace from XYZ host!");t.workspace.locale=Object.assign({key:t.locale},i.target.response),Object.keys(t.workspace.locale.layers).filter(t=>-1===t.indexOf("__")).forEach(e=>{t.layers.list[e]=t.layers.decorate(t.workspace.locale.layers[e])}),e&&e(t)},i.send()}(e)},i.send()}});function Z(){return function(){throw new Error("Unimplemented abstract method.")}()}var J=0;function Q(t){return t.ol_uid||(t.ol_uid=String(++J))}var tt,et=(tt=function(t,e){return(tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}tt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),it=function(t){function e(e){var i=this,n="Assertion failed. See https://openlayers.org/en/"+("v"+"6.3.1".split("-")[0])+"/doc/errors/#"+e+" for details.";return(i=t.call(this,n)||this).code=e,i.name="AssertionError",i.message=n,i}return et(e,t),e}(Error);function nt(t,e){if(!t)throw new it(e)}var ot=i(50),rt=i.n(ot),at="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1,o=arguments.length;n<o;++n){var r=arguments[n];if(null!=r)for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])}return i};function st(t){for(var e in t)delete t[e]}var lt="function"==typeof Object.values?Object.values:function(t){var e=[];for(var i in t)e.push(t[i]);return e};function ut(t){var e;for(e in t)return!1;return!e}function ct(t,e,i){return Math.min(Math.max(t,e),i)}var ht="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function dt(t,e,i,n,o,r){var a=o-i,s=r-n;if(0!==a||0!==s){var l=((t-i)*a+(e-n)*s)/(a*a+s*s);l>1?(i=o,n=r):l>0&&(i+=a*l,n+=s*l)}return pt(t,e,i,n)}function pt(t,e,i,n){var o=i-t,r=n-e;return o*o+r*r}function ft(t){return t*Math.PI/180}function gt(t,e){var i=t%e;return i*e<0?i+e:i}function mt(t,e,i){return t+i*(e-t)}var vt="Point",yt="LineString",bt="LinearRing",wt="Polygon",_t="MultiPoint",xt="MultiLineString",Ct="MultiPolygon",Et="GeometryCollection",kt="Circle";function St(t,e,i){var n=i||6371008.8,o=ft(t[1]),r=ft(e[1]),a=(r-o)/2,s=ft(e[0]-t[0])/2,l=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(o)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var Mt="bottom-left",Tt="bottom-right",Rt="top-left",Pt="top-right",Dt=0,Lt=1,Ft=2,Ot=4,At=8,It=16;function jt(t){for(var e=qt(),i=0,n=t.length;i<n;++i)Jt(e,t[i]);return e}function zt(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Nt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Ht(t,e,i){var n,o;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(o=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*o}function Bt(t,e){return Vt(t,e[0],e[1])}function Gt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Vt(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Wt(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],a=e[0],s=e[1],l=Dt;return a<i?l|=It:a>o&&(l|=Ot),s<n?l|=At:s>r&&(l|=Ft),l===Dt&&(l=Lt),l}function qt(){return[1/0,1/0,-1/0,-1/0]}function $t(t,e,i,n,o){return o?(o[0]=t,o[1]=e,o[2]=i,o[3]=n,o):[t,e,i,n]}function Yt(t){return $t(1/0,1/0,-1/0,-1/0,t)}function Xt(t,e){var i=t[0],n=t[1];return $t(i,n,i,n,e)}function Ut(t,e,i,n,o){return te(Yt(o),t,e,i,n)}function Kt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Zt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Jt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Qt(t,e){for(var i=0,n=e.length;i<n;++i)Jt(t,e[i]);return t}function te(t,e,i,n,o){for(;i<n;i+=o)ee(t,e[i],e[i+1]);return t}function ee(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function ie(t,e){var i;return(i=e(oe(t)))||(i=e(re(t)))||(i=e(de(t)))?i:(i=e(he(t)))||!1}function ne(t){var e=0;return ge(t)||(e=pe(t)*ue(t)),e}function oe(t){return[t[0],t[1]]}function re(t){return[t[2],t[1]]}function ae(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function se(t,e){var i;return e===Mt?i=oe(t):e===Tt?i=re(t):e===Rt?i=he(t):e===Pt?i=de(t):nt(!1,13),i}function le(t,e,i,n,o){var r=e*n[0]/2,a=e*n[1]/2,s=Math.cos(i),l=Math.sin(i),u=r*s,c=r*l,h=a*s,d=a*l,p=t[0],f=t[1],g=p-u+d,m=p-u-d,v=p+u-d,y=p+u+d,b=f-c-h,w=f-c+h,_=f+c+h,x=f+c-h;return $t(Math.min(g,m,v,y),Math.min(b,w,_,x),Math.max(g,m,v,y),Math.max(b,w,_,x),o)}function ue(t){return t[3]-t[1]}function ce(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return fe(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Yt(n),n}function he(t){return[t[0],t[3]]}function de(t){return[t[2],t[3]]}function pe(t){return t[2]-t[0]}function fe(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function ge(t){return t[2]<t[0]||t[3]<t[1]}function me(t,e,i,n){var o=[];if(n>1)for(var r=t[2]-t[0],a=t[3]-t[1],s=0;s<n;++s)o.push(t[0]+r*s/n,t[1],t[2],t[1]+a*s/n,t[2]-r*s/n,t[3],t[0],t[3]-a*s/n);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var l=[],u=[],c=(s=0,o.length);s<c;s+=2)l.push(o[s]),u.push(o[s+1]);return function(t,e,i){return $t(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(l,u,i)}var ve={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ye={};ye[ve.DEGREES]=2*Math.PI*6370997/360,ye[ve.FEET]=.3048,ye[ve.METERS]=1,ye[ve.USFEET]=1200/3937;var be=ve,we=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ye[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}(),_e=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xe=6378137*Math.PI,Ce=[-xe,-xe,xe,xe],Ee=[-180,-85,180,85],ke=function(t){function e(e){return t.call(this,{code:e,units:be.METERS,extent:Ce,global:!0,worldExtent:Ee,getPointResolution:function(t,e){return t/ht(e[1]/6378137)}})||this}return _e(e,t),e}(we),Se=[new ke("EPSG:3857"),new ke("EPSG:102100"),new ke("EPSG:102113"),new ke("EPSG:900913"),new ke("urn:ogc:def:crs:EPSG:6.18:3:3857"),new ke("urn:ogc:def:crs:EPSG::3857"),new ke("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Me(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var a=xe,s=0;s<n;s+=o){r[s]=a*t[s]/180;var l=6378137*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));l>a?l=a:l<-a&&(l=-a),r[s+1]=l}return r}function Te(t,e,i){var n=t.length,o=i>1?i:2,r=e;void 0===r&&(r=o>2?t.slice():new Array(n));for(var a=0;a<n;a+=o)r[a]=180*t[a]/xe,r[a+1]=360*Math.atan(Math.exp(t[a+1]/6378137))/Math.PI-90;return r}var Re=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pe=[-180,-90,180,90],De=6378137*Math.PI/180,Le=function(t){function e(e,i){return t.call(this,{code:e,units:be.DEGREES,extent:Pe,axisOrientation:i,global:!0,metersPerUnit:De,worldExtent:Pe})||this}return Re(e,t),e}(we),Fe=[new Le("CRS:84"),new Le("EPSG:4326","neu"),new Le("urn:ogc:def:crs:EPSG::4326","neu"),new Le("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Le("urn:ogc:def:crs:OGC:1.3:CRS84"),new Le("urn:ogc:def:crs:OGC:2:84"),new Le("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Le("urn:x-ogc:def:crs:EPSG:4326","neu")],Oe={};function Ae(t,e,i){var n=t.getCode(),o=e.getCode();n in Oe||(Oe[n]={}),Oe[n][o]=i}var Ie={};function je(t,e,i){var n;if(void 0!==e){for(var o=0,r=t.length;o<r;++o)e[o]=t[o];n=e}else n=t.slice();return n}function ze(t,e,i){if(void 0!==e&&t!==e){for(var n=0,o=t.length;n<o;++n)e[n]=t[n];t=e}return t}function Ne(t){!function(t,e){Ie[t]=e}(t.getCode(),t),Ae(t,t,je)}function He(t){return"string"==typeof t?Ie[t]||null:t||null}function Be(t,e,i,n){var o,r=(t=He(t)).getPointResolutionFunc();if(r)o=r(e,i),n&&n!==t.getUnits()&&(a=t.getMetersPerUnit())&&(o=o*a/ye[n]);else if(t.getUnits()==be.DEGREES&&!n||n==be.DEGREES)o=e;else{var a,s=$e(t,He("EPSG:4326")),l=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];o=(St((l=s(l,l,2)).slice(0,2),l.slice(2,4))+St(l.slice(4,6),l.slice(6,8)))/2,void 0!==(a=n?ye[n]:t.getMetersPerUnit())&&(o/=a)}return o}function Ge(t){!function(t){t.forEach(Ne)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ae(e,t,je)}))}))}function Ve(t,e){return t?"string"==typeof t?He(t):t:He(e)}function We(t,e){return Xe(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function qe(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||$e(t,e)===je)&&i}function $e(t,e){var i=function(t,e){var i;return t in Oe&&e in Oe[t]&&(i=Oe[t][e]),i}(t.getCode(),e.getCode());return i||(i=ze),i}function Ye(t,e){return $e(He(t),He(e))}function Xe(t,e,i){return Ye(e,i)(t,void 0,t.length)}function Ue(t,e,i,n){return me(t,Ye(e,i),void 0,n)}var Ke,Ze,Je,Qe=null;function ti(){return Qe}function ei(t,e){return Qe?Xe(t,e,Qe):t}function ii(t,e){return Qe?Xe(t,Qe,e):t}function ni(t,e){return Qe?Ue(t,e,Qe):t}function oi(t,e){return Qe?Ue(t,Qe,e):t}Ge(Se),Ge(Fe),Ke=Se,Ze=Me,Je=Te,Fe.forEach((function(t){Ke.forEach((function(e){Ae(t,e,Ze),Ae(e,t,Je)}))}));var ri=function(){function t(){this.dataProjection=null,this.defaultFeatureProjection=null}return t.prototype.getReadOptions=function(t,e){var i;if(e){var n=e.dataProjection?He(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()===be.TILE_PIXELS&&(n=He(n)).setWorldExtent(e.extent),i={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(i)},t.prototype.adaptOptions=function(t){return at({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return Z()},t.prototype.readFeature=function(t,e){return Z()},t.prototype.readFeatures=function(t,e){return Z()},t.prototype.readGeometry=function(t,e){return Z()},t.prototype.readProjection=function(t){return Z()},t.prototype.writeFeature=function(t,e){return Z()},t.prototype.writeFeatures=function(t,e){return Z()},t.prototype.writeGeometry=function(t,e){return Z()},t}();function ai(t,e,i){var n,o=i?He(i.featureProjection):null,r=i?He(i.dataProjection):null;if(n=o&&r&&!qe(o,r)?(e?t.clone():t).transform(e?o:r,e?r:o):t,e&&i&&void 0!==i.decimals){var a=Math.pow(10,i.decimals);n===t&&(n=t.clone()),n.applyTransform((function(t){for(var e=0,i=t.length;e<i;++e)t[e]=Math.round(t[e]*a)/a;return t}))}return n}var si="arraybuffer",li="json",ui="text",ci="xml",hi="XY",di="XYZ",pi="XYM",fi="XYZM";function gi(t,e){return t>e?1:t<e?-1:0}function mi(t,e,i){var n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;var o=void 0;if(i>0){for(o=1;o<n;++o)if(t[o]<e)return o-1}else if(i<0){for(o=1;o<n;++o)if(t[o]<=e)return o}else for(o=1;o<n;++o){if(t[o]==e)return o;if(t[o]<e)return t[o-1]-e<e-t[o]?o-1:o}return n-1}function vi(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function yi(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,o=0;o<n;o++)t[t.length]=i[o]}function bi(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}var wi="propertychange";function _i(t,e,i,n,o){if(n&&n!==t&&(i=i.bind(n)),o){var r=i;i=function(){t.removeEventListener(e,i),r.apply(this,arguments)}}var a={target:t,type:e,listener:i};return t.addEventListener(e,i),a}function xi(t,e,i,n){return _i(t,e,i,n,!0)}function Ci(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),st(t))}var Ei=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function ki(){return!0}function Si(){return!1}function Mi(){}var Ti=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),Ri=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pi=function(t){function e(e){var i=t.call(this)||this;return i.eventTarget_=e,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return Ri(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var i=this.listeners_[t];i||(i=[],this.listeners_[t]=i),-1===i.indexOf(e)&&i.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Ti(t):t,i=e.type;e.target||(e.target=this.eventTarget_||this);var n,o=this.listeners_[i];if(o){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var r=0,a=o.length;r<a;++r)if(!1===(n="handleEvent"in o[r]?o[r].handleEvent(e):o[r].call(this,e))||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var s=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];s--;)this.removeEventListener(i,Mi);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){st(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);-1!==n&&(t in this.pendingRemovals_?(i[n]=Mi,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},e}(Ei),Di="change",Li="error",Fi="contextmenu",Oi="click",Ai="dblclick",Ii="keydown",ji="keypress",zi="load",Ni="resize",Hi="touchmove",Bi="wheel",Gi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var Vi=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return Gi(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Di)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=_i(this,t[o],e);return n}return _i(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=xi(this,t[o],e);return n}return xi(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)},e}(Pi),Wi=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qi=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.key=i,o.oldValue=n,o}return Wi(e,t),e}(Ti),$i=function(t){function e(e){var i=t.call(this)||this;return Q(i),i.values_={},void 0!==e&&i.setProperties(e),i}return Wi(e,t),e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return at({},this.values_)},e.prototype.notify=function(t,e){var i;i=Xi(t),this.dispatchEvent(new qi(i,t,e)),i=wi,this.dispatchEvent(new qi(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(Vi),Yi={};function Xi(t){return Yi.hasOwnProperty(t)?Yi[t]:Yi[t]="change:"+t}var Ui=$i;function Ki(t,e,i,n,o,r){for(var a=r||[],s=0,l=e;l<i;l+=n){var u=t[l],c=t[l+1];a[s++]=o[0]*u+o[2]*c+o[4],a[s++]=o[1]*u+o[3]*c+o[5]}return r&&a.length!=s&&(a.length=s),a}function Zi(t,e,i,n,o,r,a){for(var s=a||[],l=Math.cos(o),u=Math.sin(o),c=r[0],h=r[1],d=0,p=e;p<i;p+=n){var f=t[p]-c,g=t[p+1]-h;s[d++]=c+f*l-g*u,s[d++]=h+f*u+g*l;for(var m=p+2;m<p+n;++m)s[d++]=t[m]}return a&&s.length!=d&&(s.length=d),s}function Ji(t,e,i,n,o,r,a){for(var s=a||[],l=0,u=e;u<i;u+=n){s[l++]=t[u]+o,s[l++]=t[u+1]+r;for(var c=u+2;c<u+n;++c)s[l++]=t[c]}return a&&s.length!=l&&(s.length=l),s}var Qi=new Array(6);function tn(t){return nn(t,1,0,0,1,0,0)}function en(t,e){var i=t[0],n=t[1],o=t[2],r=t[3],a=t[4],s=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],p=e[5];return t[0]=i*l+o*u,t[1]=n*l+r*u,t[2]=i*c+o*h,t[3]=n*c+r*h,t[4]=i*d+o*p+a,t[5]=n*d+r*p+s,t}function nn(t,e,i,n,o,r,a){return t[0]=e,t[1]=i,t[2]=n,t[3]=o,t[4]=r,t[5]=a,t}function on(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function rn(t,e,i){return en(t,nn(Qi,e,0,0,i,0,0))}function an(t,e,i,n,o,r,a,s){var l=Math.sin(r),u=Math.cos(r);return t[0]=n*u,t[1]=o*l,t[2]=-n*l,t[3]=o*u,t[4]=a*n*u-s*n*l+e,t[5]=a*o*l+s*o*u+i,t}function sn(t,e){var i,n=(i=e)[0]*i[3]-i[1]*i[2];nt(0!==n,32);var o=e[0],r=e[1],a=e[2],s=e[3],l=e[4],u=e[5];return t[0]=s/n,t[1]=-r/n,t[2]=-a/n,t[3]=o/n,t[4]=(a*u-s*l)/n,t[5]=-(o*u-r*l)/n,t}function ln(t){return"matrix("+t.join(", ")+")"}var un=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cn=[1,0,0,1,0,0],hn=function(t){function e(){var e,i,n,o,r,a=t.call(this)||this;return a.extent_=[1/0,1/0,-1/0,-1/0],a.extentRevision_=-1,a.simplifiedGeometryMaxMinSquaredTolerance=0,a.simplifiedGeometryRevision=0,a.simplifyTransformedInternal=(e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);var n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)},r=!1,function(){var t=Array.prototype.slice.call(arguments);return r&&this===o&&bi(t,n)||(r=!0,o=this,n=t,i=e.apply(this,arguments)),i}),a}return un(e,t),e.prototype.simplifyTransformed=function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)},e.prototype.clone=function(){return Z()},e.prototype.closestPointXY=function(t,e,i,n){return Z()},e.prototype.containsXY=function(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return Z()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){Z()},e.prototype.scale=function(t,e,i){Z()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return Z()},e.prototype.getType=function(){return Z()},e.prototype.applyTransform=function(t){Z()},e.prototype.intersectsExtent=function(t){return Z()},e.prototype.translate=function(t,e){Z()},e.prototype.transform=function(t,e){var i=He(t),n=i.getUnits()==be.TILE_PIXELS?function(t,n,o){var r=i.getExtent(),a=i.getWorldExtent(),s=ue(a)/ue(r);return an(cn,a[0],a[3],s,-s,0,0,0),Ki(t,0,t.length,o,cn,n),Ye(i,e)(t,n,o)}:Ye(i,e);return this.applyTransform(n),this},e}(Ui),dn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function pn(t){var e;return t==hi?e=2:t==di||t==pi?e=3:t==fi&&(e=4),e}var fn=function(t){function e(){var e=t.call(this)||this;return e.layout=hi,e.stride=2,e.flatCoordinates=null,e}return dn(e,t),e.prototype.computeExtent=function(t){return Ut(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return Z()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=pn(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){Z()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=pn(t);else{for(var o=0;o<i;++o){if(0===e.length)return this.layout=hi,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=hi:3==t?e=di:4==t&&(e=fi);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Zi(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var o=i;o||(o=ae(this.getExtent()));var r=this.getFlatCoordinates();if(r){var a=this.getStride();!function(t,e,i,n,o,r,a,s){for(var l=s||[],u=a[0],c=a[1],h=0,d=e;d<i;d+=n){var p=t[d]-u,f=t[d+1]-c;l[h++]=u+o*p,l[h++]=c+r*f;for(var g=d+2;g<d+n;++g)l[h++]=t[g]}s&&l.length!=h&&(l.length=h)}(r,0,r.length,a,t,n,o,r),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();Ji(i,0,i.length,n,t,e,i),this.changed()}},e}(hn);function gn(t,e,i,n,o,r,a){var s,l=t[e],u=t[e+1],c=t[i]-l,h=t[i+1]-u;if(0===c&&0===h)s=e;else{var d=((o-l)*c+(r-u)*h)/(c*c+h*h);if(d>1)s=i;else{if(d>0){for(var p=0;p<n;++p)a[p]=mt(t[e+p],t[i+p],d);return void(a.length=n)}s=e}}for(p=0;p<n;++p)a[p]=t[s+p];a.length=n}function mn(t,e,i,n,o){var r=t[e],a=t[e+1];for(e+=n;e<i;e+=n){var s=t[e],l=t[e+1],u=pt(r,a,s,l);u>o&&(o=u),r=s,a=l}return o}function vn(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){var s=i[r];o=mn(t,e,s,n,o),e=s}return o}function yn(t,e,i,n,o,r,a,s,l,u,c){if(e==i)return u;var h,d;if(0===o){if((d=pt(a,s,t[e],t[e+1]))<u){for(h=0;h<n;++h)l[h]=t[e+h];return l.length=n,d}return u}for(var p=c||[NaN,NaN],f=e+n;f<i;)if(gn(t,f-n,f,n,a,s,p),(d=pt(a,s,p[0],p[1]))<u){for(u=d,h=0;h<n;++h)l[h]=p[h];l.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/o|0,1);if(r&&(gn(t,i-n,e,n,a,s,p),(d=pt(a,s,p[0],p[1]))<u)){for(u=d,h=0;h<n;++h)l[h]=p[h];l.length=n}return u}function bn(t,e,i,n,o,r,a,s,l,u,c){for(var h=c||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=yn(t,e,f,n,o,r,a,s,l,u,h),e=f}return u}function wn(t,e,i,n){for(var o=0,r=i.length;o<r;++o)t[e++]=i[o];return e}function _n(t,e,i,n){for(var o=0,r=i.length;o<r;++o)for(var a=i[o],s=0;s<n;++s)t[e++]=a[s];return e}function xn(t,e,i,n,o){for(var r=o||[],a=0,s=0,l=i.length;s<l;++s){var u=_n(t,e,i[s],n);r[a++]=u,e=u}return r.length=a,r}function Cn(t,e,i,n,o){for(var r=void 0!==o?o:[],a=0,s=e;s<i;s+=n)r[a++]=t.slice(s,s+n);return r.length=a,r}function En(t,e,i,n,o){for(var r=void 0!==o?o:[],a=0,s=0,l=i.length;s<l;++s){var u=i[s];r[a++]=Cn(t,e,u,n,r[a]),e=u}return r.length=a,r}function kn(t,e,i,n,o){for(var r=void 0!==o?o:[],a=0,s=0,l=i.length;s<l;++s){var u=i[s];r[a++]=En(t,e,u,n,r[a]),e=u[u.length-1]}return r.length=a,r}function Sn(t,e,i,n,o,r){var a=NaN,s=NaN,l=(i-e)/n;if(1===l)a=t[e],s=t[e+1];else if(2==l)a=(1-o)*t[e]+o*t[e+n],s=(1-o)*t[e+1]+o*t[e+n+1];else if(0!==l){for(var u=t[e],c=t[e+1],h=0,d=[0],p=e+n;p<i;p+=n){var f=t[p],g=t[p+1];h+=Math.sqrt((f-u)*(f-u)+(g-c)*(g-c)),d.push(h),u=f,c=g}var m=o*h,v=function(t,e,i){for(var n,o,r=i||gi,a=0,s=t.length,l=!1;a<s;)(o=+r(t[n=a+(s-a>>1)],e))<0?a=n+1:(s=n,l=!o);return l?a:~a}(d,m);if(v<0){var y=(m-d[-v-2])/(d[-v-1]-d[-v-2]),b=e+(-v-2)*n;a=mt(t[b],t[b+n],y),s=mt(t[b+1],t[b+n+1],y)}else a=t[e+v*n],s=t[e+v*n+1]}return r?(r[0]=a,r[1]=s,r):[a,s]}function Mn(t,e,i,n,o,r){if(i==e)return null;var a;if(o<t[e+n-1])return r?((a=t.slice(e,e+n))[n-1]=o,a):null;if(t[i-1]<o)return r?((a=t.slice(i-n,i))[n-1]=o,a):null;if(o==t[e+n-1])return t.slice(e,e+n);for(var s=e/n,l=i/n;s<l;){var u=s+l>>1;o<t[(u+1)*n-1]?l=u:s=u+1}var c=t[s*n-1];if(o==c)return t.slice((s-1)*n,(s-1)*n+n);var h=(o-c)/(t[(s+1)*n-1]-c);a=[];for(var d=0;d<n-1;++d)a.push(mt(t[(s-1)*n+d],t[s*n+d],h));return a.push(o),a}function Tn(t,e,i,n,o){return!ie(o,(function(o){return!Rn(t,e,i,n,o[0],o[1])}))}function Rn(t,e,i,n,o,r){for(var a=0,s=t[i-n],l=t[i-n+1];e<i;e+=n){var u=t[e],c=t[e+1];l<=r?c>r&&(u-s)*(r-l)-(o-s)*(c-l)>0&&a++:c<=r&&(u-s)*(r-l)-(o-s)*(c-l)<0&&a--,s=u,l=c}return 0!==a}function Pn(t,e,i,n,o,r){if(0===i.length)return!1;if(!Rn(t,e,i[0],n,o,r))return!1;for(var a=1,s=i.length;a<s;++a)if(Rn(t,i[a-1],i[a],n,o,r))return!1;return!0}function Dn(t,e,i,n,o){for(var r,a=[t[e],t[e+1]],s=[];e+n<i;e+=n){if(s[0]=t[e+n],s[1]=t[e+n+1],r=o(a,s))return r;a[0]=s[0],a[1]=s[1]}return!1}function Ln(t,e,i,n,o){var r=te([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!fe(o,r)&&(!!Gt(o,r)||(r[0]>=o[0]&&r[2]<=o[2]||(r[1]>=o[1]&&r[3]<=o[3]||Dn(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,o=Wt(t,e),r=Wt(t,i);if(o===Lt||r===Lt)n=!0;else{var a=t[0],s=t[1],l=t[2],u=t[3],c=e[0],h=e[1],d=i[0],p=i[1],f=(p-h)/(d-c),g=void 0,m=void 0;r&Ft&&!(o&Ft)&&(n=(g=d-(p-u)/f)>=a&&g<=l),n||!(r&Ot)||o&Ot||(n=(m=p-(d-l)*f)>=s&&m<=u),n||!(r&At)||o&At||(n=(g=d-(p-s)/f)>=a&&g<=l),n||!(r&It)||o&It||(n=(m=p-(d-a)*f)>=s&&m<=u)}return n}(o,t,e)})))))}function Fn(t,e,i,n,o){if(!function(t,e,i,n,o){return!!Ln(t,e,i,n,o)||(!!Rn(t,e,i,n,o[0],o[1])||(!!Rn(t,e,i,n,o[0],o[3])||(!!Rn(t,e,i,n,o[2],o[1])||!!Rn(t,e,i,n,o[2],o[3]))))}(t,e,i[0],n,o))return!1;if(1===i.length)return!0;for(var r=1,a=i.length;r<a;++r)if(Tn(t,i[r-1],i[r],n,o)&&!Ln(t,i[r-1],i[r],n,o))return!1;return!0}function On(t,e,i,n){for(var o=t[e],r=t[e+1],a=0,s=e+n;s<i;s+=n){var l=t[s],u=t[s+1];a+=Math.sqrt((l-o)*(l-o)+(u-r)*(u-r)),o=l,r=u}return a}function An(t,e,i,n,o,r,a){var s=(i-e)/n;if(s<3){for(;e<i;e+=n)r[a++]=t[e],r[a++]=t[e+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u=[e,i-n],c=0;u.length>0;){for(var h=u.pop(),d=u.pop(),p=0,f=t[d],g=t[d+1],m=t[h],v=t[h+1],y=d+n;y<h;y+=n){var b=dt(t[y],t[y+1],f,g,m,v);b>p&&(c=y,p=b)}p>o&&(l[(c-e)/n]=1,d+n<c&&u.push(d,c),c+n<h&&u.push(c,h))}for(y=0;y<s;++y)l[y]&&(r[a++]=t[e+y*n],r[a++]=t[e+y*n+1]);return a}function In(t,e,i,n,o,r,a,s){for(var l=0,u=i.length;l<u;++l){var c=i[l];a=An(t,e,c,n,o,r,a),s.push(a),e=c}return a}function jn(t,e){return e*Math.round(t/e)}function zn(t,e,i,n,o,r,a){if(e==i)return a;var s,l,u=jn(t[e],o),c=jn(t[e+1],o);e+=n,r[a++]=u,r[a++]=c;do{if(s=jn(t[e],o),l=jn(t[e+1],o),(e+=n)==i)return r[a++]=s,r[a++]=l,a}while(s==u&&l==c);for(;e<i;){var h=jn(t[e],o),d=jn(t[e+1],o);if(e+=n,h!=s||d!=l){var p=s-u,f=l-c,g=h-u,m=d-c;p*m==f*g&&(p<0&&g<p||p==g||p>0&&g>p)&&(f<0&&m<f||f==m||f>0&&m>f)?(s=h,l=d):(r[a++]=s,r[a++]=l,u=s,c=l,s=h,l=d)}}return r[a++]=s,r[a++]=l,a}function Nn(t,e,i,n,o,r,a,s){for(var l=0,u=i.length;l<u;++l){var c=i[l];a=zn(t,e,c,n,o,r,a),s.push(a),e=c}return a}var Hn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bn=function(t){function e(e,i){var n=t.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return Hn(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?yi(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Ht(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return Dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=pi&&this.layout!=fi)return null;var i=void 0!==e&&e;return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return Cn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return On(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,hi)},e.prototype.getType=function(){return yt},e.prototype.intersectsExtent=function(t){return Ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_n(this.flatCoordinates,0,t,this.stride),this.changed()},e}(fn),Gn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vn=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,i);else if(void 0!==i&&n)o.setFlatCoordinates(i,e),o.ends_=n;else{for(var r=o.getLayout(),a=e,s=[],l=[],u=0,c=a.length;u<c;++u){var h=a[u];0===u&&(r=h.getLayout()),yi(s,h.getFlatCoordinates()),l.push(s.length)}o.setFlatCoordinates(r,s),o.ends_=l}return o}return Gn(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?yi(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Ht(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(vn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=pi&&this.layout!=fi||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,o=void 0!==i&&i;return function(t,e,i,n,o,r,a){if(a)return Mn(t,e,i[i.length-1],n,o,r);var s;if(o<t[n-1])return r?((s=t.slice(0,n))[n-1]=o,s):null;if(t[t.length-1]<o)return r?((s=t.slice(t.length-n))[n-1]=o,s):null;for(var l=0,u=i.length;l<u;++l){var c=i[l];if(e!=c){if(o<t[e+n-1])return null;if(o<=t[c-1])return Mn(t,e,c,n,o,!1);e=c}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,o)},e.prototype.getCoordinates=function(){return En(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Bn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],o=0,r=0,a=e.length;r<a;++r){var s=e[r],l=new Bn(t.slice(o,s),i);n.push(l),o=s}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,o=this.stride,r=0,a=n.length;r<a;++r){var s=n[r];yi(t,Sn(e,i,s,o,.5)),i=s}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=In(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,hi,n)},e.prototype.getType=function(){return xt},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){if(Ln(t,e,i[r],n,o))return!0;e=i[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=xn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(fn),Wn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qn=function(t){function e(e,i){var n=t.call(this)||this;return n.setCoordinates(e,i),n}return Wn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=pt(t,e,o[0],o[1]);if(r<n){for(var a=this.stride,s=0;s<a;++s)i[s]=o[s];return i.length=a,r}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Xt(this.flatCoordinates,t)},e.prototype.getType=function(){return vt},e.prototype.intersectsExtent=function(t){return Vt(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wn(this.flatCoordinates,0,t,this.stride),this.changed()},e}(fn),$n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Yn=function(t){function e(e,i){var n=t.call(this)||this;return i&&!Array.isArray(e[0])?n.setFlatCoordinates(i,e):n.setCoordinates(e,i),n}return $n(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?yi(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<Ht(this.getExtent(),t,e))return n;for(var o=this.flatCoordinates,r=this.stride,a=0,s=o.length;a<s;a+=r){var l=pt(t,e,o[a],o[a+1]);if(l<n){n=l;for(var u=0;u<r;++u)i[u]=o[a+u];i.length=r}}return n},e.prototype.getCoordinates=function(){return Cn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new qn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],o=0,r=t.length;o<r;o+=i){var a=new qn(t.slice(o,o+i),e);n.push(a)}return n},e.prototype.getType=function(){return _t},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,o=e.length;n<o;n+=i){if(Vt(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_n(this.flatCoordinates,0,t,this.stride),this.changed()},e}(fn);function Xn(t,e,i,n){for(var o=0,r=t[i-n],a=t[i-n+1];e<i;e+=n){var s=t[e],l=t[e+1];o+=a*s-r*l,r=s,a=l}return o/2}function Un(t,e,i,n){for(var o=0,r=0,a=i.length;r<a;++r){var s=i[r];o+=Xn(t,e,s,n),e=s}return o}var Kn=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zn=function(t){function e(e,i){var n=t.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?n.setCoordinates(e,i):n.setFlatCoordinates(i,e),n}return Kn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Ht(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Cn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,hi)},e.prototype.getType=function(){return bt},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=_n(this.flatCoordinates,0,t,this.stride),this.changed()},e}(fn);function Jn(t,e,i,n,o,r,a){for(var s,l,u,c,h,d,p,f=o[r+1],g=[],m=0,v=i.length;m<v;++m){var y=i[m];for(c=t[y-n],d=t[y-n+1],s=e;s<y;s+=n)h=t[s],p=t[s+1],(f<=d&&p<=f||d<=f&&f<=p)&&(u=(f-d)/(p-d)*(h-c)+c,g.push(u)),c=h,d=p}var b=NaN,w=-1/0;for(g.sort(gi),c=g[0],s=1,l=g.length;s<l;++s){h=g[s];var _=Math.abs(h-c);_>w&&Pn(t,e,i,n,u=(c+h)/2,f)&&(b=u,w=_),c=h}return isNaN(b)&&(b=o[r]),a?(a.push(b,f,w),a):[b,f,w]}function Qn(t,e,i,n,o){for(var r=[],a=0,s=i.length;a<s;++a){var l=i[a];r=Jn(t,e,l,n,o,2*a,r),e=l[l.length-1]}return r}function to(t,e,i,n){for(;e<i-n;){for(var o=0;o<n;++o){var r=t[e+o];t[e+o]=t[i-n+o],t[i-n+o]=r}e+=n,i-=n}}function eo(t,e,i,n){for(var o=0,r=t[i-n],a=t[i-n+1];e<i;e+=n){var s=t[e],l=t[e+1];o+=(s-r)*(l+a),r=s,a=l}return o>0}function io(t,e,i,n,o){for(var r=void 0!==o&&o,a=0,s=i.length;a<s;++a){var l=i[a],u=eo(t,e,l,n);if(0===a){if(r&&u||!r&&!u)return!1}else if(r&&!u||!r&&u)return!1;e=l}return!0}function no(t,e,i,n,o){for(var r=void 0!==o&&o,a=0,s=i.length;a<s;++a){var l=i[a],u=eo(t,e,l,n);(0===a?r&&u||!r&&!u:r&&!u||!r&&u)&&to(t,e,l,n),e=l}return e}function oo(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r)e=no(t,e,i[r],n,o);return e}var ro=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ao=function(t){function e(e,i,n){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==i&&n?(o.setFlatCoordinates(i,e),o.ends_=n):o.setCoordinates(e,i),o}return ro(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?yi(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Ht(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(vn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return Pn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Un(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?no(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,En(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ae(this.getExtent());this.flatInteriorPoint_=Jn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new qn(this.getFlatInteriorPoint(),pi)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Zn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],o=0,r=0,a=i.length;r<a;++r){var s=i[r],l=new Zn(e.slice(o,s),t);n.push(l),o=s}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;io(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=no(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=Nn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,hi,n)},e.prototype.getType=function(){return wt},e.prototype.intersectsExtent=function(t){return Fn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=xn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(fn),so=ao;function lo(t){var e=t[0],i=t[1],n=t[2],o=t[3],r=[e,i,e,o,n,o,n,i,e,i];return new ao(r,hi,[r.length])}function uo(t,e,i){for(var n=e||32,o=t.getStride(),r=t.getLayout(),a=t.getCenter(),s=o*(n+1),l=new Array(s),u=0;u<s;u+=o){l[u]=0,l[u+1]=0;for(var c=2;c<o;c++)l[u+c]=a[c]}var h=[l.length],d=new ao(l,r,h);return co(d,a,t.getRadius(),i),d}function co(t,e,i,n){for(var o=t.getFlatCoordinates(),r=t.getStride(),a=o.length/r-1,s=n||0,l=0;l<=a;++l){var u=l*r,c=s+2*gt(l,a)*Math.PI/a;o[u]=e[0]+i*Math.cos(c),o[u+1]=e[1]+i*Math.sin(c)}t.changed()}function ho(t,e,i,n){for(var o=[],r=[1/0,1/0,-1/0,-1/0],a=0,s=i.length;a<s;++a){var l=i[a];r=Ut(t,e,l[0],n),o.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=l[l.length-1]}return o}var po=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fo=function(t){function e(e,i,n){var o=t.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=o.getLayout(),a=e,s=[],l=[],u=0,c=a.length;u<c;++u){var h=a[u];0===u&&(r=h.getLayout());for(var d=s.length,p=h.getEnds(),f=0,g=p.length;f<g;++f)p[f]+=d;yi(s,h.getFlatCoordinates()),l.push(p)}i=r,e=s,n=l}return void 0!==i&&n?(o.setFlatCoordinates(i,e),o.endss_=n):o.setCoordinates(e,i),o}return po(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;yi(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,o=(e=t.getEnds().slice()).length;n<o;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<Ht(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){var s=i[r];o=vn(t,e,s,n,o),e=s[s.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,o,r,a,s,l,u,c){for(var h=c||[NaN,NaN],d=0,p=i.length;d<p;++d){var f=i[d];u=bn(t,e,f,n,o,r,a,s,l,u,h),e=f[f.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,o,r){if(0===i.length)return!1;for(var a=0,s=i.length;a<s;++a){var l=i[a];if(Pn(t,e,l,n,o,r))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var o=0,r=0,a=i.length;r<a;++r){var s=i[r];o+=Un(t,e,s,n),e=s[s.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?oo(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,kn(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=ho(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Qn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new Yn(this.getFlatInteriorPoints().slice(),pi)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){var s=i[r];if(!io(t,e,s,n,o))return!1;s.length&&(e=s[s.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=oo(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,o,r,a,s){for(var l=0,u=i.length;l<u;++l){var c=i[l],h=[];a=Nn(t,e,c,n,o,r,a,h),s.push(h),e=c[c.length-1]}return a}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,hi,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),o=n[n.length-1];if(0!==e)for(var r=0,a=n.length;r<a;++r)n[r]-=e;return new so(this.flatCoordinates.slice(e,o),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],o=0,r=0,a=i.length;r<a;++r){var s=i[r].slice(),l=s[s.length-1];if(0!==o)for(var u=0,c=s.length;u<c;++u)s[u]-=o;var h=new so(e.slice(o,l),t,s);n.push(h),o=l}return n},e.prototype.getType=function(){return Ct},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){var s=i[r];if(Fn(t,e,s,n,o))return!0;e=s[s.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,o){for(var r=o||[],a=0,s=0,l=i.length;s<l;++s){var u=xn(t,e,i[s],n,r[a]);r[a++]=u,e=u[u.length-1]}return r.length=a,r}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(fn),go=[1,0,0,1,0,0],mo=function(){function t(t,e,i,n,o){this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=n}return t.prototype.get=function(t){return this.properties_[t]},t.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===vt?Xt(this.flatCoordinates_):Ut(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},t.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var t=ae(this.getExtent());this.flatInteriorPoints_=Jn(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_},t.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var t=ho(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=Qn(this.flatCoordinates_,0,this.ends_,2,t)}return this.flatInteriorPoints_},t.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=Sn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},t.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,i=this.ends_,n=0,o=i.length;n<o;++n){var r=i[n],a=Sn(t,e,r,2,.5);yi(this.flatMidpoints_,a),e=r}}return this.flatMidpoints_},t.prototype.getId=function(){return this.id_},t.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},t.prototype.getGeometry=function(){return this},t.prototype.getSimplifiedGeometry=function(t){return this},t.prototype.simplifyTransformed=function(t,e){return this},t.prototype.getProperties=function(){return this.properties_},t.prototype.getStride=function(){return 2},t.prototype.getStyleFunction=function(){},t.prototype.getType=function(){return this.type_},t.prototype.transform=function(t,e){var i=(t=He(t)).getExtent(),n=t.getWorldExtent(),o=ue(n)/ue(i);an(go,n[0],n[3],o,-o,0,0,0),Ki(this.flatCoordinates_,0,this.flatCoordinates_.length,2,go,this.flatCoordinates_)},t}();mo.prototype.getEnds=function(){return this.ends_},mo.prototype.getEndss=mo.prototype.getEnds,mo.prototype.getFlatCoordinates=mo.prototype.getOrientedFlatCoordinates;var vo=mo,yo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function bo(t,e,i){if(3===t){var n={keys:[],values:[],features:[]},o=i.readVarint()+i.pos;i.readFields(wo,n,o),n.length=n.features.length,n.length&&(e[n.name]=n)}}function wo(t,e,i){if(15===t)e.version=i.readVarint();else if(1===t)e.name=i.readString();else if(5===t)e.extent=i.readVarint();else if(2===t)e.features.push(i.pos);else if(3===t)e.keys.push(i.readString());else if(4===t){for(var n=null,o=i.readVarint()+i.pos;i.pos<o;)n=1===(t=i.readVarint()>>3)?i.readString():2===t?i.readFloat():3===t?i.readDouble():4===t?i.readVarint64():5===t?i.readVarint():6===t?i.readSVarint():7===t?i.readBoolean():null;e.values.push(n)}}function _o(t,e,i){if(1==t)e.id=i.readVarint();else if(2==t)for(var n=i.readVarint()+i.pos;i.pos<n;){var o=e.layer.keys[i.readVarint()],r=e.layer.values[i.readVarint()];e.properties[o]=r}else 3==t?e.type=i.readVarint():4==t&&(e.geometry=i.pos)}function xo(t,e,i){t.pos=e.features[i];var n=t.readVarint()+t.pos,o={layer:e,type:0,properties:{}};return t.readFields(_o,o,n),o}var Co=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.dataProjection=new we({code:"",units:be.TILE_PIXELS}),i.featureClass_=n.featureClass?n.featureClass:vo,i.geometryName_=n.geometryName,i.layerName_=n.layerName?n.layerName:"layer",i.layers_=n.layers?n.layers:null,i.idProperty_=n.idProperty,i}return yo(e,t),e.prototype.readRawGeometry_=function(t,e,i,n){t.pos=e.geometry;for(var o=t.readVarint()+t.pos,r=1,a=0,s=0,l=0,u=0,c=0;t.pos<o;){if(!a){var h=t.readVarint();r=7&h,a=h>>3}a--,1===r||2===r?(s+=t.readSVarint(),l+=t.readSVarint(),1===r&&u>c&&(n.push(u),c=u),i.push(s,l),u+=2):7===r?u>c&&(i.push(i[c],i[c+1]),u+=2):nt(!1,59)}u>c&&(n.push(u),c=u)},e.prototype.createFeature_=function(t,e,i){var n,o=e.type;if(0===o)return null;var r,a=e.properties;this.idProperty_?(r=a[this.idProperty_],delete a[this.idProperty_]):r=e.id,a[this.layerName_]=e.layer.name;var s=[],l=[];this.readRawGeometry_(t,e,s,l);var u=function(t,e){var i;1===t?i=1===e?vt:_t:2===t?i=1===e?yt:xt:3===t&&(i=wt);return i}(o,l.length);if(this.featureClass_===vo)(n=new this.featureClass_(u,s,l,a,r)).transform(i.dataProjection,i.featureProjection);else{var c=void 0;if(u==wt){for(var h=[],d=0,p=0,f=0,g=l.length;f<g;++f){var m=l[f];eo(s,d,m,2)||(h.push(l.slice(p,f)),p=f),d=m}c=h.length>1?new fo(s,hi,h):new so(s,hi,l)}else c=u===vt?new qn(s,hi):u===yt?new Bn(s,hi):u===wt?new so(s,hi,l):u===_t?new Yn(s,hi):u===xt?new Vn(s,hi,l):null;n=new(0,this.featureClass_),this.geometryName_&&n.setGeometryName(this.geometryName_);var v=ai(c,!1,i);n.setGeometry(v),n.setId(r),n.setProperties(a,!0)}return n},e.prototype.getType=function(){return si},e.prototype.readFeatures=function(t,e){var i=this.layers_,n=this.adaptOptions(e),o=He(n.dataProjection);o.setWorldExtent(n.extent),n.dataProjection=o;var r=new rt.a(t),a=r.readFields(bo,{}),s=[];for(var l in a)if(!i||-1!=i.indexOf(l)){var u=a[l],c=u?[0,0,u.extent,u.extent]:null;o.setExtent(c);for(var h=0,d=u.length;h<d;++h){var p=xo(r,u,h);s.push(this.createFeature_(r,p,n))}}return s},e.prototype.readProjection=function(t){return this.dataProjection},e.prototype.setLayers=function(t){this.layers_=t},e}(ri),Eo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var ko=function(t){function e(e){var i=t.call(this)||this;if(i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener(Xi(i.geometryName_),i.handleGeometryChanged_),e)if("function"==typeof e.getSimplifiedGeometry){var n=e;i.setGeometry(n)}else{var o=e;i.setProperties(o)}return i}return Eo(e,t),e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Ci(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=_i(t,Di,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(nt("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeEventListener(Xi(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(Xi(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Ui),So=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Mo(t){if("string"==typeof t){var e=JSON.parse(t);return e||null}return null!==t?t:null}var To=function(t){function e(){return t.call(this)||this}return So(e,t),e.prototype.getType=function(){return li},e.prototype.readFeature=function(t,e){return this.readFeatureFromObject(Mo(t),this.getReadOptions(t,e))},e.prototype.readFeatures=function(t,e){return this.readFeaturesFromObject(Mo(t),this.getReadOptions(t,e))},e.prototype.readFeatureFromObject=function(t,e){return Z()},e.prototype.readFeaturesFromObject=function(t,e){return Z()},e.prototype.readGeometry=function(t,e){return this.readGeometryFromObject(Mo(t),this.getReadOptions(t,e))},e.prototype.readGeometryFromObject=function(t,e){return Z()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(Mo(t))},e.prototype.readProjectionFromObject=function(t){return Z()},e.prototype.writeFeature=function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))},e.prototype.writeFeatureObject=function(t,e){return Z()},e.prototype.writeFeatures=function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))},e.prototype.writeFeaturesObject=function(t,e){return Z()},e.prototype.writeGeometry=function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))},e.prototype.writeGeometryObject=function(t,e){return Z()},e}(ri),Ro=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Po(t){for(var e=[],i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}var Do=function(t){function e(e){var i=t.call(this)||this;return i.geometries_=e||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return Ro(e,t),e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(Ci),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(_i(this.geometries_[t],Di,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t},e.prototype.closestPointXY=function(t,e,i,n){if(n<Ht(this.getExtent(),t,e))return n;for(var o=this.geometries_,r=0,a=o.length;r<a;++r)n=o[r].closestPointXY(t,e,i,n);return n},e.prototype.containsXY=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)if(i[n].containsXY(t,e))return!0;return!1},e.prototype.computeExtent=function(t){Yt(t);for(var e=this.geometries_,i=0,n=e.length;i<n;++i)Zt(t,e[i].getExtent());return t},e.prototype.getGeometries=function(){return Po(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var i=[],n=this.geometries_,o=!1,r=0,a=n.length;r<a;++r){var s=n[r],l=s.getSimplifiedGeometry(t);i.push(l),l!==s&&(o=!0)}if(o){var u=new e(null);return u.setGeometriesArray(i),u}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return Et},e.prototype.intersectsExtent=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return 0===this.geometries_.length},e.prototype.rotate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].rotate(t,e);this.changed()},e.prototype.scale=function(t,e,i){var n=i;n||(n=ae(this.getExtent()));for(var o=this.geometries_,r=0,a=o.length;r<a;++r)o[r].scale(t,e,n);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(Po(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var e=this.geometries_,i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()},e.prototype.translate=function(t,e){for(var i=this.geometries_,n=0,o=i.length;n<o;++n)i[n].translate(t,e);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),t.prototype.disposeInternal.call(this)},e}(hn),Lo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Fo(t,e){if(!t)return null;var i;switch(t.type){case vt:i=function(t){return new qn(t.coordinates)}(t);break;case yt:i=function(t){return new Bn(t.coordinates)}(t);break;case wt:i=function(t){return new so(t.coordinates)}(t);break;case _t:i=function(t){return new Yn(t.coordinates)}(t);break;case xt:i=function(t){return new Vn(t.coordinates)}(t);break;case Ct:i=function(t){return new fo(t.coordinates)}(t);break;case Et:i=function(t,e){var i=t.geometries.map((function(t){return Fo(t,e)}));return new Do(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return ai(i,!1,e)}function Oo(t,e){var i,n=(t=ai(t,!0,e)).getType();switch(n){case vt:i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case yt:i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case wt:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case _t:i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case xt:i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case Ct:i=function(t,e){var i;e&&(i=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case Et:i=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){var i=at({},e);return delete i.featureProjection,Oo(t,i)}))}}(t,e);break;case kt:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}var Ao=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this)||this).dataProjection=He(n.dataProjection?n.dataProjection:"EPSG:4326"),n.featureProjection&&(i.defaultFeatureProjection=He(n.featureProjection)),i.geometryName_=n.geometryName,i.extractGeometryName_=n.extractGeometryName,i}return Lo(e,t),e.prototype.readFeatureFromObject=function(t,e){var i=null,n=Fo((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),o=new ko;return this.geometryName_?o.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&o.setGeometryName(i.geometry_name),o.setGeometry(n),"id"in i&&o.setId(i.id),i.properties&&o.setProperties(i.properties,!0),o},e.prototype.readFeaturesFromObject=function(t,e){var i=null;if("FeatureCollection"===t.type){i=[];for(var n=t.features,o=0,r=n.length;o<r;++o)i.push(this.readFeatureFromObject(n[o],e))}else i=[this.readFeatureFromObject(t,e)];return i},e.prototype.readGeometryFromObject=function(t,e){return Fo(t,e)},e.prototype.readProjectionFromObject=function(t){var e,i=t.crs;return i?"name"==i.type?e=He(i.properties.name):"EPSG"===i.type?e=He("EPSG:"+i.properties.code):nt(!1,36):e=this.dataProjection,e},e.prototype.writeFeatureObject=function(t,e){e=this.adaptOptions(e);var i={type:"Feature",geometry:null,properties:null},n=t.getId();void 0!==n&&(i.id=n);var o=t.getGeometry();o&&(i.geometry=Oo(o,e));var r=t.getProperties();return delete r[t.getGeometryName()],ut(r)||(i.properties=r),i},e.prototype.writeFeaturesObject=function(t,e){e=this.adaptOptions(e);for(var i=[],n=0,o=t.length;n<o;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}},e.prototype.writeGeometryObject=function(t,e){return Oo(t,this.adaptOptions(e))},e}(To),Io=0,jo=1,zo=2,No=3,Ho=4;function Bo(t){return Math.pow(t,3)}function Go(t){return 1-Bo(1-t)}function Vo(t){return 3*t*t-2*t*t*t}function Wo(t){return t}var qo=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$o=function(t){function e(e,i,n){var o=t.call(this)||this,r=n||{};return o.tileCoord=e,o.state=i,o.interimTile=null,o.hifi=!0,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o}return qo(e,t),e.prototype.changed=function(){this.dispatchEvent(Di)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==zo)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==zo){t.interimTile=null;break}t.getState()==jo?e=t:t.getState()==Io?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==No&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){Z()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Bo(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Pi),Yo="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Xo=-1!==Yo.indexOf("firefox"),Uo=(-1!==Yo.indexOf("safari")&&Yo.indexOf("chrom"),-1!==Yo.indexOf("webkit")&&-1==Yo.indexOf("edge")),Ko=-1!==Yo.indexOf("macintosh"),Zo="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Jo="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Qo="undefined"!=typeof Image&&Image.prototype.decode,tr=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function er(t,e,i){var n=i&&i.length?i.shift():Jo?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")}function ir(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function nr(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function or(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function rr(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function ar(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var sr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lr=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.extent=e,r.pixelRatio_=n,r.resolution=i,r.state=o,r}return sr(e,t),e.prototype.changed=function(){this.dispatchEvent(Di)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return Z()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){Z()},e}(Pi),ur=0,cr=1,hr=2,dr=3,pr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function fr(t,e,i){var n=t;if(n.src&&Qo){var o=n.decode(),r=!0;return o.then((function(){r&&e()})).catch((function(t){r&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():i())})),function(){r=!1}}var a=[xi(n,zi,e),xi(n,Li,i)];return function(){a.forEach(Ci)}}!function(t){function e(e,i,n,o,r,a){var s=t.call(this,e,i,n,ur)||this;return s.src_=o,s.image_=new Image,null!==r&&(s.image_.crossOrigin=r),s.unlisten_=null,s.state=ur,s.imageLoadFunction_=a,s}pr(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=dr,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=ue(this.extent)/this.image_.height),this.state=hr,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=ur&&this.state!=dr||(this.state=cr,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=fr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}(lr);var gr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var mr=function(t){function e(e,i,n,o,r,a){var s=t.call(this,e,i,a)||this;return s.crossOrigin_=o,s.src_=n,s.image_=new Image,null!==o&&(s.image_.crossOrigin=o),s.unlisten_=null,s.tileLoadFunction_=r,s}return gr(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){var t;this.state=No,this.unlistenImage_(),this.image_=((t=er(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=zo:this.state=Ho,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==No&&(this.state=Io,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Io&&(this.state=jo,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=fr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}($o),vr=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},t.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},t.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},t.prototype.get=function(t,e){var i=this.entries_[t];return nt(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},t.prototype.remove=function(t){var e=this.entries_[t];return nt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},t.prototype.getCount=function(){return this.count_},t.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},t.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},t.prototype.peekLast=function(){return this.oldest_.value_},t.prototype.peekLastKey=function(){return this.oldest_.key_},t.prototype.peekFirstKey=function(){return this.newest_.key_},t.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},t.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},t.prototype.set=function(t,e){nt(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},t.prototype.setSize=function(t){this.highWaterMark=t},t}();function yr(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function br(t,e,i){return t+"/"+e+"/"+i}function wr(t){return br(t[0],t[1],t[2])}function _r(t){return t.split("/").map(Number)}var xr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return xr(e,t),e.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=_r(this.peekFirstKey())[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(wr(e.tileCoord)),e.release())}.bind(this))}},e}(vr);function Er(t,e,i,n){var o=i-t,r=n-e,a=Math.sqrt(o*o+r*r);return[Math.round(i+o/a),Math.round(n+r/a)]}function kr(t,e,i,n,o,r,a,s,l,u,c){var h=er(Math.round(i*t),Math.round(i*e));if(0===l.length)return h.canvas;h.scale(i,i);var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){Zt(d,t.extent)}));var p=pe(d),f=ue(d),g=er(Math.round(i*p/n),Math.round(i*f/n)),m=i/n;l.forEach((function(t,e,i){var n=t.extent[0]-d[0],o=-(t.extent[3]-d[3]),r=pe(t.extent),a=ue(t.extent);g.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,n*m,o*m,r*m,a*m)}));var v=he(a);return s.getTriangles().forEach((function(t,e,o){var a=t.source,s=t.target,l=a[0][0],u=a[0][1],c=a[1][0],p=a[1][1],f=a[2][0],m=a[2][1],y=(s[0][0]-v[0])/r,b=-(s[0][1]-v[1])/r,w=(s[1][0]-v[0])/r,_=-(s[1][1]-v[1])/r,x=(s[2][0]-v[0])/r,C=-(s[2][1]-v[1])/r,E=l,k=u;l=0,u=0;var S=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,o=Math.abs(t[i][i]),r=i+1;r<e;r++){var a=Math.abs(t[r][i]);a>o&&(o=a,n=r)}if(0===o)return null;var s=t[n];t[n]=t[i],t[i]=s;for(var l=i+1;l<e;l++)for(var u=-t[l][i]/t[i][i],c=i;c<e+1;c++)i==c?t[l][c]=0:t[l][c]+=u*t[i][c]}for(var h=new Array(e),d=e-1;d>=0;d--){h[d]=t[d][e]/t[d][d];for(var p=d-1;p>=0;p--)t[p][e]-=t[p][d]*h[d]}return h}([[c-=E,p-=k,0,0,w-y],[f-=E,m-=k,0,0,x-y],[0,0,c,p,_-b],[0,0,f,m,C-b]]);if(S){h.save(),h.beginPath();var M=(y+w+x)/3,T=(b+_+C)/3,R=Er(M,T,y,b),P=Er(M,T,w,_),D=Er(M,T,x,C);h.moveTo(P[0],P[1]),h.lineTo(R[0],R[1]),h.lineTo(D[0],D[1]),h.clip(),h.transform(S[0],S[2],S[1],S[3],y,b),h.translate(d[0]-E,d[3]-k),h.scale(n/i,-n/i),h.drawImage(g.canvas,0,0),h.restore()}})),c&&(h.save(),h.strokeStyle="black",h.lineWidth=1,s.getTriangles().forEach((function(t,e,i){var n=t.target,o=(n[0][0]-v[0])/r,a=-(n[0][1]-v[1])/r,s=(n[1][0]-v[0])/r,l=-(n[1][1]-v[1])/r,u=(n[2][0]-v[0])/r,c=-(n[2][1]-v[1])/r;h.beginPath(),h.moveTo(s,l),h.lineTo(o,a),h.lineTo(u,c),h.closePath(),h.stroke()})),h.restore()),h.canvas}var Sr=function(){function t(t,e,i,n,o,r){this.sourceProj_=t,this.targetProj_=e;var a={},s=Ye(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return a[e]||(a[e]=s(t)),a[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&pe(n)==pe(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?pe(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?pe(this.targetProj_.getExtent()):null;var l=he(i),u=de(i),c=re(i),h=oe(i),d=this.transformInv_(l),p=this.transformInv_(u),f=this.transformInv_(c),g=this.transformInv_(h),m=10+(r?Math.max(0,Math.ceil(Math.log2(ne(i)/(r*r*256*256)))):0);if(this.addQuad_(l,u,c,h,d,p,f,g,m),this.wrapsXInSource_){var v=1/0;this.triangles_.forEach((function(t,e,i){v=Math.min(v,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-v>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-v>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-v>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-v>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}a={}}return t.prototype.addTriangle_=function(t,e,i,n,o,r){this.triangles_.push({source:[n,o,r],target:[t,e,i]})},t.prototype.addQuad_=function(t,e,i,n,o,r,a,s,l){var u=jt([o,r,a,s]),c=this.sourceWorldWidth_?pe(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1,p=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)p=pe(jt([t,e,i,n]))/this.targetWorldWidth_>.25||p;!d&&this.sourceProj_.isGlobal()&&c&&(p=c>.25||p)}if(p||!this.maxSourceExtent_||fe(u,this.maxSourceExtent_)){if(!(p||isFinite(o[0])&&isFinite(o[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1]))){if(!(l>0))return;p=!0}if(l>0){if(!p){var f=[(t[0]+i[0])/2,(t[1]+i[1])/2],g=this.transformInv_(f),m=void 0;if(d)m=(gt(o[0],h)+gt(a[0],h))/2-gt(g[0],h);else m=(o[0]+a[0])/2-g[0];var v=(o[1]+a[1])/2-g[1];p=m*m+v*v>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(y),w=[(n[0]+t[0])/2,(n[1]+t[1])/2],_=this.transformInv_(w);this.addQuad_(t,e,y,w,o,r,b,_,l-1),this.addQuad_(w,y,i,n,_,b,a,s,l-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],C=this.transformInv_(x),E=[(i[0]+n[0])/2,(i[1]+n[1])/2],k=this.transformInv_(E);this.addQuad_(t,x,E,n,o,C,k,s,l-1),this.addQuad_(x,e,i,E,C,r,a,k,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,o,a,s),this.addTriangle_(t,e,i,o,r,a)}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var o=e.source;Jt(t,o[0]),Jt(t,o[1]),Jt(t,o[2])})),t},t.prototype.getTriangles=function(){return this.triangles_},t}(),Mr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tr=function(t){function e(e,i,n,o,r,a,s,l,u,c,h){var d=t.call(this,r,Io)||this;d.renderEdges_=void 0!==h&&h,d.pixelRatio_=s,d.gutter_=l,d.canvas_=null,d.sourceTileGrid_=i,d.targetTileGrid_=o,d.wrappedTileCoord_=a||r,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var p=o.getTileCoordExtent(d.wrappedTileCoord_),f=d.targetTileGrid_.getExtent(),g=d.sourceTileGrid_.getExtent(),m=f?ce(p,f):p;if(0===ne(m))return d.state=Ho,d;var v=e.getExtent();v&&(g=g?ce(g,v):v);var y=o.getResolution(d.wrappedTileCoord_[0]),b=function(t,e,i,n){var o=Xe(i,e,t),r=Be(e,n,i),a=e.getMetersPerUnit();void 0!==a&&(r*=a);var s=t.getMetersPerUnit();void 0!==s&&(r/=s);var l=t.getExtent();if(!l||Bt(l,o)){var u=Be(t,r,o)/r;isFinite(u)&&u>0&&(r/=u)}return r}(e,n,ae(m),y);if(!isFinite(b)||b<=0)return d.state=Ho,d;var w=void 0!==c?c:.5;if(d.triangulation_=new Sr(e,n,m,g,b*w,y),0===d.triangulation_.getTriangles().length)return d.state=Ho,d;d.sourceZ_=i.getZForResolution(b);var _=d.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(_[1]=ct(_[1],g[1],g[3]),_[3]=ct(_[3],g[1],g[3])):_=ce(_,g)),ne(_)){for(var x=i.getTileRangeForExtentAndZ(_,d.sourceZ_),C=x.minX;C<=x.maxX;C++)for(var E=x.minY;E<=x.maxY;E++){var k=u(d.sourceZ_,C,E,s);k&&d.sourceTiles_.push(k)}0===d.sourceTiles_.length&&(d.state=Ho)}else d.state=Ho;return d}return Mr(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==zo&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=No;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],o="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=kr(n,o,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),r,s,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=zo}this.changed()},e.prototype.load=function(){if(this.state==Io){this.state=jo,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var o=e.getState();if(o==Io||o==jo){t++;var r=_i(e,Di,(function(i){var n=e.getState();n!=zo&&n!=No&&n!=Ho||(Ci(r),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(r)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==Io&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Ci),this.sourcesListenerKeys_=null},e}($o);function Rr(t,e){var i=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,r=/\{-y\}/g;return function(a,s,l){return a?t.replace(i,a[0].toString()).replace(n,a[1].toString()).replace(o,a[2].toString()).replace(r,(function(){var t=a[0],i=e.getFullTileRange(t);return nt(i,55),(i.getHeight()-a[2]-1).toString()})):void 0}}function Pr(t,e){for(var i=t.length,n=new Array(i),o=0;o<i;++o)n[o]=Rr(t[o],e);return function(t){if(1===t.length)return t[0];return function(e,i,n){if(e){var o=gt(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[o](e,i,n)}}}(n)}function Dr(t,e,i){}function Lr(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}var Fr="undefined",Or="ready",Ar=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Ir(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var jr=function(t){function e(e){var i=t.call(this)||this;return i.projection_=He(e.projection),i.attributions_=Ir(e.attributions),i.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,i.loading=!1,i.state_=void 0!==e.state?e.state:Or,i.wrapX_=void 0!==e.wrapX&&e.wrapX,i}return Ar(e,t),e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return Z()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Ir(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Ui),zr=function(){function t(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Nr(t,e,i,n,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=i,o.maxY=n,o):new zr(t,e,i,n)}var Hr=zr,Br=[0,0,0],Gr=function(){function t(t){var e,i,n,o;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,nt((e=this.resolutions_,i=!0,n=function(t,e){return e-t}||gi,e.every((function(t,o){if(0===o)return!0;var r=n(e[o-1],t);return!(r>0||i&&0===r)}))),17),!t.origins)for(var r=0,a=this.resolutions_.length-1;r<a;++r)if(o){if(this.resolutions_[r]/this.resolutions_[r+1]!==o){o=void 0;break}}else o=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=o,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,nt(this.origins_.length==this.resolutions_.length,20));var s=t.extent;void 0===s||this.origin_||this.origins_||(this.origin_=he(s)),nt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,nt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,nt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==s?s:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new Hr(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):s&&this.calculateTileRanges_(s)}return t.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),o=n.minX,r=n.maxX;o<=r;++o)for(var a=n.minY,s=n.maxY;a<=s;++a)i([e,o,a])},t.prototype.forEachTileCoordParentTileRange=function(t,e,i,n){var o,r,a=null,s=t[0]-1;for(2===this.zoomFactor_?(o=t[1],r=t[2]):a=this.getTileCoordExtent(t,n);s>=this.minZoom;){if(e(s,2===this.zoomFactor_?Nr(o=Math.floor(o/2),o,r=Math.floor(r/2),r,i):this.getTileRangeForExtentAndZ(a,s,i)))return!0;--s}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],o=2*t[2];return Nr(n,n+1,o,o+1,e)}var r=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null},t.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),o=this.getResolution(t),r=Lr(this.getTileSize(t),this.tmpSize_),a=n[0]+e.minX*r[0]*o,s=n[0]+(e.maxX+1)*r[0]*o;return $t(a,n[1]+e.minY*r[1]*o,s,n[1]+(e.maxY+1)*r[1]*o,i)},t.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=Br;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var o=n[1],r=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),Nr(o,n[1],r,n[2],i)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Lr(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]},t.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),o=Lr(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*o[0]*n,a=i[1]-(t[2]+1)*o[1]*n;return $t(r,a,r+o[0]*n,a+o[1]*n,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,o){var r=this.getZForResolution(i),a=i/this.getResolution(r),s=this.getOrigin(r),l=Lr(this.getTileSize(r),this.tmpSize_),u=n?.5:0,c=n?.5:0,h=Math.floor((t-s[0])/i+u),d=Math.floor((s[1]-e)/i+c),p=a*h/l[0],f=a*d/l[1];return n?(p=Math.ceil(p)-1,f=Math.ceil(f)-1):(p=Math.floor(p),f=Math.floor(f)),yr(r,p,f,o)},t.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,o){var r=this.getOrigin(i),a=this.getResolution(i),s=Lr(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?.5:0,c=Math.floor((t-r[0])/a+l),h=Math.floor((r[1]-e)/a+u),d=c/s[0],p=h/s[1];return n?(d=Math.ceil(d)-1,p=Math.ceil(p)-1):(d=Math.floor(d),p=Math.floor(p)),yr(i,d,p,o)},t.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,e){return ct(mi(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i},t}();function Vr(t){var e=t.getDefaultTileGrid();return e||(e=$r(t),t.setDefaultTileGrid(e)),e}function Wr(t){var e=t||{},i=e.extent||He("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:qr(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Gr(n)}function qr(t,e,i,n){for(var o=void 0!==e?e:42,r=ue(t),a=pe(t),s=Lr(void 0!==i?i:256),l=n>0?n:Math.max(a/s[0],r/s[1]),u=o+1,c=new Array(u),h=0;h<u;++h)c[h]=l/Math.pow(2,h);return c}function $r(t,e,i,n){return function(t,e,i,n){var o=void 0!==n?n:Rt,r=qr(t,e,i);return new Gr({extent:t,origin:se(t,o),resolutions:r,tileSize:i})}(Yr(t),e,i,n)}function Yr(t){var e=(t=He(t)).getExtent();if(!e){var i=180*ye[be.DEGREES]/t.getMetersPerUnit();e=$t(-i,-i,i,i)}return e}var Xr=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ur=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX})||this;i.opaque_=void 0!==e.opaque&&e.opaque,i.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,i.tileGrid=void 0!==e.tileGrid?e.tileGrid:null;var n=[256,256],o=e.tileGrid;o&&Lr(o.getTileSize(o.getMinZoom()),n);var r="undefined"!=typeof screen,a=r?screen.availWidth||screen.width:1920,s=r?screen.availHeight||screen.height:1080,l=4*Math.ceil(a/n[0])*Math.ceil(s/n[1]);return i.tileCache=new Cr(Math.max(l,e.cacheSize||0)),i.tmpSize=[0,0],i.key_=e.key||"",i.tileOptions={transition:e.transition},i.zDirection=e.zDirection?e.zDirection:0,i}return Xr(e,t),e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var o=this.getTileCacheForProjection(t);if(!o)return!1;for(var r,a,s,l=!0,u=i.minX;u<=i.maxX;++u)for(var c=i.minY;c<=i.maxY;++c)a=br(e,u,c),s=!1,o.containsKey(a)&&(s=(r=o.get(a)).getState()===zo)&&(s=!1!==n(r)),s||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,o){return Z()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Vr(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!qe(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,o,r,a=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),l=Lr(a.getTileSize(t),this.tmpSize);return 1==s?l:(n=l,o=s,void 0===(r=this.tmpSize)&&(r=[0,0]),r[0]=n[0]*o+.5|0,r[1]=n[1]*o+.5|0,r)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],o=t.getTileCoordCenter(e),r=Yr(i);if(Bt(r,o))return e;var a=pe(r),s=Math.ceil((r[0]-o[0])/a);return o[0]+=a*s,t.getTileCoordForCoordAndZ(o,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],o=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var r,a=e.getExtent();return!(r=a?e.getTileRangeForExtentAndZ(a,i):e.getFullTileRange(i))||r.containsXY(n,o)}(t,n)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},e.prototype.useTile=function(t,e,i,n){},e}(jr),Kr=function(t){function e(e,i){var n=t.call(this,e)||this;return n.tile=i,n}return Xr(e,t),e}(Ti),Zr=Ur,Jr="tileloadstart",Qr="tileloadend",ta="tileloaderror",ea=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ia=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.generateTileUrlFunction_=!e.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,i.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(i):Dr,i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return ea(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=Q(i),o=i.getState();o==jo?(this.tileLoadingKeys_[n]=!0,e=Jr):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=o==No?ta:o==zo?Qr:void 0),null!=e&&this.dispatchEvent(new Kr(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=function(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n=i[1].charCodeAt(0),o=i[2].charCodeAt(0),r=void 0;for(r=n;r<=o;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(i[2],10),s=parseInt(i[1],10);s<=a;s++)e.push(t.replace(i[0],s.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Pr(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=br(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(Zr),na=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function oa(t,e){t.getImage().src=e}var ra=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:oa,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,i.tileClass=void 0!==e.tileClass?e.tileClass:mr,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return na(e,t),e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var o=this.tileCacheForProjection[n];o.expireCache(o==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!qe(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!qe(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!qe(e,t)){var i=Q(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Vr(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||qe(e,t))return this.tileCache;var i=Q(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Cr(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,o,r){var a=[t,e,i],s=this.getTileCoordForTileUrlFunction(a,o),l=s?this.tileUrlFunction(s,n,o):void 0,u=new this.tileClass(a,void 0!==l?Io:Ho,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=r,u.addEventListener(Di,this.handleTileChange.bind(this)),u},e.prototype.getTile=function(t,e,i,n,o){var r=this.getProjection();if(r&&o&&!qe(r,o)){var a=this.getTileCacheForProjection(o),s=[t,e,i],l=void 0,u=wr(s);a.containsKey(u)&&(l=a.get(u));var c=this.getKey();if(l&&l.key==c)return l;var h=this.getTileGridForProjection(r),d=this.getTileGridForProjection(o),p=this.getTileCoordForTileUrlFunction(s,o),f=new Tr(r,h,o,d,s,p,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,r)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return f.key=c,l?(f.interimTile=l,f.refreshInterimChain(),a.replace(u,f)):a.set(u,f),f}return this.getTileInternal(t,e,i,n,r||o)},e.prototype.getTileInternal=function(t,e,i,n,o){var r=null,a=br(t,e,i),s=this.getKey();if(this.tileCache.containsKey(a)){if((r=this.tileCache.get(a)).key!=s){var l=r;r=this.createTile_(t,e,i,n,o,s),l.getState()==Io?r.interimTile=l.interimTile:r.interimTile=l,r.refreshInterimChain(),this.tileCache.replace(a,r)}}else r=this.createTile_(t,e,i,n,o,s),this.tileCache.set(a,r);return r},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=He(t);if(i){var n=Q(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(ia),aa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sa=function(t){function e(e){var i=e||{},n=void 0!==i.projection?i.projection:"EPSG:3857",o=void 0!==i.tileGrid?i.tileGrid:Wr({extent:Yr(n),maxResolution:i.maxResolution,maxZoom:i.maxZoom,minZoom:i.minZoom,tileSize:i.tileSize});return t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:i.opaque,projection:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:i.tileLoadFunction,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:i.tileUrlFunction,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this}return aa(e,t),e}(ra),la=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ua=function(t){function e(e){var i,n=e||{};i=void 0!==n.attributions?n.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];var o=void 0!==n.crossOrigin?n.crossOrigin:"anonymous",r=void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:i,cacheSize:n.cacheSize,crossOrigin:o,opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:r,wrapX:n.wrapX,attributionsCollapsible:!1})||this}return la(e,t),e}(sa),ca=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ha=[],da=function(t){function e(e,i,n,o){var r=t.call(this,e,i,{transition:0})||this;return r.context_={},r.executorGroups={},r.loadingSourceTiles=0,r.errorSourceTileKeys={},r.hitDetectionImageData={},r.replayState_={},r.sourceTiles=null,r.wantedResolution,r.getSourceTiles=o.bind(void 0,r),r.sourceZ=-1,r.hifi=!1,r.wrappedTileCoord=n,r}return ca(e,t),e.prototype.getContext=function(t){var e=Q(t);return e in this.context_||(this.context_[e]=er(1,1,ha)),this.context_[e]},e.prototype.hasContext=function(t){return Q(t)in this.context_},e.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},e.prototype.getReplayState=function(t){var e=Q(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[e]},e.prototype.load=function(){this.getSourceTiles()},e.prototype.release=function(){for(var e in this.context_)ha.push(this.context_[e].canvas);t.prototype.release.call(this)},e}($o),pa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fa=function(t){function e(e,i,n,o,r,a){var s=t.call(this,e,i,a)||this;return s.extent=null,s.format_=o,s.features_=null,s.loader_,s.projection=null,s.resolution,s.tileLoadFunction_=r,s.url_=n,s}return pa(e,t),e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.getKey=function(){return this.url_},e.prototype.load=function(){this.state==Io&&(this.setState(jo),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},e.prototype.onLoad=function(t,e){this.setFeatures(t)},e.prototype.onError=function(){this.setState(No)},e.prototype.setFeatures=function(t){this.features_=t,this.setState(zo)},e.prototype.setLoader=function(t){this.loader_=t},e}($o),ga=!1;function ma(t,e,i,n){return function(o,r,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(o,r,a):t,!0),e.getType()==si&&(s.responseType="arraybuffer"),s.withCredentials=ga,s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var r=e.getType(),l=void 0;r==li||r==ui?l=s.responseText:r==ci?(l=s.responseXML)||(l=(new DOMParser).parseFromString(s.responseText,"application/xml")):r==si&&(l=s.response),l?i.call(this,e.readFeatures(l,{extent:o,featureProjection:a}),e.readProjection(l)):n.call(this)}else n.call(this)}.bind(this),s.onerror=function(){n.call(this)}.bind(this),s.send()}}function va(t,e){return ma(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),Mi)}var ya=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ba=function(t){function e(e){var i=this,n=e.projection||"EPSG:3857",o=e.extent||Yr(n),r=e.tileGrid||Wr({extent:o,maxResolution:e.maxResolution,maxZoom:void 0!==e.maxZoom?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});return(i=t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,opaque:!1,projection:n,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:wa,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:void 0===e.zDirection?1:e.zDirection})||this).format_=e.format?e.format:null,i.loadingTiles_={},i.sourceTileCache=new Cr(i.tileCache.highWaterMark),i.overlaps_=null==e.overlaps||e.overlaps,i.tileClass=e.tileClass?e.tileClass:fa,i.tileGrids_={},i}return ya(e,t),e.prototype.getFeaturesInExtent=function(t){var e=[],i=this.tileCache;if(0===i.getCount())return e;var n=_r(i.peekFirstKey())[0],o=this.tileGrid;return i.forEach((function(i){if(i.tileCoord[0]===n&&i.getState()===zo)for(var r=i.getSourceTiles(),a=0,s=r.length;a<s;++a){var l=r[a],u=l.tileCoord;if(fe(t,o.getTileCoordExtent(u))){var c=l.getFeatures();if(c)for(var h=0,d=c.length;h<d;++h){var p=c[h],f=p.getGeometry();fe(t,f.getExtent())&&e.push(p)}}}})),e},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},e.prototype.expireCache=function(e,i){t.prototype.expireCache.call(this,e,i),this.sourceTileCache.expireCache({})},e.prototype.getSourceTiles=function(t,e,i){var n=i.wrappedTileCoord,o=this.getTileGridForProjection(e),r=o.getTileCoordExtent(n),a=n[0],s=o.getResolution(a);zt(r,-s,r);var l=this.tileGrid,u=l.getExtent();u&&ce(r,u,r);var c,h,d,p=l.getZForResolution(s,1),f=l.getMinZoom(),g=i.sourceTiles;if(g&&g.length>0&&g[0].tileCoord[0]===p)c=g,h=!0,d=p;else{c=[],d=p+1;do{--d,h=!0,l.forEachTileCoord(r,d,function(n){var o,r=this.tileUrlFunction(n,t,e);if(void 0!==r)if(this.sourceTileCache.containsKey(r)){var a=(o=this.sourceTileCache.get(r)).getState();if(a===zo||a===No||a===Ho)return void c.push(o)}else d===p&&((o=new this.tileClass(n,Io,r,this.format_,this.tileLoadFunction)).extent=l.getTileCoordExtent(n),o.projection=e,o.resolution=l.getResolution(n[0]),this.sourceTileCache.set(r,o),o.addEventListener(Di,this.handleTileChange.bind(this)),o.load());h=h&&o&&o.getState()===zo,o&&o.getState()!==Ho&&i.getState()===Io&&(i.loadingSourceTiles++,o.addEventListener(Di,(function t(){var e=o.getState(),n=o.getKey();if(e===zo||e===No){e===zo?(o.removeEventListener(Di,t),i.loadingSourceTiles--,delete i.errorSourceTileKeys[n]):e===No&&(i.errorSourceTileKeys[n]=!0);var r=Object.keys(i.errorSourceTileKeys).length;i.loadingSourceTiles-r==0&&(i.hifi=0===r,i.sourceZ=p,i.setState(zo))}})))}.bind(this)),h||(c.length=0)}while(!h&&d>f)}return i.getState()===Io&&i.setState(jo),h&&(i.hifi=p===d,i.sourceZ=d,i.getState()<zo?i.setState(zo):g&&bi(c,g)||(i.sourceTiles=c)),c},e.prototype.getTile=function(t,e,i,n,o){var r,a=br(t,e,i),s=this.getKey();if(this.tileCache.containsKey(a)&&(r=this.tileCache.get(a)).key===s)return r;var l=[t,e,i],u=this.getTileCoordForTileUrlFunction(l,o),c=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(o);if(u&&c){var d=h.getTileCoordExtent(u);zt(d,-h.getResolution(t),d),fe(c,d)||(u=null)}var p=!0;if(null!==u){var f=this.tileGrid,g=h.getResolution(t),m=f.getZForResolution(g,1),v=h.getTileCoordExtent(u);zt(v,-g,v),f.forEachTileCoord(v,m,function(t){p=p&&!this.tileUrlFunction(t,n,o)}.bind(this))}var y=new da(l,p?Ho:Io,u,this.getSourceTiles.bind(this,n,o));return y.key=s,r?(y.interimTile=r,y.refreshInterimChain(),this.tileCache.replace(a,y)):this.tileCache.set(a,y),y},e.prototype.getTileGridForProjection=function(t){var e=t.getCode(),i=this.tileGrids_[e];if(!i){var n=this.tileGrid;i=$r(t,void 0,n?n.getTileSize(n.getMinZoom()):void 0),this.tileGrids_[e]=i}return i},e.prototype.getTilePixelRatio=function(t){return t},e.prototype.getTilePixelSize=function(t,e,i){var n=Lr(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(n[0]*e),Math.round(n[1]*e)]},e}(ia);function wa(t,e){var i=ma(e,t.getFormat(),t.onLoad.bind(t),t.onError.bind(t));t.setLoader(i)}var _a="add",xa="remove",Ca=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ea="length",ka=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.element=i,o.index=n,o}return Ca(e,t),e}(Ti),Sa=function(t){function e(e,i){var n=t.call(this)||this,o=i||{};if(n.unique_=!!o.unique,n.array_=e||[],n.unique_)for(var r=0,a=n.array_.length;r<a;++r)n.assertUnique_(n.array_[r],r);return n.updateLength_(),n}return Ca(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Ea)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new ka(_a,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new ka(xa,e,t)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new ka(xa,n,t)),this.dispatchEvent(new ka(_a,e,t))}else{for(var o=i;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Ea,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new it(58)},e}(Ui);function Ma(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Ta(t,e){return[t]}var Ra="addfeature",Pa="changefeature",Da="clear",La="removefeature",Fa=i(13),Oa=i.n(Fa),Aa=function(){function t(t){this.rbush_=new Oa.a(t),this.items_={}}return t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Q(e)]=i},t.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,o=e.length;n<o;n++){var r=t[n],a=e[n],s={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:a};i[n]=s,this.items_[Q(a)]=s}this.rbush_.load(i)},t.prototype.remove=function(t){var e=Q(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t.prototype.update=function(t,e){var i=this.items_[Q(e)];Kt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var i,n=0,o=t.length;n<o;n++)if(i=e(t[n]))return i;return i},t.prototype.isEmpty=function(){return ut(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return $t(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),Ia=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ja=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return Ia(e,t),e}(Ti),za=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{attributions:n.attributions,projection:void 0,state:Or,wrapX:void 0===n.wrapX||n.wrapX})||this).loader_=Mi,i.format_=n.format,i.overlaps_=void 0===n.overlaps||n.overlaps,i.url_=n.url,void 0!==n.loader?i.loader_=n.loader:void 0!==i.url_&&(nt(i.format_,7),i.loader_=va(i.url_,i.format_)),i.strategy_=void 0!==n.strategy?n.strategy:Ma;var o,r,a=void 0===n.useSpatialIndex||n.useSpatialIndex;return i.featuresRtree_=a?new Aa:null,i.loadedExtentsRtree_=new Aa,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(n.features)?r=n.features:n.features&&(r=(o=n.features).getArray()),a||void 0!==o||(o=new Sa(r)),void 0!==r&&i.addFeaturesInternal(r),void 0!==o&&i.bindFeaturesCollection_(o),i}return Ia(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Q(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new ja(Ra,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[_i(e,Di,this.handleFeatureChange_,this),_i(e,wi,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(nt(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],o=0,r=t.length;o<r;o++){var a=Q(l=t[o]);this.addToIndex_(a,l)&&i.push(l)}o=0;for(var s=i.length;o<s;o++){var l;a=Q(l=i[o]);this.setupChangeEvents_(a,l);var u=l.getGeometry();if(u){var c=u.getExtent();e.push(c),n.push(l)}else this.nullGeometryFeatures_[a]=l}this.featuresRtree_&&this.featuresRtree_.load(e,n);o=0;for(var h=i.length;o<h;o++)this.dispatchEvent(new ja(Ra,i[o]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(Ra,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(La,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(_a,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(xa,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(Ci)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new ja(Da);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),ut(this.nullGeometryFeatures_)||yi(t,lt(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],o=null,r=[NaN,NaN],a=1/0,s=[-1/0,-1/0,1/0,1/0],l=e||ki;return this.featuresRtree_.forEachInExtent(s,(function(t){if(l(t)){var e=t.getGeometry(),u=a;if((a=e.closestPointXY(i,n,r,a))<u){o=t;var c=Math.sqrt(a);s[0]=i-c,s[1]=n-c,s[2]=i+c,s[3]=n+c}}})),o},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=Q(e),n=e.getGeometry();if(n){var o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var r=e.getId();if(void 0!==r){var a=r.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new ja(Pa,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Q(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&ut(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var r=function(t,r){var s=o[t];n.forEachInExtent(s,(function(t){return Gt(t.extent,s)}))||(a.loader_.call(a,s,e,i),n.insert(s,{extent:s.slice()}),a.loading=a.loader_!==Mi)},a=this,s=0,l=o.length;s<l;++s)r(s)},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(Kt(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=Q(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=Q(t);this.featureChangeKeys_[e].forEach(Ci),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new ja(La,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){nt(this.format_,7),this.setLoader(va(t,this.format_))},e}(jr),Na="opacity",Ha="visible",Ba="extent",Ga="zIndex",Va="maxResolution",Wa="minResolution",qa="maxZoom",$a="minZoom",Ya="source",Xa=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ua=function(t){function e(e){var i=t.call(this)||this,n=at({},e);return n[Na]=void 0!==e.opacity?e.opacity:1,nt("number"==typeof n[Na],64),n[Ha]=void 0===e.visible||e.visible,n[Ga]=e.zIndex,n[Va]=void 0!==e.maxResolution?e.maxResolution:1/0,n[Wa]=void 0!==e.minResolution?e.minResolution:0,n[$a]=void 0!==e.minZoom?e.minZoom:-1/0,n[qa]=void 0!==e.maxZoom?e.maxZoom:1/0,i.className_=void 0!==n.className?e.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return Xa(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=ct(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i?i:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return Z()},e.prototype.getLayerStatesArray=function(t){return Z()},e.prototype.getExtent=function(){return this.get(Ba)},e.prototype.getMaxResolution=function(){return this.get(Va)},e.prototype.getMinResolution=function(){return this.get(Wa)},e.prototype.getMinZoom=function(){return this.get($a)},e.prototype.getMaxZoom=function(){return this.get(qa)},e.prototype.getOpacity=function(){return this.get(Na)},e.prototype.getSourceState=function(){return Z()},e.prototype.getVisible=function(){return this.get(Ha)},e.prototype.getZIndex=function(){return this.get(Ga)},e.prototype.setExtent=function(t){this.set(Ba,t)},e.prototype.setMaxResolution=function(t){this.set(Va,t)},e.prototype.setMinResolution=function(t){this.set(Wa,t)},e.prototype.setMaxZoom=function(t){this.set(qa,t)},e.prototype.setMinZoom=function(t){this.set($a,t)},e.prototype.setOpacity=function(t){nt("number"==typeof t,64),this.set(Na,t)},e.prototype.setVisible=function(t){this.set(Ha,t)},e.prototype.setZIndex=function(t){this.set(Ga,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(Ui),Ka="prerender",Za="postrender",Ja="precompose",Qa="postcompose",ts="rendercomplete",es=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function is(t,e){if(!t.visible)return!1;var i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;var n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var ns=function(t){function e(e){var i=this,n=at({},e);delete n.source,(i=t.call(this,n)||this).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,e.render&&(i.render=e.render),e.map&&i.setMap(e.map),i.addEventListener(Xi(Ya),i.handleSourcePropertyChange_);var o=e.source?e.source:null;return i.setSource(o),i}return es(e,t),e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Ya)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Fr},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Ci(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=_i(t,Di,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_.getFeatures(t)},e.prototype.render=function(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return i.renderFrame(t,e)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Ci(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ci(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=_i(t,Ja,(function(t){var e=t.frameState.layerStatesArray,i=this.getLayerState(!1);nt(!e.some((function(t){return t.layer===i.layer})),67),e.push(i)}),this),this.mapRenderKey_=_i(this,Di,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Ya,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.setSource(null),t.prototype.disposeInternal.call(this)},e}(Ua),os="preload",rs="useInterimTilesOnError",as=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ss=function(t){function e(e){var i=this,n=e||{},o=at({},n);return delete o.preload,delete o.useInterimTilesOnError,(i=t.call(this,o)||this).setPreload(void 0!==n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return as(e,t),e.prototype.getPreload=function(){return this.get(os)},e.prototype.setPreload=function(t){this.set(os,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(rs)},e.prototype.setUseInterimTilesOnError=function(t){this.set(rs,t)},e}(ns),ls=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),us=function(t){function e(e,i,n,o){var r=t.call(this,e)||this;return r.inversePixelTransform=i,r.frameState=n,r.context=o,r}return ls(e,t),e}(Ti),cs=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),hs=["style","variant","weight","size","lineHeight","family"],ds=function(t){var e=t.match(cs);if(!e)return null;for(var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,o=hs.length;n<o;++n){var r=e[n+1];void 0!==r&&(i[hs[n]]=r)}return i.families=i.family.split(/,\s?/),i},ps=[],fs=[0,0,0,0],gs=new Ui;(new Pi).setSize=function(){console.warn("labelCache is deprecated.")};var ms,vs,ys,bs=null,ws={},_s=function(){var t,e,i=["monospace","serif"],n=i.length,o="wmytzilWMYTZIL@#/&?$%10";function r(t,r,a){for(var s=!0,l=0;l<n;++l){var u=i[l];if(e=Es(t+" "+r+" 32px "+u,o),a!=u){var c=Es(t+" "+r+" 32px "+a+","+u,o);s=s&&c!=e}}return!!s}function a(){for(var e=!0,i=gs.getKeys(),n=0,o=i.length;n<o;++n){var a=i[n];gs.get(a)<100&&(r.apply(this,a.split("\n"))?(st(ws),bs=null,ms=void 0,gs.set(a,100)):(gs.set(a,gs.get(a)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var i=ds(e);if(i)for(var n=i.families,o=0,s=n.length;o<s;++o){var l=n[o],u=i.style+"\n"+i.weight+"\n"+l;void 0===gs.get(u)&&(gs.set(u,100,!0),r(i.style,i.weight,l)||(gs.set(u,0,!0),void 0===t&&(t=setInterval(a,32))))}}}(),xs=(ys=ws,function(t){var e=ys[t];if(null==e)if(Jo){var i=ds(t),n=Cs(t,"g"),o=isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight);ws[t]=o*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else vs||((vs=document.createElement("div")).innerHTML="M",vs.style.margin="0 !important",vs.style.padding="0 !important",vs.style.position="absolute !important",vs.style.left="-99999px !important"),vs.style.font=t,document.body.appendChild(vs),e=vs.offsetHeight,ys[t]=e,document.body.removeChild(vs);return e});function Cs(t,e){return bs||(bs=er(1,1)),t!=ms&&(bs.font=t,ms=bs.font),bs.measureText(e)}function Es(t,e){return Cs(t,e).width}function ks(t,e,i){if(e in i)return i[e];var n=Es(t,e);return i[e]=n,n}function Ss(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}function Ms(t,e,i,n,o,r,a,s,l,u,c){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(l,u),t.scale(c,c),function(t,e){for(var i=t.contextInstructions,n=0,o=i.length;n<o;n+=2)Array.isArray(i[n+1])?e[i[n]].apply(e,i[n+1]):e[i[n]]=i[n+1]}(n,t)):t.drawImage(n,o,r,a,s,l,u,a*c,s*c),t.restore()}var Ts=null;var Rs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ps=function(t){function e(e){var i=t.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=e,i}return Rs(e,t),e.prototype.getFeatures=function(t){return Z()},e.prototype.prepareFrame=function(t){return Z()},e.prototype.renderFrame=function(t,e){return Z()},e.prototype.loadedTileCallback=function(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i},e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,o){var r=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,o,r)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){},e.prototype.getDataAtPixel=function(t,e,i){return Z()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===hr&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=hr&&e!=dr&&t.addEventListener(Di,this.boundHandleImageChange_),e==ur&&(t.load(),e=t.getState()),e==hr},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Or&&t.changed()},e}(Vi),Ds=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ls=function(t){function e(e){var i=t.call(this,e)||this;return i.container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i}return Ds(e,t),e.prototype.useContainer=function(t,e,i){var n,o,r=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===r&&((s=t.firstElementChild)instanceof HTMLCanvasElement&&(o=s.getContext("2d")));if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(n=document.createElement("div")).className=r;var a=n.style;a.position="absolute",a.width="100%",a.height="100%";var s=(o=er()).canvas;n.appendChild(s),(a=s.style).position="absolute",a.left="0",a.transformOrigin="top left",this.container=n,this.context=o}},e.prototype.clip=function(t,e,i){var n=e.pixelRatio,o=e.size[0]*n/2,r=e.size[1]*n/2,a=e.viewState.rotation,s=he(i),l=de(i),u=re(i),c=oe(i);on(e.coordinateToPixelTransform,s),on(e.coordinateToPixelTransform,l),on(e.coordinateToPixelTransform,u),on(e.coordinateToPixelTransform,c),t.save(),Ss(t,-a,o,r),t.beginPath(),t.moveTo(s[0]*n,s[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(c[0]*n,c[1]*n),t.clip(),Ss(t,a,o,r)},e.prototype.clipUnrotated=function(t,e,i){var n=he(i),o=de(i),r=re(i),a=oe(i);on(e.coordinateToPixelTransform,n),on(e.coordinateToPixelTransform,o),on(e.coordinateToPixelTransform,r),on(e.coordinateToPixelTransform,a);var s=this.inversePixelTransform;on(s,n),on(s,o),on(s,r),on(s,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,i){var n=this.getLayer();if(n.hasListener(t)){var o=new us(t,this.inversePixelTransform,i,e);n.dispatchEvent(o)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(Ka,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(Za,t,e)},e.prototype.getRenderTransform=function(t,e,i,n,o,r,a){var s=o/2,l=r/2,u=n/e,c=-u,h=-t[0]+a,d=-t[1];return an(this.tempTransform_,s,l,u,c,-i,h,d)},e.prototype.getDataAtPixel=function(t,e,i){var n,o=on(this.inversePixelTransform,t.slice()),r=this.context;try{n=r.getImageData(Math.round(o[0]),Math.round(o[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:n}return 0===n[3]?null:n},e}(Ps),Fs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Os=function(t){function e(e){var i=t.call(this,e)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.tmpTileRange_=new Hr(0,0,0,0),i}return Fs(e,t),e.prototype.isDrawableTile=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==zo||i==Ho||i==No&&!n},e.prototype.getTile=function(t,e,i,n){var o=n.pixelRatio,r=n.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(t,e,i,o,r);return s.getState()==No&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(zo)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},e.prototype.loadedTileCallback=function(e,i,n){return!!this.isDrawableTile(n)&&t.prototype.loadedTileCallback.call(this,e,i,n)},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,e){var i=t.layerStatesArray[t.layerIndex],n=t.viewState,o=n.projection,r=n.resolution,a=n.center,s=n.rotation,l=t.pixelRatio,u=this.getLayer(),c=u.getSource(),h=c.getRevision(),d=c.getTileGridForProjection(o),p=d.getZForResolution(r,c.zDirection),f=d.getResolution(p),g=t.extent,m=i.extent&&oi(i.extent,o);m&&(g=ce(g,oi(i.extent,o)));var v=c.getTilePixelRatio(l),y=Math.round(t.size[0]*v),b=Math.round(t.size[1]*v);if(s){var w=Math.round(Math.sqrt(y*y+b*b));y=w,b=w}var _=f*y/2/v,x=f*b/2/v,C=[a[0]-_,a[1]-x,a[0]+_,a[1]+x],E=d.getTileRangeForExtentAndZ(g,p),k={};k[p]={};var S=this.createLoadedTileFinder(c,o,k),M=this.tmpExtent,T=this.tmpTileRange_;this.newTiles_=!1;for(var R=E.minX;R<=E.maxX;++R)for(var P=E.minY;P<=E.maxY;++P){var D=this.getTile(p,R,P,t);if(this.isDrawableTile(D)){var L=Q(this);if(D.getState()==zo){k[p][D.tileCoord.toString()]=D;var F=D.inTransition(L);this.newTiles_||!F&&-1!==this.renderedTiles.indexOf(D)||(this.newTiles_=!0)}if(1===D.getAlpha(L,t.time))continue}var O=d.getTileCoordChildTileRange(D.tileCoord,T,M),A=!1;O&&(A=S(p+1,O)),A||d.forEachTileCoordParentTileRange(D.tileCoord,S,T,M)}var I=f/r;an(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/v,1/v,s,-y/2,-b/2);var j,z=(j=this.pixelTransform,Jo?ln(j):(Ts||(Ts=er(1,1).canvas),Ts.style.transform=ln(j),Ts.style.transform));this.useContainer(e,z,i.opacity);var N=this.context,H=N.canvas;sn(this.inversePixelTransform,this.pixelTransform),an(this.tempTransform_,y/2,b/2,I,I,0,-y/2,-b/2),H.width!=y||H.height!=b?(H.width=y,H.height=b):this.containerReused||N.clearRect(0,0,y,b),m&&this.clipUnrotated(N,t,m),this.preRender(N,t),this.renderedTiles.length=0;var B,G,V,W=Object.keys(k).map(Number);W.sort(gi),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(B=[],G=[]):W=W.reverse();for(var q=W.length-1;q>=0;--q){var $=W[q],Y=c.getTilePixelSize($,l,o),X=d.getResolution($)/f,U=Y[0]*X*I,K=Y[1]*X*I,Z=d.getTileCoordForCoordAndZ(he(C),$),J=d.getTileCoordExtent(Z),tt=on(this.tempTransform_,[v*(J[0]-C[0])/f,v*(C[3]-J[3])/f]),et=v*c.getGutterForProjection(o),it=k[$];for(var nt in it){var ot=(D=it[nt]).tileCoord,rt=tt[0]-(Z[1]-ot[1])*U,at=Math.round(rt+U),st=tt[1]-(Z[2]-ot[2])*K,lt=Math.round(st+K),ut=at-(R=Math.round(rt)),ct=lt-(P=Math.round(st)),ht=p===$;if(!(F=ht&&1!==D.getAlpha(Q(this),t.time)))if(B){N.save(),V=[R,P,R+ut,P,R+ut,P+ct,R,P+ct];for(var dt=0,pt=B.length;dt<pt;++dt)if(p!==$&&$<G[dt]){var ft=B[dt];N.beginPath(),N.moveTo(V[0],V[1]),N.lineTo(V[2],V[3]),N.lineTo(V[4],V[5]),N.lineTo(V[6],V[7]),N.moveTo(ft[6],ft[7]),N.lineTo(ft[4],ft[5]),N.lineTo(ft[2],ft[3]),N.lineTo(ft[0],ft[1]),N.clip()}B.push(V),G.push($)}else N.clearRect(R,P,ut,ct);this.drawTileImage(D,t,R,P,ut,ct,et,ht,i.opacity),B&&!F&&N.restore(),this.renderedTiles.push(D),this.updateUsedTiles(t.usedTiles,c,D)}}return this.renderedRevision=h,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!Kt(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=l,this.renderedProjection=o,this.manageTilePyramid(t,c,d,l,o,g,p,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(N,t),i.extent&&N.restore(),z!==H.style.transform&&(H.style.transform=z),this.container},e.prototype.drawTileImage=function(t,e,i,n,o,r,a,s,l){var u=this.getTileImage(t);if(u){var c=Q(this),h=s?t.getAlpha(c,e.time):1,d=l*h,p=d!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,i,n,o,r),p&&this.context.restore(),1!==h?e.animate=!0:s&&t.endTransition(c)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=Q(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i){var n=Q(e);n in t||(t[n]={}),t[n][i.getKey()]=!0},e.prototype.manageTilePyramid=function(t,e,i,n,o,r,a,s,l){var u=Q(e);u in t.wantedTiles||(t.wantedTiles[u]={});var c,h,d,p,f,g,m=t.wantedTiles[u],v=t.tileQueue;for(g=i.getMinZoom();g<=a;++g)for(h=i.getTileRangeForExtentAndZ(r,g,h),d=i.getResolution(g),p=h.minX;p<=h.maxX;++p)for(f=h.minY;f<=h.maxY;++f)a-g<=s?((c=e.getTile(g,p,f,n,o)).getState()==Io&&(m[c.getKey()]=!0,v.isKeyQueued(c.getKey())||v.enqueue([c,u,i.getTileCoordCenter(c.tileCoord),d])),void 0!==l&&l(c)):e.useTile(g,p,f,o)},e}(Ls);Os.prototype.getLayer;var As=Os,Is=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),js=function(t){function e(e){return t.call(this,e)||this}return Is(e,t),e.prototype.createRenderer=function(){return new As(this)},e}(ss),zs=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Ns=/^([a-z]*)$|^hsla?\(.*\)$/i;function Hs(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var i=getComputedStyle(e).color;return document.body.removeChild(e),i}return""}var Bs,Gs,Vs=(Bs={},Gs=0,function(t){var e;if(Bs.hasOwnProperty(t))e=Bs[t];else{if(Gs>=1024){var i=0;for(var n in Bs)0==(3&i++)&&(delete Bs[n],--Gs)}e=function(t){var e,i,n,o,r;if(Ns.exec(t)&&(t=Hs(t)),zs.exec(t)){var a=t.length-1,s=void 0;s=a<=4?1:2;var l=4===a||8===a;e=parseInt(t.substr(1+0*s,s),16),i=parseInt(t.substr(1+1*s,s),16),n=parseInt(t.substr(1+2*s,s),16),o=l?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,l&&(o=(o<<4)+o)),r=[e,i,n,o/255]}else 0==t.indexOf("rgba(")?qs(r=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((r=t.slice(4,-1).split(",").map(Number)).push(1),qs(r)):nt(!1,14);return r}(t),Bs[t]=e,++Gs}return e});function Ws(t){return Array.isArray(t)?t:Vs(t)}function qs(t){return t[0]=ct(t[0]+.5|0,0,255),t[1]=ct(t[1]+.5|0,0,255),t[2]=ct(t[2]+.5|0,0,255),t[3]=ct(t[3],0,1),t}function $s(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function Ys(t){return Array.isArray(t)?$s(t):t}var Xs=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.displacement_=t.displacement}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return Z()},t.prototype.getImage=function(t){return Z()},t.prototype.getHitDetectionImage=function(t){return Z()},t.prototype.getImageState=function(){return Z()},t.prototype.getImageSize=function(){return Z()},t.prototype.getHitDetectionImageSize=function(){return Z()},t.prototype.getOrigin=function(){return Z()},t.prototype.getSize=function(){return Z()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){Z()},t.prototype.load=function(){Z()},t.prototype.unlistenImageChange=function(t){Z()},t}(),Us=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ks=function(t){function e(e){var i=this,n=void 0!==e.rotateWithView&&e.rotateWithView;return(i=t.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==e.rotation?e.rotation:0,scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return Us(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return hr},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.render=function(){var t,e="round",i="round",n=0,o=null,r=0,a=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=Ys(t),void 0===(a=this.stroke_.getWidth())&&(a=1),o=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),void 0===(i=this.stroke_.getLineJoin())&&(i="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(n=this.stroke_.getMiterLimit())&&(n=10));var s=2*(this.radius_+a)+1,l={strokeStyle:t,strokeWidth:a,size:s,lineCap:e,lineDash:o,lineDashOffset:r,lineJoin:i,miterLimit:n},u=er(s,s);this.canvas_=u.canvas;var c=s=this.canvas_.width,h=this.getDisplacement();this.draw_(l,u,0,0),this.createHitDetectionCanvas_(l),this.anchor_=[s/2-h[0],s/2+h[1]],this.size_=[s,s],this.imageSize_=[c,c]},e.prototype.draw_=function(t,e,i,n){var o,r,a;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var s=this.points_;if(s===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(s*=2),o=0;o<=s;o++)r=2*o*Math.PI/s-Math.PI/2+this.angle_,a=o%2==0?this.radius_:l,e.lineTo(t.size/2+a*Math.cos(r),t.size/2+a*Math.sin(r))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u="#000"),e.fillStyle=Ys(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=Ws(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var n=er(t.size,t.size);this.hitDetectionCanvas_=n.canvas,this.drawHitDetectionCanvas_(t,n,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var o=this.points_;if(o===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var r=void 0!==this.radius2_?this.radius2_:this.radius_;r!==this.radius_&&(o*=2);var a=void 0,s=void 0,l=void 0;for(a=0;a<=o;a++)l=2*a*Math.PI/o-Math.PI/2+this.angle_,s=a%2==0?this.radius_:r,e.lineTo(t.size/2+s*Math.cos(l),t.size/2+s*Math.sin(l))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(Xs),Zs=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Js=function(t){function e(e){var i=e||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,displacement:void 0!==i.displacement?i.displacement:[0,0]})||this}return Zs(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Ks),Qs=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}(),tl=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}(),el=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=rl,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=rl,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();var il=null;function nl(t,e){if(!il){var i=new Qs({color:"rgba(255,255,255,0.4)"}),n=new tl({color:"#3399CC",width:1.25});il=[new el({image:new Js({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return il}function ol(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[wt]=[new el({fill:new Qs({color:[255,255,255,.5]})})],t[Ct]=t[wt],t[yt]=[new el({stroke:new tl({color:e,width:5})}),new el({stroke:new tl({color:i,width:3})})],t[xt]=t[yt],t[kt]=t[wt].concat(t[yt]),t[vt]=[new el({image:new Js({radius:6,fill:new Qs({color:i}),stroke:new tl({color:e,width:1.5})}),zIndex:1/0})],t[_t]=t[vt],t[Et]=t[wt].concat(t[yt],t[vt]),t}function rl(t){return t.getGeometry()}var al=el,sl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ll="renderOrder",ul=function(t){function e(e){var i=this,n=e||{},o=at({},n);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,(i=t.call(this,o)||this).declutter_=void 0!==n.declutter&&n.declutter,i.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,i.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,i}return sl(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(ll)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(ll,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:nl,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else nt("function"==typeof t.getZIndex,41),i=[t];e=function(){return i}}return e}(this.style_),this.changed()},e}(ns),cl="image",hl="hybrid",dl="vector",pl=0,fl=1,gl="Circle",ml="Default",vl="Image",yl="LineString",bl="Polygon",wl="Text",_l=function(){function t(){}return t.prototype.drawCustom=function(t,e,i){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,e){},t.prototype.drawFeature=function(t,e){},t.prototype.drawGeometryCollection=function(t,e){},t.prototype.drawLineString=function(t,e){},t.prototype.drawMultiLineString=function(t,e){},t.prototype.drawMultiPoint=function(t,e){},t.prototype.drawMultiPolygon=function(t,e){},t.prototype.drawPoint=function(t,e){},t.prototype.drawPolygon=function(t,e){},t.prototype.drawText=function(t,e){},t.prototype.setFillStrokeStyle=function(t,e){},t.prototype.setImageStyle=function(t,e){},t.prototype.setTextStyle=function(t,e){},t}(),xl={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Cl=[xl.FILL],El=[xl.STROKE],kl=[xl.BEGIN_PATH],Sl=[xl.CLOSE_PATH],Ml=xl,Tl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rl=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.tolerance=e,r.maxExtent=i,r.pixelRatio=o,r.maxLineWidth=0,r.resolution=n,r.beginGeometryInstruction1_=null,r.beginGeometryInstruction2_=null,r.bufferedMaxExtent_=null,r.instructions=[],r.coordinates=[],r.tmpCoordinate_=[],r.hitDetectionInstructions=[],r.state={},r}return Tl(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,o,r){var a=this.coordinates.length,s=this.getBufferedMaxExtent();r&&(e+=n);var l,u,c,h=t[e],d=t[e+1],p=this.tmpCoordinate_,f=!0;for(l=e+n;l<i;l+=n)p[0]=t[l],p[1]=t[l+1],(c=Wt(s,p))!==u?(f&&(this.coordinates[a++]=h,this.coordinates[a++]=d),this.coordinates[a++]=p[0],this.coordinates[a++]=p[1],f=!1):c===Lt?(this.coordinates[a++]=p[0],this.coordinates[a++]=p[1],f=!1):f=!0,h=p[0],d=p[1],u=c;return(o&&f||l===e+n)&&(this.coordinates[a++]=h,this.coordinates[a++]=d),a},e.prototype.drawCustomCoordinates_=function(t,e,i,n,o){for(var r=0,a=i.length;r<a;++r){var s=i[r],l=this.appendFlatCoordinates(t,e,s,n,!1,!1);o.push(l),e=s}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,o,r,a,s,l=t.getType(),u=t.getStride(),c=this.coordinates.length;if(l==Ct){n=(t=t).getOrientedFlatCoordinates(),a=[];var h=t.getEndss();s=0;for(var d=0,p=h.length;d<p;++d){var f=[];s=this.drawCustomCoordinates_(n,s,h[d],u,f),a.push(f)}this.instructions.push([Ml.CUSTOM,c,a,t,i,kn])}else l==wt||l==xt?(r=[],n=l==wt?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),s=this.drawCustomCoordinates_(n,0,t.getEnds(),u,r),this.instructions.push([Ml.CUSTOM,c,r,t,i,En])):l==yt||l==_t?(n=t.getFlatCoordinates(),o=this.appendFlatCoordinates(n,0,n.length,u,!1,!1),this.instructions.push([Ml.CUSTOM,c,o,t,i,Cn])):l==vt&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),o=this.coordinates.length,this.instructions.push([Ml.CUSTOM,c,o,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[Ml.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ml.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,o=e.length,r=-1;for(t=0;t<o;++t)(n=(i=e[t])[0])==Ml.END_GEOMETRY?r=t:n==Ml.BEGIN_GEOMETRY&&(i[2]=t,vi(this.hitDetectionInstructions,r,t),r=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=Ys(n||"#000")}else i.fillStyle=void 0;if(e){var o=e.getColor();i.strokeStyle=Ys(o||"#000");var r=e.getLineCap();i.lineCap=void 0!==r?r:"round";var a=e.getLineDash();i.lineDash=a?a.slice():ps;var s=e.getLineDashOffset();i.lineDashOffset=s||0;var l=e.getLineJoin();i.lineJoin=void 0!==l?l:"round";var u=e.getWidth();i.lineWidth=void 0!==u?u:1;var c=e.getMiterLimit();i.miterLimit=void 0!==c?c:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[Ml.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[Ml.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,o=t.lineDash,r=t.lineDashOffset,a=t.lineJoin,s=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||o!=t.currentLineDash&&!bi(t.currentLineDash,o)||t.currentLineDashOffset!=r||t.currentLineJoin!=a||t.currentLineWidth!=s||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=o,t.currentLineDashOffset=r,t.currentLineJoin=a,t.currentLineWidth=s,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[Ml.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Nt(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;zt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(_l),Pl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Dl=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_=null,r.hitDetectionImage_=null,r.image_=null,r.anchorX_=void 0,r.anchorY_=void 0,r.height_=void 0,r.opacity_=void 0,r.originX_=void 0,r.originY_=void 0,r.rotateWithView_=void 0,r.rotation_=void 0,r.scale_=void 0,r.width_=void 0,r}return Pl(e,t),e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([Ml.DRAW_IMAGE,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([Ml.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),o=this.coordinates.length,r=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([Ml.DRAW_IMAGE,o,r,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([Ml.DRAW_IMAGE,o,r,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),o=t.getHitDetectionImage(1),r=t.getImage(1),a=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=o,this.image_=r,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(Rl),Ll=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fl=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Ll(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,e,i,n,!1,!1),a=[Ml.MOVE_TO_LINE_TO,o,r];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Ml.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],kl);var r=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(r,0,r.length,a),this.hitDetectionInstructions.push(El),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,o=i.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Ml.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],kl);for(var r=t.getEnds(),a=t.getFlatCoordinates(),s=t.getStride(),l=0,u=0,c=r.length;u<c;++u)l=this.drawFlatCoordinates_(a,l,r[u],s);this.hitDetectionInstructions.push(El),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(El),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(El),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(kl)},e}(Rl),Ol=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Al=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Ol(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var o=this.state,r=void 0!==o.fillStyle,a=void 0!==o.strokeStyle,s=i.length;this.instructions.push(kl),this.hitDetectionInstructions.push(kl);for(var l=0;l<s;++l){var u=i[l],c=this.coordinates.length,h=this.appendFlatCoordinates(t,e,u,n,!0,!a),d=[Ml.MOVE_TO_LINE_TO,c,h];this.instructions.push(d),this.hitDetectionInstructions.push(d),a&&(this.instructions.push(Sl),this.hitDetectionInstructions.push(Sl)),e=u}return r&&(this.instructions.push(Cl),this.hitDetectionInstructions.push(Cl)),a&&(this.instructions.push(El),this.hitDetectionInstructions.push(El)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Ml.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Ml.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length;this.appendFlatCoordinates(r,0,r.length,a,!1,!1);var l=[Ml.CIRCLE,s];this.instructions.push(kl,l),this.hitDetectionInstructions.push(kl,l),void 0!==i.fillStyle&&(this.instructions.push(Cl),this.hitDetectionInstructions.push(Cl)),void 0!==i.strokeStyle&&(this.instructions.push(El),this.hitDetectionInstructions.push(El)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Ml.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Ml.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var r=t.getEnds(),a=t.getOrientedFlatCoordinates(),s=t.getStride();this.drawFlatCoordinatess_(a,0,r,s),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,o=i.strokeStyle;if(void 0!==n||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Ml.SET_FILL_STYLE,"#000"]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Ml.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var r=t.getEndss(),a=t.getOrientedFlatCoordinates(),s=t.getStride(),l=0,u=0,c=r.length;u<c;++u)l=this.drawFlatCoordinatess_(a,l,r[u],s);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,n=0,o=i.length;n<o;++n)i[n]=jn(i[n],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(Rl);function Il(t,e,i,n,o){var r,a,s,l,u,c,h,d,p,f=i,g=i,m=0,v=0,y=i;for(r=i;r<n;r+=o){var b=e[r],w=e[r+1];void 0!==l&&(d=b-l,p=w-u,s=Math.sqrt(d*d+p*p),void 0!==c&&(v+=a,Math.acos((c*d+h*p)/(a*s))>t&&(v>m&&(m=v,f=y,g=r),v=0,y=r-o)),a=s,c=d,h=p),l=b,u=w}return(v+=s)>m?[y,r]:[f,g]}var jl="point",zl="line",Nl=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hl={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Bl={Circle:Al,Default:Rl,Image:Dl,LineString:Fl,Polygon:Al,Text:function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.declutterGroups_,r.labels_=null,r.text_="",r.textOffsetX_=0,r.textOffsetY_=0,r.textRotateWithView_=void 0,r.textRotation_=0,r.textFillState_=null,r.fillStates={},r.textStrokeState_=null,r.strokeStates={},r.textState_={},r.textStates={},r.textKey_="",r.fillKey_="",r.strokeKey_="",r}return Nl(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,o=this.textState_;if(""!==this.text_&&o&&(i||n)){var r,a,s=this.coordinates.length,l=t.getType(),u=null,c=2,h=2;if(o.placement===zl){if(!fe(this.getBufferedMaxExtent(),t.getExtent()))return;var d=void 0;if(u=t.getFlatCoordinates(),h=t.getStride(),l==yt)d=[u.length];else if(l==xt)d=t.getEnds();else if(l==wt)d=t.getEnds().slice(0,1);else if(l==Ct){var p=t.getEndss();for(d=[],r=0,a=p.length;r<a;++r)d.push(p[r][0])}this.beginGeometry(t,e);for(var f=o.textAlign,g=0,m=void 0,v=0,y=d.length;v<y;++v){if(null==f){var b=Il(o.maxAngle,u,g,d[v],h);g=b[0],m=b[1]}else m=d[v];for(r=g;r<m;r+=h)this.coordinates.push(u[r],u[r+1]);c=this.coordinates.length,g=d[v];var w=this.declutterGroups_?0===v?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(s,c,w),s=c}this.endGeometry(e)}else{var _=null;switch(o.overflow||(_=[]),l){case vt:case _t:c=(u=t.getFlatCoordinates()).length;break;case yt:u=t.getFlatMidpoint();break;case kt:u=t.getCenter();break;case xt:c=(u=t.getFlatMidpoints()).length;break;case wt:u=t.getFlatInteriorPoint(),o.overflow||_.push(u[2]/this.resolution),h=3;break;case Ct:var x=t.getFlatInteriorPoints();for(u=[],r=0,a=x.length;r<a;r+=3)o.overflow||_.push(x[r+2]/this.resolution),u.push(x[r],x[r+1]);if(0==(c=u.length))return}c=this.appendFlatCoordinates(u,0,c,h,!1,!1),this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var C=this.pixelRatio;this.instructions.push([Ml.DRAW_IMAGE,s,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,o.padding==fs?fs:o.padding.map((function(t){return t*C})),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.hitDetectionInstructions.push([Ml.DRAW_IMAGE,s,c,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,o.padding,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var o=this.textKey_;o in this.textStates||(this.textStates[o]={font:e.font,textAlign:e.textAlign||"center",textBaseline:e.textBaseline||"middle",scale:e.scale});var r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,o=this.textState_,r=this.strokeKey_,a=this.textKey_,s=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,u=Hl[o.textBaseline],c=this.textOffsetY_*l,h=this.text_,d=o.scale,p=n?n.lineWidth*d/2:0;this.instructions.push([Ml.DRAW_CHARS,t,e,u,i,o.overflow,s,o.maxAngle,l,c,r,p*l,h,a,1]),this.hitDetectionInstructions.push([Ml.DRAW_CHARS,t,e,u,i,o.overflow,s,o.maxAngle,1,c,r,p,h,a,1/l])},e.prototype.setTextStyle=function(t,e){var i,n,o;if(t){this.declutterGroups_=e;var r=t.getFill();r?((n=this.textFillState_)||(n={},this.textFillState_=n),n.fillStyle=Ys(r.getColor()||"#000")):(n=null,this.textFillState_=n);var a=t.getStroke();if(a){(o=this.textStrokeState_)||(o={},this.textStrokeState_=o);var s=a.getLineDash(),l=a.getLineDashOffset(),u=a.getWidth(),c=a.getMiterLimit();o.lineCap=a.getLineCap()||"round",o.lineDash=s?s.slice():ps,o.lineDashOffset=void 0===l?0:l,o.lineJoin=a.getLineJoin()||"round",o.lineWidth=void 0===u?1:u,o.miterLimit=void 0===c?10:c,o.strokeStyle=Ys(a.getColor()||"#000")}else o=null,this.textStrokeState_=o;i=this.textState_;var h=t.getFont()||"10px sans-serif";_s(h);var d=t.getScale();i.overflow=t.getOverflow(),i.font=h,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||"middle",i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||fs,i.scale=void 0===d?1:d;var p=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===f?0:f,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===m?0:m,this.strokeKey_=o?("string"==typeof o.strokeStyle?o.strokeStyle:Q(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Q(n.fillStyle):""}else this.text_=""},e}(Rl)},Gl=function(){function t(t,e,i,n,o){this.declutter_=o,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][4]++:(e=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=e,e[0].push(1))),e},t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var n in i){var o=i[n].finish();t[e][n]=o}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);var o=n[e];void 0===o&&(o=new(0,Bl[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=o);return o},t}(),Vl={Point:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=hr)return;var r=t.getBuilder(i.getZIndex(),vl);r.setImageStyle(o,t.addDeclutter(!1)),r.drawPoint(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),wl);s.setTextStyle(a,t.addDeclutter(!!o)),s.drawText(e,n)}},LineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),yl);r.setFillStrokeStyle(null,o),r.drawLineString(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),wl);s.setTextStyle(a,t.addDeclutter(!1)),s.drawText(e,n)}},Polygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var a=t.getBuilder(i.getZIndex(),bl);a.setFillStrokeStyle(o,r),a.drawPolygon(e,n)}var s=i.getText();if(s){var l=t.getBuilder(i.getZIndex(),wl);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,n)}},MultiPoint:function(t,e,i,n){var o=i.getImage();if(o){if(o.getImageState()!=hr)return;var r=t.getBuilder(i.getZIndex(),vl);r.setImageStyle(o,t.addDeclutter(!1)),r.drawMultiPoint(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),wl);s.setTextStyle(a,t.addDeclutter(!!o)),s.drawText(e,n)}},MultiLineString:function(t,e,i,n){var o=i.getStroke();if(o){var r=t.getBuilder(i.getZIndex(),yl);r.setFillStrokeStyle(null,o),r.drawMultiLineString(e,n)}var a=i.getText();if(a){var s=t.getBuilder(i.getZIndex(),wl);s.setTextStyle(a,t.addDeclutter(!1)),s.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(r||o){var a=t.getBuilder(i.getZIndex(),bl);a.setFillStrokeStyle(o,r),a.drawMultiPolygon(e,n)}var s=i.getText();if(s){var l=t.getBuilder(i.getZIndex(),wl);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var o,r,a=e.getGeometriesArray();for(o=0,r=a.length;o<r;++o){(0,Vl[a[o].getType()])(t,a[o],i,n)}},Circle:function(t,e,i,n){var o=i.getFill(),r=i.getStroke();if(o||r){var a=t.getBuilder(i.getZIndex(),gl);a.setFillStrokeStyle(o,r),a.drawCircle(e,n)}var s=i.getText();if(s){var l=t.getBuilder(i.getZIndex(),wl);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,n)}}};function Wl(t,e){return parseInt(Q(t),10)-parseInt(Q(e),10)}function ql(t,e){var i=$l(t,e);return i*i}function $l(t,e){return.5*t/e}function Yl(t,e,i,n,o,r){var a=!1,s=i.getImage();if(s){var l=s.getImageState();l==hr||l==dr?s.unlistenImageChange(o):(l==ur&&s.load(),l=s.getImageState(),s.listenImageChange(o),a=!0)}return function(t,e,i,n,o){var r=i.getGeometryFunction()(e);if(!r)return;var a=r.simplifyTransformed(n,o);if(i.getRenderer())!function t(e,i,n,o){if(i.getType()==Et){for(var r=i.getGeometries(),a=0,s=r.length;a<s;++a)t(e,r[a],n,o);return}e.getBuilder(n.getZIndex(),ml).drawCustom(i,o,n.getRenderer())}(t,a,i,e);else{(0,Vl[a.getType()])(t,a,i,e)}}(t,e,i,n,r),a}function Xl(t,e,i,n,o,r,a,s,l,u,c){for(var h,d,p=[],f=t[e]>t[i-n],g=o.length,m=t[e],v=t[e+1],y=t[e+=n],b=t[e+1],w=0,_=Math.sqrt(Math.pow(y-m,2)+Math.pow(b-v,2)),x=!1,C=0;C<g;++C){for(var E=o[h=f?g-C-1:C],k=s*l(u,E,c),S=r+k/2;e<i-n&&w+_<S;)m=y,v=b,y=t[e+=n],b=t[e+1],w+=_,_=Math.sqrt(Math.pow(y-m,2)+Math.pow(b-v,2));var M=S-w,T=Math.atan2(b-v,y-m);if(f&&(T+=T>0?-Math.PI:Math.PI),void 0!==d){var R=T-d;if(x=x||0!==R,R+=R>Math.PI?-2*Math.PI:R<-Math.PI?2*Math.PI:0,Math.abs(R)>a)return null}d=T;var P=M/_,D=mt(m,y,P),L=mt(v,b,P);p[h]=[D,L,k/2,T,E],r+=k}return x?p:[[p[0][0],p[0][1],p[0][2],p[0][3],o]]}var Ul=[1/0,1/0,-1/0,-1/0],Kl=[1,0,0,1,0,0],Zl=[],Jl=[],Ql=[],tu=[],eu=function(){function t(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,i,n){var o=t+e+i+n;if(this.labels_[o])return this.labels_[o];var r=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,s=this.textStates[e],l=this.pixelRatio,u=s.scale*l,c=Hl[s.textAlign||"center"],h=n&&r.lineWidth?r.lineWidth:0,d=t.split("\n"),p=d.length,f=[],g=function(t,e,i){for(var n=e.length,o=0,r=0;r<n;++r){var a=Es(t,e[r]);o=Math.max(o,a),i.push(a)}return o}(s.font,d,f),m=xs(s.font),v=m*p,y=g+h,b=[],w={width:Math.ceil((y+2)*u),height:Math.ceil((v+h)*u),contextInstructions:b};(1!=u&&b.push("scale",[u,u]),b.push("font",s.font),n)&&(b.push("strokeStyle",r.strokeStyle),b.push("lineWidth",h),b.push("lineCap",r.lineCap),b.push("lineJoin",r.lineJoin),b.push("miterLimit",r.miterLimit),(Jo?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(b.push("setLineDash",[r.lineDash]),b.push("lineDashOffset",r.lineDashOffset)));i&&b.push("fillStyle",a.fillStyle),b.push("textBaseline","middle"),b.push("textAlign","center");var _,x=.5-c,C=c*y+x*h;if(n)for(_=0;_<p;++_)b.push("strokeText",[d[_],C+x*f[_],.5*(h+m)+_*m]);if(i)for(_=0;_<p;++_)b.push("fillText",[d[_],C+x*f[_],.5*(h+m)+_*m]);return this.labels_[o]=w,w},t.prototype.replayTextBackground_=function(t,e,i,n,o,r,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,o),t.lineTo.apply(t,e),r&&(this.alignFill_=r[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())},t.prototype.replayImageOrLabel_=function(t,e,i,n,o,r,a,s,l,u,c,h,d,p,f,g,m,v){var y=m||v;e-=o*=d,i-=r*=d;var b=f+u>n.width?n.width-u:f,w=s+c>n.height?n.height-c:s,_=g[3]+b*d+g[1],x=g[0]+w*d+g[2],C=e-g[3],E=i-g[0];(y||0!==h)&&(Zl[0]=C,tu[0]=C,Zl[1]=E,Jl[1]=E,Jl[0]=C+_,Ql[0]=Jl[0],Ql[1]=E+x,tu[1]=Ql[1]);var k=null;if(0!==h){var S=e+o,M=i+r;k=an(Kl,S,M,1,1,h,-S,-M),on(Kl,Zl),on(Kl,Jl),on(Kl,Ql),on(Kl,tu),$t(Math.min(Zl[0],Jl[0],Ql[0],tu[0]),Math.min(Zl[1],Jl[1],Ql[1],tu[1]),Math.max(Zl[0],Jl[0],Ql[0],tu[0]),Math.max(Zl[1],Jl[1],Ql[1],tu[1]),Ul)}else $t(C,E,C+_,E+x,Ul);var T=t.canvas,R=v?v[2]*d/2:0,P=Ul[0]-R<=T.width&&Ul[2]+R>=0&&Ul[1]-R<=T.height&&Ul[3]+R>=0;if(p&&(e=Math.round(e),i=Math.round(i)),a){if(!P&&1==a[4])return;Zt(a,Ul);var D=P?[t,k?k.slice(0):null,l,n,u,c,b,w,e,i,d]:null;D&&(y&&D.push(m,v,Zl.slice(0),Jl.slice(0),Ql.slice(0),tu.slice(0)),a.push(D))}else P&&(y&&this.replayTextBackground_(t,Zl,Jl,Ql,tu,m,v),Ms(t,k,l,n,u,c,b,w,e,i,d))},t.prototype.fill_=function(t){if(this.alignFill_){var e=on(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.renderDeclutter=function(t,e,i,n){if(t&&t.length>5){var o=t[4];if(1==o||o==t.length-5){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(n||(n=new Oa.a(9)),!n.collides(r)){n.insert(r);for(var a=5,s=t.length;a<s;++a){var l=t[a],u=l[0],c=u.globalAlpha;c!==i&&(u.globalAlpha=i),l.length>11&&this.replayTextBackground_(l[0],l[13],l[14],l[15],l[16],l[11],l[12]),Ms.apply(void 0,l),c!==i&&(u.globalAlpha=c)}}t.length=5,Yt(t)}}return n},t.prototype.drawLabelWithPointPlacement_=function(t,e,i,n){var o=this.textStates[e],r=this.createLabel(t,e,n,i),a=this.strokeStates[i],s=this.pixelRatio,l=Hl[o.textAlign||"center"],u=Hl[o.textBaseline||"middle"],c=a&&a.lineWidth?a.lineWidth:0;return{label:r,anchorX:l*(r.width/s-2*o.scale)+2*(.5-l)*c,anchorY:u*r.height/s+2*(.5-u)*c}},t.prototype.execute_=function(t,e,i,n,o,r){var a,s,l;this.declutterItems.length=0,this.pixelCoordinates_&&bi(e,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=Ki(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),s=this.renderedTransform_,l=e,s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5]);for(var u,c,h,d,p,f,g,m,v,y,b,w,_,x,C,E,k,S=0,M=i.length,T=0,R=0,P=0,D=null,L=null,F=this.coordinateCache_,O=this.viewRotation_,A=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,I={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},j=this.instructions!=i||this.overlaps?0:200;S<M;){var z=i[S];switch(z[0]){case Ml.BEGIN_GEOMETRY:(C=z[1]).getGeometry()?void 0===r||fe(r,z[3])?++S:S=z[2]+1:S=z[2];break;case Ml.BEGIN_PATH:R>j&&(this.fill_(t),R=0),P>j&&(t.stroke(),P=0),R||P||(t.beginPath(),d=NaN,p=NaN),++S;break;case Ml.CIRCLE:var N=a[T=z[1]],H=a[T+1],B=a[T+2]-N,G=a[T+3]-H,V=Math.sqrt(B*B+G*G);t.moveTo(N+V,H),t.arc(N,H,V,0,2*Math.PI,!0),++S;break;case Ml.CLOSE_PATH:t.closePath(),++S;break;case Ml.CUSTOM:T=z[1],u=z[2];var W=z[3],q=z[4],$=6==z.length?z[5]:void 0;I.geometry=W,I.feature=C,S in F||(F[S]=[]);var Y=F[S];$?$(a,T,u,2,Y):(Y[0]=a[T],Y[1]=a[T+1],Y.length=2),q(Y,I),++S;break;case Ml.DRAW_IMAGE:T=z[1],u=z[2],y=z[3],c=z[4],h=z[5],v=o?null:z[6];var X=z[7],U=z[8],K=z[9],Z=z[10],J=z[11],Q=z[12],tt=z[13],et=z[14];if(!y&&z.length>=19){b=z[18],w=z[19],_=z[20],x=z[21];var it=this.drawLabelWithPointPlacement_(b,w,_,x);y=it.label,z[3]=y;var nt=z[22];c=(it.anchorX-nt)*this.pixelRatio,z[4]=c;var ot=z[23];h=(it.anchorY-ot)*this.pixelRatio,z[5]=h,X=y.height,z[7]=X,et=y.width,z[14]=et}var rt=void 0;z.length>24&&(rt=z[24]);var at=void 0,st=void 0,lt=void 0;z.length>16?(at=z[15],st=z[16],lt=z[17]):(at=fs,st=!1,lt=!1),J&&A?Q+=O:J||A||(Q-=O);for(var ut=0,ct=0;T<u;T+=2)if(!(rt&&rt[ut++]<et/this.pixelRatio)){if(v){var ht=Math.floor(ct);v.length<ht+1&&((m=[1/0,1/0,-1/0,-1/0]).push(v[0][4]),v.push(m)),m=v[ht]}this.replayImageOrLabel_(t,a[T],a[T+1],y,c,h,m,X,U,K,Z,Q,tt,n,et,at,st?D:null,lt?L:null),m&&(ct===Math.floor(ct)&&this.declutterItems.push(this,m,C),ct+=1/m[4])}++S;break;case Ml.DRAW_CHARS:var dt=z[1],pt=z[2],ft=z[3];m=o?null:z[4];var gt=z[5];x=z[6];var mt=z[7],vt=z[8],yt=z[9];_=z[10];var bt=z[11];b=z[12],w=z[13];var wt=z[14],_t=this.textStates[w],xt=_t.font,Ct=_t.scale*vt,Et=void 0;xt in this.widths_?Et=this.widths_[xt]:(Et={},this.widths_[xt]=Et);var kt=On(a,dt,pt,2),St=Ct*ks(xt,b,Et);if(gt||St<=kt){var Mt=this.textStates[w].textAlign,Tt=Xl(a,dt,pt,2,b,(kt-St)*Hl[Mt],mt,Ct,ks,xt,Et);if(Tt){var Rt=void 0,Pt=void 0,Dt=void 0,Lt=void 0,Ft=void 0;if(_)for(Rt=0,Pt=Tt.length;Rt<Pt;++Rt)Dt=(Ft=Tt[Rt])[4],Lt=this.createLabel(Dt,w,"",_),c=Ft[2]+bt,h=ft*Lt.height+2*(.5-ft)*bt-yt,this.replayImageOrLabel_(t,Ft[0],Ft[1],Lt,c,h,m,Lt.height,1,0,0,Ft[3],wt,!1,Lt.width,fs,null,null);if(x)for(Rt=0,Pt=Tt.length;Rt<Pt;++Rt)Dt=(Ft=Tt[Rt])[4],Lt=this.createLabel(Dt,w,x,""),c=Ft[2],h=ft*Lt.height-yt,this.replayImageOrLabel_(t,Ft[0],Ft[1],Lt,c,h,m,Lt.height,1,0,0,Ft[3],wt,!1,Lt.width,fs,null,null)}}this.declutterItems.push(this,m,C),++S;break;case Ml.END_GEOMETRY:if(void 0!==o){var Ot=o(C=z[1]);if(Ot)return Ot}++S;break;case Ml.FILL:j?R++:this.fill_(t),++S;break;case Ml.MOVE_TO_LINE_TO:for(T=z[1],u=z[2],E=a[T],g=(k=a[T+1])+.5|0,(f=E+.5|0)===d&&g===p||(t.moveTo(E,k),d=f,p=g),T+=2;T<u;T+=2)f=(E=a[T])+.5|0,g=(k=a[T+1])+.5|0,T!=u-2&&f===d&&g===p||(t.lineTo(E,k),d=f,p=g);++S;break;case Ml.SET_FILL_STYLE:D=z,this.alignFill_=z[2],R&&(this.fill_(t),R=0,P&&(t.stroke(),P=0)),t.fillStyle=z[1],++S;break;case Ml.SET_STROKE_STYLE:L=z,P&&(t.stroke(),P=0),this.setStrokeStyle_(t,z),++S;break;case Ml.STROKE:j?P++:t.stroke(),++S;break;default:++S}}R&&this.fill_(t),P&&t.stroke()},t.prototype.execute=function(t,e,i,n){this.viewRotation_=i,this.execute_(t,e,this.instructions,n,void 0,void 0)},t.prototype.executeHitDetection=function(t,e,i,n,o){return this.viewRotation_=i,this.execute_(t,e,this.hitDetectionInstructions,!0,n,o)},t}(),iu=[bl,gl,yl,vl,wl,ml],nu=function(){function t(t,e,i,n,o,r){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=r,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(o)}return t.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);var n=t[e];for(var o in n){var r=n[o];i[o]=new eu(this.resolution_,this.pixelRatio_,this.overlaps_,r)}}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],n=0,o=t.length;n<o;++n)if(t[n]in i)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r){var a=2*(n=Math.round(n))+1,s=an(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=er(a,a));var l,u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):u.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(Jt(l=[1/0,1/0,-1/0,-1/0],t),zt(l,e*(this.renderBuffer_+n),l));var c,h=function(t){if(void 0!==ou[t])return ou[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var o=t,r=0,a=0;for(;o>=r;)ru(i,t+o,t+r),ru(i,t+r,t+o),ru(i,t-r,t+o),ru(i,t-o,t+r),ru(i,t-o,t-r),ru(i,t-r,t-o),ru(i,t+r,t-o),ru(i,t+o,t-r),r++,2*((a+=1+2*r)-o)+1>0&&(a+=1-2*(o-=1));return ou[t]=i,i}(n);function d(t){for(var e=u.getImageData(0,0,a,a).data,i=0;i<a;i++)for(var n=0;n<a;n++)if(h[i][n]&&e[4*(n*a+i)+3]>0){var s=void 0;return(!r||c!=vl&&c!=wl||-1!==r.indexOf(t))&&(s=o(t)),s||void u.clearRect(0,0,a,a)}}var p,f,g,m,v,y=Object.keys(this.executorsByZIndex_).map(Number);for(y.sort(gi),p=y.length-1;p>=0;--p){var b=y[p].toString();for(g=this.executorsByZIndex_[b],f=iu.length-1;f>=0;--f)if(void 0!==(m=g[c=iu[f]])&&(v=m.executeHitDetection(u,s,i,d,l)))return v}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],n=e[1],o=e[2],r=e[3],a=[i,n,i,r,o,r,o,n];return Ki(a,0,8,2,t,a),a},t.prototype.isEmpty=function(){return ut(this.executorsByZIndex_)},t.prototype.execute=function(t,e,i,n,o,r){var a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(gi),this.maxExtent_&&(t.save(),this.clip(t,e));var s,l,u,c,h,d,p=o||iu;for(s=0,l=a.length;s<l;++s){var f=a[s].toString();for(h=this.executorsByZIndex_[f],u=0,c=p.length;u<c;++u){var g=p[u];if(void 0!==(d=h[g]))if(!r||g!=vl&&g!=wl)d.execute(t,e,i,n);else{var m=r[f];m?m.push(d,e.slice(0)):r[f]=[d,e.slice(0)]}}}this.maxExtent_&&t.restore()},t}(),ou={0:[[!0]]};function ru(t,e,i){var n,o=Math.floor(t.length/2);if(e>=o)for(n=o;n<e;n++)t[n][i]=!0;else if(e<o)for(n=e+1;n<o;n++)t[n][i]=!0}function au(t,e,i,n,o,r){for(var a=Object.keys(t).map(Number).sort(gi),s=0,l=a.length;s<l;++s)for(var u=t[a[s].toString()],c=void 0,h=0,d=u.length;h<d;){var p=u[h++];p!==c&&(c=p,r.push({items:p.declutterItems,opacity:n}));var f=u[h++];p.execute(e,f,i,o)}}var su=nu,lu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),uu=function(t){function e(e,i,n,o,r,a,s){var l=t.call(this)||this;return l.context_=e,l.pixelRatio_=i,l.extent_=n,l.transform_=o,l.viewRotation_=r,l.squaredTolerance_=a,l.userTransform_=s,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=0,l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=0,l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return lu(e,t),e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var o=Ki(t,e,i,2,this.transform_,this.pixelCoordinates_),r=this.context_,a=this.tmpLocalTransform_,s=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=s*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,c=o.length;u<c;u+=2){var h=o[u]-this.imageAnchorX_,d=o[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var p=h+this.imageAnchorX_,f=d+this.imageAnchorY_;an(a,p,f,this.imageScale_,this.imageScale_,l,-p,-f),r.setTransform.apply(r,a)}r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,d,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||r.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(r.globalAlpha=s)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var o=Ki(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){var s=o[e]+this.textOffsetX_,l=o[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){var u=an(this.tmpLocalTransform_,s,l,this.textScale_,this.textScale_,a,-s,-l);r.setTransform.apply(r,u)}this.textStrokeState_&&r.strokeText(this.text_,s,l),this.textFillState_&&r.fillText(this.text_,s,l)}0===a&&1==this.textScale_||r.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,o){var r=this.context_,a=Ki(t,e,i,n,this.transform_,this.pixelCoordinates_);r.moveTo(a[0],a[1]);var s=a.length;o&&(s-=2);for(var l=2;l<s;l+=2)r.lineTo(a[l],a[l+1]);return o&&r.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var o=0,r=i.length;o<r;++o)e=this.moveToLineTo_(t,e,i[o],n,!0);return e},e.prototype.drawCircle=function(t){if(fe(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var o=t.getStride();return Ki(n,0,n.length,o,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],o=Math.sqrt(i*i+n*n),r=this.context_;r.beginPath(),r.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case vt:this.drawPoint(t);break;case yt:this.drawLineString(t);break;case wt:this.drawPolygon(t);break;case _t:this.drawMultiPoint(t);break;case xt:this.drawMultiLineString(t);break;case Ct:this.drawMultiPolygon(t);break;case Et:this.drawGeometryCollection(t);break;case kt:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&fe(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fe(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(fe(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),o=0,r=t.getEnds(),a=t.getStride();i.beginPath();for(var s=0,l=r.length;s<l;++s)o=this.moveToLineTo_(n,o,r[s],a,!1);i.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),fe(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,o=t.getEndss(),r=t.getStride();e.beginPath();for(var a=0,s=o.length;a<s;++a){var l=o[a];n=this.drawRings_(i,n,l,r)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(bi(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:"center";i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:Ys(i||"#000")}}else this.fillState_=null;if(e){var n=e.getColor(),o=e.getLineCap(),r=e.getLineDash(),a=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit();this.strokeState_={lineCap:void 0!==o?o:"round",lineDash:r||ps,lineDashOffset:a||0,lineJoin:void 0!==s?s:"round",lineWidth:this.pixelRatio_*(void 0!==l?l:1),miterLimit:void 0!==u?u:10,strokeStyle:Ys(n||"#000")}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),o=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=o[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=o[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:Ys(i||"#000")}}else this.textFillState_=null;var n=t.getStroke();if(n){var o=n.getColor(),r=n.getLineCap(),a=n.getLineDash(),s=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),c=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==r?r:"round",lineDash:a||ps,lineDashOffset:s||0,lineJoin:void 0!==l?l:"round",lineWidth:void 0!==u?u:1,miterLimit:void 0!==c?c:10,strokeStyle:Ys(o||"#000")}}else this.textStrokeState_=null;var h=t.getFont(),d=t.getOffsetX(),p=t.getOffsetY(),f=t.getRotateWithView(),g=t.getRotation(),m=t.getScale(),v=t.getText(),y=t.getTextAlign(),b=t.getTextBaseline();this.textState_={font:void 0!==h?h:"10px sans-serif",textAlign:void 0!==y?y:"center",textBaseline:void 0!==b?b:"middle"},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==m?m:1)}else this.text_=""},e}(_l),cu="fraction",hu="pixels",du=function(){function t(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return t.prototype.clear=function(){this.cache_={},this.cacheSize_=0},t.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},t.prototype.get=function(t,e,i){var n=pu(t,e,i);return n in this.cache_?this.cache_[n]:null},t.prototype.set=function(t,e,i,n){var o=pu(t,e,i);this.cache_[o]=n,++this.cacheSize_},t.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},t}();function pu(t,e,i){return e+":"+t+":"+(i?function(t){return"string"==typeof t?t:$s(t)}(i):"null")}var fu=new du,gu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mu=function(t){function e(e,i,n,o,r,a){var s=t.call(this)||this;return s.hitDetectionImage_=null,s.image_=e||new Image,null!==o&&(s.image_.crossOrigin=o),s.canvas_=a?document.createElement("canvas"):null,s.color_=a,s.unlisten_=null,s.imageState_=r,s.size_=n,s.src_=i,s.tainted_,s}return gu(e,t),e.prototype.isTainted_=function(t){if(void 0===this.tainted_&&this.imageState_===hr){t||(t=er(1,1)).drawImage(this.image_,0,0);try{t.getImageData(0,0,1,1),this.tainted_=!1}catch(t){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Di)},e.prototype.handleImageError_=function(){this.imageState_=dr,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=hr,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],n=er(e,i);n.fillRect(0,0,e,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==ur){this.imageState_=cr;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=fr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");if(t.drawImage(this.image_,0,0),this.isTainted_(t)){var e=this.color_;return t.globalCompositeOperation="multiply",t.fillStyle="rgb("+e[0]+","+e[1]+","+e[2]+")",t.fillRect(0,0,this.image_.width,this.image_.height),t.globalCompositeOperation="destination-in",void t.drawImage(this.image_,0,0)}for(var i=t.getImageData(0,0,this.image_.width,this.image_.height),n=i.data,o=this.color_[0]/255,r=this.color_[1]/255,a=this.color_[2]/255,s=0,l=n.length;s<l;s+=4)n[s]*=o,n[s+1]*=r,n[s+2]*=a;t.putImageData(i,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Pi);var vu="bottom-left",yu="bottom-right",bu="top-left",wu="top-right",_u=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xu=function(t){function e(e){var i=this,n=e||{},o=void 0!==n.opacity?n.opacity:1,r=void 0!==n.rotation?n.rotation:0,a=void 0!==n.scale?n.scale:1,s=void 0!==n.rotateWithView&&n.rotateWithView;(i=t.call(this,{opacity:o,rotation:r,scale:a,displacement:void 0!==n.displacement?n.displacement:[0,0],rotateWithView:s})||this).anchor_=void 0!==n.anchor?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==n.anchorOrigin?n.anchorOrigin:bu,i.anchorXUnits_=void 0!==n.anchorXUnits?n.anchorXUnits:cu,i.anchorYUnits_=void 0!==n.anchorYUnits?n.anchorYUnits:cu,i.crossOrigin_=void 0!==n.crossOrigin?n.crossOrigin:null;var l=void 0!==n.img?n.img:null,u=void 0!==n.imgSize?n.imgSize:null,c=n.src;nt(!(void 0!==c&&l),4),nt(!l||l&&u,5),void 0!==c&&0!==c.length||!l||(c=l.src||Q(l)),nt(void 0!==c&&c.length>0,6);var h=void 0!==n.src?ur:hr;return i.color_=void 0!==n.color?Ws(n.color):null,i.iconImage_=function(t,e,i,n,o,r){var a=fu.get(e,n,r);return a||(a=new mu(t,e,i,n,o,r),fu.set(e,n,r,a)),a}(l,c,u,i.crossOrigin_,h,i.color_),i.offset_=void 0!==n.offset?n.offset:[0,0],i.offsetOrigin_=void 0!==n.offsetOrigin?n.offsetOrigin:bu,i.origin_=null,i.size_=void 0!==n.size?n.size:null,i}return _u(e,t),e.prototype.clone=function(){return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==cu||this.anchorYUnits_==cu){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==cu&&(t[0]*=e[0]),this.anchorYUnits_==cu&&(t[1]*=e[1])}if(this.anchorOrigin_!=bu){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=wu&&this.anchorOrigin_!=yu||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=vu&&this.anchorOrigin_!=yu||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=bu){var i=this.getSize(),n=this.iconImage_.getSize();if(!i||!n)return null;t=t.slice(),this.offsetOrigin_!=wu&&this.offsetOrigin_!=yu||(t[0]=n[0]-i[0]-t[0]),this.offsetOrigin_!=vu&&this.offsetOrigin_!=yu||(t[1]=n[1]-i[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(Di,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(Di,t)},e}(Xs);function Cu(t,e,i,n,o,r,a){var s=er(t[0]/2,t[1]/2);s.imageSmoothingEnabled=!1;for(var l=s.canvas,u=new uu(s,.5,o,null,a),c=i.length,h=Math.floor(16777215/c),d={},p=1;p<=c;++p){var f=i[p-1],g=f.getStyleFunction()||n;if(n){var m=g(f,r);if(m){Array.isArray(m)||(m=[m]);for(var v="#"+("000000"+(p*h).toString(16)).slice(-6),y=0,b=m.length;y<b;++y){var w=m[y],_=w.clone(),x=_.getFill();x&&x.setColor(v);var C=_.getStroke();C&&C.setColor(v),_.setText(void 0);var E=w.getImage();if(E){var k=E.getImageSize();if(!k)continue;var S=document.createElement("canvas");S.width=k[0],S.height=k[1];var M=S.getContext("2d",{alpha:!1});M.fillStyle=v;var T=M.canvas;M.fillRect(0,0,T.width,T.height),er(k?k[0]:T.width,k?k[1]:T.height).drawImage(T,0,0),_.setImage(new xu({img:T,imgSize:k,anchor:E.getAnchor(),anchorXUnits:hu,anchorYUnits:hu,offset:E.getOrigin(),size:E.getSize(),opacity:E.getOpacity(),scale:E.getScale(),rotation:E.getRotation(),rotateWithView:E.getRotateWithView()}))}var R=Number(_.getZIndex());(F=d[R])||(F={},d[R]=F,F[wt]=[],F[kt]=[],F[yt]=[],F[vt]=[]);var P=_.getGeometryFunction()(f);P&&fe(o,P.getExtent())&&F[P.getType().replace("Multi","")].push(P,_)}}}}for(var D=Object.keys(d).map(Number).sort(gi),L=(p=0,D.length);p<L;++p){var F=d[D[p]];for(var O in F){var A=F[O];for(y=0,b=A.length;y<b;y+=2){u.setStyle(A[y+1]);for(var I=0,j=e.length;I<j;++I)u.setTransform(e[I]),u.drawGeometry(A[y])}}}return document.body.appendChild(s.canvas),s.getImageData(0,0,l.width,l.height)}function Eu(t,e,i){var n=[];if(i){var o=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),r=i.data[o],a=i.data[o+1],s=i.data[o+2]+256*(a+256*r),l=Math.floor(16777215/e.length);s&&s%l==0&&n.push(e[s/l-1])}return n}function ku(t,e){var i,n,o=t[0],r=t[1],a=e[0],s=e[1],l=a[0],u=a[1],c=s[0],h=s[1],d=c-l,p=h-u,f=0===d&&0===p?0:(d*(o-l)+p*(r-u))/(d*d+p*p||0);return f<=0?(i=l,n=u):f>=1?(i=c,n=h):(i=l+f*d,n=u+f*p),[i,n]}function Su(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Mu(t,e){var i=Math.cos(e),n=Math.sin(e),o=t[0]*i-t[1]*n,r=t[1]*i+t[0]*n;return t[0]=o,t[1]=r,t}function Tu(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function Ru(t,e){return Math.sqrt(Tu(t,e))}function Pu(t,e){var i=e.getExtent();if(e.canWrapX()&&(t[0]<i[0]||t[0]>=i[2])){var n=pe(i),o=Math.floor((t[0]-i[0])/n);t[0]-=o*n}return t}var Du=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Lu={image:[bl,gl,yl,vl,wl],hybrid:[bl,yl],vector:[]},Fu={image:[ml],hybrid:[vl,wl,ml],vector:[bl,gl,yl,vl,wl,ml]},Ou=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.dirty_=!1,i.renderedLayerRevision_,i.renderedPixelToCoordinateTransform_=null,i.renderedRotation_,i.renderTileImageQueue_={},i.tileListenerKeys_={},i.tmpTransform_=[1,0,0,1,0,0],i}return Du(e,t),e.prototype.prepareTile=function(t,e,i,n){var o,r=Q(t),a=t.getState();return(a===zo&&t.hifi||a===No)&&r in this.tileListenerKeys_&&(Ci(this.tileListenerKeys_[r]),delete this.tileListenerKeys_[r]),a!==zo&&a!==No||(this.updateExecutorGroup_(t,e,i),this.tileImageNeedsRender_(t,e,i)&&(o=!0,n&&(this.renderTileImageQueue_[r]=t))),o},e.prototype.getTile=function(e,i,n,o){var r=o.pixelRatio,a=o.viewState,s=a.resolution,l=a.projection,u=this.getLayer(),c=u.getSource().getTile(e,i,n,r,l);if(c.getState()<zo){c.wantedResolution=s;var h=Q(c);if(!(h in this.tileListenerKeys_)){var d=_i(c,Di,this.prepareTile.bind(this,c,r,l,!0));this.tileListenerKeys_[h]=d}}else{var p=o.viewHints;!!(p[pl]||p[fl])&&c.wantedResolution||(c.wantedResolution=s),this.prepareTile(c,r,l,!1)&&u.getRenderMode()!==dl&&this.renderTileImage_(c,o)}return t.prototype.getTile.call(this,e,i,n,o)},e.prototype.isDrawableTile=function(e){var i=this.getLayer();return t.prototype.isDrawableTile.call(this,e)&&i.getRenderMode()===dl||e.hasContext(i)},e.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},e.prototype.prepareFrame=function(e){var i=this.getLayer().getRevision();return this.renderedLayerRevision_!=i&&(this.renderedTiles.length=0),this.renderedLayerRevision_=i,t.prototype.prepareFrame.call(this,e)},e.prototype.updateExecutorGroup_=function(t,e,i){var n=this.getLayer(),o=n.getRevision(),r=n.getRenderOrder()||null,a=t.wantedResolution,s=t.getReplayState(n);if(s.dirty||s.renderedResolution!==a||s.renderedRevision!=o||s.renderedRenderOrder!=r||s.renderedZ!==t.sourceZ){var l=n.getSource(),u=l.getTileGrid(),c=l.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),h=l.getSourceTiles(e,i,t),d=Q(n);delete t.hitDetectionImageData[d],t.executorGroups[d]=[];for(var p=function(i,o){var p=h[i];if(p.getState()!=zo)return"continue";var g=p.tileCoord,m=u.getTileCoordExtent(g),v=ce(c,m),y=Kt(m,v)?null:zt(v,n.getRenderBuffer()*a,f.tmpExtent);s.dirty=!1;var b=new Gl(0,v,a,e,n.getDeclutter()),w=ql(a,e),_=function(t){var e,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(e=i(t,a)),e){var o=this.renderFeature(t,w,e,b);this.dirty_=this.dirty_||o,s.dirty=s.dirty||o}},x=p.getFeatures();r&&r!==s.renderedRenderOrder&&x.sort(r);for(var C=0,E=x.length;C<E;++C){var k=x[C];y&&!fe(y,k.getGeometry().getExtent())||_.call(f,k)}var S=b.finish(),M=n.getRenderMode()!==dl&&n.getDeclutter()&&1===h.length?null:v,T=new su(M,a,e,l.getOverlaps(),S,n.getRenderBuffer());t.executorGroups[d].push(T)},f=this,g=0,m=h.length;g<m;++g)p(g);s.renderedRevision=o,s.renderedZ=t.sourceZ,s.renderedRenderOrder=r,s.renderedResolution=a}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){var r=e.viewState.resolution,a=e.viewState.rotation;i=null==i?0:i;var s,l,u,c=this.getLayer(),h=c.getDeclutter(),d=c.getSource().getTileGridForProjection(e.viewState.projection),p={},f=this.renderedTiles,g=function(){var e=f[l],u=Bt(d.getTileCoordExtent(e.wrappedTileCoord),t);if(!h&&!u)return"continue";for(var g=e.executorGroups[Q(c)],m=0,v=g.length;m<v;++m){var y=g[m];s=s||y.forEachFeatureAtCoordinate(t,r,a,i,(function(t){if(u||o&&-1!==o.indexOf(t)){var e=t.getId();if(void 0===e&&(e=Q(t)),!(e in p))return p[e]=!0,n(t,c)}}),c.getDeclutter()?o:null)}};for(l=0,u=f.length;l<u;++l)g();return s},e.prototype.getFeatures=function(t){return new Promise(function(e,i){for(var n,o=this.getLayer(),r=Q(o),a=o.getSource(),s=this.renderedProjection,l=s.getExtent(),u=this.renderedResolution,c=a.getTileGridForProjection(s),h=on(this.renderedPixelToCoordinateTransform_,t.slice()),d=c.getTileCoordForCoordAndResolution(h,u),p=0,f=this.renderedTiles.length;p<f;++p)if(d.toString()===this.renderedTiles[p].tileCoord.toString()){if((n=this.renderedTiles[p]).getState()===zo&&n.hifi){var g=c.getTileCoordExtent(n.tileCoord);a.getWrapX()&&s.canWrapX()&&!Gt(l,g)&&Pu(h,s);break}n=void 0}if(!n||n.loadingSourceTiles>0)e([]);else{var m=he(c.getTileCoordExtent(n.wrappedTileCoord)),v=[(h[0]-m[0])/u,(m[1]-h[1])/u],y=n.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]),b=n.hitDetectionImageData[r];if(!b&&!this.animatingOrInteracting_){var w=Lr(c.getTileSize(c.getZForResolution(u))),_=[w[0]/2,w[1]/2],x=this.renderedRotation_;b=Cu(w,[this.getRenderTransform(c.getTileCoordCenter(n.wrappedTileCoord),u,0,.5,_[0],_[1],0)],y,o.getStyleFunction(),c.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(o).renderedResolution,x),n.hitDetectionImageData[r]=b}e(Eu(v,y,b))}}.bind(this))},e.prototype.handleFontsChanged=function(){st(this.renderTileImageQueue_);var t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.renderFrame=function(e,i){var n=e.viewHints,o=!(n[pl]||n[fl]);this.renderQueuedTileImages_(o,e),t.prototype.renderFrame.call(this,e,i),this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;var r=this.getLayer(),a=r.getRenderMode();if(a===cl)return this.container;var s=r.getSource(),l=e.usedTiles[Q(s)];for(var u in this.renderTileImageQueue_)l&&u in l||delete this.renderTileImageQueue_[u];for(var c=this.context,h=r.getDeclutter()?{}:null,d=Fu[a],p=e.pixelRatio,f=e.viewState,g=f.center,m=f.resolution,v=f.rotation,y=e.size,b=Math.round(y[0]*p),w=Math.round(y[1]*p),_=this.renderedTiles,x=s.getTileGridForProjection(e.viewState.projection),C=[],E=[],k=_.length-1;k>=0;--k)for(var S=_[k],M=S.tileCoord,T=x.getTileCoordExtent(S.wrappedTileCoord),R=x.getTileCoordExtent(M,this.tmpExtent)[0]-T[0],P=en(rn(this.inversePixelTransform.slice(),1/p,1/p),this.getRenderTransform(g,m,v,p,b,w,R)),D=S.executorGroups[Q(r)],L=!1,F=0,O=D.length;F<O;++F){var A=D[F];if(A.hasExecutors(d)){var I=S.tileCoord[0],j=void 0;if(!h&&!L){j=A.getClipCoords(P),c.save();for(var z=0,N=C.length;z<N;++z){var H=C[z];I<E[z]&&(c.beginPath(),c.moveTo(j[0],j[1]),c.lineTo(j[2],j[3]),c.lineTo(j[4],j[5]),c.lineTo(j[6],j[7]),c.moveTo(H[6],H[7]),c.lineTo(H[4],H[5]),c.lineTo(H[2],H[3]),c.lineTo(H[0],H[1]),c.clip())}}A.execute(c,P,v,o,d,h),h||L||(c.restore(),C.push(j),E.push(I),L=!0)}}h&&au(h,c,v,e.layerStatesArray[e.layerIndex].opacity,o,e.declutterItems);return this.container},e.prototype.renderQueuedTileImages_=function(t,e){for(var i in this.renderTileImageQueue_){if(!t&&Date.now()-e.time>8){e.animate=!0;break}var n=this.renderTileImageQueue_[i];delete this.renderTileImageQueue_[i],this.renderTileImage_(n,e)}},e.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var r=0,a=i.length;r<a;++r)o=Yl(n,t,i[r],e,this.boundHandleStyleImageChange_)||o;else o=Yl(n,t,i,e,this.boundHandleStyleImageChange_);return o},e.prototype.tileImageNeedsRender_=function(t,e,i){var n=this.getLayer(),o=t.getReplayState(n),r=n.getRevision(),a=t.sourceZ,s=t.wantedResolution;return o.renderedTileResolution!==s||o.renderedTileRevision!==r||o.renderedTileZ!==a},e.prototype.renderTileImage_=function(t,e){var i=this.getLayer(),n=t.getReplayState(i),o=i.getRevision(),r=t.executorGroups[Q(i)];n.renderedTileRevision=o,n.renderedTileZ=t.sourceZ;var a=t.wrappedTileCoord,s=a[0],l=i.getSource(),u=e.pixelRatio,c=e.viewState.projection,h=l.getTileGridForProjection(c),d=h.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*d,f=h.getResolution(s),g=t.getContext(i);u=Math.max(u,p/u);var m=l.getTilePixelSize(s,u,c);g.canvas.width=m[0],g.canvas.height=m[1];var v=u/p;if(1!==v){var y=tn(this.tmpTransform_);rn(y,v,v),g.setTransform.apply(g,y)}var b=h.getTileCoordExtent(a,this.tmpExtent),w=p/f,_=tn(this.tmpTransform_);rn(_,w,-w),function(t,e,i){en(t,nn(Qi,1,0,0,1,e,i))}(_,-b[0],-b[3]);for(var x=0,C=r.length;x<C;++x){r[x].execute(g,_,0,!0,Lu[i.getRenderMode()])}n.renderedTileResolution=t.wantedResolution},e}(As),Au=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Iu=function(t){function e(e){var i=this,n=e||{},o=at({},n);delete o.preload,delete o.useInterimTilesOnError,i=t.call(this,o)||this;var r=n.renderMode||hl;return nt(null==r||r==cl||r==hl||r==dl,28),i.renderMode_=r,i.setPreload(n.preload?n.preload:0),i.setUseInterimTilesOnError(void 0===n.useInterimTilesOnError||n.useInterimTilesOnError),i}return Au(e,t),e.prototype.createRenderer=function(){return new Ou(this)},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderMode=function(){return this.renderMode_},e.prototype.getPreload=function(){return this.get(os)},e.prototype.getUseInterimTilesOnError=function(){return this.get(rs)},e.prototype.setPreload=function(t){this.set(os,t)},e.prototype.setUseInterimTilesOnError=function(t){this.set(rs,t)},e}(ul),ju=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zu=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i}return ju(e,t),e.prototype.useContainer=function(e,i,n){n<1&&(e=null),t.prototype.useContainer.call(this,e,i,n)},e.prototype.renderFrame=function(t,e){var i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){nn(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),sn(this.inversePixelTransform,this.pixelTransform);var o=ln(this.pixelTransform);this.useContainer(e,o,n.opacity);var r=this.context,a=r.canvas,s=this.replayGroup_;if(!s||s.isEmpty())return!this.containerReused&&a.width>0&&(a.width=0),this.container;var l=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);a.width!=l||a.height!=u?(a.width=l,a.height=u,a.style.transform!==o&&(a.style.transform=o)):this.containerReused||r.clearRect(0,0,l,u),this.preRender(r,t);var c=t.extent,h=t.viewState,d=h.center,p=h.resolution,f=h.projection,g=h.rotation,m=f.getExtent(),v=this.getLayer().getSource(),y=!1;if(n.extent){var b=oi(n.extent,f);(y=!Gt(b,t.extent)&&fe(b,t.extent))&&this.clip(r,t,b)}var w=t.viewHints,_=!(w[pl]||w[fl]),x=this.getRenderTransform(d,p,g,i,l,u,0),C=this.getLayer().getDeclutter()?{}:null;if(s.execute(r,x,g,_,void 0,C),v.getWrapX()&&f.canWrapX()&&!Gt(m,c)){for(var E=c[0],k=pe(m),S=0,M=void 0;E<m[0];){M=k*--S;var T=this.getRenderTransform(d,p,g,i,l,u,M);s.execute(r,T,g,_,void 0,C),E+=k}for(S=0,E=c[2];E>m[2];){M=k*++S;var R=this.getRenderTransform(d,p,g,i,l,u,M);s.execute(r,R,g,_,void 0,C),E-=k}}if(C){var P=t.viewHints;au(C,r,g,1,!(P[pl]||P[fl]),t.declutterItems)}y&&r.restore(),this.postRender(r,t);var D=n.opacity,L=this.container;return D!==parseFloat(L.style.opacity)&&(L.style.opacity=1===D?"":D),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e,i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];on(this.pixelTransform,n);var o=this.renderedCenter_,r=this.renderedResolution_,a=this.renderedRotation_,s=this.renderedProjection_,l=this.renderedExtent_,u=this.getLayer(),c=[],h=n[0]/2,d=n[1]/2;c.push(this.getRenderTransform(o,r,a,.5,h,d,0).slice());var p=u.getSource(),f=s.getExtent();if(p.getWrapX()&&s.canWrapX()&&!Gt(f,l)){for(var g=l[0],m=pe(f),v=0,y=void 0;g<f[0];)y=m*--v,c.push(this.getRenderTransform(o,r,a,.5,h,d,y).slice()),g+=m;for(v=0,g=l[2];g>f[2];)y=m*++v,c.push(this.getRenderTransform(o,r,a,.5,h,d,y).slice()),g-=m}this.hitDetectionImageData_=Cu(n,c,this.renderedFeatures_,u.getStyleFunction(),l,r,a)}e(Eu(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o){if(this.replayGroup_){var r=e.viewState.resolution,a=e.viewState.rotation,s=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,r,a,i,(function(t){var e=Q(t);if(!(e in l))return l[e]=!0,n(t,s)}),s.getDeclutter()?o:null)}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),i=e.getSource();if(!i)return!1;var n=t.viewHints[pl],o=t.viewHints[fl],r=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(!this.dirty_&&!r&&n||!a&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=t.extent,l=t.viewState,u=l.projection,c=l.resolution,h=t.pixelRatio,d=e.getRevision(),p=e.getRenderBuffer(),f=e.getRenderOrder();void 0===f&&(f=Wl);var g=l.center.slice(),m=zt(s,p*c),v=[m.slice()],y=u.getExtent();if(i.getWrapX()&&u.canWrapX()&&!Gt(y,t.extent)){var b=pe(y),w=Math.max(pe(m)/2,b);m[0]=y[0]-w,m[2]=y[2]+w,Pu(g,u);var _=function(t,e){var i=e.getExtent(),n=ae(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){var o=pe(i),r=Math.floor((n[0]-i[0])/o)*o;t[0]-=r,t[2]-=r}return t}(v[0],u);_[0]<y[0]&&_[2]<y[2]?v.push([_[0]+b,_[1],_[2]+b,_[3]]):_[0]>y[0]&&_[2]>y[2]&&v.push([_[0]-b,_[1],_[2]-b,_[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&Gt(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var x,C=new Gl($l(c,h),m,c,h,e.getDeclutter()),E=ti();if(E){for(var k=0,S=v.length;k<S;++k)i.loadFeatures(ni(v[k],u),c,E);x=$e(E,u)}else for(k=0,S=v.length;k<S;++k)i.loadFeatures(v[k],c,u);var M=ql(c,h),T=function(t){var i,n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){var o=this.renderFeature(t,M,i,C,x);this.dirty_=this.dirty_||o}}.bind(this),R=ni(m,u),P=i.getFeaturesInExtent(R);f&&P.sort(f);for(k=0,S=P.length;k<S;++k)T(P[k]);this.renderedFeatures_=P;var D=C.finish(),L=new su(m,c,h,i.getOverlaps(),D,e.getRenderBuffer());return this.renderedResolution_=c,this.renderedRevision_=d,this.renderedRenderOrder_=f,this.renderedExtent_=m,this.renderedRotation_=l.rotation,this.renderedCenter_=g,this.renderedProjection_=u,this.replayGroup_=L,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,o){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var a=0,s=i.length;a<s;++a)r=Yl(n,t,i[a],e,this.boundHandleStyleImageChange_,o)||r;else r=Yl(n,t,i,e,this.boundHandleStyleImageChange_,o);return r},e}(Ls),Nu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hu=function(t){function e(e){return t.call(this,e)||this}return Nu(e,t),e.prototype.createRenderer=function(){return new zu(this)},e}(ul),Bu=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new Qs({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:jl,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}(),Gu=function(){function t(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var o=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,o),this.initialVelocity_=Math.sqrt(o*o+r*r)/n,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}(),Vu={SINGLECLICK:"singleclick",CLICK:Oi,DBLCLICK:Ai,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Wu="active",qu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function $u(t,e,i,n){var o=t.getZoom();if(void 0!==o){var r=t.getConstrainedZoom(o+e),a=t.getResolutionForZoom(r);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:i,duration:void 0!==n?n:250,easing:Go})}}var Yu=function(t){function e(e){var i=t.call(this)||this;return e.handleEvent&&(i.handleEvent=e.handleEvent),i.map_=null,i.setActive(!0),i}return qu(e,t),e.prototype.getActive=function(){return this.get(Wu)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Wu,t)},e.prototype.setMap=function(t){this.map_=t},e}(Ui),Xu=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Uu(t){var e=!1;if(t.type==Vu.DBLCLICK){var i=t.originalEvent,n=t.map,o=t.coordinate,r=i.shiftKey?-this.delta_:this.delta_;$u(n.getView(),r,o,this.duration_),t.preventDefault(),e=!0}return!e}var Ku=function(t){function e(e){var i=t.call(this,{handleEvent:Uu})||this,n=e||{};return i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:250,i}return Xu(e,t),e}(Yu),Zu=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Ju=function(t){return t.target.getTargetElement()===document.activeElement},Qu=ki,tc=function(t){return t.type==Vu.CLICK},ec=function(t){var e=t.originalEvent;return 0==e.button&&!(Uo&&Ko&&e.ctrlKey)},ic=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},nc=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},oc=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},rc=function(t){var e=t.pointerEvent;return nt(void 0!==e,56),"mouse"==e.pointerType},ac=function(t){var e=t.pointerEvent;return nt(void 0!==e,56),e.isPrimary&&0===e.button},sc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function lc(t){for(var e=t.length,i=0,n=0,o=0;o<e;o++)i+=t[o].clientX,n+=t[o].clientY;return[i/e,n/e]}var uc=function(t){function e(e){var i=this,n=e||{};return i=t.call(this,n)||this,n.handleDownEvent&&(i.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(i.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(i.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(i.handleUpEvent=n.handleUpEvent),n.stopDown&&(i.stopDown=n.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return sc(e,t),e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Vu.POINTERDRAG)this.handleDragEvent(t);else if(t.type==Vu.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Vu.POINTERDOWN){var n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Vu.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Vu.POINTERDOWN||e===Vu.POINTERDRAG||e===Vu.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==Vu.POINTERUP?delete this.trackedPointers_[i]:(t.type==Vu.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=lt(this.trackedPointers_)}},e}(Yu),cc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function hc(t){return ic(t)&&ac(t)}var dc=function(t){function e(e){var i=t.call(this,{stopDown:Si})||this,n=e||{};return i.kinetic_=n.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1,i.condition_=n.condition?n.condition:hc,i.noKinetic_=!1,i}return cc(e,t),e.prototype.conditionInternal_=function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=Ju(t)),e&&this.condition_(t)},e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e,i,n=this.targetPointers,o=lc(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(o[0],o[1]),this.lastCentroid){var r=[this.lastCentroid[0]-o[0],o[1]-this.lastCentroid[1]],a=t.map.getView();e=r,i=a.getResolution(),e[0]*=i,e[1]*=i,Mu(r,a.getRotation()),a.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=o,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),r=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(r),s=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(o),a[1]-n*Math.sin(o)]);i.animateInternal({center:i.getConstrainedCenter(s),duration:500,easing:Go})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.conditionInternal_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(uc);function pc(t){return void 0!==t?0:void 0}function fc(t){return void 0!==t?t:void 0}var gc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mc=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,{stopDown:Si})||this).condition_=n.condition?n.condition:Zu,i.lastAngle_=void 0,i.duration_=void 0!==n.duration?n.duration:250,i}return gc(e,t),e.prototype.handleDragEvent=function(t){if(rc(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==pc){var n=e.getSize(),o=t.pixel,r=Math.atan2(n[1]/2-o[1],o[0]-n[0]/2);if(void 0!==this.lastAngle_){var a=r-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=r}}},e.prototype.handleUpEvent=function(t){return!rc(t)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){return!!rc(t)&&(!(!ec(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))},e}(uc),vc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),yc=function(t){function e(e){var i=t.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.className="ol-box "+e,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return vc(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new so([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(Ei),bc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wc="boxstart",_c="boxdrag",xc="boxend",Cc=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.coordinate=i,o.mapBrowserEvent=n,o}return bc(e,t),e}(Ti),Ec=function(t){function e(e){var i=t.call(this)||this,n=e||{};return i.box_=new yc(n.className||"ol-dragbox"),i.minArea_=void 0!==n.minArea?n.minArea:64,i.onBoxEnd_=n.onBoxEnd?n.onBoxEnd:Mi,i.startPixel_=null,i.condition_=n.condition?n.condition:ec,i.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:i.defaultBoxEndCondition,i}return bc(e,t),e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],o=i[1]-e[1];return n*n+o*o>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Cc(_c,t.coordinate,t))},e.prototype.handleUpEvent=function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Cc(xc,t.coordinate,t))),!1},e.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Cc(wc,t.coordinate,t)),!0)},e}(uc),kc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Sc(){var t,e,i=this.getMap(),n=i.getView(),o=i.getSize(),r=this.getGeometry().getExtent();if(this.out_){var a=n.calculateExtentInternal(o),s=(t=[i.getPixelFromCoordinateInternal(oe(r)),i.getPixelFromCoordinateInternal(de(r))],Qt(Yt(e),t));!function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(a,1/n.getResolutionForExtentInternal(s,o)),r=a}var l=n.getConstrainedResolution(n.getResolutionForExtentInternal(r,o)),u=n.getConstrainedCenter(ae(r),l);n.animateInternal({resolution:l,center:u,duration:this.duration_,easing:Go})}var Mc=function(t){function e(e){var i=this,n=e||{},o=n.condition?n.condition:nc;return(i=t.call(this,{condition:o,className:n.className||"ol-dragzoom",minArea:n.minArea,onBoxEnd:Sc})||this).duration_=void 0!==n.duration?n.duration:200,i.out_=void 0!==n.out&&n.out,i}return kc(e,t),e}(Ec),Tc=37,Rc=38,Pc=39,Dc=40,Lc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Fc(t){var e=!1;if(t.type==Ii){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==Dc||i==Tc||i==Pc||i==Rc)){var n=t.map.getView(),o=n.getResolution()*this.pixelDelta_,r=0,a=0;i==Dc?a=-o:i==Tc?r=-o:i==Pc?r=o:a=o;var s=[r,a];Mu(s,n.getRotation()),function(t,e,i){var n=t.getCenterInternal();if(n){var o=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Wo,center:t.getConstrainedCenter(o)})}}(n,s,this.duration_),t.preventDefault(),e=!0}}return!e}var Oc=function(t){function e(e){var i=t.call(this,{handleEvent:Fc})||this,n=e||{};return i.defaultCondition_=function(t){return ic(t)&&oc(t)},i.condition_=void 0!==n.condition?n.condition:i.defaultCondition_,i.duration_=void 0!==n.duration?n.duration:100,i.pixelDelta_=void 0!==n.pixelDelta?n.pixelDelta:128,i}return Lc(e,t),e}(Yu),Ac=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Ic(t){var e=!1;if(t.type==Ii||t.type==ji){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,o=i=="+".charCodeAt(0)?this.delta_:-this.delta_;$u(n.getView(),o,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var jc=function(t){function e(e){var i=t.call(this,{handleEvent:Ic})||this,n=e||{};return i.condition_=n.condition?n.condition:oc,i.delta_=n.delta?n.delta:1,i.duration_=void 0!==n.duration?n.duration:100,i}return Ac(e,t),e}(Yu),zc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nc="trackpad",Hc="wheel",Bc=function(t){function e(e){var i=this,n=e||{};return(i=t.call(this,n)||this).totalDelta_=0,i.lastDelta_=0,i.maxDelta_=void 0!==n.maxDelta?n.maxDelta:1,i.duration_=void 0!==n.duration?n.duration:250,i.timeout_=void 0!==n.timeout?n.timeout:80,i.useAnchor_=void 0===n.useAnchor||n.useAnchor,i.condition_=n.condition?n.condition:Qu,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.deltaPerZoom_=300,i}return zc(e,t),e.prototype.conditionInternal_=function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=Ju(t)),e&&this.condition_(t)},e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.conditionInternal_(t))return!0;if(t.type!==Bi)return!0;t.preventDefault();var e,i=t.map,n=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==Bi&&(e=n.deltaY,Xo&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Zo),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var o=Date.now();void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?Nc:Hc);var r=i.getView();if(this.mode_===Nc&&!r.getConstrainResolution())return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(r.getAnimating()&&r.cancelAnimations(),r.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),r.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),a),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var i=-ct(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;e.getConstrainResolution()&&(i=i?i>0?1:-1:0),$u(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Yu),Gc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vc=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=Si),(i=t.call(this,o)||this).anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=void 0!==n.threshold?n.threshold:.3,i.duration_=void 0!==n.duration?n.duration:250,i}return Gc(e,t),e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],o=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var r=o-this.lastAngle_;this.rotationDelta_+=r,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=r}this.lastAngle_=o;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==pc){var l=a.getViewport().getBoundingClientRect(),u=lc(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(u),this.rotating_&&(a.render(),s.adjustRotationInternal(e,this.anchor_))}},e.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(uc),Wc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),qc=function(t){function e(e){var i=this,n=e||{},o=n;return o.stopDown||(o.stopDown=Si),(i=t.call(this,o)||this).anchor_=null,i.duration_=void 0!==n.duration?n.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return Wc(e,t),e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],o=i.clientX-n.clientX,r=i.clientY-n.clientY,a=Math.sqrt(o*o+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,l=s.getView();1!=e&&(this.lastScaleDelta_=e);var u=s.getViewport().getBoundingClientRect(),c=lc(this.targetPointers);c[0]-=u.left,c[1]-=u.top,this.anchor_=s.getCoordinateFromPixelInternal(c),s.render(),l.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(uc);function $c(t){var e=t||{},i=new Sa,n=new Gu(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new mc),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new Ku({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new dc({condition:e.onFocusOnly?Ju:void 0,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new Vc),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new qc({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Oc),i.push(new jc({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Bc({condition:e.onFocusOnly?Ju:void 0,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new Mc({duration:e.zoomDuration})),i}var Yc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xc=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.map=i,o.frameState=void 0!==n?n:null,o}return Yc(e,t),e}(Ti),Uc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Kc=function(t){function e(e,i,n,o,r){var a=t.call(this,e,i,r)||this;return a.originalEvent=n,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==o&&o,a}return Uc(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Xc),Zc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Jc=function(t){function e(e,i,n,o,r){var a=t.call(this,e,i,n,o,r)||this;return a.pointerEvent=n,a}return Zc(e,t),e}(Kc),Qc=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),th=function(t){function e(e,i,n){var o=t.call(this)||this;if(void 0!==n&&void 0===i)o.setFlatCoordinates(n,e);else{var r=i||0;o.setCenterAndRadius(e,r,n)}return o}return Qc(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var o=this.flatCoordinates,r=t-o[0],a=e-o[1],s=r*r+a*a;if(s<n){if(0===s)for(var l=0;l<this.stride;++l)i[l]=o[l];else{var u=this.getRadius()/Math.sqrt(s);i[0]=o[0]+u*r,i[1]=o[1]+u*a;for(l=2;l<this.stride;++l)i[l]=o[l]}return i.length=this.stride,s}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],o=e-i[1];return n*n+o*o<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return $t(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return kt},e.prototype.intersectsExtent=function(t){if(fe(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||ie(t,this.intersectsCoordinate.bind(this)))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var o=1;o<e;++o)n[e+o]=t[o];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,o=wn(n,0,t,this.stride);n[o++]=n[0]+e;for(var r=1,a=this.stride;r<a;++r)n[o++]=n[r];n.length=o,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(Zi(i,0,i.length,n,t,e,i)),this.changed()},e.prototype.translate=function(t,e){var i=this.getCenter(),n=this.getStride();this.setCenter(Ji(i,0,i.length,n,t,e,i)),this.changed()},e}(fn);th.prototype.transform;var eh=th,ih=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nh="Point",oh="LineString",rh="Polygon",ah="Circle",sh="drawstart",lh="drawend",uh="drawabort",ch=function(t){function e(e,i){var n=t.call(this,e)||this;return n.feature=i,n}return ih(e,t),e}(Ti);function hh(t,e){return function(i,n,o){var r=ii(i[0],o),a=ii(i[1],o),s=Math.sqrt(Tu(r,a)),l=n||uo(new eh(r),t),u=e;if(!e){var c=a[0]-r[0],h=a[1]-r[1];u=Math.atan(h/c)-(c<0?Math.PI:0)}co(l,r,s,u);var d=ti();return d&&l.transform(o,d),l}}function dh(){return function(t,e,i){var n=jt(t.map((function(t){return ii(t,i)}))),o=[[oe(n),re(n),de(n),he(n),oe(n)]],r=e;r?r.setCoordinates(o):r=new so(o);var a=ti();return a&&r.transform(i,a),r}}var ph=function(t){function e(e){var i=this,n=e;n.stopDown||(n.stopDown=Si),(i=t.call(this,n)||this).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=e.source?e.source:null,i.features_=e.features?e.features:null,i.snapTolerance_=e.snapTolerance?e.snapTolerance:12,i.type_=e.type,i.mode_=function(t){var e;t===vt||t===_t?e=nh:t===yt||t===xt?e=oh:t===wt||t===Ct?e=rh:t===kt&&(e=ah);return e}(i.type_),i.stopClick_=!!e.stopClick,i.minPoints_=e.minPoints?e.minPoints:i.mode_===rh?3:2,i.maxPoints_=e.maxPoints?e.maxPoints:1/0,i.finishCondition_=e.finishCondition?e.finishCondition:ki;var o,r=e.geometryFunction;if(!r)if(i.type_===kt)r=function(t,e,i){var n=e||new eh([NaN,NaN]),o=ii(t[0],i),r=Tu(o,ii(t[1],i));n.setCenterAndRadius(o,Math.sqrt(r));var a=ti();return a&&n.transform(i,a),n};else{var a,s=i.mode_;s===nh?a=qn:s===oh?a=Bn:s===rh&&(a=so),r=function(t,e,i){var n=e;return n?s===rh?t[0].length?n.setCoordinates([t[0].concat([t[0][0]])]):n.setCoordinates([]):n.setCoordinates(t):n=new a(t),n}}return i.geometryFunction_=r,i.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,i.overlay_=new Hu({source:new za({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:(o=ol(),function(t,e){return o[t.getGeometry().getType()]}),updateWhileInteracting:!0}),i.geometryName_=e.geometryName,i.condition_=e.condition?e.condition:ic,i.freehandCondition_,e.freehand?i.freehandCondition_=Qu:i.freehandCondition_=e.freehandCondition?e.freehandCondition:nc,i.addEventListener(Xi(Wu),i.updateState_),i}return ih(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===Fi&&e.preventDefault(),this.freehand_=this.mode_!==nh&&this.freehandCondition_(e);var i=e.type===Vu.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===Vu.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===Vu.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),n=!1):this.freehand_&&e.type===Vu.POINTERDOWN?n=!1:i?(n=e.type===Vu.POINTERMOVE)&&this.freehand_?n=this.handlePointerMove_(e):("mouse"==e.pointerEvent.pointerType||e.type===Vu.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Vu.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Jc(Vu.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===ah;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate):(this.startDrawing_(t),this.mode_===nh&&this.finishDrawing()),e=!1):this.freehand_&&this.abortDrawing(),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],o=e[1]-i[1],r=n*n+o*o;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_];if(this.mode_===oh)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===rh){var o=this.sketchCoords_;i=o[0].length>this.minPoints_,n=[o[0][0],o[0][o[0].length-2]]}if(i)for(var r=t.map,a=0,s=n.length;a<s;a++){var l=n[a],u=r.getPixelFromCoordinate(l),c=t.pixel,h=c[0]-u[0],d=c[1]-u[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(h*h+d*d)<=p){this.finishCoordinate_=l;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ko(new qn(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate,i=t.map.getView().getProjection();this.finishCoordinate_=e,this.mode_===nh?this.sketchCoords_=e.slice():this.mode_===rh?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ko(new Bn(this.sketchLineCoords_)));var n=this.geometryFunction_(this.sketchCoords_,void 0,i);this.sketchFeature_=new ko,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new ch(sh,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,n,o=t.coordinate,r=this.sketchFeature_.getGeometry(),a=t.map.getView().getProjection();(this.mode_===nh?i=this.sketchCoords_:this.mode_===rh?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(o=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=o[0],i[1]=o[1],this.geometryFunction_(this.sketchCoords_,r,a),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(o);if(r.getType()==wt&&this.mode_!==rh){this.sketchLine_||(this.sketchLine_=new ko);var s=r.getLinearRing(0);(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(s.getLayout(),s.getFlatCoordinates()),n.changed()):(n=new Bn(s.getFlatCoordinates(),s.getLayout()),this.sketchLine_.setGeometry(n))}else this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection();this.mode_===oh?(this.finishCoordinate_=t.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),this.geometryFunction_(i,n,o)):this.mode_===rh&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,n,o)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();this.mode_===oh?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e,i),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===rh&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)),0===t.length&&this.abortDrawing(),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry(),n=this.getMap().getView().getProjection();this.mode_===oh?(e.pop(),this.geometryFunction_(e,i,n)):this.mode_===rh&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),this.type_===_t?t.setGeometry(new Yn([e])):this.type_===xt?t.setGeometry(new Vn([e])):this.type_===Ct&&t.setGeometry(new fo([e])),this.dispatchEvent(new ch(lh,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t},e.prototype.abortDrawing=function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new ch(uh,t))},e.prototype.appendCoordinates=function(t){var e=this.mode_,i=[];e===oh?i=this.sketchCoords_:e===rh&&(i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var n=i.pop(),o=0;o<t.length;o++)this.addToDrawing_(t[o]);this.addToDrawing_(n)},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new ch(sh,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)},e}(uc),fh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gh=[0,0,0,0],mh=[],vh="modifystart",yh="modifyend",bh=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.features=i,o.mapBrowserEvent=n,o}return fh(e,t),e}(Ti);function wh(t,e){return t.index-e.index}function _h(t,e,i){var n=e.geometry;if(n.getType()===kt){var o=n;if(1===e.index){var r=ti();r&&(o=o.clone().transform(r,i));var a=Tu(o.getCenter(),ii(t,i)),s=Math.sqrt(a)-o.getRadius();return s*s}}var l=ii(t,i);return mh[0]=ii(e.segment[0],i),mh[1]=ii(e.segment[1],i),function(t,e){return Tu(t,ku(t,e))}(l,mh)}function xh(t,e,i){var n=e.geometry;if(n.getType()===kt&&1===e.index){var o=n,r=ti();return r&&(o=o.clone().transform(r,i)),ei(o.getClosestPoint(ii(t,i)),i)}var a=ii(t,i);return mh[0]=ii(e.segment[0],i),mh[1]=ii(e.segment[1],i),ei(ku(a,mh),i)}var Ch=function(t){function e(e){var i,n,o=t.call(this,e)||this;if(o.boundHandleFeatureChange_=o.handleFeatureChange_.bind(o),o.condition_=e.condition?e.condition:ac,o.defaultDeleteCondition_=function(t){return function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&function(t){return t.type==Vu.SINGLECLICK}(t)},o.deleteCondition_=e.deleteCondition?e.deleteCondition:o.defaultDeleteCondition_,o.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Qu,o.vertexFeature_=null,o.vertexSegments_=null,o.lastPixel_=[0,0],o.ignoreNextSingleClick_=!1,o.modified_=!1,o.rBush_=new Aa,o.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,o.snappedToVertex_=!1,o.changingFeature_=!1,o.dragSegments_=[],o.overlay_=new Hu({source:new za({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:(i=ol(),function(t,e){return i[vt]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),o.SEGMENT_WRITERS_={Point:o.writePointGeometry_.bind(o),LineString:o.writeLineStringGeometry_.bind(o),LinearRing:o.writeLineStringGeometry_.bind(o),Polygon:o.writePolygonGeometry_.bind(o),MultiPoint:o.writeMultiPointGeometry_.bind(o),MultiLineString:o.writeMultiLineStringGeometry_.bind(o),MultiPolygon:o.writeMultiPolygonGeometry_.bind(o),Circle:o.writeCircleGeometry_.bind(o),GeometryCollection:o.writeGeometryCollectionGeometry_.bind(o)},o.source_=null,e.source?(o.source_=e.source,n=new Sa(o.source_.getFeatures()),o.source_.addEventListener(Ra,o.handleSourceAdd_.bind(o)),o.source_.addEventListener(La,o.handleSourceRemove_.bind(o))):n=e.features,!n)throw new Error("The modify interaction requires features or a source");return o.features_=n,o.features_.forEach(o.addFeature_.bind(o)),o.features_.addEventListener(_a,o.handleFeatureAdd_.bind(o)),o.features_.addEventListener(xa,o.handleFeatureRemove_.bind(o)),o.lastPointerEvent_=null,o}return fh(e,t),e.prototype.addFeature_=function(t){var e=t.getGeometry();if(e){var i=this.SEGMENT_WRITERS_[e.getType()];i&&i(t,e)}var n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener(Di,this.boundHandleFeatureChange_)},e.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new bh(vh,this.features_,t)))},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(Di,this.boundHandleFeatureChange_)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach((function(e){t===e.feature&&i.push(e)}));for(var n=i.length-1;n>=0;--n){for(var o=i[n],r=this.dragSegments_.length-1;r>=0;--r)this.dragSegments_[r][0]===o&&this.dragSegments_.splice(r,1);e.remove(o)}},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n){var r=i[n],a={feature:t,geometry:e,depth:[n],index:n,segment:[r,r]};this.rBush_.insert(e.getExtent(),a)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length-1;n<o;++n){var r=i.slice(n,n+2),a={feature:t,geometry:e,index:n,segment:r};this.rBush_.insert(jt(r),a)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],a=0,s=r.length-1;a<s;++a){var l=r.slice(a,a+2),u={feature:t,geometry:e,depth:[n],index:a,segment:l};this.rBush_.insert(jt(l),u)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],a=0,s=r.length-1;a<s;++a){var l=r.slice(a,a+2),u={feature:t,geometry:e,depth:[n],index:a,segment:l};this.rBush_.insert(jt(l),u)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,o=i.length;n<o;++n)for(var r=i[n],a=0,s=r.length;a<s;++a)for(var l=r[a],u=0,c=l.length-1;u<c;++u){var h=l.slice(u,u+2),d={feature:t,geometry:e,depth:[a,n],index:u,segment:h};this.rBush_.insert(jt(h),d)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},o={feature:t,geometry:e,index:1,segment:[i,i]},r=[n,o];n.featureSegments=r,o.featureSegments=r,this.rBush_.insert(Xt(i),n);var a=e,s=ti();if(s&&this.getMap()){var l=this.getMap().getView().getProjection();a=uo(a=a.clone().transform(s,l)).transform(l,s)}this.rBush_.insert(a.getExtent(),o)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n){var o=i[n];(0,this.SEGMENT_WRITERS_[o.getType()])(t,o)}},e.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new ko(new qn(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Vu.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=Vu.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Vu.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,n=this.dragSegments_.length;i<n;++i){for(var o=this.dragSegments_[i],r=o[0],a=r.depth,s=r.geometry,l=void 0,u=r.segment,c=o[1];e.length<s.getStride();)e.push(u[c][e.length]);switch(s.getType()){case vt:l=e,u[0]=e,u[1]=e;break;case _t:(l=s.getCoordinates())[r.index]=e,u[0]=e,u[1]=e;break;case yt:(l=s.getCoordinates())[r.index+c]=e,u[c]=e;break;case xt:case wt:(l=s.getCoordinates())[a[0]][r.index+c]=e,u[c]=e;break;case Ct:(l=s.getCoordinates())[a[1]][a[0]][r.index+c]=e,u[c]=e;break;case kt:if(u[0]=e,u[1]=e,0===r.index)this.changingFeature_=!0,s.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;var h=t.map.getView().getProjection(),d=Ru(ii(s.getCenter(),h),ii(e,h)),p=ti();if(p){var f=s.clone().transform(p,h);f.setRadius(d),d=f.transform(h,p).getRadius()}s.setRadius(d),this.changingFeature_=!1}}l&&this.setGeometryCoordinates_(s,l)}this.createOrUpdateVertexFeature_(e)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var n=t.map.getView().getProjection(),o=[],r=i.getGeometry().getCoordinates(),a=jt([r]),s=this.rBush_.getInExtent(a),l={};s.sort(wh);for(var u=0,c=s.length;u<c;++u){var h=s[u],d=h.segment,p=Q(h.feature),f=h.depth;if(f&&(p+="-"+f.join("-")),l[p]||(l[p]=new Array(2)),h.geometry.getType()!==kt||1!==h.index)if(!Su(d[0],r)||l[p][0])if(!Su(d[1],r)||l[p][1])Q(d)in this.vertexSegments_&&!l[p][0]&&!l[p][1]&&this.insertVertexCondition_(t)&&o.push([h,r]);else{if((h.geometry.getType()===yt||h.geometry.getType()===xt)&&l[p][0]&&0===l[p][0].index)continue;this.dragSegments_.push([h,1]),l[p][1]=h}else this.dragSegments_.push([h,0]),l[p][0]=h;else Su(xh(e,h,n),r)&&!l[p][0]&&(this.dragSegments_.push([h,0]),l[p][0]=h)}o.length&&this.willModifyFeatures_(t);for(var g=o.length-1;g>=0;--g)this.insertVertex_.apply(this,o[g])}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],n=i.geometry;if(n.getType()===kt){var o=n.getCenter(),r=i.featureSegments[0],a=i.featureSegments[1];r.segment[0]=o,r.segment[1]=o,a.segment[0]=o,a.segment[1]=o,this.rBush_.update(Xt(o),r);var s=n,l=ti();if(l){var u=t.map.getView().getProjection();s=uo(s=s.clone().transform(l,u)).transform(u,l)}this.rBush_.update(s.getExtent(),a)}else this.rBush_.update(jt(i.segment),i)}return this.modified_&&(this.dispatchEvent(new bh(yh,this.features_,t)),this.modified_=!1),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)},e.prototype.handlePointerAtPixel_=function(t,e,i){var n=i||e.getCoordinateFromPixel(t),o=e.getView().getProjection(),r=ni(zt(oi(Xt(n,gh),o),e.getView().getResolution()*this.pixelTolerance_,gh),o),a=this.rBush_.getInExtent(r);if(a.length>0){a.sort((function(t,e){return _h(n,t,o)-_h(n,e,o)}));var s=a[0],l=s.segment,u=xh(n,s,o),c=e.getPixelFromCoordinate(u),h=Ru(t,c);if(h<=this.pixelTolerance_){var d={};if(s.geometry.getType()===kt&&1===s.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{var p=e.getPixelFromCoordinate(l[0]),f=e.getPixelFromCoordinate(l[1]),g=Tu(c,p),m=Tu(c,f);h=Math.sqrt(Math.min(g,m)),this.snappedToVertex_=h<=this.pixelTolerance_,this.snappedToVertex_&&(u=g>m?l[1]:l[0]),this.createOrUpdateVertexFeature_(u);for(var v=1,y=a.length;v<y;++v){var b=a[v].segment;if(!(Su(l[0],b[0])&&Su(l[1],b[1])||Su(l[0],b[1])&&Su(l[1],b[0])))break;d[Q(b)]=!0}}return d[Q(l)]=!0,void(this.vertexSegments_=d)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,o=t.feature,r=t.geometry,a=t.depth,s=t.index;e.length<r.getStride();)e.push(0);switch(r.getType()){case xt:case wt:(i=r.getCoordinates())[a[0]].splice(s+1,0,e);break;case Ct:(i=r.getCoordinates())[a[1]][a[0]].splice(s+1,0,e);break;case yt:(i=r.getCoordinates()).splice(s+1,0,e);break;default:return}this.setGeometryCoordinates_(r,i);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(r,s,a,1);var u={segment:[n[0],e],feature:o,geometry:r,depth:a,index:s};l.insert(jt(u.segment),u),this.dragSegments_.push([u,1]);var c={segment:[e,n[1]],feature:o,geometry:r,depth:a,index:s+1};l.insert(jt(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Vu.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t);var e=this.removeVertex_();return this.dispatchEvent(new bh(yh,this.features_,t)),this.modified_=!1,e}return!1},e.prototype.removeVertex_=function(){var t,e,i,n,o,r,a,s,l,u,c,h=this.dragSegments_,d={},p=!1;for(o=h.length-1;o>=0;--o)c=Q((u=(i=h[o])[0]).feature),u.depth&&(c+="-"+u.depth.join("-")),c in d||(d[c]={}),0===i[1]?(d[c].right=u,d[c].index=u.index):1==i[1]&&(d[c].left=u,d[c].index=u.index+1);for(c in d){switch(l=d[c].right,a=d[c].left,(s=(r=d[c].index)-1)<0&&(s=0),t=e=(n=(u=void 0!==a?a:l).geometry).getCoordinates(),p=!1,n.getType()){case xt:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(r,1),p=!0);break;case yt:e.length>2&&(e.splice(r,1),p=!0);break;case Ct:t=t[u.depth[1]];case wt:(t=t[u.depth[0]]).length>4&&(r==t.length-1&&(r=0),t.splice(r,1),p=!0,0===r&&(t.pop(),t.push(t[0]),s=t.length-1))}if(p){this.setGeometryCoordinates_(n,e);var f=[];if(void 0!==a&&(this.rBush_.remove(a),f.push(a.segment[0])),void 0!==l&&(this.rBush_.remove(l),f.push(l.segment[1])),void 0!==a&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:s,segment:f};this.rBush_.insert(jt(g.segment),g)}this.updateSegmentIndices_(n,r,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),h.length=0}}return p},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),(function(o){o.geometry===t&&(void 0===i||void 0===o.depth||bi(o.depth,i))&&o.index>e&&(o.index+=n)}))},e}(uc),Eh=(i(143),"pointermove"),kh="pointerdown",Sh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mh=function(t){function e(e,i){var n=t.call(this,e)||this;n.map_=e,n.clickTimeoutId_,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=i?i*Zo:Zo,n.down_=null;var o=n.map_.getViewport();return n.activePointers_=0,n.trackedTouches_={},n.element_=o,n.pointerdownListenerKey_=_i(o,kh,n.handlePointerDown_,n),n.originalPointerMoveEvent_,n.relayedListenerKey_=_i(o,Eh,n.relayEvent_,n),n.boundHandleTouchMove_=n.handleTouchMove_.bind(n),n.element_.addEventListener(Hi,n.boundHandleTouchMove_,!!tr&&{passive:!1}),n}return Sh(e,t),e.prototype.emulateClick_=function(t){var e=new Jc(Vu.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Jc(Vu.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Jc(Vu.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Vu.POINTERUP||e.type==Vu.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Vu.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Jc(Vu.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(Ci),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Jc(Vu.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(_i(document,Vu.POINTERMOVE,this.handlePointerMove_,this),_i(document,Vu.POINTERUP,this.handlePointerUp_,this),_i(this.element_,Vu.POINTERCANCEL,this.handlePointerUp_,this))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Jc(Vu.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Jc(t.type,this.map_,t,e))},e.prototype.handleTouchMove_=function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Ci(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Hi,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ci(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ci),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(Pi),Th="postrender",Rh="movestart",Ph="moveend",Dh="layergroup",Lh="size",Fh="target",Oh="view",Ah=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,st(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){nt(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,o=e[t],r=i[t],a=t;t<n>>1;){var s=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&i[l]<i[s]?l:s;e[t]=e[u],i[t]=i[u],t=u}e[t]=o,i[t]=r,this.siftDown_(a,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,o=i[e],r=n[e];e>t;){var a=this.getParentIndex_(e);if(!(n[a]>r))break;i[e]=i[a],n[e]=n[a],e=a}i[e]=o,n[e]=r},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,o=this.elements_,r=this.priorities_,a=0,s=o.length;for(e=0;e<s;++e)(i=n(t=o[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(r[a]=i,o[a++]=t);o.length=a,r.length=a,this.heapify_()},t}(),Ih=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jh=function(t){function e(e,i){var n=t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=i,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return Ih(e,t),e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&e[0].addEventListener(Di,this.boundHandleTileChange_);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(e.hifi&&i===zo||i===No||i===Ho){e.removeEventListener(Di,this.boundHandleTileChange_);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,o=0;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=(i=this.dequeue()[0]).getKey(),i.getState()!==Io||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++o,i.load())},e}(Ah);function zh(t,e,i){return function(n,o,r,a){if(n){var s=e?0:r[0]*o,l=e?0:r[1]*o,u=t[0]+s/2,c=t[2]-s/2,h=t[1]+l/2,d=t[3]-l/2;u>c&&(c=u=(c+u)/2),h>d&&(d=h=(d+h)/2);var p=ct(n[0],u,c),f=ct(n[1],h,d),g=30*o;return a&&i&&(p+=-g*Math.log(1+Math.max(0,u-n[0])/g)+g*Math.log(1+Math.max(0,n[0]-c)/g),f+=-g*Math.log(1+Math.max(0,h-n[1])/g)+g*Math.log(1+Math.max(0,n[1]-d)/g)),[p,f]}}}function Nh(t){return t}function Hh(t,e,i,n){var o=pe(e)/i[0],r=ue(e)/i[1];return n?Math.min(t,Math.max(o,r)):Math.min(t,Math.min(o,r))}function Bh(t,e,i){var n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),ct(n,i/2,2*e)}function Gh(t,e,i,n,o){return function(r,a,s,l){if(void 0!==r){var u=n?Hh(t,n,s,o):t;return(void 0===i||i)&&l?Bh(r,u,e):ct(r,e,u)}}}var Vh="center",Wh="resolution",qh="rotation",$h=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function Yh(t,e){setTimeout((function(){t(e)}),0)}function Xh(t){return!(t.sourceCenter&&t.targetCenter&&!Su(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}var Uh=function(t){function e(e){var i=t.call(this)||this,n=at({},e);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=Ve(n.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.targetResolution_,i.targetRotation_,i.cancelAnchor_=void 0,n.center&&(n.center=ii(n.center,i.projection_)),n.extent&&(n.extent=oi(n.extent,i.projection_)),i.applyOptions_(n),i}return $h(e,t),e.prototype.applyOptions_=function(t){var e=function(t){var e,i,n,o=void 0!==t.minZoom?t.minZoom:0,r=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,c=Ve(t.projection,"EPSG:3857"),h=c.getExtent(),d=t.constrainOnlyCenter,p=t.extent;s||p||!c.isGlobal()||(d=!1,p=h);if(void 0!==t.resolutions){var f=t.resolutions;i=f[o],n=void 0!==f[r]?f[r]:f[f.length-1],e=t.constrainResolution?function(t,e,i,n){return function(o,r,a,s){if(void 0!==o){var l=t[0],u=t[t.length-1],c=i?Hh(l,i,a,n):l;if(s)return void 0===e||e?Bh(o,c,u):ct(o,u,c);var h=Math.min(c,o),d=Math.floor(mi(t,h,r));return t[d]>c&&d<t.length-1?t[d+1]:t[d]}}}(f,l,!d&&p,u):Gh(i,n,l,!d&&p,u)}else{var g=(h?Math.max(pe(h),ue(h)):360*ye[be.DEGREES]/c.getMetersPerUnit())/256/Math.pow(2,0),m=g/Math.pow(2,28);void 0!==(i=t.maxResolution)?o=0:i=g/Math.pow(a,o),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(a,r):g/Math.pow(a,r):m),r=o+Math.floor(Math.log(i/n)/Math.log(a)),n=i/Math.pow(a,r-o),e=t.constrainResolution?function(t,e,i,n,o,r){return function(a,s,l,u){if(void 0!==a){var c=o?Hh(e,o,l,r):e,h=void 0!==i?i:0;if(u)return void 0===n||n?Bh(a,c,h):ct(a,h,c);var d=Math.ceil(Math.log(e/c)/Math.log(t)-1e-9),p=-s*(.5-1e-9)+.5,f=Math.min(c,a),g=Math.floor(Math.log(e/f)/Math.log(t)+p),m=Math.max(d,g);return ct(e/Math.pow(t,m),h,c)}}}(a,i,n,l,!d&&p,u):Gh(i,n,l,!d&&p,u)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:o,zoomFactor:a}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var i=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return zh(t.extent,t.constrainOnlyCenter,e)}var i=Ve(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal()){var n=i.getExtent().slice();return n[0]=-1/0,n[2]=1/0,zh(n,!1,!1)}return Nh}(t),n=e.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(r=o||ft(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=r?0:t:void 0}):!1===e?fc:"number"==typeof e?(i=e,n=2*Math.PI/i,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):fc}return pc;var i,n;var o,r}(t);this.constraints_={center:i,resolution:n,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=at({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),at({},e,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),i=0;i<e.length;++i){var n=arguments[i];n.center&&((n=at({},n)).center=ii(n.center,this.getProjection())),n.anchor&&((n=at({},n)).anchor=ii(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)},e.prototype.animateInternal=function(t){var e,i=arguments.length;if(i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i),!this.isDef()){var n=arguments[i-1];return n.center&&this.setCenterInternal(n.center),void 0!==n.zoom&&this.setZoom(n.zoom),void 0!==n.rotation&&this.setRotation(n.rotation),void(e&&Yh(e,!0))}for(var o=Date.now(),r=this.targetCenter_.slice(),a=this.targetResolution_,s=this.targetRotation_,l=[],u=0;u<i;++u){var c=arguments[u],h={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||Vo,callback:e};if(c.center&&(h.sourceCenter=r,h.targetCenter=c.center.slice(),r=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(c.zoom),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),void 0!==c.rotation){h.sourceRotation=s;var d=gt(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=s+d,s=h.targetRotation}Xh(h)?h.complete=!0:o+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(pl,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[pl]>0},e.prototype.getInteracting=function(){return this.hints_[fl]>0},e.prototype.cancelAnimations=function(){var t;this.setHint(pl,-this.hints_[pl]);for(var e=0,i=this.animations_.length;e<i;++e){var n=this.animations_[e];if(n[0].callback&&Yh(n[0].callback,!1),!t)for(var o=0,r=n.length;o<r;++o){var a=n[o];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],o=!0,r=0,a=n.length;r<a;++r){var s=n[r];if(!s.complete){var l=t-s.start,u=s.duration>0?l/s.duration:1;u>=1?(s.complete=!0,u=1):o=!1;var c=s.easing(u);if(s.sourceCenter){var h=s.sourceCenter[0],d=s.sourceCenter[1],p=h+c*(s.targetCenter[0]-h),f=d+c*(s.targetCenter[1]-d);this.targetCenter_=[p,f]}if(s.sourceResolution&&s.targetResolution){var g=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);if(s.anchor){var m=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(g,0,m,!0);this.targetCenter_=this.calculateCenterZoom(v,s.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var y=1===c?gt(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);if(s.anchor){var b=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(b,s.anchor)}this.targetRotation_=y}if(this.applyTargetState_(!0),e=!0,!s.complete)break}}if(o){this.animations_[i]=null,this.setHint(pl,-1);var w=n[0].callback;w&&Yh(w,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,e){var i,n,o,r=this.getCenterInternal();return void 0!==r&&(Mu(i=[r[0]-e[0],r[1]-e[1]],t-this.getRotation()),o=e,(n=i)[0]+=+o[0],n[1]+=+o[1]),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenterInternal(),o=this.getResolution();void 0!==n&&void 0!==o&&(i=[e[0]-t*(e[0]-n[0])/o,e[1]-t*(e[1]-n[1])/o]);return i},e.prototype.getViewportSize_=function(t){var e=this.viewportSize_;if(t){var i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t?ei(t,this.getProjection()):t},e.prototype.getCenterInternal=function(){return this.get(Vh)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){return ni(this.calculateExtentInternal(t),this.getProjection())},e.prototype.calculateExtentInternal=function(t){var e=t||this.getViewportSize_(),i=this.getCenterInternal();nt(i,1);var n=this.getResolution();nt(void 0!==n,2);var o=this.getRotation();return nt(void 0!==o,3),le(i,n,o,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Wh)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){return this.getResolutionForExtentInternal(oi(t,this.getProjection()),e)},e.prototype.getResolutionForExtentInternal=function(t,e){var i=e||this.getViewportSize_(),n=pe(t)/i[0],o=ue(t)/i[1];return Math.max(n,o)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,o=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*o)}},e.prototype.getRotation=function(){return this.get(qh)},e.prototype.getValueForResolutionFunction=function(t){var e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,o=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/o}},e.prototype.getState=function(){var t=this.getCenterInternal(),e=this.getProjection(),i=this.getResolution(),n=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:i,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var o=mi(this.resolutions_,t,1);n=o,e=this.resolutions_[o],i=o==this.resolutions_.length-1?2:e/this.resolutions_[o+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=ct(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,ct(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,e){var i,n=at({size:this.getViewportSize_()},e||{});if(nt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))nt(!ge(t),25),i=lo(o=oi(t,this.getProjection()));else if(t.getType()===kt){var o;(i=lo(o=oi(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),ae(o))}else{var r=ti();i=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(i,n)},e.prototype.fitInternal=function(t,e){var i=e||{},n=i.size;n||(n=this.getViewportSize_());var o,r=void 0!==i.padding?i.padding:[0,0,0,0],a=void 0!==i.nearest&&i.nearest;o=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;for(var s=t.getFlatCoordinates(),l=this.getRotation(),u=Math.cos(-l),c=Math.sin(-l),h=1/0,d=1/0,p=-1/0,f=-1/0,g=t.getStride(),m=0,v=s.length;m<v;m+=g){var y=s[m]*u-s[m+1]*c,b=s[m]*c+s[m+1]*u;h=Math.min(h,y),d=Math.min(d,b),p=Math.max(p,y),f=Math.max(f,b)}var w=this.getResolutionForExtentInternal([h,d,p,f],[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);w=isNaN(w)?o:Math.max(w,o),w=this.getConstrainedResolution(w,a?0:1),c=-c;var _=(h+p)/2,x=(d+f)/2,C=[(_+=(r[1]-r[3])/2*w)*u-(x+=(r[0]-r[2])/2*w)*c,x*u+_*c],E=i.callback?i.callback:Mi;void 0!==i.duration?this.animateInternal({resolution:w,center:this.getConstrainedCenter(C,w),duration:i.duration,easing:i.easing},E):(this.targetResolution_=w,this.targetCenter_=C,this.applyTargetState_(!1,!0),Yh(E,!0))},e.prototype.centerOn=function(t,e,i){this.centerOnInternal(ii(t,this.getProjection()),e,i)},e.prototype.centerOnInternal=function(t,e,i){var n=this.getRotation(),o=Math.cos(-n),r=Math.sin(-n),a=t[0]*o-t[1]*r,s=t[1]*o+t[0]*r,l=this.getResolution(),u=(a+=(e[0]/2-i[0])*l)*o-(s+=(i[1]-e[1]/2)*l)*(r=-r),c=s*o+a*r;this.setCenterInternal([u,c])},e.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},e.prototype.adjustCenter=function(t){var e=ei(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])},e.prototype.adjustResolution=function(t,e){var i=e&&ii(e,this.getProjection());this.adjustResolutionInternal(t,i)},e.prototype.adjustResolutionInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)},e.prototype.adjustRotation=function(t,e){e&&(e=ii(e,this.getProjection())),this.adjustRotationInternal(t,e)},e.prototype.adjustRotationInternal=function(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(ii(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,e){var i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),o=this.getViewportSize_(n),r=this.constraints_.resolution(this.targetResolution_,0,o,i),a=this.constraints_.center(this.targetCenter_,r,o,i);this.get(qh)!==n&&this.set(qh,n),this.get(Wh)!==r&&this.set(Wh,r),this.get(Vh)&&Su(this.get(Vh),a)||this.set(Vh,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,e,i){var n=void 0!==t?t:200,o=e||0,r=this.constraints_.rotation(this.targetRotation_),a=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,o,a),l=this.constraints_.center(this.targetCenter_,s,a);if(0===n&&!this.cancelAnchor_)return this.targetResolution_=s,this.targetRotation_=r,this.targetCenter_=l,void this.applyTargetState_();var u=i||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===s&&this.getRotation()===r&&this.getCenterInternal()&&Su(this.getCenterInternal(),l)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:s,duration:n,easing:Go,anchor:u}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(fl,1)},e.prototype.endInteraction=function(t,e,i){var n=i&&ii(i,this.getProjection());this.endInteractionInternal(t,e,n)},e.prototype.endInteractionInternal=function(t,e,i){this.setHint(fl,-1),this.resolveConstraints(t,e,i)},e.prototype.getConstrainedCenter=function(t,e){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)},e.prototype.getConstrainedZoom=function(t,e){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))},e.prototype.getConstrainedResolution=function(t,e){var i=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)},e}(Ui),Kh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zh="layers",Jh=function(t){function e(e){var i=this,n=e||{},o=at({},n);delete o.layers;var r=n.layers;return(i=t.call(this,o)||this).layersListenerKeys_=[],i.listenerKeys_={},i.addEventListener(Xi(Zh),i.handleLayersChanged_),r?Array.isArray(r)?r=new Sa(r.slice(),{unique:!0}):nt("function"==typeof r.getArray,43):r=new Sa(void 0,{unique:!0}),i.setLayers(r),i}return Kh(e,t),e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Ci),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(_i(t,_a,this.handleLayersAdd_,this),_i(t,xa,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(Ci);st(this.listenerKeys_);for(var i=t.getArray(),n=0,o=i.length;n<o;n++){var r=i[n];this.listenerKeys_[Q(r)]=[_i(r,wi,this.handleLayerChange_,this),_i(r,Di,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[Q(e)]=[_i(e,wi,this.handleLayerChange_,this),_i(e,Di,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=Q(t.element);this.listenerKeys_[e].forEach(Ci),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(Zh)},e.prototype.setLayers=function(t){this.set(Zh,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),o=i,r=e.length;o<r;o++){var a=e[o];a.opacity*=n.opacity,a.visible=a.visible&&n.visible,a.maxResolution=Math.min(a.maxResolution,n.maxResolution),a.minResolution=Math.max(a.minResolution,n.minResolution),a.minZoom=Math.max(a.minZoom,n.minZoom),a.maxZoom=Math.min(a.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==a.extent?a.extent=ce(a.extent,n.extent):a.extent=n.extent)}return e},e.prototype.getSourceState=function(){return Or},e}(Ua),Qh=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();var td=function(t){function e(e){var i=t.call(this)||this,n=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,o,r={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Jh({layers:t.layers});r[Dh]=a,r[Fh]=t.target,r[Oh]=void 0!==t.view?t.view:new Uh,void 0!==t.controls&&(Array.isArray(t.controls)?i=new Sa(t.controls.slice()):(nt("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new Sa(t.interactions.slice()):(nt("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?o=new Sa(t.overlays.slice()):(nt("function"==typeof t.overlays.getArray,49),o=t.overlays):o=new Sa;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:o,values:r}}(e);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i),i.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,i.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:Zo,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(i),i.coordinateToPixelTransform_=[1,0,0,1,0,0],i.pixelToCoordinateTransform_=[1,0,0,1,0,0],i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=new Mh(i,e.moveTolerance);var o=i.handleMapBrowserEvent.bind(i);for(var r in Vu)i.mapBrowserEventHandler_.addEventListener(Vu[r],o);i.keyboardEventTarget_=n.keyboardEventTarget,i.keyHandlerKeys_=null;var a=i.handleBrowserEvent.bind(i);return i.viewport_.addEventListener(Fi,a,!1),i.viewport_.addEventListener(Bi,a,!!tr&&{passive:!1}),i.controls=n.controls||new Sa,i.interactions=n.interactions||new Sa,i.overlays_=n.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new jh(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addEventListener(Xi(Dh),i.handleLayerGroupChanged_),i.addEventListener(Xi(Oh),i.handleViewChanged_),i.addEventListener(Xi(Lh),i.handleSizeChanged_),i.addEventListener(Xi(Fh),i.handleTargetChanged_),i.setProperties(n.values),i.controls.forEach(function(t){t.setMap(this)}.bind(i)),i.controls.addEventListener(_a,function(t){t.element.setMap(this)}.bind(i)),i.controls.addEventListener(xa,function(t){t.element.setMap(null)}.bind(i)),i.interactions.forEach(function(t){t.setMap(this)}.bind(i)),i.interactions.addEventListener(_a,function(t){t.element.setMap(this)}.bind(i)),i.interactions.addEventListener(xa,function(t){t.element.setMap(null)}.bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i.overlays_.addEventListener(_a,function(t){this.addOverlayInternal_(t.element)}.bind(i)),i.overlays_.addEventListener(xa,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(i)),i}return Qh(e,t),e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(Fi,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Bi,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(Ni,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixelInternal(t),o=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,r=void 0!==i.layerFilter?i.layerFilter:ki,a=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,o,a,e,null,r,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},o=void 0!==n.hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,r=n.layerFilter||ki;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,o,e,r)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:ki,o=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,r=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,o,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(Fh)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return ei(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var e=this.frameState_;return e?on(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Dh)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer.getSource();if(n&&n.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var e=ii(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)},e.prototype.getPixelFromCoordinateInternal=function(t){var e=this.frameState_;return e?on(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Lh)},e.prototype.getView=function(){return this.get(Oh)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){return function(t,e,i,n,o){if(!t||!(i in t.wantedTiles))return 1/0;if(!t.wantedTiles[i][e.getKey()])return 1/0;var r=t.viewState.center,a=n[0]-r[0],s=n[1]-r[1];return 65536*Math.log(o)+Math.sqrt(a*a+s*s)/o}(this.frameState_,t,e,i,n)},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new Kc(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var e=t.originalEvent.target;if(t.dragging||!this.overlayContainerStopEvent_.contains(e)&&(document.body.contains(e)||this.viewport_.getRootNode&&this.viewport_.getRootNode().contains(e))){t.frameState=this.frameState_;var i=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var n=i.length-1;n>=0;n--){var o=i[n];if(o.getActive())if(!o.handleEvent(t))break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var o=t.viewHints;if(o[pl]||o[fl]){var r=!Qo&&Date.now()-t.time>8;i=r?0:8,n=r?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(ts)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(ts,t);for(var a=this.postRenderFunctions_,s=0,l=a.length;s<l;++s)a[s](this,t);a.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)Ci(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[_i(n,Ii,this.handleBrowserEvent,this),_i(n,ji,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(Ni,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),rr(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(Ni,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Ci(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ci(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=_i(t,wi,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=_i(t,Di,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ci),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[_i(t,wi,this.render,this),_i(t,Di,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,i=t.length;e<i;++e){var n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e=this.getSize(),i=this.getView(),n=this.frameState_,o=null;if(void 0!==e&&function(t){return t[0]>0&&t[1]>0}(e)&&i&&i.isDef()){var r=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:n?n.declutterItems:[],extent:le(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:r,wantedTiles:{}}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),n)(!this.previousExtent_||!ge(this.previousExtent_)&&!Kt(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Xc(Rh,this,n)),this.previousExtent_=Yt(this.previousExtent_));this.previousExtent_&&!o.viewHints[pl]&&!o.viewHints[fl]&&!Kt(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Xc(Ph,this,o)),Nt(o.extent,this.previousExtent_))}this.dispatchEvent(new Xc(Th,this,o)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(Dh,t)},e.prototype.setSize=function(t){this.set(Lh,t)},e.prototype.setTarget=function(t){this.set(Fh,t)},e.prototype.setView=function(t){this.set(Oh,t)},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var e=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}},e}(Ui),ed=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),id=function(t){function e(e){var i=t.call(this)||this;return i.element=e.element?e.element:null,i.target_=null,i.map_=null,i.listenerKeys=[],i.render_=e.render?e.render:Mi,e.target&&i.setTarget(e.target),i}return ed(e,t),e.prototype.disposeInternal=function(){rr(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&rr(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Ci(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Mi&&this.listenerKeys.push(_i(t,Th,this.render,this)),t.render())},e.prototype.render=function(t){this.render_.call(this,t)},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(Ui),nd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function od(t){this.updateElement_(t.frameState)}var rd=function(t){function e(e){var i=this,n=e||{};(i=t.call(this,{element:document.createElement("div"),render:n.render||od,target:n.target})||this).ulElement_=document.createElement("ul"),i.collapsed_=void 0===n.collapsed||n.collapsed,i.overrideCollapsible_=void 0!==n.collapsible,i.collapsible_=void 0===n.collapsible||n.collapsible,i.collapsible_||(i.collapsed_=!1);var o=void 0!==n.className?n.className:"ol-attribution",r=void 0!==n.tipLabel?n.tipLabel:"Attributions",a=void 0!==n.collapseLabel?n.collapseLabel:"";"string"==typeof a?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=a):i.collapseLabel_=a;var s=void 0!==n.label?n.label:"i";"string"==typeof s?(i.label_=document.createElement("span"),i.label_.textContent=s):i.label_=s;var l=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,u=document.createElement("button");u.setAttribute("type","button"),u.title=r,u.appendChild(l),u.addEventListener(Oi,i.handleClick_.bind(i),!1);var c=o+" ol-unselectable ol-control"+(i.collapsed_&&i.collapsible_?" ol-collapsed":"")+(i.collapsible_?"":" ol-uncollapsible"),h=i.element;return h.className=c,h.appendChild(i.ulElement_),h.appendChild(u),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return nd(e,t),e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,o=0,r=n.length;o<r;++o){var a=n[o];if(is(a,t.viewState)){var s=a.layer.getSource();if(s){var l=s.getAttributions();if(l){var u=l(t);if(u)if(this.overrideCollapsible_||!1!==s.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(u))for(var c=0,h=u.length;c<h;++c)u[c]in e||(i.push(u[c]),e[u[c]]=!0);else u in e||(i.push(u),e[u]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!bi(e,this.renderedAttributions_)){ar(this.ulElement_);for(var n=0,o=e.length;n<o;++n){var r=document.createElement("li");r.innerHTML=e[n],this.ulElement_.appendChild(r)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?or(this.collapseLabel_,this.label_):or(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(id),ad=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function sd(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var o=this.element.classList.contains("ol-hidden");o||0!==i?o&&0!==i&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.transform=n}this.rotation_=i}}var ld=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),render:n.render||sd,target:n.target})||this;var o=void 0!==n.className?n.className:"ol-rotate",r=void 0!==n.label?n.label:"";i.label_=null,"string"==typeof r?(i.label_=document.createElement("span"),i.label_.className="ol-compass",i.label_.textContent=r):(i.label_=r,i.label_.classList.add("ol-compass"));var a=n.tipLabel?n.tipLabel:"Reset rotation",s=document.createElement("button");s.className=o+"-reset",s.setAttribute("type","button"),s.title=a,s.appendChild(i.label_),s.addEventListener(Oi,i.handleClick_.bind(i),!1);var l=o+" ol-unselectable ol-control",u=i.element;return u.className=l,u.appendChild(s),i.callResetNorth_=n.resetNorth?n.resetNorth:void 0,i.duration_=void 0!==n.duration?n.duration:250,i.autoHide_=void 0===n.autoHide||n.autoHide,i.rotation_=void 0,i.autoHide_&&i.element.classList.add("ol-hidden"),i}return ad(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Go}):t.setRotation(0))}},e}(id),ud=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cd=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{element:document.createElement("div"),target:n.target})||this;var o=void 0!==n.className?n.className:"ol-zoom",r=void 0!==n.delta?n.delta:1,a=void 0!==n.zoomInLabel?n.zoomInLabel:"+",s=void 0!==n.zoomOutLabel?n.zoomOutLabel:"",l=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",u=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=o+"-in",c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof a?document.createTextNode(a):a),c.addEventListener(Oi,i.handleClick_.bind(i,r),!1);var h=document.createElement("button");h.className=o+"-out",h.setAttribute("type","button"),h.title=u,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(Oi,i.handleClick_.bind(i,-r),!1);var d=o+" ol-unselectable ol-control",p=i.element;return p.className=d,p.appendChild(c),p.appendChild(h),i.duration_=void 0!==n.duration?n.duration:250,i}return ud(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getZoom();if(void 0!==i){var n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Go})):e.setZoom(n)}}},e}(id);function hd(t){var e=t||{},i=new Sa;return(void 0===e.zoom||e.zoom)&&i.push(new cd(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new ld(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new rd(e.attributionOptions)),i}var dd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function pd(t,e){fu.expire()}var fd=function(t){function e(e){var i=t.call(this)||this;return i.map_=e,i.declutterTree_=null,i}return dd(e,t),e.prototype.dispatchRenderEvent=function(t,e){Z()},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;an(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),sn(n,i)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,o,r,a,s){var l,u=e.viewState;function c(t,e,i){return o.call(r,e,t?i:null)}var h=u.projection,d=Pu(t.slice(),h),p=[[0,0]];if(h.canWrapX()&&n){var f=pe(h.getExtent());p.push([-f,0],[f,0])}var g,m=e.layerStatesArray,v=m.length;this.declutterTree_&&(g=this.declutterTree_.all().map((function(t){return t.value})));for(var y=[],b=0;b<p.length;b++)for(var w=v-1;w>=0;--w){var _=m[w],x=_.layer;if(x.hasRenderer()&&is(_,u)&&a.call(s,x)){var C=x.getRenderer(),E=x.getSource();if(C&&E){var k=E.getWrapX()?d:t,S=c.bind(null,_.managed);y[0]=k[0]+p[b][0],y[1]=k[1]+p[b][1],l=C.forEachFeatureAtCoordinate(y,e,i,S,g)}if(l)return l}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){return Z()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,o,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,ki,this,o,r)},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){this.declutterTree_=function(t,e){e&&e.clear();for(var i=t.declutterItems,n=i.length-1;n>=0;--n)for(var o=i[n],r=o.items,a=0,s=r.length;a<s;a+=3)e=r[a].renderDeclutter(r[a+1],r[a+2],o.opacity,e);return i.length=0,e}(t,this.declutterTree_)},e.prototype.scheduleExpireIconCache=function(t){fu.canExpireCache()&&t.postRenderFunctions.push(pd)},e}(Ei),gd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),md=function(t){function e(e){var i=t.call(this,e)||this;i.fontChangeListenerKey_=_i(gs,wi,e.redrawText.bind(e)),i.element_=document.createElement("div");var n=i.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",i.element_.className="ol-unselectable ol-layers";var o=e.getViewport();return o.insertBefore(i.element_,o.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return gd(e,t),e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap();if(i.hasListener(t)){var n=new us(t,void 0,e);i.dispatchEvent(n)}},e.prototype.disposeInternal=function(){Ci(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),t.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(e){if(e){this.calculateMatrices2D(e),this.dispatchRenderEvent(Ja,e);var i=e.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=e.viewState;this.children_.length=0;for(var o=null,r=0,a=i.length;r<a;++r){var s=i[r];if(e.layerIndex=r,is(s,n)&&(s.sourceState==Or||s.sourceState==Fr)){var l=s.layer.render(e,o);l&&l!==o&&(this.children_.push(l),o=l)}}t.prototype.renderFrame.call(this,e),function(t,e){for(var i=t.childNodes,n=0;;++n){var o=i[n],r=e[n];if(!o&&!r)break;o!==r&&(o?r?t.insertBefore(r,o):(t.removeChild(o),--n):t.appendChild(r))}}(this.element_,this.children_),this.dispatchRenderEvent(Qa,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,o){for(var r=e.viewState,a=e.layerStatesArray,s=a.length-1;s>=0;--s){var l=a[s],u=l.layer;if(u.hasRenderer()&&is(l,r)&&o(u)){var c=u.getRenderer().getDataAtPixel(t,e,i);if(c){var h=n(u,c);if(h)return h}}}},e}(fd),vd=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),yd=function(t){function e(e){return(e=at({},e)).controls||(e.controls=hd()),e.interactions||(e.interactions=$c()),t.call(this,e)||this}return vd(e,t),e.prototype.createRenderer=function(){return new md(this)},e}(td),bd="bottom-left",wd="bottom-center",_d="bottom-right",xd="center-left",Cd="center-center",Ed="center-right",kd="top-left",Sd="top-center",Md="top-right",Td=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rd="element",Pd="map",Dd="offset",Ld="position",Fd="positioning",Od=function(t){function e(e){var i=t.call(this)||this;i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container ol-selectable",i.element.style.position="absolute";var n=e.autoPan;return n&&"object"!=typeof n&&(n={animation:e.autoPanAnimation,margin:e.autoPanMargin}),i.autoPan=n||!1,i.rendered={transform_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(Xi(Rd),i.handleElementChanged),i.addEventListener(Xi(Pd),i.handleMapChanged),i.addEventListener(Xi(Dd),i.handleOffsetChanged),i.addEventListener(Xi(Ld),i.handlePositionChanged),i.addEventListener(Xi(Fd),i.handlePositioningChanged),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:kd),void 0!==e.position&&i.setPosition(e.position),i}return Td(e,t),e.prototype.getElement=function(){return this.get(Rd)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(Pd)},e.prototype.getOffset=function(){return this.get(Dd)},e.prototype.getPosition=function(){return this.get(Ld)},e.prototype.getPositioning=function(){return this.get(Fd)},e.prototype.handleElementChanged=function(){ar(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(rr(this.element),Ci(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=_i(t,Th,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(Rd,t)},e.prototype.setMap=function(t){this.set(Pd,t)},e.prototype.setOffset=function(t){this.set(Dd,t)},e.prototype.setPosition=function(t){this.set(Ld,t)},e.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},e.prototype.panIntoView=function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(Ld)){var i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),o=this.getRect(n,[ir(n),nr(n)]),r=void 0===t.margin?20:t.margin;if(!Gt(i,o)){var a=o[0]-i[0],s=i[2]-o[2],l=o[1]-i[1],u=i[3]-o[3],c=[0,0];if(a<0?c[0]=a-r:s<0&&(c[0]=Math.abs(s)+r),l<0?c[1]=l-r:u<0&&(c[1]=Math.abs(u)+r),0!==c[0]||0!==c[1]){var h=e.getView().getCenterInternal(),d=e.getPixelFromCoordinateInternal(h),p=[d[0]+c[0],d[1]+c[1]],f=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(p),duration:f.duration,easing:f.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,o=i.top+window.pageYOffset;return[n,o,n+e[0],o+e[1]]},e.prototype.setPositioning=function(t){this.set(Fd,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),o=this.getPositioning();this.setVisible(!0);var r=Math.round(t[0]+n[0])+"px",a=Math.round(t[1]+n[1])+"px",s="0%",l="0%";o==_d||o==Ed||o==Md?s="-100%":o!=wd&&o!=Cd&&o!=Sd||(s="-50%"),o==bd||o==wd||o==_d?l="-100%":o!=xd&&o!=Cd&&o!=Ed||(l="-50%");var u="translate("+s+", "+l+") translate("+r+", "+a+")";this.rendered.transform_!=u&&(this.rendered.transform_=u,i.transform=u,i.msTransform=u)},e.prototype.getOptions=function(){return this.options},e}(Ui),Ad=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Id="degrees",jd="imperial",zd="nautical",Nd="metric",Hd="us",Bd=[1,2,5];function Gd(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}var Vd=function(t){function e(e){var i=this,n=e||{},o=void 0!==n.className?n.className:n.bar?"ol-scale-bar":"ol-scale-line";return(i=t.call(this,{element:document.createElement("div"),render:n.render||Gd,target:n.target})||this).innerElement_=document.createElement("div"),i.innerElement_.className=o+"-inner",i.element.className=o+" ol-unselectable",i.element.appendChild(i.innerElement_),i.viewState_=null,i.minWidth_=void 0!==n.minWidth?n.minWidth:64,i.renderedVisible_=!1,i.renderedWidth_=void 0,i.renderedHTML_="",i.addEventListener(Xi("units"),i.handleUnitsChanged_),i.setUnits(n.units||Nd),i.scaleBar_=n.bar||!1,i.scaleBarSteps_=n.steps||4,i.scaleBarText_=n.text||!1,i}return Ad(e,t),e.prototype.getUnits=function(){return this.get("units")},e.prototype.handleUnitsChanged_=function(){this.updateElement_()},e.prototype.setUnits=function(t){this.set("units",t)},e.prototype.updateElement_=function(){var t=this.viewState_;if(t){var e=t.center,i=t.projection,n=this.getUnits(),o=n==Id?be.DEGREES:be.METERS,r=Be(i,t.resolution,e,o),a=this.minWidth_*r,s="";if(n==Id){var l=ye[be.DEGREES];(a*=l)<l/60?(s="",r*=3600):a<l?(s="",r*=60):s=""}else n==jd?a<.9144?(s="in",r/=.0254):a<1609.344?(s="ft",r/=.3048):(s="mi",r/=1609.344):n==zd?(r/=1852,s="nm"):n==Nd?a<.001?(s="m",r*=1e6):a<1?(s="mm",r*=1e3):a<1e3?s="m":(s="km",r/=1e3):n==Hd?a<.9144?(s="in",r*=39.37):a<1609.344?(s="ft",r/=.30480061):(s="mi",r/=1609.3472):nt(!1,33);for(var u,c,h,d,p=3*Math.floor(Math.log(this.minWidth_*r)/Math.log(10));;){h=Math.floor(p/3);var f=Math.pow(10,h);if(u=Bd[(p%3+3)%3]*f,c=Math.round(u/r),isNaN(c))return this.element.style.display="none",void(this.renderedVisible_=!1);if(c>=this.minWidth_)break;++p}d=this.scaleBar_?this.createScaleBar(c,u,s):u.toFixed(h<0?-h:0)+" "+s,this.renderedHTML_!=d&&(this.innerElement_.innerHTML=d,this.renderedHTML_=d),this.renderedWidth_!=c&&(this.innerElement_.style.width=c+"px",this.renderedWidth_=c),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.createScaleBar=function(t,e,i){for(var n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),o=[],r=t/this.scaleBarSteps_,a="#ffffff",s=0;s<this.scaleBarSteps_;s++)0===s&&o.push(this.createMarker("absolute",s)),o.push('<div><div class="ol-scale-singlebar" style="width: '+r+"px;background-color: "+a+';"></div>'+this.createMarker("relative",s)+(s%2==0||2===this.scaleBarSteps_?this.createStepText(s,t,!1,e,i):"")+"</div>"),s===this.scaleBarSteps_-1&&o.push(this.createStepText(s+1,t,!0,e,i)),a="#ffffff"===a?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"")+o.join("")+"</div>"},e.prototype.createMarker=function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'},e.prototype.createStepText=function(t,e,i,n,o){var r=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+o);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(i?e+"px":"unset")+';">'+r+"</div>"},e.prototype.getScaleForResolution=function(){var t=this.getMap().getView().getResolution(),e=this.viewState_.projection.getMetersPerUnit();return parseFloat(t.toString())*e*39.37*(25.4/.28)},e}(id),Wd=t=>e=>{if(!e.target)return console.log("No target for mapview!");t.mapview.node=e.target,t.mapview.srid=e.srid||"3857";const i=e.view&&e.view.z||t.workspace.locale.view.z||t.workspace.locale.minZoom||0,n=t.mapview.lib.proj.fromLonLat([parseFloat(e.view&&e.view.lng||t.workspace.locale.view.lng||0),parseFloat(e.view&&e.view.lat||t.workspace.locale.view.lat||0)]);if(t.map=new t.mapview.lib.Map({target:t.mapview.node,interactions:t.mapview.lib.interaction.defaults({mouseWheelZoom:e.scrollWheelZoom||!1}),controls:[],view:new t.mapview.lib.View({projection:"EPSG:"+t.mapview.srid,zoom:i,minZoom:t.workspace.locale.minZoom,maxZoom:t.workspace.locale.maxZoom,center:n,extent:t.mapview.lib.proj.transformExtent([parseFloat(e.bounds&&e.bounds.west||t.workspace.locale.bounds.west),parseFloat(e.bounds&&e.bounds.south||t.workspace.locale.bounds.south),parseFloat(e.bounds&&e.bounds.east||t.workspace.locale.bounds.east),parseFloat(e.bounds&&e.bounds.north||t.workspace.locale.bounds.north)],"EPSG:4326","EPSG:"+t.mapview.srid)})}),t.map.on("movestart",()=>t.mapview.interaction.break=!0),t.mapview.node.addEventListener("changeEnd",()=>{if(Object.values(t.layers.list).forEach(t=>{t.display&&t._dataviews.forEach(t=>t.update()),t.view&&t.tables&&(null===t.tableCurrent()?t.view.classList.add("disabled"):t.view.classList.remove("disabled"))}),t.hooks){const e=t.mapview.lib.proj.transform(t.map.getView().getCenter(),"EPSG:"+t.mapview.srid,"EPSG:4326");t.hooks.set({lat:e[1],lng:e[0],z:t.map.getView().getZoom()})}setTimeout(()=>delete t.mapview.interaction.break,500)}),t.mapview.interaction.highlight.begin(),"never"!==e.zoomControl&&(e.zoomControl||t.workspace.locale.zoomControl)&&t.map.addControl(new t.mapview.lib.control.Zoom),e.attribution&&t.mapview.attribution.create(e.attribution),"never"!==e.showScaleBar&&(e.showScaleBar||t.workspace.locale.showScaleBar)&&t.map.addControl(new t.mapview.lib.control.ScaleLine({target:"ol-scale"})),e.maskBounds||t.workspace.locale.maskBounds){const e=[[180,90],[180,-90],[-180,-90],[-180,90],[180,90]],i=[[t.workspace.locale.bounds.east,t.workspace.locale.bounds.north],[t.workspace.locale.bounds.east,t.workspace.locale.bounds.south],[t.workspace.locale.bounds.west,t.workspace.locale.bounds.south],[t.workspace.locale.bounds.west,t.workspace.locale.bounds.north],[t.workspace.locale.bounds.east,t.workspace.locale.bounds.north]];var o=new t.mapview.lib.Feature({geometry:new t.mapview.lib.geom.Polygon([e,i]).transform("EPSG:4326","EPSG:"+t.mapview.srid)}),r=new t.mapview.lib.layer.Vector({source:new t.mapview.lib.source.Vector({features:[o]}),style:new t.mapview.lib.style.Style({fill:new t.mapview.lib.style.Fill({color:t.utils.Chroma("#000").alpha(.2).rgba()})}),zIndex:999});t.map.addLayer(r)}let a;t.map.on("moveend",(function(){clearTimeout(a),a=setTimeout(()=>t.mapview.node.dispatchEvent(t.mapview.changeEndEvent),500)})),t.hooks&&t.hooks.current.layers.length&&Object.values(t.layers.list).forEach(e=>{e.display=!!~t.hooks.current.layers.indexOf(e.key)}),Object.values(t.layers.list).forEach(t=>t.display&&t.show())},qd=t=>{const e={create:function(n){e.container&&e.container.remove(),e.container=t.utils.wire()`<div class="attribution">`,t.mapview.node.appendChild(e.container),e.scalebar=t.utils.wire()`<div id="ol-scale">`,e.container.appendChild(e.scalebar),n.logo&&e.container.appendChild(n.logo),e.links=t.utils.wire()`
    <div>
      <a target="_blank" href="https://geolytix.github.io/xyz">XYZ v${t.version}</a>
      <a target="_blank" href="https://openlayers.org">Openlayers</a>`,e.container.appendChild(e.links),t.workspace.locale.attribution&&Object.entries(t.workspace.locale.attribution).forEach(i=>{e.links.appendChild(t.utils.wire()`
        <a target="_blank" href="${i[1]}">${i[0]}`)});e.layer={},i()},check:i,set:n,remove:function(t){Object.entries(t).forEach(t=>{e.layer&&e.layer[t[0]]&&(e.layer[t[0]].remove(),delete e.layer[t[0]])})}};return e;function i(){Object.values(t.layers.list).forEach(t=>{t.display&&t.attribution&&n(t.attribution)})}function n(i){Object.entries(i).forEach(i=>{e.layer&&!e.layer[i[0]]&&(e.layer[i[0]]=t.utils.wire()`
        <a target="_blank" href="${i[1]}">${i[0]}</a>`,e.links.appendChild(e.layer[i[0]]))})}},$d=t=>{const e={toggle:function(){e.active=!e.active;let i=!0;e.L||(e.L=new t.mapview.lib.layer.Vector({source:new t.mapview.lib.source.Vector({features:[e.marker]}),zIndex:40,style:new t.mapview.lib.style.Style({image:t.mapview.icon(t.mapview.locate.icon)})}));if(!e.active)return t.map.removeLayer(e.L);t.map.addLayer(e.L),e.watcher||(e.watcher=navigator.geolocation.watchPosition(n=>{if(e.active){const o=t.mapview.lib.proj.fromLonLat([parseFloat(n.coords.longitude),parseFloat(n.coords.latitude)]);e.marker.getGeometry().setCoordinates(o),i&&t.map.getView().animate({center:o},{zoom:t.workspace.locale.maxZoom}),i=!1}},t=>{console.error(t)},{}))},active:!1,icon:{type:"geo",scale:.05},marker:new t.mapview.lib.Feature({geometry:new t.mapview.lib.geom.Point([0,0])})};return e},Yd=t=>function(e){const i=(new t.mapview.lib.format.GeoJSON).readFeature({type:"Feature",geometry:e.geometry},{dataProjection:"EPSG:"+(e.dataProjection||t.mapview.srid),featureProjection:"EPSG:"+(e.featureProjection||t.mapview.srid)}),n=new t.mapview.lib.source.Vector({features:[i]}),o=new t.mapview.lib.layer.Vector({source:n,zIndex:isNaN(e.zIndex)?2e3:e.zIndex,style:e.style});return t.map.addLayer(o),o},Xd=t=>({create:function(e){this.node&&this.node.remove(),this.node=t.utils.wire()`<div class="popup">`,this.node.addEventListener("mousemove",t=>t.stopPropagation());const i=t.utils.wire()`<div>`;i.appendChild(e.content),this.node.appendChild(i),this.overlay&&t.map.removeOverlay(this.overlay);this.overlay=new t.mapview.lib.Overlay({element:this.node,positioning:"bottom-center",autoPan:!0,insertFirst:!0,autoPanAnimation:{duration:250}}),t.map.addOverlay(this.overlay),this.overlay.setPosition(e.coords)}}),Ud=t=>{const e={begin:function(){t.mapview.interaction.current&&t.mapview.interaction.current.finish&&t.mapview.interaction.current.finish(),t.mapview.interaction.current=e,t.mapview.node.style.cursor="auto",e.featureSet=new Set,t.utils.touch()&&(t.mapview.node.addEventListener("touchend",a),t.mapview.node.addEventListener("touchmove",i),t.mapview.node.addEventListener("touchstart",i));t.mapview.node.addEventListener("click",s),t.mapview.node.addEventListener("mousemove",n),t.mapview.node.addEventListener("mouseout",o)},pointerMove:r,finish:function(){t.mapview.node.removeEventListener("click",s),t.utils.touch()&&(t.mapview.node.removeEventListener("touchend",a),t.mapview.node.removeEventListener("touchmove",i),t.mapview.node.removeEventListener("touchstart",i));t.mapview.node.removeEventListener("mousemove",n),t.mapview.node.removeEventListener("mouseout",o)},select:s,clear:l};return e;function i(t){e.lastmove=t}function n(e){t.mapview.interaction.break||(t.mapview.pointerLocation={x:e.clientX,y:e.clientY},t.mapview.infotip.node&&t.mapview.infotip.position(),r(e))}function o(e){t.mapview.pointerLocation={x:null,y:null},l()}function r(i){const n=new Set;t.map.forEachFeatureAtPixel(t.map.getEventPixel(i),(i,o)=>{n.add(i),e.featureSet.has(i)||(e.feature=i,e.layer=o.get("layer"),e.layer.highlight=i.get("id"),t.mapview.node.style.cursor="pointer",e.layer.L.setStyle(e.layer.L.getStyle()),e.layer.hover&&e.layer.hover.field&&e.layer.infotip())},{layerFilter:e=>Object.values(t.layers.list).some(t=>t.qID&&t.style&&t.style.highlight&&t.L===e),hitTolerance:5}),e.featureSet=n,n.size&&n.has(e.feature)||l()}function a(i){if(e.recentTouched)return;if(e.recentTouched=!0,setTimeout(()=>delete e.recentTouched,1e3),t.mapview.interaction.break)return;if(i.touches.length>1)return;const n=new Set;t.map.forEachFeatureAtPixel(t.map.getEventPixel(e.lastmove),(t,i)=>{n.add(t),e.featureSet.has(t)||(e.feature=t,e.layer=i.get("layer"))},{layerFilter:e=>Object.values(t.layers.list).some(t=>t.qID&&t.L===e),hitTolerance:5}),e.featureSet=n,n.size&&e.feature&&e.layer.select(e.feature)}function s(){e.recentTouched||(t.mapview.popup.overlay&&t.map.removeOverlay(t.mapview.popup.overlay),e.layer&&e.feature&&e.layer.select(e.feature))}function l(){e.featureSet=new Set,t.mapview.infotip.node&&t.mapview.infotip.node.remove(),e.layer&&(e.layer.highlight=!0,t.mapview.node.style.cursor="auto",e.layer.L.setStyle(e.layer.L.getStyle()),delete e.layer,delete e.feature)}},Kd=t=>{const e={begin:function(i){t.mapview.interaction.current&&t.mapview.interaction.current.finish&&t.mapview.interaction.current.finish(),t.mapview.interaction.current=e,e.finish=i.finish||n,e.callback=i.callback,e.layer=i.layer,e.layer.display||e.layer.show();t.mapview.node.style.cursor="crosshair",e.vertices=[],t.map.addLayer(e.Layer),e.interaction=new t.mapview.lib.interaction.Draw({source:e.Layer.getSource(),geometryFunction:i.geometryFunction,freehand:i.freehand,type:i.type,condition:n=>{if("Polygon"===i.type||"LineString"===i.type){if(e.trail&&t.utils.turf.kinks(e.trail).features.length>0)return!1;t.map.on("pointermove",a),t.map.un("click",s)}if(1===n.pointerEvent.buttons)return e.vertices.push(n.coordinate),t.mapview.popup.node&&t.mapview.popup.node.remove(),!0}}),e.interaction.on("drawstart",n=>{i.style&&n.feature.setStyle(new t.mapview.lib.style.Style({stroke:i.style.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(i.style.strokeColor),width:i.style.strokeWidth||1})})),e.Layer.getSource().clear(),t.mapview.popup.node&&t.mapview.popup.node.remove()}),e.interaction.on("drawend",t=>{if(i.freehand&&e.vertices.push(t.target.sketchCoords_.pop()),i.drawend)return i.drawend(t);setTimeout(r,400)}),t.map.addInteraction(e.interaction),t.mapview.node.addEventListener("contextmenu",r)},finish:n,cancel:i,update:o,Layer:new t.mapview.lib.layer.Vector({source:new t.mapview.lib.source.Vector})};return e;function i(){n(),t.mapview.interaction.highlight.begin()}function n(){e.callback&&(e.callback(),delete e.callback),t.mapview.popup.node&&t.mapview.popup.node.remove(),t.mapview.node.removeEventListener("contextmenu",r),t.map.removeInteraction(e.interaction),t.map.removeLayer(e.Layer),e.Layer.getSource().clear()}function o(){const n=e.Layer.getSource().getFeatures(),o=new t.mapview.lib.format.GeoJSON,r=JSON.parse(o.writeFeature(n[0],{dataProjection:"EPSG:"+e.layer.srid,featureProjection:"EPSG:"+t.mapview.srid})),a=new XMLHttpRequest;a.open("POST",t.host+"/api/location/new?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.layer.key,table:e.layer.table})),a.setRequestHeader("Content-Type","application/json"),a.onload=i=>{200===i.target.status&&(e.layer.reload(),t.locations.select({layer:e.layer,table:e.layer.table,id:i.target.response}))},a.send(JSON.stringify({geometry:r.geometry})),i()}function r(i){if(s(i),0===e.vertices.length)return;i&&i.preventDefault();const r=t.utils.wire()`<ul>`,l=e.Layer.getSource().getFeatures();l.length&&r.appendChild(t.utils.wire()`
      <li  class="off-white-hover" onclick=${o}>Save</li>`),l.length||r.appendChild(t.utils.wire()`
      <li  class="off-white-hover" onclick=${i=>{i.preventDefault(),e.interaction.removeLastPoint(),e.vertices.pop(),t.mapview.popup.node&&t.mapview.popup.node.remove(),t.map.on("pointermove",a)}}>Remove last vertex</li>`),r.appendChild(t.utils.wire()`
      <li  class="off-white-hover" onclick=${n}>Cancel</li>`),t.mapview.popup.create({coords:e.vertices[e.vertices.length-1],content:r})}function a(i){let n=t.mapview.lib.proj.transform(i.coordinate,`EPSG:${t.mapview.srid}`,"EPSG:4326"),o=e.vertices.map(e=>t.mapview.lib.proj.transform(e,`EPSG:${t.mapview.srid}`,"EPSG:4326"));o.push(n),o.unshift(n),e.trail={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[o]}},e.info&&e.info.remove(),e.info=null,t.utils.turf.kinks(t.utils.turf.flatten(e.trail).features[0]).features.length>0&&(i.stopPropagation(),i.preventDefault(),e.info=t.utils.wire()`<div class="infotip" style="color:#d32f2f;">Invalid geometry.`,t.mapview.node.appendChild(e.info),e.info.style.left=`${i.originalEvent.clientX}px`,e.info.style.top=`${i.originalEvent.clientY}px`,e.info.style.opacity=1,setTimeout(()=>{e.info&&e.info.remove(),e.info=null},1500))}function s(i){t.map.un("pointermove",a),e.trail=null}},Zd=t=>{return{begin:function(i){t.mapview.interaction.current.finish&&t.mapview.interaction.current.finish(),t.mapview.interaction.current=t.mapview.interaction.edit,t.mapview.interaction.edit.finish=i.finish||e,t.mapview.interaction.edit.callback=i.callback,t.mapview.interaction.edit.location=i.location,t.mapview.node.style.cursor="crosshair",t.mapview.interaction.edit.vertices=[i.location.marker],t.mapview.interaction.edit.feature=[],t.mapview.interaction.edit.Source=new t.mapview.lib.source.Vector({features:[t.mapview.interaction.edit.location.Layer.getSource().getFeatures()[0].clone()]}),t.mapview.interaction.edit.Layer=new t.mapview.lib.layer.Vector({source:t.mapview.interaction.edit.Source,zIndex:20,style:t.mapview.interaction.edit.style}),t.map.addLayer(t.mapview.interaction.edit.Layer),t.mapview.interaction.edit.interaction=new t.mapview.lib.interaction.Modify({source:t.mapview.interaction.edit.Source,condition:e=>"Polygon"!==i.type&&"LineString"===i.type||!(t.mapview.interaction.edit.trail&&t.utils.turf.kinks(t.utils.flatten(t.mapview.interaction.edit.trail).features[0]).features.length>0)}),t.mapview.interaction.edit.interaction.on("modifystart",e=>{t.mapview.popup.node&&t.mapview.popup.node.remove(),t.mapview.interaction.edit.feature.push(t.mapview.interaction.edit.Source.getFeatures()[0].clone())}),t.mapview.interaction.edit.interaction.on("modifyend",e=>{t.mapview.interaction.edit.vertices.push(e.mapBrowserEvent.coordinate),"Polygon"!==i.type&&"LineString"!==i.type||r(e)}),t.map.addInteraction(t.mapview.interaction.edit.interaction),t.mapview.node.addEventListener("contextmenu",o)},finish:e,update:i,style:[new t.mapview.lib.style.Style({stroke:new t.mapview.lib.style.Stroke({color:"#3399CC",width:1})}),new t.mapview.lib.style.Style({image:new t.mapview.lib.style.Circle({radius:6,stroke:new t.mapview.lib.style.Stroke({color:"#3399CC",width:1})}),geometry:function(e){const i=e.getGeometry();return"Point"===i.getType()?new t.mapview.lib.geom.Point(i.getCoordinates()):"LineString"===i.getType()?new t.mapview.lib.geom.MultiPoint(i.getCoordinates()):new t.mapview.lib.geom.MultiPoint(i.getCoordinates()[0])}})]};function e(){delete t.mapview.interaction.edit.finish,t.mapview.interaction.edit.Source&&t.mapview.interaction.edit.Source.clear(),t.mapview.popup.node&&t.mapview.popup.node.remove(),t.mapview.node.removeEventListener("contextmenu",o),t.map.removeLayer(t.mapview.interaction.edit.Layer),t.map.removeInteraction(t.mapview.interaction.edit.interaction),t.mapview.interaction.edit.callback&&t.mapview.interaction.edit.callback(),t.mapview.interaction.highlight.begin(),t.mapview.interaction.edit.info&&t.mapview.interaction.edit.info.remove(),t.mapview.interaction.edit.info=null,t.mapview.interaction.edit.trail=null}function i(){const i=t.mapview.interaction.edit.Source.getFeatures(),n=t.mapview.interaction.edit.location,o=n.layer,r=new t.mapview.lib.format.GeoJSON,a=JSON.parse(r.writeFeature(i[0],{dataProjection:"EPSG:"+o.srid,featureProjection:"EPSG:"+t.mapview.srid})),s=new XMLHttpRequest;s.open("POST",t.host+"/api/location/update?"+t.utils.paramString({locale:t.workspace.locale.key,layer:o.key,table:n.table,id:n.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=e=>{if(200!==e.target.status)return;n.Layer.getSource().getFeatures()[0].setGeometry(i[0].getGeometry()),t.map.removeLayer(n.Marker),n.geometry=a.geometry,n.marker=t.mapview.lib.proj.transform(t.utils.turf.pointOnFeature(a.geometry).geometry.coordinates,"EPSG:"+n.layer.srid,"EPSG:"+t.mapview.srid),n.Marker=t.mapview.geoJSON({geometry:{type:"Point",coordinates:n.marker},zIndex:2e3,style:new t.mapview.lib.style.Style({image:t.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+t.locations.list.indexOf(n.record)),color:n.style.strokeColor,scale:.05,anchor:[.5,1]})})}),o.reload()},s.send(JSON.stringify({[o.geom]:a.geometry})),e()}function n(e){t.mapview.popup.node&&t.mapview.popup.node.remove(),t.mapview.interaction.edit.Source.clear(),t.mapview.interaction.edit.Source.addFeature(t.mapview.interaction.edit.feature.pop()),t.mapview.interaction.edit.vertices.pop(),r(e)}function o(o){o.preventDefault();const r=t.utils.wire()`<ul>`;!t.mapview.interaction.edit.info&&t.mapview.interaction.edit.feature.length&&r.appendChild(t.utils.wire()`<li class="off-white-hover" onclick=${i}>Update</li>`),t.mapview.interaction.edit.feature.length&&r.appendChild(t.utils.wire()`<li class="off-white-hover" onclick=${n}>Undo</li>`),r.appendChild(t.utils.wire()`<li class="off-white-hover" onclick=${e}>Cancel</li>`),t.mapview.popup.create({coords:t.mapview.interaction.edit.vertices[t.mapview.interaction.edit.vertices.length-1],content:r})}function r(e){const i=new t.mapview.lib.format.GeoJSON;t.mapview.interaction.edit.trail=null,t.mapview.interaction.edit.trail=i.writeFeatureObject(t.mapview.interaction.edit.Source.getFeatures()[0].clone(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+t.mapview.srid}),"Point"!==t.mapview.interaction.edit.trail.geometry.type&&(t.mapview.interaction.edit.info&&t.mapview.interaction.edit.info.remove(),t.mapview.interaction.edit.info=null,t.utils.turf.kinks(t.mapview.interaction.edit.trail).features.length>0&&(t.mapview.interaction.edit.info=t.utils.wire()`<div class="infotip" style="color:#d32f2f;">Invalid geometry. Right click to continue.`,t.mapview.node.appendChild(t.mapview.interaction.edit.info),t.mapview.interaction.edit.info.style.left=`${e.mapBrowserEvent.originalEvent.clientX}px`,t.mapview.interaction.edit.info.style.top=`${e.mapBrowserEvent.originalEvent.clientY}px`,t.mapview.interaction.edit.info.style.opacity=1))}},Jd=t=>{const e={begin:function(n={}){t.mapview.interaction.current&&t.mapview.interaction.current.finish&&t.mapview.interaction.current.finish(),t.mapview.interaction.current=e,e.callback=n.callback,e.Layer.getSource().clear(),t.map.addLayer(e.Layer),t.mapview.node.style.cursor="zoom-in",e.interaction=new t.mapview.lib.interaction.Draw({source:e.Layer.getSource(),type:"Circle",geometryFunction:t.mapview.lib.draw.createBox(),style:new t.mapview.lib.style.Style({stroke:new t.mapview.lib.style.Stroke({color:"#ddd",width:1}),fill:new t.mapview.lib.style.Stroke({color:t.utils.Chroma("#fff").alpha(.3).rgba()})})}),e.interaction.on("drawend",e=>{t.mapview.flyToBounds(e.feature.getGeometry().getExtent()),i()}),t.map.addInteraction(e.interaction)},finish:n,cancel:i,Layer:new t.mapview.lib.layer.Vector({source:new t.mapview.lib.source.Vector})};return e;function i(){n(),t.mapview.interaction.highlight.begin()}function n(){e.callback&&(e.callback(),delete e.callback),t.mapview.node.style.cursor="auto",t.map.removeInteraction(e.interaction),t.map.removeLayer(e.Layer),e.Layer.getSource().clear()}},Qd=t=>({current:{},highlight:Ud(t),draw:Kd(t),edit:Zd(t),zoom:Jd(t)}),tp=t=>function(e){const i=t.map.getView().calculateExtent();if(!e)return{south:i[1],west:i[0],north:i[3],east:i[2]};const n=t.mapview.lib.proj.transformExtent(i,"EPSG:"+t.mapview.srid,"EPSG:"+e);return{south:n[1],west:n[0],north:n[3],east:n[2]}},ep=t=>function(e){return(e.svg||e.type&&"circle"!==e.type)&&(e.url=t.utils.svg_symbols(e)),e.type&&"circle"===e.type?new t.mapview.lib.style.Circle({radius:parseInt(e.radius)||10,fill:e.fillColor&&new t.mapview.lib.style.Fill({color:t.utils.Chroma(e.fillColor).alpha(0===e.fillOpacity?0:parseFloat(e.fillOpacity)||1).rgba()}),stroke:e.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(e.strokeColor).alpha(0===e.strokeColor?0:parseFloat(e.strokeOpacity)||1).rgba(),width:parseInt(e.strokeWidth)||1})}):new t.mapview.lib.style.Icon({src:e.url,scale:e.scale||1,anchor:e.anchor||[.5,.5]})},ip=t=>({create:function(e){this.node&&this.node.remove();this.node=t.utils.wire()`<div class="infotip">`,this.node.innerHTML=e,t.mapview.node.appendChild(this.node),this.position()},position:function(){this.node.style.opacity=1,this.node.style.left=t.mapview.pointerLocation.x-this.node.offsetWidth/2+"px",this.node.style.top=t.mapview.pointerLocation.y-15-this.node.offsetHeight+"px"}}),np=t=>function(e){t.locations.select({locale:t.workspace.locale.key,layer:this,table:this.tableCurrent(),id:e.get("id")})},op=t=>function(){const e=this,i=new XMLHttpRequest;i.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"infotip",locale:t.workspace.locale.key,layer:e.key,table:e.tableCurrent(),id:e.highlight,coords:"cluster"===e.format&&t.mapview.lib.proj.transform(t.mapview.interaction.highlight.feature.getGeometry().getCoordinates(),"EPSG:"+t.mapview.srid,"EPSG:"+e.srid),field:e.hover.field})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{200===i.target.status&&t.mapview.infotip.create(i.target.response[e.hover.field])},i.send()},rp=t=>e=>{e.highlight=!0,e.select=np(t),e.infotip=op(t),e.reload=()=>{i.clear(),i.refresh({force:!0})};const i=new t.mapview.lib.source.VectorTile({format:new t.mapview.lib.format.MVT({}),transition:0,tileUrlFunction:n=>{const o=e.tableCurrent();return o?`${t.host}/api/layer/mvt/${n[0]}/${n[1]}/${n[2]}?`+t.utils.paramString({locale:t.workspace.locale.key,srid:t.mapview.srid,layer:e.key,table:o,filter:e.filter&&JSON.stringify(e.filter.current)}):i.clear()}});e.L=new t.mapview.lib.layer.VectorTile({source:i,zIndex:e.style.zIndex||1,style:i=>{const n=Object.assign({},e.style.default),o=e.style.theme;if(i.get("strokecolor")&&(n.strokeColor=i.get("strokecolor")),o&&"categorized"===o.type){const t=i.get(o.field);if(void 0===t)return Object.assign(n,{});Object.assign(n,o.cat[t]&&o.cat[t].style||o.cat[t])}if(o&&"graduated"===o.type&&o.cat_arr){const t=parseFloat(i.get(o.field));if(t||0===t){for(let e=0;e<o.cat_arr.length&&!(t<o.cat_arr[e].value);e++)var r=o.cat_arr[e].style||o.cat_arr[e];Object.assign(n,r)}}return Object.assign(n,e.highlight===i.get("id")?e.style.highlight:{},e.highlight===i.get("id")?{zIndex:30}:{zIndex:10}),new t.mapview.lib.style.Style({zIndex:n.zIndex,stroke:n.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(n.strokeColor).alpha(void 0===n.strokeOpacity?1:parseFloat(n.strokeOpacity)||0).rgba(),width:parseFloat(n.strokeWidth)||1}),fill:n.fillColor&&new t.mapview.lib.style.Fill({color:t.utils.Chroma(n.fillColor).alpha(void 0===n.fillOpacity?1:parseFloat(n.fillOpacity)||0).rgba()}),image:n.marker&&t.mapview.icon(n.marker)})}}),e.L.set("layer",e,!0),e.label=t.mapview.layer.mvtLabel(e)},ap=t=>e=>{if(!e.style.label)return;const i=new t.mapview.lib.source.Vector({loader:function(n,o,r){e.xhr&&e.xhr.abort(),this.resolution=o,i.clear();const a=e.tableCurrent();a&&(e.xhr=new XMLHttpRequest,e.xhr.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"labels",locale:t.workspace.locale.key,layer:e.key,table:a,label:e.style.label&&e.style.label.field,filter:e.filter&&JSON.stringify(e.filter.current),west:n[0],south:n[1],east:n[2],north:n[3]})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=e=>{if(200!==e.target.status)return;const n=e.target.response.map(e=>new t.mapview.lib.Feature({geometry:new t.mapview.lib.geom.Point([e.x,e.y]),properties:{label:e.label}}));i.addFeatures(n)},e.xhr.send())},strategy:function(i,n){return this.resolution&&this.resolution!=n&&this.loadedExtentsRtree_.clear(),[t.mapview.lib.proj.transformExtent(i,"EPSG:"+t.mapview.srid,"EPSG:"+e.srid)]}});return new t.mapview.lib.layer.Vector({source:i,declutter:!!e.style.label&&!!e.style.label.declutter,zIndex:e.style.zIndex||1,style:i=>{const n=i.getProperties().properties;return new t.mapview.lib.style.Style({text:new t.mapview.lib.style.Text({font:e.style.label.font||"12px sans-serif",text:n.label,stroke:e.style.label.strokeColor&&new t.mapview.lib.style.Stroke({color:e.style.label.strokeColor,width:e.style.label.strokeWidth||1}),fill:new t.mapview.lib.style.Fill({color:e.style.label.fillColor||"#000"})})})}})},sp=t=>e=>{e.highlight=!0,e.select=np(t),e.infotip=op(t),e.reload=()=>{i.refresh()};const i=new t.mapview.lib.source.Vector({loader:function(){e.xhr&&e.xhr.abort(),i.clear();const n=e.tableCurrent();n&&(e.xhr=new XMLHttpRequest,e.xhr.open("GET",t.host+"/api/layer/geojson?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.key,table:n,cat:e.style.theme&&e.style.theme.field,filter:e.filter&&JSON.stringify(e.filter.current)})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=n=>{if(200!==n.target.status)return;const o=new t.mapview.lib.format.GeoJSON,r=n.target.response.map(i=>o.readFeature({type:"Feature",geometry:i.geometry,properties:{id:i.properties.id}},{dataProjection:"EPSG:"+e.srid,featureProjection:"EPSG:"+t.mapview.srid}));i.addFeatures(r)},e.xhr.send())},strategy:function(i,n){return this.resolution&&this.resolution!=n&&this.loadedExtentsRtree_.clear(),[t.mapview.lib.proj.transformExtent(i,"EPSG:"+t.mapview.srid,"EPSG:"+e.srid)]}});e.L=new t.mapview.lib.layer.Vector({source:i,zIndex:e.style.zIndex||1,style:i=>{const n=Object.assign({},e.style.default),o=e.style.theme;if(o&&"categorized"===o.type&&Object.assign(n,o.cat[i.get(o.field)].style||{}),o&&"graduated"===o.type&&o.cat_arr){const t=parseFloat(i.get(o.field));if(t){for(let e=0;e<o.cat_arr.length&&!(t<o.cat_arr[e].value);e++)var r=o.cat_arr[e].style;Object.assign(n,r)}}return Object.assign(n,e.highlight===i.get("id")?e.style.highlight:{},e.highlight===i.get("id")?{zIndex:30}:{zIndex:10}),new t.mapview.lib.style.Style({zIndex:n.zIndex,stroke:n.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(n.strokeColor).alpha(void 0===n.strokeOpacity?1:parseFloat(n.strokeOpacity)||0).rgba(),width:parseInt(n.strokeWidth)||1}),fill:n.fillColor&&new t.mapview.lib.style.Fill({color:t.utils.Chroma(n.fillColor).alpha(void 0===n.fillOpacity?1:parseFloat(n.fillOpacity)||0).rgba()}),image:n.marker&&t.mapview.icon(n.marker)})}}),e.L.set("layer",e,!0)},lp=t=>function(e){const i=this;let n=e.get("properties").count,o=e.getGeometry().getCoordinates(),r=t.mapview.lib.proj.transform(o,"EPSG:"+t.mapview.srid,"EPSG:"+i.srid);const a=new XMLHttpRequest;a.open("GET",t.host+"/api/query/get_nnearest?"+t.utils.paramString({locale:t.workspace.locale.key,layer:i.key,table:i.tableCurrent(),filter:i.filter&&JSON.stringify(i.filter.current),n:n>99?99:n,coords:r})),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.onload=e=>{if(e.target.status>=300)return;let n=e.target.response;if(!(n&&n.length>1))return t.locations.select({locale:t.workspace.locale.key,layer:i,table:i.tableCurrent(),id:n.id});{const e=t.utils.wire()`
      <ul>
      ${n.map(e=>t.utils.wire()`
        <li class="secondary-colour-hover" onclick=${()=>t.locations.select({locale:t.workspace.locale.key,layer:i,table:i.tableCurrent(),id:e.id,marker:e.coords})}>${e.label||'"'+i.cluster_label+'"'}`)}`;t.mapview.popup.create({coords:t.mapview.lib.proj.transform(r,"EPSG:"+i.srid,"EPSG:"+t.mapview.srid),content:e})}},a.send()},up=t=>e=>{e.highlight=!0,e.select=lp(t),e.infotip=op(t),e.reload=()=>{i.clear(),i.refresh({force:!0})};const i=new t.mapview.lib.source.Vector({loader:function(n,o,r){e.xhr&&e.xhr.abort(),this.resolution=o,i.clear();const a=e.tableCurrent();a&&(e.xhr=new XMLHttpRequest,e.xhr.open("GET",t.host+"/api/layer/cluster?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.key,table:a,kmeans:e.cluster_kmeans,dbscan:e.cluster_dbscan,pixelRatio:window.devicePixelRatio,aggregate:e.style.theme&&e.style.theme.aggregate,theme:e.style.theme&&encodeURIComponent(Object.keys(e.style.themes).find(t=>e.style.themes[t]===e.style.theme)),label:e.style.label&&e.style.label.field,filter:e.filter&&JSON.stringify(e.filter.current),viewport:[n[0],n[1],n[2],n[3]],z:t.mapview.getZoom()})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=n=>{if(200!==n.target.status)return;const o=n.target.response;e.max_size=o.reduce((t,e)=>Math.max(t,e.properties.size),0);let r=1;const a=o.map(i=>new t.mapview.lib.Feature({id:r++,geometry:new t.mapview.lib.geom.Point(4326==e.srid&&t.mapview.lib.proj.fromLonLat([i.geometry.x,i.geometry.y])||[i.geometry.x,i.geometry.y]),properties:i.properties}));i.addFeatures(a)},e.xhr.send())},strategy:function(i,n){return this.resolution&&this.resolution!=n&&this.loadedExtentsRtree_.clear(),[t.mapview.lib.proj.transformExtent(i,"EPSG:"+t.mapview.srid,"EPSG:"+e.srid)]}});e.L=new t.mapview.lib.layer.Vector({layer:e,source:i,zIndex:e.style.zIndex||1,style:i=>{const n=i.getProperties().properties,o=n.size>1?Object.assign({},e.style.markerMulti):Object.assign({},e.style.marker),r=Object.assign({},e.style.theme);if(r&&"categorized"===r.type&&Object.assign(o,r.cat[n.cat]&&r.cat[n.cat].style||r.cat[n.cat]),r&&"graduated"===r.type){const t=parseFloat(n.cat);if(t||0===t){for(let e=0;e<r.cat_arr.length&&!(t<r.cat_arr[e].value);e++)var a=r.cat_arr[e].style||r.cat_arr[e];Object.assign(o,a)}}if(r&&"competition"===r.type){let t=n.size,e={layers:{}};Object.entries(n.cat).sort((t,e)=>t[1]-e[1]).forEach(i=>{r.cat[i[0]]&&(e.layers[t/n.size]=r.cat[i[0]].style.fillColor),t-=i[1]}),Object.assign({},o,e)}const s=e.cluster_logscale?1===n.count?o.markerMin||e.style.markerMin:(o.markerMin||e.style.markerMin)+(o.markerMax||e.style.markerMax)/Math.log(e.max_size)*Math.log(n.size):1===n.count?o.markerMin||e.style.markerMin:(o.markerMax||e.style.markerMin)+(o.markerMax||e.style.markerMax)/e.max_size*n.size;return Object.assign(o,e.highlight===i.get("id")&&e.style.highlight),new t.mapview.lib.style.Style({zIndex:parseInt(e.max_size-n.size),image:t.mapview.icon(Object.assign({},o,{scale:s/40*(o.scale||.05)}))})}}),e.label=t.mapview.layer.clusterLabel(e)},cp=t=>e=>{if(e.style.label)return new t.mapview.lib.layer.Vector({source:e.L.getSource(),declutter:!!e.style.label&&!!e.style.label.declutter,zIndex:e.style.zIndex||1,style:i=>{const n=i.getProperties().properties;return new t.mapview.lib.style.Style({text:new t.mapview.lib.style.Text({font:e.style.label.font||"12px sans-serif",text:n.label||`${n.count>1?n.count:""}`,stroke:e.style.label.strokeColor&&new t.mapview.lib.style.Stroke({color:e.style.label.strokeColor,width:e.style.label.strokeWidth||1}),fill:new t.mapview.lib.style.Fill({color:e.style.label.fillColor||"#000"})})})}})},hp=t=>e=>{const i=e.URI.indexOf("provider")>0?t.host+"/api/proxy?"+t.utils.paramString({uri:e.URI}):e.URI,n=new t.mapview.lib.source.OSM({url:decodeURIComponent(i),opaque:!1,transition:0});e.L=new t.mapview.lib.layer.Tile({source:n,layer:e,zIndex:-1})},dp=t=>e=>{e.grid_size=Object.values(e.grid_fields)[0],e.grid_color=Object.values(e.grid_fields)[1],e.grid_ratio=!1,e.reload=()=>i.refresh();const i=new t.mapview.lib.source.Vector({loader:function(n,o,r){e.xhr&&e.xhr.abort(),this.resolution=o,i.clear();const a=e.tableCurrent();a&&(e.xhr=new XMLHttpRequest,e.xhr.open("GET",t.host+"/api/layer/grid?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.key,table:a,size:e.grid_size,color:e.grid_color,viewport:[n[0],n[1],n[2],n[3]]})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=n=>{if(200!==n.target.status)return;const o=n.target.response;e.sizeAvg=0,e.colorAvg=0;const r=o.map(i=>{if(parseFloat(i[2])>0)return i[2]=isNaN(i[2])?i[2]:parseFloat(i[2]),i[3]=isNaN(i[3])?i[3]:parseFloat(i[3]),e.grid_ratio&&i[3]>0&&(i[3]/=i[2]),e.sizeAvg+=parseFloat(i[2]),e.colorAvg+=isNaN(i[3])?0:parseFloat(i[3]),new t.mapview.lib.Feature({geometry:new t.mapview.lib.geom.Point(t.mapview.lib.proj.fromLonLat([i[0],i[1]])),properties:{size:parseFloat(i[2]),color:isNaN(i[3])?i[3]:parseFloat(i[3])}})});function a(t,e,i){const n=t.filter(t=>isFinite(t[e]));return Math[i].apply(null,n.map(t=>t[e]))}e.sizeMin=a(o,2,"min"),e.sizeAvg/=r.length,e.sizeMax=a(o,2,"max"),e.colorMin=a(o,3,"min"),e.colorAvg/=r.length,e.colorMax=a(o,3,"max"),e.colorBins=[];let s=e.style.range.length;for(var l=1;l<s;l++)l<s/2&&e.colorBins.push(e.colorMin+(e.colorAvg-e.colorMin)/(s/2)*l),l===s/2&&e.colorBins.push(e.colorAvg),l>s/2&&e.colorBins.push(e.colorAvg+(e.colorMax-e.colorAvg)/(s/2)*(l-s/2));i.addFeatures(r),e.style.legend.size_min&&(e.style.legend.size_min.textContent=e.sizeMin.toLocaleString("en-GB",{maximumFractionDigits:0})),e.style.legend.size_avg&&(e.style.legend.size_avg.textContent=e.sizeAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),e.style.legend.size_max&&(e.style.legend.size_max.textContent=e.sizeMax.toLocaleString("en-GB",{maximumFractionDigits:0})),e.grid_ratio?(e.style.legend.color_min&&(e.style.legend.color_min.textContent=e.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),e.style.legend.color_avg&&(e.style.legend.color_avg.textContent=e.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),e.style.legend.color_max&&(e.style.legend.color_max.textContent=e.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"}))):(e.style.legend.color_min&&(e.style.legend.color_min.textContent=e.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0})),e.style.legend.color_avg&&(e.style.legend.color_avg.textContent=e.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),e.style.legend.color_max&&(e.style.legend.color_max.textContent=e.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0})))},e.xhr.send())},strategy:function(i,n){return this.resolution&&this.resolution!=n&&this.loadedExtentsRtree_.clear(),[t.mapview.lib.proj.transformExtent(i,"EPSG:"+t.mapview.srid,"EPSG:"+e.srid)]}});e.L=new t.mapview.lib.layer.Vector({source:i,zIndex:e.style.zIndex||1,style:i=>{const n=i.getProperties().properties,o=n.size<=e.sizeAvg?7+7/e.sizeAvg*n.size:14+7/(e.sizeMax-e.sizeAvg)*(n.size-e.sizeAvg);if(n.hxcolor="#C0C0C0",parseFloat(n.color)){n.hxcolor=e.style.range[0];for(let t=0;t<e.colorBins.length&&!(n.color<e.colorBins[t]);t++)n.hxcolor=e.style.range[t+1]}return new t.mapview.lib.style.Style({image:t.mapview.icon({type:"dot",fillColor:n.hxcolor,scale:o/40*.05})})}}),e.L.set("layer",e,!0)},pp=t=>({mvt:rp(t),mvtLabel:ap(t),geojson:sp(t),cluster:up(t),clusterLabel:cp(t),tiles:hp(t),grid:dp(t)}),fp=t=>(e,i,n)=>{n&&e.style.legend.appendChild(t.utils.wire()`
  <div class="title bold off-black secondary-colour-bb">${n}`);const o={};let r;o.node=t.utils.wire()`<div class="block">`,e.style.legend.appendChild(o.node),o.wrapper=t.utils.wire()`<div style="display: inline-block; width: 65%;">`,o.node.appendChild(o.wrapper),o.stroke_color=t.utils.wire()`<div>Stroke Colour `,o.wrapper.appendChild(o.stroke_color),o.strokeColor=t.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${t=>{o.colorSelect="strokeColor",o.colour_swatch.style.display="table"}}>${i.strokeColor||"#ffffff"}`,o.stroke_color.appendChild(o.strokeColor),o.fill_colour=t.utils.wire()`<div>Fill Colour `,o.wrapper.appendChild(o.fill_colour),o.fillColor=t.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${t=>{o.colorSelect="fillColor",o.colour_swatch.style.display="table"}}>${i.fillColor||"#ffffff"}`,o.fill_colour.appendChild(o.fillColor),o.sample_poly=t.utils.wire()`
  <div
    class="sample-poly"
    style="display: inline-block; ${"border:"+(i.strokeWidth||1)+"px solid "+(i.strokeColor||"#ffffff")}">`,o.sample_poly.style.backgroundColor=i.fillColor,o.node.appendChild(o.sample_poly),o.colour_swatch=t.utils.wire()`
  <tr
    style="width: 100%; margin-bottom: 10px; display: none">`,o.node.appendChild(o.colour_swatch),t.defaults.colours.forEach(n=>{o.colour_swatch.appendChild(t.utils.wire()`
    <td
      title=${n.name}
      style="${"height: 20px; background-color:"+n.hex}"
      onclick=${t=>{o[o.colorSelect].textContent=n.hex,i[o.colorSelect]=n.hex,o.sample_poly.style.backgroundColor=i.fillColor,o.sample_poly.style.border=(i.strokeWidth||1)+"px solid "+i.strokeColor,o.colour_swatch.style.display="none",e.reload()}}>`)}),o.node.appendChild(t.utils.wire()`
  <div style="display: inline-block; width: 35%;">Stroke Weight`),o.node.appendChild(t.utils.wire()`
  <div
    class="input-range"
    style="display: inline-block; width: 65%; padding-top:10px; padding-bottom:6px;">
    <input
      type="range"
      class="secondary-colour-bg"
      min=1
      value=${i.strokeWidth||1}
      max=5
      oninput=${t=>{i.strokeWidth=parseInt(t.target.value),o.sample_poly.style.border=i.strokeWidth+"px solid "+i.strokeColor,clearTimeout(r),r=setTimeout(()=>{r=null,e.reload()},500)}}>`),o.node.appendChild(t.utils.wire()`
  <div style="display: inline-block; width: 35%;">Fill Opacity `),o.node.appendChild(t.utils.wire()`
  <div
    class="input-range"
    style="display: inline-block; width: 65%; padding-top:10px; padding-bottom:6px;">
    <input
      type="range"
      class="secondary-colour-bg"
      min=0.1
      value=${void 0===i.fillOpacity?1:parseFloat(i.fillOpacity)||0}
      max=1
      step=0.1
      oninput=${t=>{i.fillOpacity=t.target.value,clearTimeout(r),r=setTimeout(()=>{r=null,e.reload()},500)}}>`)},gp=t=>(e,i,n)=>{n&&e.style.legend.appendChild(t.utils.wire()`
  <div class="title bold off-black secondary-colour-bb">${n}`);const o={};o.node=t.utils.wire()`<div class="block">`,e.style.legend.appendChild(o.node),o.fill_colour=t.utils.wire()`<div style="display: inline-block; width: 85%;">Fill Colour `,o.node.appendChild(o.fill_colour),o.fillColor=t.utils.wire()`
  <span
    class="cursor primary-colour"
    onclick=${t=>{o.colorSelect="fillColor",o.colour_swatch.style.display="table"}}>${i.fillColor}`,o.fill_colour.appendChild(o.fillColor),o.sample_wrapper=t.utils.wire()`<div style="display: inline-block; padding-bottom: 5px;">`,o.node.appendChild(o.sample_wrapper),o.sample=t.utils.wire()`<div class="sample-circle">`,o.sample.style.backgroundColor=i.fillColor&&t.utils.Chroma(i.fillColor).alpha(1).hex(),o.sample_wrapper.appendChild(o.sample),o.node.appendChild(o.sample_wrapper),o.node.appendChild(t.utils.wire()`<br>`),o.colour_swatch=t.utils.wire()`
  <tr
    style="width: 100%; margin-bottom: 10px; display: none;">`,o.node.appendChild(o.colour_swatch),t.defaults.colours.forEach(n=>{o.colour_swatch.appendChild(t.utils.wire()`
    <td
      title="${n.name}"
      style="${"height: 20px; background-color:"+n.hex}"
      onclick=${r=>{o[o.colorSelect].textContent=n.hex,i[o.colorSelect]=n.hex,o.sample.style.backgroundColor=t.utils.Chroma(i.fillColor).alpha(1).hex(),o.colour_swatch.style.display="none",e.reload()}}>`)})},mp=t=>e=>{const i=t.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;if(e.style.legend=i,Object.entries(e.style.theme.cat).forEach(n=>{let o=t.utils.wire()`<div style="height: 24px; width: 24px;">`,r=t.utils.wire()`<svg>`;o.appendChild(r);let a=Object.assign({},e.style.default,n[1].style||n[1]);if(void 0===a.fillOpacity){let e=t.utils.wire(null,"svg")`
      <line
        x1=4
        x2=18
        y1=10
        y2=10
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`;r.appendChild(e)}else{let e=t.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${a.fillColor||"#FFF"}
        fill-opacity=${a.fillOpacity}
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`;r.appendChild(e)}i.appendChild(o),i.appendChild(t.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${t=>{t.stopPropagation(),"line-through"===t.target.style.textDecoration?(t.target.style.textDecoration="none",t.target.style.opacity=1,t.target.style.fillOpacity=1,e.filter.current[e.style.theme.field].ni.splice(e.filter.current[e.style.theme.field].ni.indexOf(n[0]),1)):(t.target.style.textDecoration="line-through",t.target.style.opacity=.8,t.target.style.fillOpacity=.8,e.filter.current[e.style.theme.field]||(e.filter.current[e.style.theme.field]={ni:[]}),e.filter.current[e.style.theme.field].ni.push(n[0])),e.reload()}}>${n[1].label||n[0]}`)}),e.style.theme.other){let n=t.utils.wire()`<div style="height: 24px; width: 24px;">`,o=t.utils.wire()`<svg>`;if(n.appendChild(o),void 0===e.style.default.fillOpacity){let i=t.utils.wire(null,"svg")`
      <line
        x1=4
        x2=18
        y1=10
        y2=10
        stroke=${e.style.default.strokeColor}
        stroke-width=${e.style.default.strokeWidth||1}>`;o.appendChild(i)}else{let i=t.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${e.style.default.fillColor||"#FFF"}
        fill-opacity=${e.style.default.fillOpacity}
        stroke=${e.style.default.strokeColor}
        stroke-width=${e.style.default.strokeWidth||1}>`;o.appendChild(i)}i.appendChild(n),i.appendChild(t.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${t=>{t.stopPropagation(),"line-through"===t.target.style.textDecoration?(t.target.style.textDecoration="none",t.target.style.opacity=1,t.target.style.fillOpacity=1,e.filter.current[e.style.theme.field].in=[]):(t.target.style.textDecoration="line-through",t.target.style.opacity=.8,t.target.style.fillOpacity=.8,e.filter.current[e.style.theme.field]||(e.filter.current[e.style.theme.field]={ni:[]}),e.filter.current[e.style.theme.field].in=Object.keys(e.style.theme.cat)),e.reload()}}>other`)}return i},vp=t=>e=>{if(!e.style.theme.cat_arr)return;const i=t.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;return e.style.legend=i,e.style.theme.cat_arr.forEach(n=>{let o=t.utils.wire()`<div style="height: 24px; width: 24px;">`,r=t.utils.wire()`<svg>`;o.appendChild(r);let a=Object.assign({},e.style.default,n.style||n);r.appendChild(t.utils.wire(null,"svg")`
      <rect
        x=4
        y=2
        width=14
        height=14
        fill=${a.fillColor}
        fill-opacity=${a.fillOpacity}
        stroke=${a.strokeColor}/>`),i.appendChild(o);let s=t.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default;">${n.label||n.value}`;i.appendChild(s)}),i},yp=t=>e=>{const i=t.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;if(e.style.legend=i,Object.entries(e.style.theme.cat).forEach(n=>{let o=t.utils.wire()`<div style="height: 24px; width: 24px;">`,r=t.utils.wire()`<img height=20 width=20>`;r.setAttribute("src",t.utils.svg_symbols(Object.assign({},e.style.marker,n[1].style||n[1]))),o.appendChild(r),i.appendChild(o),i.appendChild(t.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${t=>{t.stopPropagation(),"line-through"===t.target.style.textDecoration?(t.target.style.textDecoration="none",t.target.style.opacity=1,t.target.style.fillOpacity=1,e.filter.current[e.style.theme.field].ni.splice(e.filter.current[e.style.theme.field].ni.indexOf(n[0]),1)):(t.target.style.textDecoration="line-through",t.target.style.opacity=.8,t.target.style.fillOpacity=.8,e.filter.current[e.style.theme.field]||(e.filter.current[e.style.theme.field]={ni:[]}),e.filter.current[e.style.theme.field].ni.push(n[0])),e.reload()}}>${n[1].label||n[0]}`)}),e.style.theme.other){let n=t.utils.wire()`<div style="height: 24px; width: 24px;">`,o=t.utils.wire()`<svg>`,r=t.utils.wire(null,"svg")`
    <image x=0 y=0 width=20 height=20>`;r.setAttribute("href",t.utils.svg_symbols(e.style.marker)),o.appendChild(r),n.appendChild(o),i.appendChild(n),i.appendChild(t.utils.wire()`
    <div
      style="font-size:12px; alignment-baseline:central; cursor:pointer;"
      class="switch"
      onclick=${t=>{t.stopPropagation(),"line-through"===t.target.style.textDecoration?(t.target.style.textDecoration="none",t.target.style.opacity=1,t.target.style.fillOpacity=1,e.filter.current[e.style.theme.field].in=[]):(t.target.style.textDecoration="line-through",t.target.style.opacity=.8,t.target.style.fillOpacity=.8,e.filter.current[e.style.theme.field]||(e.filter.current[e.style.theme.field]={ni:[]}),e.filter.current[e.style.theme.field].in=Object.keys(e.style.theme.cat)),e.reload()}}>other`)}let n=t.utils.wire()`<div style="height: 40px; width: 40px;">`,o=t.utils.wire()`<img height=40 width=40>`;o.setAttribute("src",t.utils.svg_symbols(e.style.markerMulti)),n.appendChild(o),i.appendChild(n);let r=t.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default; margin-left: 20px; margin-top: 10px;">Multiple Locations`;return i.appendChild(r),i},bp=t=>e=>{if(!e.style.theme.cat_arr)return;const i=t.utils.wire()`<div style="margin-top: 5px; display: grid; grid-template-columns: 30px auto;">`;return e.style.legend=i,e.style.theme.cat_arr.forEach(n=>{let o=t.utils.wire()`<div style="height: 24px; width: 24px;">`,r=t.utils.wire()`<img width=20 height=20>`;r.setAttribute("src",t.utils.svg_symbols(Object.assign({},e.style.marker,n.style))),o.appendChild(r),i.appendChild(o);let a=t.utils.wire()`<div style="font-size:12px; alignment-baseline:central; cursor:default;">${n.label||n.style}`;i.appendChild(a)}),i},wp=t=>e=>{e.style.legend.appendChild(t.utils.wire()`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(e.grid_fields)[0]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(e.grid_fields).map(i=>t.utils.wire()`
        <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=i[0],e.grid_size=i[1],e.reload()}}>${i[0]}`)}`);const i=e.style.legend.appendChild(t.utils.wire()`
  <svg xmlns='http://www.w3.org/2000/svg'>`);e.style.legend.appendChild(t.utils.wire()`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(e.grid_fields)[1]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(e.grid_fields).map(i=>t.utils.wire()`
      <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=i[0],e.grid_color=i[1],e.reload()}}>${i[0]}`)}`);let n=15,o=e.style.range.length,r=100/o;for(let e=0;e<o;e++){let a=10*(e+2)/o,s=e*r,l=t.utils.wire(null,"svg")`
    <circle fill='#777'>`;l.setAttribute("cx",s+r/2+1+"%"),l.setAttribute("cy",n+1),l.setAttribute("r",a),i.appendChild(l);let u=t.utils.wire(null,"svg")`
    <circle fill='#999'>`;u.setAttribute("cx",s+r/2+"%"),u.setAttribute("cy",n),u.setAttribute("r",a),i.appendChild(u)}n+=20;for(let a=0;a<o;a++){let s=a*r,l=t.utils.wire(null,"svg")`
    <rect
      height=20
      fill=${e.style.range[a]}>`;l.setAttribute("x",s+"%"),l.setAttribute("y",n),l.setAttribute("width",r+"%"),i.appendChild(l),0===a&&(e.style.legend.color_min=t.utils.wire(null,"svg")`
      <text
        style='font-size:11px; text-anchor: start; 
        font-family: "Open Sans", sans-serif;'>min`,e.style.legend.color_min.setAttribute("x",s+"%"),e.style.legend.color_min.setAttribute("y",n+40),i.appendChild(e.style.legend.color_min)),a===(o/2%1!=0&&Math.round(o/2)-1)&&(e.style.legend.color_avg=t.utils.wire(null,"svg")`
      <text id="grid_legend_color__avg"
        style='font-size:11px; text-anchor: middle; 
        font-family: "Open Sans", sans-serif;'>avg`,e.style.legend.color_avg.setAttribute("x",s+r/2+"%"),e.style.legend.color_avg.setAttribute("y",n+40),i.appendChild(e.style.legend.color_avg)),a===o-1&&(e.style.legend.color_max=t.utils.wire(null,"svg")`
      <text id="grid_legend_color__max"
        style='font-size:11px; text-anchor: end; 
        font-family: "Open Sans", sans-serif;'>max`,e.style.legend.color_max.setAttribute("x",s+r+"%"),e.style.legend.color_max.setAttribute("y",n+40),i.appendChild(e.style.legend.color_max))}return i.style.height=`${n+43}px`,e.style.legend.appendChild(t.utils.wire()`
  <td style="padding-top: 5px;" colSpan=2>
  <label class="input-checkbox">
  <input type="checkbox"
    onchange=${t=>{e.grid_ratio=t.target.checked,e.reload()}}>
  </input>
  <div></div><span>Display colour as a ratio to the size.`),e.style.legend},_p=t=>{const e={polyCategorized:mp(t),polyGraduated:vp(t),clusterCategorized:yp(t),clusterGraduated:bp(t),grid:wp(t)};return i=>(i.style.legend=t.utils.wire()`<div class="legend">`,"grid"===i.format?e.grid(i):(i.filter=i.filter||{},"mvt"===i.format&&"categorized"===i.style.theme.type?e.polyCategorized(i):"mvt"===i.format&&"graduated"===i.style.theme.type?e.polyGraduated(i):"cluster"===i.format&&"categorized"===i.style.theme.type||"cluster"===i.format&&"competition"===i.style.theme.type?e.clusterCategorized(i):"cluster"===i.format&&"graduated"===i.style.theme.type?e.clusterGraduated(i):void 0))},xp=t=>{const e={panel:function(i){if(!i.style)return;if(!i.style.theme&&i.style.hidden)return;const n=t.utils.wire()`
    <div class="drawer panel expandable ${i.style.theme||"grid"===i.format?"expanded":""}">`;if(n.appendChild(t.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}><span>Style</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),i.style.label&&n.appendChild(t.utils.wire()`
    <label class="input-checkbox" style="margin-bottom: 10px;">
    <input type="checkbox"
      checked=${!!i.style.label.display}
      onchange=${t=>{i.style.label.display=t.target.checked,i.show()}}>
    </input>
    <div></div><span>Display Labels.`),i.style.theme&&!i.style.hidden){const e=Object.assign({Basic:null},i.style.themes);n.appendChild(t.utils.wire()`<div>Select thematic style.`),n.appendChild(t.utils.wire()`
      <button class="btn-drop">
      <div
        class="head"
        onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
        <span>${Object.keys(e)[1]}</span>
        <div class="icon"></div>
      </div>
      <ul>
        ${Object.entries(e).map(e=>t.utils.wire()`
          <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.querySelector("span").textContent=e[0],n.classList.toggle("active"),i.style.theme=e[1],o(i),i.reload()}}>${e[0]}`)}`)}i.style.theme&&i.style.themes&&i.style.hidden&&n.appendChild(t.utils.wire()`<span style="font-weight: bold;">${Object.keys(i.style.themes)[0]}`);return n.appendChild(t.utils.wire()`
      <div class="switch-all" style="font-size: 90%; display:none;">Click on labels to switch visibity or 
      <a class="primary-colour" style="cursor: pointer;"
      onclick=${t=>{t.stopPropagation(),n.querySelectorAll(".switch").forEach(t=>t.click()),i.reload()}}>switch all</a>.`),i.style.bringToFront=t.utils.wire()`<button 
      title="Bring layer to front."
      style="margin-top: 5px;"
      class="btn-wide primary-colour"
      onclick=${()=>i.bringToFront()}>Bring layer to front`,o(i),n;function o(i){if(n.querySelector(".switch-all").style.display=i.style.theme&&"categorized"===i.style.theme.type?"block":"none",i.style.legend&&i.style.legend.remove(),i.style.bringToFront.remove(),i.style.theme||"grid"===i.format)return i.style.bringToFront.disabled=!i.display,n.appendChild(t.layers.view.style.legend(i)),void n.appendChild(i.style.bringToFront);i.style.legend=t.utils.wire()`<div class="legend">`,i.style.marker&&e.clusterStyle(i,i.style.marker,"Marker"),i.style.markerMulti&&e.clusterStyle(i,i.style.markerMulti,"MultiMarker"),i.style.default&&e.polyStyle(i,i.style.default,"Polygon"),i.style.highlight&&e.polyStyle(i,i.style.highlight,"Highlight"),n.appendChild(i.style.legend),i.style.bringToFront.disabled=!i.display,n.appendChild(i.style.bringToFront)}},legend:_p(t),polyStyle:fp(t),clusterStyle:gp(t)};return e},Cp=t=>(e,i)=>{if(i.el&&i.el.parentNode)return t.layers.view.filter.reset(e,i);const n=t.layers.view.filter.block(e,i);n.dataset.field=i.field,i.el=n,n.appendChild(t.utils.wire()`
  <input type="text" placeholder="Search" onkeyup=${t=>{e.filter.current[i.field]={},e.filter.current[i.field][i.filter]=encodeURIComponent(t.target.value),e.reload(),e.show(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})}}>`)},Ep=t=>(e,i)=>{if(i.el&&i.el.parentNode)return t.layers.view.filter.reset(e,i);const n=new XMLHttpRequest;n.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"field_stats",locale:t.workspace.locale.key,layer:e.key,table:e.tableCurrent(),field:i.field,filter:e.filter&&JSON.stringify(e.filter.current)})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=n=>{const o=n.target.response,r=t.layers.view.filter.block(e,i);r.dataset.field=i.field,i.el=r;const a="integer"===i.type?1:.01;var s=t.utils.wire()`
    <div class="input-flex">
      <span>Greater or equal`;const l=t.utils.wire()`
    <input
      type="number"
      min=${o.min}
      value=${o.min}
      max=${o.max}
      step=${a}
      onkeyup=${t=>{c.value=t.target.value,g()}}>`;s.appendChild(l),r.appendChild(s);const u=t.utils.wire()`<div class="input-range">`;r.appendChild(u);const c=t.utils.wire()`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${o.min}
      value=${o.min}
      max=${o.max}
      step=${a}
      oninput=${t=>{l.value=t.target.value,g()}}>`;u.appendChild(c);s=t.utils.wire()`
    <div class="input-flex">
      <span>Smaller or equal`;const h=t.utils.wire()`
    <input
      type="number"
      min=${o.min}
      value=${o.max}
      max=${o.max}
      step=${a}
      onkeyup=${t=>{p.value=t.target.value,g()}}>`;s.appendChild(h),r.appendChild(s);var d=t.utils.wire()`<div class="input-range">`;r.appendChild(d);const p=t.utils.wire()`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${o.min}
      value=${o.max}
      max=${o.max}
      step=${a}
      oninput=${t=>{h.value=t.target.value,g()}}>`;let f;function g(){clearTimeout(f),f=setTimeout(()=>{f=null,e.filter.current[i.field]={},e.filter.current[i.field].gte=parseFloat(l.value),e.filter.current[i.field].lte=parseFloat(h.value),e.reload(),e.show(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})},500)}d.appendChild(p)},n.send()},kp=t=>(e,i)=>{if(i.el&&i.el.parentNode)return t.layers.view.filter.reset(e,i);const n=t.layers.view.filter.block(e,i);n.dataset.field=i.field,i.el=n,i.filter.in.forEach(o=>{n.appendChild(t.utils.wire()`
    <label class="input-checkbox">
    <input
      type="checkbox"
      onchange=${t=>{if(e.filter.current[i.field]||(e.filter.current[i.field]={in:[]}),t.target.checked)e.filter.current[i.field].in.push(encodeURIComponent(t.target.parentNode.innerText));else{let n=e.filter.current[i.field].in.indexOf(encodeURIComponent(t.target.parentNode.innerText));e.filter.current[i.field].in.splice(n,1)}e.reload(),e.show(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})}}>
    </input>
    <div></div><span>${o}`)})},Sp=t=>(e,i)=>{if(i.el&&i.el.parentNode)return t.layers.view.filter.reset(e,i);const n=t.layers.view.filter.block(e,i);n.dataset.field=i.field,i.el=n;var o=t.utils.wire()`
  <div class="input-flex">
    <span>After`;const r=t.utils.wire()`
  <input type="text" readonly placeholder="Pick from calendar." style="width: 60%;">`;o.appendChild(r),n.appendChild(o);o=t.utils.wire()`
  <div class="input-flex">
    <span>Before`;const a=t.utils.wire()`
  <input type="text" readonly placeholder="Pick from calendar." style="width: 60%;">`;let s;function l(){clearTimeout(s),s=setTimeout(()=>{s=null,e.filter.current[i.field]={},e.filter.current[i.field].gt=t.utils.meltDateStr(r.value)||null,e.filter.current[i.field].lt=t.utils.meltDateStr(a.value)||null,e.reload(),e.show(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})},500)}o.appendChild(a),n.appendChild(o),t.utils.flatpickr({element:r,enableTime:"datetime"===i.type,callback:t=>{r.value=t,l()}}),t.utils.flatpickr({element:a,enableTime:"datetime"===i.type,callback:t=>{a.value=t,l()}})},Mp=t=>(e,i)=>{if(i.el&&i.el.parentNode)return t.layers.view.filter.reset(e,i);const n=t.layers.view.filter.block(e,i);n.dataset.field=i.field,i.el=n,e.filter.current[i.field]||(e.filter.current[i.field]={}),e.filter.current[i.field].boolean=!0,n.appendChild(t.utils.wire()`
  <label class="input-checkbox">
  <input type="checkbox"
    checked=true 
    onchange=${t=>{t.target.checked?e.filter.current[i.field].boolean=!0:e.filter.current[i.field].boolean=!1,e.reload(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})}}>
  </input>
  <div></div><span>${i.name||"True"}`),e.reload(),e.show(),e.count(t=>{e.filter.run_output.disabled=!(t>1),i.filterZoom&&t>1&&e.zoomToExtent()})},Tp=t=>{const e={panel:function(i){if(!i.infoj)return;if(!i.infoj.some(t=>t.filter))return;i.filter.current={};const n=i.infoj.filter(t=>t.filter);n.unshift("Select filter from list.");const o=t.utils.wire()`
    <div class="drawer panel expandable">`;o.appendChild(t.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}><span>Filter</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`);let r={};Object.values(n).forEach(t=>{t.field&&(r[t.field]=t.title||t.field)}),i.filter.select=t.utils.wire()`
      <button class="btn-drop">
      <div
        class="head"
        onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
        <span>Select filter from list.</span>
        <div class="icon"></div>
      </div>
      <ul>
        ${Object.entries(r).map(o=>t.utils.wire()`
          <li onclick=${t=>{t.target.closest(".btn-drop").classList.toggle("active");const r=n.find(t=>t.field===o[0]);return i.filter.clear_all.style.display="block","date"==r.filter?e.filter_date(i,r):"numeric"===r.filter?e.filter_numeric(i,r):"like"===r.filter||"match"===r.filter?e.filter_text(i,r):r.filter.in?e.filter_in(i,r):"boolean"===r.filter?e.filter_boolean(i,r):void 0}}>${o[1]}`)}`,o.appendChild(i.filter.select),i.filter.clear_all=t.utils.wire()`
    <button
      class="primary-colour"
      style="display: none; margin-bottom: 5px;"
      onclick=${t=>{t.target.style.display="none",i.filter.list.innerHTML=null,i.filter.current={},i.reload(),i.count(t=>{i.filter.run_output.disabled=!(t>1)})}}>Clear all filters`,o.appendChild(i.filter.clear_all),i.filter.list=t.utils.wire()`<div>`,o.appendChild(i.filter.list),i.filter.run_output=t.utils.wire()`
    <button
      style="margin-top: 5px;"
      class="btn-wide primary-colour"
      onclick=${()=>{const e=new XMLHttpRequest;e.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"filter_aggregate",locale:t.workspace.locale.key,layer:i.key,table:i.tableMin(),filter:i.filter&&JSON.stringify(i.filter.current)})),e.setRequestHeader("Content-Type","application/json"),e.responseType="json",e.onload=e=>{if(200!==e.target.status)return;const n=i.filter.infoj.map(t=>(t.value=e.target.response[t.field],t));t.locations.select({_new:!0,_flyTo:!0,geometry:JSON.parse(e.target.response.geometry),infoj:n,layer:i})},e.send()}}>Run Output`,o.appendChild(i.filter.run_output),i.filter.infoj||(i.filter.run_output.style.display="none");return i.count(t=>{i.filter.run_output.disabled=!(t>1)}),o},block:function(e,i){const n=t.utils.wire()`
    <div class="drawer">
    <div class="header bold">
    <span>${i.title}</span>
    <button
      class="btn-header xyz-icon icon-close primary-colour-filter"
      onclick=${t=>{delete e.filter.current[i.field],e.reload(),n.remove(),e.filter.list.children.length||(e.filter.clear_all.style.display="none")}}>`;return e.filter.list.appendChild(n),n},reset:function(t,e){e.el.parentNode.removeChild(e.el),e.el=null,t.filter.list.children.length||(t.filter.clear_all.style.display="none")},filter_text:Cp(t),filter_numeric:Ep(t),filter_in:kp(t),filter_date:Sp(t),filter_boolean:Mp(t)};return e},Rp=t=>e=>t.utils.wire()`
    <button
      class="btn-wide primary-colour"
      onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Point",callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Point`,Pp=t=>e=>t.utils.wire()`
<button
  class="btn-wide primary-colour"
  onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Polygon",callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Polygon`,Dp=t=>e=>t.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Circle",geometryFunction:t.mapview.lib.draw.createBox(),callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Rectangle`,Lp=t=>e=>t.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Circle",geometryFunction:t.mapview.lib.draw.createRegularPolygon(33),callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Circle`,Fp=t=>e=>t.utils.wire()`
    <button
      class="btn-wide primary-colour"
      onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"LineString",callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Line`,Op=t=>e=>t.utils.wire()`
  <button
    class="btn-wide primary-colour"
    onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"LineString",freehand:!0,callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Freehand`,Ap=t=>e=>{"object"!=typeof e.edit.isoline_mapbox&&(e.edit.isoline_mapbox={});const i=t.utils.wire()`<div>`,n=t.utils.wire()`
      <div
        class="drawer group panel expandable"
      style="max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${e=>{t.utils.toggleExpanderParent(e.target)}}><span>Mapbox Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;e.edit.isoline_mapbox.profile=e.edit.isoline_mapbox.profile||"driving",e.edit.isoline_mapbox.minutes=e.edit.isoline_mapbox.minutes||10;return e.edit.isoline_mapbox.profile="driving",n.appendChild(t.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"driving"},{Walking:"walking"},{Cycling:"cycling"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_mapbox.profile=Object.values(i)[0]}}>${Object.keys(i)[0]}`)}`),n.appendChild(t.utils.wire()`
    <div style="margin-top: 12px;">
        <span>Travel time in minutes: </span>
        <span class="bold">${e.edit.isoline_mapbox.minutes}</span>
        <div class="input-range">
        <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${e.edit.isoline_mapbox.minutes}
        max=60
        step=1
        oninput=${t=>{e.edit.isoline_mapbox.minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_mapbox.minutes}}>`),i.appendChild(n),i.appendChild(t.utils.wire()`
    <button
        class="btn-wide primary-colour"
        onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Point",geometryFunction:function(i,n){n=new t.mapview.lib.geom.Circle(i,1e3*e.edit.isoline_mapbox.minutes);const o=t.mapview.lib.proj.transform(i,`EPSG:${t.mapview.srid}`,"EPSG:4326"),r=new XMLHttpRequest;return r.open("GET",t.host+"/api/provider/mapbox?"+t.utils.paramString({url:`api.mapbox.com/isochrone/v1/mapbox/${e.edit.isoline_mapbox.profile||"driving"}/${o.join(",")}?`,contours_minutes:e.edit.isoline_mapbox.minutes,generalize:e.edit.isoline_mapbox.minutes,polygons:!0})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=e=>{if(200!==e.target.status||!e.target.response.features)return alert("No route found. Try a longer travel time or alternative setup.");const i=(new t.mapview.lib.format.GeoJSON).readFeature({type:"Feature",geometry:e.target.response.features[0].geometry},{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+t.mapview.srid});t.mapview.interaction.draw.Source.clear(),t.mapview.interaction.draw.Source.addFeature(i)},r.send(),n},callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Isoline Mapbox`),i},Ip=t=>e=>{"object"!=typeof e.edit.isoline_here&&(e.edit.isoline_here={});const i=t.utils.wire()`<div>`,n=t.utils.wire()`
      <div
        class="drawer group panel expandable"
      style="max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${e=>{t.utils.toggleExpanderParent(e.target)}}><span>Here Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;e.edit.isoline_here.minutes=e.edit.isoline_here.minutes||10,e.edit.isoline_here.distance=e.edit.isoline_here.distance||10;e.edit.isoline_here.mode="car",n.appendChild(t.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"car"},{Walking:"pedestrian"},{Cargo:"truck"},{"HOV lane":"carHOV"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_here.mode=Object.values(i)[0]}}>${Object.keys(i)[0]}`)}`);e.edit.isoline_here.rangetype="time",n.appendChild(t.utils.wire()`
    <div
        style="margin-top: 8px; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Range</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Time (min)</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{"Time (min)":"time"},{"Distance (km)":"distance"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_here.rangetype=Object.values(i)[0];const r=o.querySelector("input");"time"===e.edit.isoline_here.rangetype&&(o.querySelector("span").textContent="Travel time in minutes: ",r.oninput=t=>{e.edit.isoline_here.minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here.minutes},r.value=e.edit.isoline_here.minutes,r.parentNode.previousElementSibling.textContent=e.edit.isoline_here.minutes),"distance"===e.edit.isoline_here.rangetype&&(o.querySelector("span").textContent="Travel distance in kilometer: ",r.oninput=t=>{e.edit.isoline_here.distance=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here.distance},r.value=e.edit.isoline_here.distance,r.parentNode.previousElementSibling.textContent=e.edit.isoline_here.distance)}}>${Object.keys(i)[0]}`)}`);const o=t.utils.wire()`
    <div style="margin-top: 12px;">
        <span>Travel time in minutes: </span>
        <span class="bold">${e.edit.isoline_here.minutes}</span>
        <div class="input-range">
        <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${e.edit.isoline_here.minutes}
        max=60
        step=1
        oninput=${t=>{e.edit.isoline_here.minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here.minutes}}>`;return n.appendChild(o),i.appendChild(n),i.appendChild(t.utils.wire()`
    <button
        class="btn-wide primary-colour"
        onclick=${i=>{i.stopPropagation();const n=i.target;if(n.classList.contains("active"))return t.mapview.interaction.draw.cancel();n.classList.add("active"),e.show(),e.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),t.mapview.interaction.draw.begin({layer:e,type:"Point",geometryFunction:function(i,n){n=new t.mapview.lib.geom.Circle(i,1e3*e.edit.isoline_here.minutes);const o=t.mapview.lib.proj.transform(i,`EPSG:${t.mapview.srid}`,"EPSG:4326"),r=new XMLHttpRequest,a="time"===e.edit.isoline_here.rangetype?60*(e.edit.isoline_here.minutes||10)||600:"distance"===e.edit.isoline_here.rangetype?1e3*(e.edit.isoline_here.distance||1)||1e3:600;return r.open("GET",t.host+"/api/provider/here?"+t.utils.paramString({url:"isoline.route.api.here.com/routing/7.2/calculateisoline.json?",mode:`${e.edit.isoline_here.type||"fastest"};${e.edit.isoline_here.mode||"car"};traffic:disabled`,start:`geo!${o.reverse().join(",")}`,range:a,rangetype:e.edit.isoline_here.rangetype||"time"})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=e=>{if(200!==e.target.status||!e.target.response.response)return alert("No route found. Try a longer travel time or alternative setup.");const i=(new t.mapview.lib.format.GeoJSON).readFeature({type:"Feature",geometry:{type:"Polygon",coordinates:[e.target.response.response.isoline[0].component[0].shape.map(t=>t.split(",").reverse())]}},{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+t.mapview.srid});t.mapview.interaction.draw.Source.clear(),t.mapview.interaction.draw.Source.addFeature(i)},r.send(),n},callback:()=>{e.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>Isoline Here`),i},jp=t=>{const e={panel:function(i){if(!i.edit)return;const n=t.utils.wire()`
    <div class="drawer panel expandable">`;if(n.appendChild(t.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}><span>Add new Locations</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),i.edit.point&&n.appendChild(e.point(i)),i.edit.polygon&&n.appendChild(e.polygon(i)),i.edit.rectangle&&n.appendChild(e.rectangle(i)),i.edit.circle&&n.appendChild(e.circle(i)),i.edit.line&&n.appendChild(e.line(i)),i.edit.freehand&&n.appendChild(e.freehand(i)),i.edit.isoline_mapbox&&n.appendChild(e.isoline_mapbox(i)),i.edit.isoline_here&&n.appendChild(e.isoline_here(i)),n.children.length<2)return;return n},polygon:Pp(t),point:Rp(t),rectangle:Dp(t),circle:Lp(t),line:Fp(t),freehand:Op(t),isoline_mapbox:Ap(t),isoline_here:Ip(t)};return e},zp=t=>({panel:function(e){if(!e.dataviews||!t.dataviews.tabview.node)return;const i=t.utils.wire()`
    <div class="drawer panel expandable">`;return i.appendChild(t.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}><span>Data Views</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(e.dataviews).forEach(n=>{n[1].key=n[0],n[1].layer=e,i.appendChild(t.utils.wire()`
        <label class="input-checkbox">
        <input
          type="checkbox"
          checked=${!!n[1].display}
          onchange=${e=>{if(n[1].display=e.target.checked,n[1].display)return t.dataviews.tabview.add(n[1]);n[1].remove()}}>
        </input>
        <div></div><span>${n[1].title||n[0]}`),n[1].display&&e.display&&t.dataviews.tabview.add(n[1])}),i}}),Np=t=>({panel:function(e){if(!e.report)return;if(!e.report.templates)return;const i=t.utils.wire()`
    <div class="drawer panel expandable">`;return i.appendChild(t.utils.wire()`
    <div
      class="header primary-colour"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}><span>Reports</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(e.report.templates).forEach(n=>{const o=t.host+"/view/"+encodeURIComponent(e.report.template)+"?"+t.utils.paramString(Object.assign(n[1],{locale:t.workspace.locale.key,layer:e.key,lat:t.hooks.current.lat,lng:t.hooks.current.lng,z:t.hooks.current.z}));i.appendChild(t.utils.wire()`
      <a
        target="_blank"
        href="${o}"
        class="link-with-img">
        <div class="xyz-icon icon-event-note"></div><span>${n[1].name||n[0]}`)}),i}}),Hp=t=>{const e={create:function(i){i.view=t.utils.wire()`<div class="drawer layer-view">`;const n=t.utils.wire()`
    <div class="header enabled"><span>${i.name||i.key}`;"cluster"===i.format&&i.style.marker&&n.appendChild(t.utils.wire()`
      <img
        class="btn-header"
        title="Default icon"
        style="float: right; cursor: help;"
        src="${t.utils.svg_symbols(i.style.marker)}">`);if(n.appendChild(t.utils.wire()`
    <button
      title="Zoom to filtered layer extent"
      class="btn-header xyz-icon icon-fullscreen"
      onclick=${t=>{t.stopPropagation(),i.zoomToExtent()}}>`),n.toggleDisplay=t.utils.wire()`
    <button
      title="Toggle visibility"
      class="${"btn-header xyz-icon icon-toggle "+(i.display&&"on")}"
      onclick=${t=>{t.stopPropagation(),i.display?i.remove():i.show()}}>`,n.appendChild(n.toggleDisplay),i.view.addEventListener("toggleDisplay",()=>{n.toggleDisplay.classList.toggle("on"),i.style&&i.style.bringToFront&&(i.style.bringToFront.disabled=!!i.display)}),i.view.appendChild(n),i.meta){const e=t.utils.wire()`<p class="meta">`;e.innerHTML=i.meta,i.view.appendChild(e)}const o=e.style.panel(i);o&&i.view.appendChild(o);const r=e.filter.panel(i);r&&i.view.appendChild(r);const a=e.data.panel(i);a&&i.view.appendChild(a);const s=e.draw.panel(i);s&&i.view.appendChild(s);const l=e.report.panel(i);if(l&&i.view.appendChild(l),i.scripts&&Object.entries(i.scripts).forEach(e=>{const n=t.utils.wire()`<script src="${e[1]}">`,o=r=>{r.detail(t,i),document.removeEventListener(e[0],o,!0),n.remove()};document.addEventListener(e[0],o,!0),i.view.appendChild(n)}),i.view.children.length<=1)return;i.view.classList.add("expandable"),n.onclick=e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)},n.appendChild(t.utils.wire()`
    <button
      title="Toggle layer dashboard"
      class="btn-header xyz-icon icon-expander"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target)}}>`);const u=i.view.querySelector(".panel");u&&u.classList.add("expanded")},style:xp(t),filter:Tp(t),draw:jp(t),report:Np(t),data:zp(t)};return e},Bp=t=>({init:function(e){t.layers.listview.node=e.target,t.layers.listview.node.innerHTML="",t.layers.listview.groups={},Object.values(t.layers.list).forEach(e=>{if(t.layers.view.create(e),!e.group)return t.layers.listview.node.appendChild(e.view),e.view.querySelectorAll(".panel").forEach(t=>{t.style.maxHeight=t.querySelector(".header").offsetHeight+"px"}),void(e.view.style.maxHeight=e.view.querySelector(".header").offsetHeight+"px");t.layers.listview.groups[e.group]||function(e){const i={list:[]};t.layers.listview.groups[e.group]=i;const n=t.utils.wire()`
    <div class="drawer layer-group expandable">`;t.layers.listview.node.appendChild(n);const o=t.utils.wire()`
    <div
      class="header enabled"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target,!0)}}>
      <span>${e.group}`;n.appendChild(o);const r=t.utils.wire()`<div class="meta">`;n.appendChild(r),i.chkVisibleLayer=()=>{i.list.some(t=>t.display)?a.classList.add("on"):a.classList.remove("on")},i.addLayer=e=>{if(e.groupmeta){const i=t.utils.wire()`<div>`;i.innerHTML=e.groupmeta,r.appendChild(i)}i.list.push(e),n.appendChild(e.view),e.view.querySelectorAll(".panel").forEach(t=>{t.style.maxHeight=t.querySelector(".header").offsetHeight+"px"}),e.view.style.maxHeight=e.view.querySelector(".header").offsetHeight+"px",i.chkVisibleLayer()};const a=t.utils.wire()`
    <button
      class="btn-header xyz-icon icon-toggle"
      title="Hide layers from group"
      onclick=${t=>{t.stopPropagation(),t.target.classList.toggle("on"),t.target.classList.contains("on")?i.list.filter(t=>!t.display).forEach(t=>t.show()):i.list.filter(t=>t.display).forEach(t=>t.remove())}}>`;o.appendChild(a),o.appendChild(t.utils.wire()`
    <button 
      class="xyz-icon btn-header icon-expander"
      title="Toggle group panel"
      onclick=${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target)}}>`),n.style.maxHeight=o.offsetHeight+"px"}(e),t.layers.listview.groups[e.group].addLayer(e)})}}),Gp=t=>function(){if(!this.tables)return this.table;let e,i=parseInt(t.mapview.getZoom()),n=Object.keys(this.tables),o=parseInt(n[0]),r=parseInt(n[n.length-1]);return e=this.tables[i],e=i<o?this.tables[o]:e,e=i>r?this.tables[r]:e,e},Vp=t=>function(){if(!this.tables)return this.table;let t=Object.keys(this.tables);return this.tables[t[0]]||this.tables[t[1]]},Wp=t=>function(){if(!this.tables)return this.table;let t=Object.keys(this.tables);return this.tables[t[t.length-1]]||this.tables[t[t.length-2]]},qp=t=>function(e){const i=new XMLHttpRequest;i.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"layer_extent",locale:t.workspace.locale.key,srid:t.mapview.srid,layer:this.key,filter:this.filter&&JSON.stringify(this.filter.current)})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=i=>{if(200!==i.target.status)return;const n=/\((.*?)\)/.exec(i.target.response.box2d)[1].replace(/ /g,",");t.mapview.flyToBounds(n.split(",").map(t=>parseFloat(t)),e)},i.send()},$p=t=>function(){const e=this;!e.display&&e.view&&e.view.dispatchEvent(new CustomEvent("toggleDisplay")),e.display=!0,e.L&&t.map.removeLayer(e.L),t.map.addLayer(e.L),e.style&&e.style.label&&(t.map.getLayers().forEach(i=>{i===e.label&&t.map.removeLayer(e.label)}),e.style.label.display&&t.map.addLayer(e.label)),t.mapview.attribution.check(),t.hooks&&t.hooks.push("layers",e.key),e.group&&t.layers.listview.groups&&t.layers.listview.groups[e.group]&&t.layers.listview.groups[e.group].chkVisibleLayer(),e.dataviews&&t.dataviews.tabview.node&&Object.entries(e.dataviews).forEach(e=>{e[1].display&&t.dataviews.tabview.add(e[1])})},Yp=t=>function(){const e=this;e.display&&e.view&&e.view.dispatchEvent(new CustomEvent("toggleDisplay")),e.display=!1,e.L&&t.map.removeLayer(e.L),e.style&&e.style.label&&e.label&&t.map.removeLayer(e.label),e.attribution&&t.mapview.attribution.remove(e.attribution),t.mapview.attribution.check(),t.hooks&&t.hooks.filter("layers",e.key),e.group&&t.layers.listview.groups&&t.layers.listview.groups[e.group]&&t.layers.listview.groups[e.group].chkVisibleLayer(),e.dataviews&&t.dataviews.tabview.node&&Object.entries(e.dataviews).forEach(t=>{t[1].tab&&t[1].remove()})},Xp=t=>function(e){const i=new XMLHttpRequest;i.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"count_locations",locale:t.workspace.locale.key,layer:this.key,table:this.tableMin(),filter:this.filter&&JSON.stringify(this.filter.current)})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=t=>{200===t.target.status&&e&&e(parseInt(t.target.response.count))},i.send()},Up=t=>function(){1e3!==this.L.getZIndex()&&(Object.values(t.layers.list).map(t=>{"tiles"!==t.format&&t.L.setZIndex(t.style.zIndex||1)&&t.display&&t.reload()}),this.L.setZIndex(1e3),this.reload())},Kp=t=>e=>{t.mapview.popup.node&&t.mapview.popup.node.remove(),e.hook=`${e.layer.key}!${e.table}!${e.id}`;let i={stamp:parseInt(Date.now())};if(t.locations.list.some(t=>{if(t.location&&t.location.hook===e.hook)return t.location.remove(),t.stamp=0,!0}))return;for(const e of t.locations.list){if(!e.location){i=e;break}e.stamp<i.stamp&&(i=e)}if(i.stamp=parseInt(Date.now()),i.location&&i.location.remove(),i.location=e,e.style=i.style,e.colorFilter=i.colorFilter,e._new)return t.locations.decorate(e),e.marker=t.mapview.lib.proj.transform(t.utils.turf.pointOnFeature(e.geometry).geometry.coordinates,"EPSG:"+e.layer.srid,"EPSG:"+t.mapview.srid),"function"==typeof e.callback?e.callback(e):t.locations.selectCallback(e);const n=new XMLHttpRequest;i.location.xhr=n,n.open("GET",t.host+"/api/location/get?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.layer.key,table:e.table,id:e.id})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=n=>{if(n.target.status>200)return delete i.stamp,void(t.hooks&&t.hooks.filter("locations",e.hook));t.hooks&&t.hooks.push("locations",e.hook);const o=e.layer.infoj.map(e=>{const i=t.utils.cloneDeep(e);return i.title=n.target.response.properties[i.field+"_label"]||i.title,i.value=n.target.response.properties[i.field],i});if(t.locations.decorate(e,{infoj:o,geometry:n.target.response.geometry,editable:e.layer.edit,record:i}),e.marker=t.mapview.lib.proj.transform(t.utils.turf.pointOnFeature(n.target.response.geometry).geometry.coordinates,"EPSG:"+e.layer.srid,"EPSG:"+t.mapview.srid),"function"==typeof e.callback)return e.callback(e);t.locations.selectCallback(e)},n.send(),i.location.remove=()=>{i.location.xhr.abort(),i.location=null}},Zp=t=>e=>(t.locations.view.create(e),e.draw(),e.Marker=t.mapview.geoJSON({geometry:{type:"Point",coordinates:e.marker},zIndex:2e3,style:new t.mapview.lib.style.Style({image:t.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+t.locations.list.indexOf(e.record)),color:e.style.strokeColor,scale:.05,anchor:[.5,1]})})}),e._flyTo&&e.flyTo(),t.mapview.popup?t.locations.listview.node?t.locations.listview.add(e):void t.mapview.popup.create({coords:e.marker,content:e.view}):alert(JSON.stringify(e.infoj,t.utils.getCircularReplacer()," "))),Jp=t=>e=>{if(!e.infoj||e.infoj.length<1)return;e.geometries=e.geometries.filter(e=>{t.map.removeLayer(e)}),e.geometryCollection=e.geometryCollection.filter(e=>{t.map.removeLayer(e)}),e.tabviews.forEach(t=>t.remove&&t.remove());const i=t.utils.wire()`
  <div class="location-view-grid" style="display: grid;">`,n={};for(const o of e.infoj){if(e.view&&e.view.classList.contains("disabled"))break;if(o.edit||null!==o.value)if(o.listview=i,"report"===document.body.dataset.viewmode&&(o.edit=null),o.location=e,o.displayValue="numeric"===o.type?parseFloat(o.value).toLocaleString("en-GB",{maximumFractionDigits:2}):"integer"===o.type?parseInt(o.value).toLocaleString("en-GB",{maximumFractionDigits:0}):"date"===o.type?t.utils.formatDate(o.value):"datetime"===o.type?t.utils.formatDateTime(o.value):o.value,o.prefix&&(o.displayValue=o.prefix+o.displayValue),o.suffix&&(o.displayValue=o.displayValue+o.suffix),o.group&&(n[o.group]||(n[o.group]=t.utils.wire()`
        <div
          class="drawer group panel expandable ${o.class||""}"
          style="display: grid; grid-column: 1 / 3; max-height: 20px;">
          <div
            class="header primary-colour"
            style="text-align: left; grid-column: 1 / 3;"
            onclick=${e=>{t.utils.toggleExpanderParent(e.target)}}>
            <span>${o.group}</span>
            <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,o.listview.appendChild(n[o.group])),o.group_class&&o.group_class.split(" ").forEach(t=>n[o.group].classList.add(t)),o.expanded&&n[o.group].classList.add("expanded"),o.listview=n[o.group]),o.script){const e=t.utils.wire()`<script src="${o.src}">`;o.target=t.utils.wire()`
      <div style="grid-column: 1 / 3;" class="${o.class||""}">`;const i=n=>{n.detail(t,o),document.removeEventListener(o.script,i,!0),e.remove()};document.addEventListener(o.script,i,!0),o.target.appendChild(e),o.listview.appendChild(o.target)}else if("dataview"!==o.type)o.title&&(o.title_div=t.utils.wire()`
      <div
        class="${`label lv-${o.level||"0"} ${o.class||""}`}"
        style="grid-column: 1;"
        title="${o.tooltip||null}">${o.title}`,o.listview.appendChild(o.title_div)),"key"!==o.type?"title"!==o.type?"streetview"!==o.type?"report"!==o.type?"images"!==o.type?"documents"!==o.type?"geometry"!==o.type?"meta"!==o.type?"boolean"!==o.type?(o.edit||o.displayValue)&&(o.inline||"integer"===o.type^"numeric"===o.type^"date"===o.type?(o.val=t.utils.wire()`<div class="val num ${o.class||""}" style="grid-column: 2;">`,o.listview.appendChild(o.val)):(o.title_div&&(o.title_div.style.gridColumn="1 / 3"),o.val=t.utils.wire()`<div class="val ${o.class||""}" style="grid-column: 1 / 3;">`,o.listview.appendChild(o.val)),!o.edit||o.fieldfx?"html"!==o.type?o.val.textContent=o.displayValue:(o.val.style="grid-column: 1 / 3;",o.val.innerHTML=o.value):t.locations.view.edit.input(o)):t.locations.view.boolean(o):t.locations.view.meta(o):t.locations.view.geometry(o):t.locations.view.documents(o):t.locations.view.images(o):t.locations.view.report(o):t.locations.view.streetview(o):o.title_div.style.gridColumn="1 / 3":o.listview.appendChild(t.utils.wire()`
      <div
        class="label lv-0 ${o.class||""}"
        style="grid-column: 2; margin: 3px;">
        <span
          title="Source layer"
          style="${"float: right; padding: 3px; cursor: help; border-radius: 2px; background-color: "+t.utils.Chroma(e.style.strokeColor).alpha(.3)+";"}"
          >${e.layer.name}`);else{const e=t.locations.view.dataview(o);e&&o.listview.appendChild(e)}}return i},Qp=t=>e=>{e.__title_div&&(e.__title_div.style.gridColumn="1 / 3");const i=t.mapview.lib.proj.transform(e.location.marker,"EPSG:"+t.mapview.srid,"EPSG:4326"),n=`${t.host}/api/proxy?uri=/maps/api/streetview?location=${i[1]},${i[0]}%26source=outdoor%26size=300x230&provider=GOOGLE&host=maps.googleapis.com`;e.listview.appendChild(t.utils.wire()`
    <div
      class="${e.class||""}"
      style="grid-column: 1 / 3;">
      <a
        target="_blank"
        href="${"https://www.google.com/maps?cbll="+i[1]+","+i[0]+"&layer=c"}">
        <img src="${n}">`)},tf=t=>e=>{if(!e.value.length&&!e.edit)return e.title_div.remove();e.title_div&&(e.title_div.style.gridColumn="1 / 3");for(let n of e.value)e.listview.appendChild(t.utils.wire()`
      <div
        class="${e.class||""}"
        style="grid-column: 1 / 3; position: relative;">
        <img src=${n} style="width:100%;">
        ${e.edit&&t.utils.wire()`
        <button
          class="xyz-icon icon-trash img-remove"
          data-name=${n.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
          data-src=${n}
          onclick=${t=>i(t)}>
        </button>`}`);function i(i){if(!confirm("Remove image?"))return;const n=i.target,o=new XMLHttpRequest;o.open("GET",t.host+"/api/provider/cloudinary?"+t.utils.paramString({destroy:!0,public_id:n.dataset.name})),o.onload=i=>{if(i.target.status>202)return;const o=new XMLHttpRequest;o.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"set_field_array",locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,action:"remove",field:e.field,secure_url:n.dataset.src,id:e.location.id})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=t=>{t.target.status>202||n.parentNode.remove()},o.send()},o.send()}e.edit&&e.listview.appendChild(t.utils.wire()`
    <div class="list" style="grid-column: 1 / 3;">
    <div class="add xyz-icon icon-add-photo off-black-filter">
    <input
      type="file"
      accept="image/*;capture=camera"
      onchange=${n=>{const o=new FileReader,r=n.target.files[0];if(!r)return;const a=t.utils.wire()`
          <div><div class="xyz-icon loader">`;e.listview.insertBefore(a,e.listview.childNodes[e.listview.childNodes.length-1]),o.onload=n=>{const o=new Image;o.onload=()=>{let n=t.utils.wire()`<canvas>`,r=o.width,s=o.height;r>s&&r>1024?(s*=1024/r,r=1024):s>1024&&(r*=1024/s,s=1024),n.width=r,n.height=s,n.getContext("2d").drawImage(o,0,0,r,s);const l=n.toDataURL("image/jpeg",.5),u=new XMLHttpRequest;u.open("POST",t.host+"/api/provider/cloudinary?"+t.utils.paramString({resource_type:"image"})),u.setRequestHeader("Content-Type","application/octet-stream"),u.responseType="json",u.onload=n=>{if(n.target.status>202)return console.error("image upload failed");const o=n.target.response.secure_url,r=n.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),s=new XMLHttpRequest;s.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"set_field_array",locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,action:"append",field:e.field,secure_url:o,id:e.location.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=n=>{n.target.status>202||t.utils.bind(a)`
                  <img src=${o}>
                    ${e.edit&&t.utils.wire()`
                      <button
                        class="xyz-icon icon-trash img-remove"
                        data-name=${r}
                        data-src=${o}
                        onclick=${t=>i(t)}>
                      </button>`}`},s.send()},u.send(t.utils.dataURLtoBlob(l))},o.src=n.target.result},o.readAsDataURL(r),n.target.value=""}}>`)},ef=t=>e=>{if(!e.value.length&&!e.edit)return e.title_div.remove();e.title_div&&(e.title_div.style.gridColumn="1 / 3"),e.documents=t.utils.wire()`<div style="grid-column: 1 / 3;"">`,e.listview.appendChild(e.documents);for(let n of e.value)e.documents.appendChild(t.utils.wire()`
		<div class="item">
		${e.edit&&t.utils.wire()`
		<button
			class="xyz-icon icon-trash link-remove"
			data-name=${n.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
			data-href=${n}
			onclick=${t=>i(t)}>
		</button>`}		
		<a href=${n}>${n.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}`);function i(i){if(!confirm("Remove document link?"))return;const n=i.target,o=new XMLHttpRequest;o.open("GET",t.host+"/api/provider/cloudinary?"+t.utils.paramString({destroy:!0,public_id:n.dataset.name})),o.onload=i=>{if(i.target.status>202)return;const o=new XMLHttpRequest;o.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"set_field_array",locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,action:"remove",field:e.field,secure_url:n.dataset.href,id:e.location.id})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=t=>{t.target.status>202||n.parentNode.remove()},o.send()},o.send()}e.edit&&e.listview.appendChild(t.utils.wire()`
    <div class="list" style="grid-column: 1 / 3;">
	<div class="add xyz-icon icon-cloud-upload off-black-filter">
	<input
	type="file"
	accept=".txt,.pdf,.doc,.docx,.xls,.xlsx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document;"
	onchange=${n=>{const o=new FileReader,r=n.target.files[0];if(!r)return;const a=t.utils.wire()`<div class="item"><div class="xyz-icon loader">`;e.documents.appendChild(a),o.onload=n=>{const o=new XMLHttpRequest;o.open("POST",t.host+"/api/provider/cloudinary?"+t.utils.paramString({resource_type:"raw",public_id:r.name})),o.setRequestHeader("Content-Type","application/octet-stream"),o.responseType="json",o.onload=n=>{if(n.target.status>202)return console.log("document_upload failed");const o=n.target.response.secure_url,r=n.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),s=new XMLHttpRequest;s.open("GET",t.host+"/api/query?"+t.utils.paramString({template:"set_field_array",locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,action:"append",field:e.field,secure_url:o,id:e.location.id})),s.setRequestHeader("Content-Type","application/json"),s.responseType="json",s.onload=n=>{n.target.status>202||t.utils.bind(a)`
				<div class="item">
				${e.edit&&t.utils.wire()`
				<button
					class="xyz-icon icon-trash link-remove"
					data-name=${r}
					data-href=${o}
					onclick=${t=>i(t)}>
				</button>`}
				<a href=${o} target="_blank">${r}`},s.send()},o.send(n.target.result)},o.readAsDataURL(r),n.target.value=""}}>`)},nf=t=>e=>{if(!e.value)return;let i=t.utils.wire()`
   <div 
    style="grid-column: 1 / 3;
    width: 100%;
    padding: 4px;
    margin-top: 2px;
    color: #666;
    border-radius: 4px;
    background-color: linen;">`,n=t.utils.wire()`<div style="display: grid;">`;i.appendChild(n),e.listview.appendChild(i),Object.entries(e.value).forEach(e=>{n.appendChild(t.utils.wire()`<div style="grid-column: 1;">${e[0]}`),n.appendChild(t.utils.wire()`<div style="grid-column: 2;">${e[1]}`)})},of=t=>e=>{if(!e.report.template)return;const i=t.host+"/view/"+encodeURIComponent(e.report.template)+"?"+t.utils.paramString(Object.assign(e.report,{locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,id:e.location.id,host:t.host}));e.listview.appendChild(t.utils.wire()`
    <div
      class="${"label lv-0 "+(e.class||"")}"
      style="grid-column: 1 / 3;">
      <a
        class="primary-colour"
        target="_blank"
        href="${i}">
          ${e.report.title||e.report.name||"Location Report"}`)},rf=t=>e=>{e.listview.appendChild(t.utils.wire()`
    <div style="padding-top: 5px; grid-column: 1 / 3">
      <label class="input-checkbox">
        <input type="checkbox"
          disabled=${!e.edit}
          checked=${!!e.value}
          onchange=${t=>{e.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:e,newValue:!!t.target.checked}}))}}>
        </input>
        <div></div><span>${e.title||e.name||e.field}`)},af=t=>{const e=(t=>({create:function(e){const i=[e.location.geometry.coordinates[1],e.location.geometry.coordinates[0]],n=new XMLHttpRequest,o="time"!==e.edit.isoline_here.rangetype&&e.edit.isoline_here.rangetype?"distance"===e.edit.isoline_here.rangetype?1e3*(e.edit.isoline_here._distance||1)||1e3:600:60*(e.edit.isoline_here._minutes||e.edit.isoline_here.minutes||10)||600;n.open("GET",t.host+"/api/provider/here?"+t.utils.paramString({url:"isoline.route.api.here.com/routing/7.2/calculateisoline.json?",mode:`${e.edit.isoline_here.type||"fastest"};${e.edit.isoline_here.mode||"car"};traffic:disabled`,start:`geo!${i.join(",")}`,range:o,rangetype:e.edit.isoline_here.rangetype||"time"})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=t=>{if(200!==t.target.status||!t.target.response.response)return e.location.view&&e.location.view.classList.remove("disabled"),console.log(t.target.response),alert("No route found. Try alternative set up.");if(e.newValue={type:"Polygon",coordinates:[t.target.response.response.isoline[0].component[0].shape.map(t=>t.split(",").reverse())]},e.edit.isoline_here.meta){let t=new Date;e.location.infoj.filter(t=>"meta"===t.type&&t.field===e.edit.isoline_here.meta).forEach(i=>i.newValue={"Recent isoline":"Here",Mode:e.edit.isoline_here.mode,"Range type":e.edit.isoline_here.rangetype,Range:"time"===e.edit.isoline_here.rangetype?e.edit.isoline_here._minutes:e.edit.isoline_here._distance,Created:`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${t.getMinutes()>8?t.getMinutes()+1:`0${t.getMinutes()+1}`}`})}e.location.update()},n.send(),e.location.view&&e.location.view.classList.add("disabled")},settings:function(e){if(e.edit.isoline_here&&(e.edit.isoline_here.minutes||!e.edit.isoline_here.minutes&&e.value))return t.utils.wire()`<div>`;const i=t.utils.wire()`
      <div
        class="drawer group panel expandable ${e.class||""}"
      style="display: grid; grid-column: 1 / 3; max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${e=>{t.utils.toggleExpanderParent(e.target)}}><span>Here Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;e.edit.isoline_here._minutes=e.edit.isoline_here.minutes||10,e.edit.isoline_here._distance=e.edit.isoline_here.distance||10;e.edit.isoline_here.mode="car",i.appendChild(t.utils.wire()`
    <div
        style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"car"},{Walking:"pedestrian"},{Cargo:"truck"},{"HOV lane":"carHOV"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_here.mode=Object.values(i)[0]}}>${Object.keys(i)[0]}`)}`);e.edit.isoline_here.rangetype="time",i.appendChild(t.utils.wire()`
    <div
        style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Range</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Time (min)</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{"Time (min)":"time"},{"Distance (km)":"distance"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const o=t.target.closest(".btn-drop");o.classList.toggle("active"),o.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_here.rangetype=Object.values(i)[0];const r=n.querySelector("input");"time"===e.edit.isoline_here.rangetype&&(n.querySelector("span").textContent="Travel time in minutes: ",r.oninput=t=>{e.edit.isoline_here._minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here._minutes},r.value=e.edit.isoline_here._minutes,r.parentNode.previousElementSibling.textContent=e.edit.isoline_here._minutes),"distance"===e.edit.isoline_here.rangetype&&(n.querySelector("span").textContent="Travel distance in kilometer: ",r.oninput=t=>{e.edit.isoline_here._distance=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here._distance},r.value=e.edit.isoline_here._distance,r.parentNode.previousElementSibling.textContent=e.edit.isoline_here._distance)}}>${Object.keys(i)[0]}`)}`);const n=t.utils.wire()`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>Travel time in minutes: </span>
        <span class="bold">${e.edit.isoline_here._minutes}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${e.edit.isoline_here._minutes}
          max=60
          step=1
          oninput=${t=>{e.edit.isoline_here._minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_here._minutes}}>`;return i.appendChild(n),i}}))(t),i=(t=>({create:function(e){const i=e.location.geometry.coordinates,n=new XMLHttpRequest;n.open("GET",t.host+"/api/location/edit/isoline/mapbox?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.location.layer.key,table:e.location.table,coordinates:i.join(","),minutes:e.edit.isoline_mapbox._minutes||e.edit.isoline_mapbox.minutes,profile:e.edit.isoline_mapbox.profile,meta:e.edit.isoline_mapbox.meta||null})),n.open("GET",t.host+"/api/provider/mapbox?"+t.utils.paramString({url:`api.mapbox.com/isochrone/v1/mapbox/${e.edit.isoline_mapbox.profile||"driving"}/${i.join(",")}?`,contours_minutes:e.edit.isoline_mapbox._minutes||e.edit.isoline_mapbox.minutes,generalize:e.edit.isoline_mapbox._minutes||e.edit.isoline_mapbox.minutes,polygons:!0})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=t=>{if(200!==t.target.status||!t.target.response.features)return e.location.view&&e.location.view.classList.remove("disabled"),console.log(t.target.response),alert("No route found. Try alternative set up.");if(e.newValue=t.target.response.features[0].geometry,e.edit.isoline_mapbox.meta){let t=new Date;e.location.infoj.filter(t=>"meta"===t.type&&t.field===e.edit.isoline_mapbox.meta).forEach(i=>i.newValue={"Recent isoline":"Mapbox",Mode:e.edit.isoline_mapbox.profile,Minutes:e.edit.isoline_mapbox._minutes,Created:`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${t.getMinutes()>8?t.getMinutes()+1:`0${t.getMinutes()+1}`}`})}e.location.update()},n.send(),e.location.view&&e.location.view.classList.add("disabled")},settings:function(e){if(e.edit.isoline_mapbox&&(e.edit.isoline_mapbox.minutes||!e.edit.isoline_mapbox.minutes&&e.value))return t.utils.wire()`<div>`;const i=t.utils.wire()`
      <div
        class="drawer group panel expandable ${e.class||""}"
      style="display: grid; grid-column: 1 / 3; max-height: 20px;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${e=>{t.utils.toggleExpanderParent(e.target)}}><span>Mapbox Isoline settings</span>
      <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;e.edit.isoline_mapbox.profile=e.edit.isoline_mapbox.profile||"driving",e.edit.isoline_mapbox._minutes=e.edit.isoline_mapbox.minutes||10;return e.edit.isoline_mapbox.profile="driving",i.appendChild(t.utils.wire()`
    <div
      style="margin-top: 8px; grid-column: 1 / 3; display: grid; grid-template-columns: 50px 1fr; align-items: center;">
        <span style="grid-column: 1;">Mode</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
                <span>Driving</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${[{Driving:"driving"},{Walking:"walking"},{Cycling:"cycling"}].map(i=>t.utils.wire()`
                <li onclick=${t=>{const n=t.target.closest(".btn-drop");n.classList.toggle("active"),n.querySelector(":first-child").textContent=Object.keys(i)[0],e.edit.isoline_mapbox.profile=Object.values(i)[0]}}>${Object.keys(i)[0]}`)}`),i.appendChild(t.utils.wire()`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
      <span>Travel time in minutes: </span>
      <span class="bold">${e.edit.isoline_mapbox._minutes}</span>
      <div class="input-range">
      <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${e.edit.isoline_mapbox._minutes}
        max=60
        step=1
        oninput=${t=>{e.edit.isoline_mapbox._minutes=parseInt(t.target.value),t.target.parentNode.previousElementSibling.textContent=e.edit.isoline_mapbox._minutes}}>`),i}}))(t),n=(t=>e=>{e.value.features&&(e.value.features.map(i=>{let n;if(e.style||(n=e.location.style),e.style.theme||(n=e.style),e.style.theme&&"categorized"===e.style.theme.type&&(n=e.style.theme&&e.style.theme.cat[i.properties[e.style.theme.field]].style),e.style.theme&&"graduated"===e.style.theme.type)for(let t=0;t<e.style.theme.cat_arr.length&&!(i.properties[e.style.theme.field]<e.style.theme.cat_arr[t].value);t++)n=e.style.theme.cat_arr[t].style;let o=t.mapview.geoJSON({geometry:i.geometry,dataProjection:"4326",zIndex:e.location.layer.L.getZIndex()-1,style:new t.mapview.lib.style.Style({stroke:n.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(n.color||n.strokeColor).alpha(1),width:e.style.strokeWidth||1}),fill:new t.mapview.lib.style.Fill({color:t.utils.Chroma(n.fillColor||n.strokeColor).alpha(void 0===n.fillOpacity?1:parseFloat(n.fillOpacity)||0).rgba()})})});e.location.geometryCollection.push(o)}),e.location.geometries.push(e.location.geometryCollection),e.display=!0,e.style&&e.style.theme&&e.style.theme.legend&&(e.legend=t.utils.wire()`<div class="legend lv-1">`,e.legend.appendChild(t.layers.view.style.legend({format:"mvt",style:e.style})),e.container.style.display="block",e.container.appendChild(e.legend)))})(t),o=(t=>e=>new Promise((i,n)=>{const o=new XMLHttpRequest;o.open("GET",t.host+"/api/query?"+t.utils.paramString(Object.assign({locale:t.workspace.locale.key,layer:e.location.layer&&e.location.layer.key,id:e.location.id,template:encodeURIComponent(e.query)},e.queryparams||{}))),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=t=>{if(t.target.status>=300)return n({err:t.target.status});i(t.target.response)},o.send()}))(t);return r=>{if(r.query)r.display&&c(),a(Object.assign(r,{callback:t=>{r.display?c():l()}}));else{if(!r.value&&!r.edit)return;a(r)}function a(e){e.style=Object.assign({},e.location.style,e.style),e.container=t.utils.wire()`
      <div 
      class=${"lv-"+(e.level||0)+" "+(e.class||"")}
      style="grid-column: 1 / 3; position: relative; display: flex; align-items: center;">`,e.listview.appendChild(e.container),e.container.appendChild(t.utils.wire()`
        <label class="input-checkbox">
        <input type="checkbox"
        checked=${e.edit&&e.value||!!e.display}
        onchange=${t=>(e.display=t.target.checked,e.callback?e.callback(t):e.display&&e.edit?u():e.display&&!e.edit?s():!e.display&&e.edit?(e.newValue=null,e.edit.isoline_here&&e.edit.isoline_here.meta&&e.location.infoj.filter(t=>"meta"===t.type&&t.field===e.edit.isoline_here.meta).forEach(t=>t.newValue=null),e.edit.isoline_mapbox&&e.edit.isoline_mapbox.meta&&e.location.infoj.filter(t=>"meta"===t.type&&t.field===e.edit.isoline_mapbox.meta).forEach(t=>t.newValue=null),void e.location.update()):e.display||e.edit?void 0:l())}>
        </input>
        <div></div>
        <span>${e.name||"Geometry"}<span>`),!e.style.theme&&e.container.appendChild(t.utils.wire()`
        <div class="sample-circle"
        style="${`\n          background-color: ${t.utils.Chroma(e.style.fillColor||e.style.strokeColor).alpha(void 0===e.style.fillOpacity?1:parseFloat(e.style.fillOpacity)||0)};\n          border-color: ${t.utils.Chroma(e.style.color||e.style.strokeColor).alpha(1)};\n          border-style: solid;\n          border-width: ${e.style.strokeWidth||1}px;\n          margin-left: auto;`}">`)}function s(){"FeatureCollection"===r.value.type?n(r):(r.geometry=r.value&&t.mapview.geoJSON({geometry:"object"==typeof r.value&&r.value||JSON.parse(r.value),dataProjection:"4326",zIndex:r.location.layer.L.getZIndex()-1,style:new t.mapview.lib.style.Style({stroke:r.style.strokeColor&&new t.mapview.lib.style.Stroke({color:t.utils.Chroma(r.style.color||r.style.strokeColor).alpha(1),width:r.style.strokeWidth||1}),fill:new t.mapview.lib.style.Fill({color:t.utils.Chroma(r.style.fillColor||r.style.strokeColor).alpha(void 0===r.style.fillOpacity?1:parseFloat(r.style.fillOpacity)||0).rgba()})})}),r.geometry&&r.location.geometries.push(r.geometry),r.display=!0)}function l(){r.display=!1,r.legend&&r.legend.remove(),"FeatureCollection"===r.value.type?r.location.geometries.splice(r.location.geometries.indexOf(r.geometryCollection),1)&&r.location.geometryCollection.map(e=>t.map.removeLayer(e)):r.geometry&&r.location.geometries.splice(r.location.geometries.indexOf(r.geometry),1)&&t.map.removeLayer(r.geometry)}function u(){if(r.edit)return r.edit.isoline_mapbox?i.create(r):r.edit.isoline_here?e.create(r):void 0}function c(){r.promise=o(r),r.promise.then(t=>{r.value=t[r.field],s()})}if(r.edit&&r.edit.isoline_mapbox&&r.container.parentNode.insertBefore(i.settings(r),r.container.nextSibling),r.edit&&r.edit.isoline_here&&r.container.parentNode.insertBefore(e.settings(r),r.container.nextSibling),r.value&&(r.display||r.edit))return s();!r.value&&r.display&&u()}},sf=t=>e=>{e.val.appendChild(t.utils.wire()`
  <div>
  <span>${e.edit.range.label}</span>
  <span class="bold">${e.value}</span>
  <div class="input-range">
  <input
    class="secondary-colour-bg"
    type="range"
    min=${e.edit.range.min}
    value=${e.value}
    max=${e.edit.range.max}
    oninput=${t=>{t.target.parentNode.previousElementSibling.textContent=t.target.value}}>`)},lf=t=>e=>{const i=e.edit.options.find(t=>"object"==typeof t&&Object.values(t)[0]===e.value||t===e.value)||e.value;e.displayValue=i&&"object"==typeof i&&Object.keys(i)[0]||i||e.value,e.val.appendChild(t.utils.wire()`
      <button class="btn-drop">
      <div
      class="head"
      onclick=${t=>{t.preventDefault(),t.target.parentElement.classList.toggle("active")}}>
      <span>${e.displayValue}</span>
      <div class="icon"></div>
      </div>
      <ul>
      ${e.edit.options.map(i=>{let n=i,o=i;return"object"==typeof i&&(n=Object.keys(i)[0],o=Object.values(i)[0]),t.utils.wire()`<li onclick=${t=>{const i=t.target.closest(".btn-drop");i.classList.toggle("active"),i.querySelector(":first-child").textContent=n,i.querySelector(":first-child").value=o,e.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:i.querySelector(":first-child"),entry:e}}))}}>${n}`})}`)},uf=t=>e=>{const i=t.utils.wire()`<input type="text" placeholder="Pick from calendar." style="text-align: end;">${"datetime"===e.type&&t.utils.formatDateTime(e.value)||t.utils.formatDate(e.value)||""}`.childNodes[0];i.value="datetime"===e.type&&t.utils.formatDateTime(e.value)||t.utils.formatDate(e.value)||"",e.val.appendChild(i),t.utils.flatpickr({value:e.value?new Date(1e3*e.value).toISOString():"",element:i,enableTime:"datetime"===e.type,callback:n=>{i.value=n;const o=t.utils.meltDateStr(n);e.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:i,entry:e,newValue:o}}))}})},cf=t=>e=>{let i=t.utils.wire()`
  <textarea
    value=${e.value||""}
    style="auto; min-height: 50px;"
	  onfocus=${t=>{t.target.style.height=t.target.scrollHeight+"px"}}
	  onfocusout=${t=>{t.target.style.height="auto"}}
	  onkeyup=${t=>{e.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:e}}))}}
	  onkeydown=${t=>setTimeout(()=>{t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px"},100)}>`;return e.val.style.gridColumn="1 / 3",e.val.appendChild(i),i},hf=t=>{const e={input:function(i){if(!i.edit)return;if("date"===i.type||"datetime"===i.type)return e.date(i);if(i.edit.range)return e.range(i);if(i.edit.options)return e.options(i);if("textarea"===i.type||"html"===i.type)return e.textarea(i);i.val.appendChild(t.utils.wire()`
    <input type="${"numeric"===i.type||"integer"===i.type?"number":"text"}" value="${i.value||i.displayValue||""}"
      onkeyup=${t=>{i.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:i}}))}}>`)},range:sf(t),date:uf(t),options:lf(t),textarea:cf(t)};return e},df=t=>e=>(e.dependents&&e.dependents.some(t=>e.location.infoj.some(e=>!e.value&&e.field===t))&&delete e.display,e.layer=e.location.layer,e.id=e.location.id,"location"===e._target?e.target:(e._target=e.target,"location"===e.target?(e.active=!0,e.target=t.utils.wire()`
    <div
      class=${e.class}
      style="grid-column: 1 / 3; padding-top: 10px;">`,t.dataviews.create(e),e.target):document.getElementById(e.target)?(e.active=!0,e.target=document.getElementById(e.target),void t.dataviews.create(e)):t.dataviews.tabview.node?(e.tab_style=`border-bottom: 2px solid ${e.location.style.strokeColor}`,e.display&&t.dataviews.tabview.add(e),e.location.tabviews.push(e),t.utils.wire()`
    <label
      class="input-checkbox ${e.class}"
      style="grid-column: 1 / 3">
      <input
        type="checkbox"
        checked=${!!e.display}
        onchange=${i=>{if(e.display=i.target.checked,e.display)return t.dataviews.tabview.add(e);e.remove()}}>
      </input>
      <div></div><span>${e.title||"Dataview"}`):void 0)),pf=t=>({create:function(e){e.view||(e.view=t.utils.wire()`<div class="drawer location-view expandable expanded">`);e.view.classList.remove("disabled"),e.view.innerHTML="",e.view.classList.remove("disabled"),e.view.addEventListener("valChange",t=>{const e=void 0===t.detail.newValue?t.detail.input.value:t.detail.newValue;t.detail.entry.value!=e?(t.detail.entry.newValue=e,t.detail.input.classList.add("primary-colour")):(delete t.detail.entry.newValue,t.detail.input.classList.remove("primary-colour")),t.detail.entry.location.infoj.some(t=>void 0!==t.newValue)?n.style.display="inline-block":n.style.display="none"});const i=t.utils.wire()`
    <div
      class = "header"
      style = "${"border-bottom: 2px solid "+e.style.strokeColor}"
      onclick = ${e=>{e.preventDefault(),t.utils.toggleExpanderParent(e.target,!0)}}>
      <div>${String.fromCharCode(65+t.locations.list.indexOf(e.record))}`;e.view.appendChild(i),e.infoj&&i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Toggle location view drawer."
      class = "btn-header xyz-icon icon-expander "
      onclick = ${e=>{e.stopPropagation(),t.utils.toggleExpanderParent(e.target)}}>`),i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Zoom map to feature bounds"
      class = "btn-header xyz-icon icon-search"
      onclick = ${t=>{t.stopPropagation(),e.flyTo()}}>`);const n=t.utils.wire()`
    <button
      style = "${"display: none; filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Save changes to cloud."
      class = "btn-header xyz-icon icon-cloud-upload"
      onclick = ${t=>{t.stopPropagation(),e.update()}}>`;i.appendChild(n),e.layer.edit&&e.layer.edit.geometry&&i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Edit location geometry."
      class = "btn-header xyz-icon icon-build"
      onclick = ${n=>{if(n.stopPropagation(),i.classList.contains("edited"))return t.mapview.interaction.edit.finish();i.classList.add("edited","secondary-colour-bg"),t.mapview.interaction.edit.begin({location:e,type:"LineString",callback:()=>{i.classList.remove("edited","secondary-colour-bg")}})}}>`),e.layer.edit&&e.layer.edit.delete&&i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Delete location."
      class = "btn-header xyz-icon icon-trash"
      onclick = ${t=>{t.stopPropagation(),e.trash()}}>`),i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Hide marker"
      class = "btn-header xyz-icon icon-location-tick" 
      onclick = ${i=>{i.stopPropagation(),i.target.classList.contains("icon-location")?(i.target.classList.remove("icon-location"),i.target.classList.add("icon-location-tick"),t.map.addLayer(e.Marker)):(i.target.classList.remove("icon-location-tick"),i.target.classList.add("icon-location"),t.map.removeLayer(e.Marker))}}>`),i.appendChild(t.utils.wire()`
    <button
      style = "${"filter: "+e.colorFilter+"; -webkit-filter: "+e.colorFilter}"
      title = "Remove feature from selection"
      class = "btn-header xyz-icon icon-close"
      onclick = ${i=>{i.stopPropagation(),e.remove(),t.map.updateSize()}}>`),e.infoj&&e.view.appendChild(t.locations.view.infoj(e))},infoj:Jp(t),streetview:Qp(t),images:tf(t),documents:ef(t),geometry:af(t),meta:nf(t),edit:hf(t),boolean:rf(t),report:of(t),dataview:df(t)}),ff=t=>{const e={init:function(n){e.add=i,e.callbackAdd=e.callbackAdd||n.callbackAdd,e.callbackInit=e.callbackInit||n.callbackInit,e.node=e.node||n.target,e.node.innerHTML="",t.locations.list=[["#4227b0","invert(19%) sepia(57%) saturate(4245%) hue-rotate(247deg) brightness(76%) contrast(101%)"],["#2196f3","invert(60%) sepia(94%) saturate(3876%) hue-rotate(184deg) brightness(98%) contrast(94%)"],["#009688","invert(37%) sepia(46%) saturate(1993%) hue-rotate(144deg) brightness(96%) contrast(101%)"],["#cddc39","invert(84%) sepia(82%) saturate(420%) hue-rotate(6deg) brightness(88%) contrast(94%)"],["#ff9800","invert(59%) sepia(90%) saturate(1526%) hue-rotate(358deg) brightness(99%) contrast(106%)"],["#673ab7","invert(23%) sepia(26%) saturate(6371%) hue-rotate(251deg) brightness(87%) contrast(87%)"],["#03a9f4","invert(65%) sepia(61%) saturate(5963%) hue-rotate(168deg) brightness(101%) contrast(103%)"],["#4caf50","invert(65%) sepia(8%) saturate(3683%) hue-rotate(73deg) brightness(92%) contrast(69%)"],["#ffeb3b","invert(75%) sepia(76%) saturate(391%) hue-rotate(2deg) brightness(104%) contrast(109%)"],["#ff5722","invert(47%) sepia(96%) saturate(3254%) hue-rotate(346deg) brightness(100%) contrast(102%)"],["#0d47a1","invert(15%) sepia(99%) saturate(2827%) hue-rotate(213deg) brightness(87%) contrast(90%)"],["#00bcd4","invert(60%) sepia(39%) saturate(2788%) hue-rotate(144deg) brightness(93%) contrast(102%)"],["#8bc34a","invert(87%) sepia(8%) saturate(3064%) hue-rotate(35deg) brightness(85%) contrast(85%)"],["#ffc107","invert(79%) sepia(86%) saturate(3969%) hue-rotate(346deg) brightness(98%) contrast(111%)"],["#d32f2f","invert(28%) sepia(94%) saturate(3492%) hue-rotate(345deg) brightness(85%) contrast(92%)"]].map(t=>({style:{strokeColor:t[0]},colorFilter:t[1]})),e.callbackInit&&e.callbackInit()}};return e;function i(t){e.node&&(Object.values(e.node.children).forEach(t=>t.classList.remove("expanded")),e.node.insertBefore(t.view,e.node.firstChild),t.view.style.maxHeight="30px",e.callbackAdd&&e.callbackAdd())}},gf=t=>function(){this.Layer=t.mapview.geoJSON({geometry:this.geometry,zIndex:1999,style:[new t.mapview.lib.style.Style({stroke:new t.mapview.lib.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:8})}),new t.mapview.lib.style.Style({stroke:new t.mapview.lib.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:6})}),new t.mapview.lib.style.Style({stroke:new t.mapview.lib.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:4})}),new t.mapview.lib.style.Style({stroke:this.style.strokeColor&&new t.mapview.lib.style.Stroke({color:this.style.strokeColor,width:this.style.strokeWidth||1}),fill:this.style.fillColor&&new t.mapview.lib.style.Fill({color:t.utils.Chroma(this.style.fillColor).alpha(void 0===this.style.fillOpacity?1:parseFloat(this.style.fillOpacity)||0).rgba()})})],dataProjection:this.layer.srid,featureProjection:t.mapview.srid})},mf=t=>function(){t.hooks&&t.hooks.filter("locations",this.hook),t.mapview.interaction.edit.finish&&t.mapview.interaction.edit.finish(),this.view&&this.view.remove(),t.locations.listview.node&&0===t.locations.listview.node.childElementCount&&t.locations.listview.init(),this.tabviews.forEach(t=>t.remove&&t.remove()),this.geometries.forEach(e=>t.map.removeLayer(e)),this.geometryCollection.forEach(e=>t.map.removeLayer(e)),this.Layer&&t.map.removeLayer(this.Layer),this.Marker&&t.map.removeLayer(this.Marker),"function"==typeof this.removeCallback&&this.removeCallback(),this.record.location=null},vf=t=>function(){if(!t.map)return;const e=new t.mapview.lib.source.Vector;this.Layer&&e.addFeatures(this.Layer.getSource().getFeatures()),this.Marker&&e.addFeatures(this.Marker.getSource().getFeatures()),this.geometries.forEach(t=>{t.length?t.forEach(t=>e.addFeatures(t.getSource().getFeatures())):e.addFeatures(t.getSource().getFeatures())}),t.mapview.flyToBounds(e.getExtent())},yf=t=>function(e){const i=this,n={};if(i.infoj.filter(t=>void 0!==t.newValue).forEach(t=>{"integer"===t.type&&(t.newValue=isNaN(parseInt(t.newValue))?null:t.newValue),"numeric"===t.type&&(t.newValue=isNaN(parseFloat(t.newValue))?null:t.newValue),Object.assign(n,{[t.field]:t.newValue})}),!Object.keys(n).length)return;i.view&&i.view.classList.add("disabled");const o=new XMLHttpRequest;o.open("POST",t.host+"/api/location/update?"+t.utils.paramString({locale:t.workspace.locale.key,layer:i.layer.key,table:i.table,id:i.id})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=n=>{if(200!==n.target.status)return console.error(n.target.response);const o=[];if(i.infoj.filter(t=>void 0!==t.newValue).forEach(t=>{t.dependents&&t.dependents.forEach(t=>{if(i.infoj.some(e=>e.field===t))return o.push(t);i.infoj.filter(t=>"dataview"===t.type).forEach(e=>{if(e.query===t&&e.update)return e.update();e.dataviews&&e.dataviews.filter(e=>e.query===t).forEach(t=>t.update&&t.update())})}),t.value=t.newValue,delete t.newValue}),o.length>0){const n=new XMLHttpRequest;return n.open("GET",t.host+"/api/location/get?"+t.utils.paramString({locale:t.workspace.locale.key,layer:i.layer.key,table:i.table,id:i.id,fields:o.join()})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=n=>{i.infoj.filter(t=>void 0!==n.target.response[t.field]).forEach(t=>{t.value=n.target.response[t.field]}),i.view&&t.locations.view.create(i),i.layer.reload(),e&&e()},void n.send()}i.view&&t.locations.view.create(i),i.layer.reload(),e&&e()},o.send(JSON.stringify(n))},bf=t=>function(){const e=this,i=new XMLHttpRequest;i.open("GET",t.host+"/api/location/delete?"+t.utils.paramString({locale:t.workspace.locale.key,layer:e.layer.key,table:e.table,id:e.id})),i.onload=t=>{200===t.target.status&&(e.layer.reload(),e.remove())},confirm("Are you sure you want to delete this feature? This cannot be undone.")&&i.send()},wf=t=>e=>new Promise((i,n)=>{const o=new XMLHttpRequest,r=e.viewport&&t.mapview&&t.mapview.getBounds(),a=e.center&&t.mapview&&t.mapview.lib.proj.transform(t.map.getView().getCenter(),"EPSG:"+t.mapview.srid,"EPSG:4326");o.open("GET",t.host+"/api/query?"+t.utils.paramString(Object.assign({locale:t.workspace.locale.key,layer:e.layer&&e.layer.key,dbs:e.dbs,id:e.id,template:encodeURIComponent(e.query),lat:a&&a[1],lng:a&&a[0],filter:e.layer&&e.layer.filter&&JSON.stringify(e.layer.filter.current),viewport:r&&[r.west,r.south,r.east,r.north,t.mapview.srid]},e.queryparams||{}))),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=t=>{if(t.target.status>=300)return n({err:t.target.status});i(t.target.response)},o.send()}),_f=t=>{const e={init:function(i){if(!i.target)return;e.node=i.target;const n=t.utils.wire()`<div class="tab-bar">`;let o;e.bar=t.utils.wire()`<div>`,n.appendChild(e.bar),e.node.appendChild(n),e.panel=t.utils.wire()`<div class="tab-panel">`,e.node.appendChild(e.panel),e._dataviews=new Set,e.add=i=>{if(i.showTab)return e.bar.appendChild(i.tab),e.panel.appendChild(i.target),e._dataviews.add(i),i.showTab();i.showTab=()=>{e._dataviews.forEach(t=>{t.target.style.display="none",t.tab.classList.remove("active"),t.target.classList.remove("active")}),i.tab.classList.add("active"),i.target.style.display="grid",i.target.classList.add("active"),e.node.style.display="block",i.update&&i.update(),i.dataviews&&i.dataviews.forEach(t=>t.update()),t.mapview.attribution.container&&(t.mapview.attribution.container.style.bottom="65px")},i.tab=t.utils.wire()`
      <div
        style="${i.tab_style||""}"
        class="active"
        onclick=${()=>{clearTimeout(o),o=setTimeout(()=>i.showTab(),500)}}>${i.title||i.key||"Tab"}`,e.bar.appendChild(i.tab),i.target=t.utils.wire()`
        <div
          class="${i.class||""}"
          style="${i.style||""}">`,e.panel.appendChild(i.target),t.dataviews.create(i),e._dataviews.add(i),i.remove=()=>{if(i.target.remove(),i.layer&&i.layer._dataviews.delete(i),i.tab.remove(),e._dataviews.delete(i),e._dataviews.size)return Array.from(e._dataviews)[0].showTab();e.node.style.display="none",t.mapview.attribution.container&&(t.mapview.attribution.container.style.bottom="0")},i.tab.click()}}};return e},xf=t=>{return{create:e,query:wf(t),tabview:_f(t)};function e(i){if(i.target=i.target instanceof HTMLElement&&i.target||t.utils.wire()`<div class="${i.class||""}" style="${i.style||""}">`,i.dataviews)return function(i){return i.dataviews.forEach(n=>{n.active=i.active,n.tab=i.tab,n.layer=i.layer,n.id=i.id,n.target=t.utils.wire()`
        <div class="${n.class||""}" style="${n.style||""}">`,i.target.appendChild(n.target),e(n)}),i}(i);i.layer&&i.layer._dataviews.add(i),i.remove=()=>{i.target.remove(),i.layer&&i.layer._dataviews.delete(i)};const n=t.utils.wire()`<div class="toolbar">`;i.target.appendChild(n);const o=t.utils.wire()`<div>`;if(i.target.appendChild(o),i.update=()=>{(i.active||i.tab&&i.tab.classList.contains("active"))&&(i.promise=t.dataviews.query(i),i.promise.then(t=>i.setData(t)))},i.chart){i.chart.div=t.utils.wire()`<div style="position: relative;">`;const e=t.utils.wire()`<canvas>`;i.chart.height&&e.setAttribute("height",i.chart.height),i.chart.width&&e.setAttribute("width",i.chart.width),i.chart.div.appendChild(e),t.utils.Chart.defaults.global.plugins.datalabels.display=!1,i.chart.ChartJS=new t.utils.Chart(e,{type:i.chart.type||"bar",plugins:i.chart.plugins||[],options:i.chart.options||{legend:{display:!1}}}),i.chart.options&&Object.assign(i.chart.ChartJS.options,i.chart.options),i.chart.setData=t=>{i.chart.ChartJS.data={labels:"function"==typeof i.chart.labels&&i.chart.labels(t)||i.chart.labels,datasets:i.chart.datasets.map(e=>Object.assign(e,{data:e.fields&&e.fields.map(e=>t[e])||e.field&&t[e.field]||t}))}},o.appendChild(i.chart.div),i.setData=t=>{t&&(i.chart.setData(t),i.chart.ChartJS.update())}}return i.columns&&(!function e(i){i.forEach(i=>{i.customFormatter&&(i.formatter=t.utils.TabulatorFormatter[i.customFormatter]),i.columns&&e(i.columns)})}(i.columns),i.Tabulator=new t.utils.Tabulator(o,Object.assign({invalidOptionWarnings:!1,tooltipsHeader:!0,columnHeaderVertAlign:"center",layout:i.layout||"fitDataFill",height:"auto",rowFormatter:t=>{if(t.getData().backgroundcolour){t.getElement().style.backgroundColor=t.getData().backgroundcolour}},selectable:!1,rowClick:(e,n)=>{const o=n.getData();i.layer&&o.id&&(t.locations.select({locale:t.workspace.locale.key,layer:o.layer&&t.layers.list[o.layer]||i.layer,table:o.table||i.table,id:o.id}),n.deselect())}},i)),i.setData=t=>{t&&i.Tabulator.setData(t.length&&t||[t])}),!i.tab&&i.update(),i.toolbar&&i.toolbar.viewport&&n.appendChild(t.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${t=>{t.target.classList.toggle("primary-colour"),i.viewport=!i.viewport,i.update()}}>Viewport`),i.toolbar&&i.toolbar.download_csv&&n.appendChild(t.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${()=>{i.Tabulator.download("csv",`${i.title||"table"}.csv`)}}>CSV`),i.toolbar&&i.toolbar.download_json&&n.appendChild(t.utils.wire()`
    <button
      class="off-white-hover primary-colour"
      onclick=${()=>{i.Tabulator.download("json",`${i.title||"table"}.json`)}}>JSON`),i}};async function Cf(t){const e=Object.assign({version:"3.2.0",defaults:{colours:[{hex:"#c62828",name:"Fire Engine Red"},{hex:"#f50057",name:"Folly"},{hex:"#9c27b0",name:"Dark Orchid"},{hex:"#673ab7",name:"Plump Purple"},{hex:"#3f51b5",name:"Violet Blue"},{hex:"#2196f3",name:"Dodger Blue"},{hex:"#03a9f4",name:"Vivid Cerulean"},{hex:"#00bcd4",name:"Turquoise Surf"},{hex:"#009688",name:"Dark Cyan"},{hex:"#4caf50",name:"Middle Green"},{hex:"#8bc34a",name:"Dollar Bill"},{hex:"#cddc39",name:"Pear"},{hex:"#ffeb3b",name:"Banana Yellow"},{hex:"#ffb300",name:"UCLA Gold"},{hex:"#fb8c00",name:"Dark Orange"},{hex:"#f4511e",name:"Orioles Orange"},{hex:"#8d6e63",name:"Dark Chestnut"},{hex:"#777777",name:"Sonic Silver"},{hex:"#bdbdbd",name:"X11 Gray"},{hex:"#aaaaaa",name:"Dark Medium Gray"},{hex:"#78909c",name:"Light Slate Gray"}]},utils:n},t);return e.workspace=K(e),e.hooks=(t=>{if(!t.hooks)return null;const e={layers:[],locations:[]};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(t,i,n)=>{e[i]?e[i]=decodeURI(n).split(","):e[i]=decodeURI(n)}),{current:e,set:function(e){Object.assign(t.hooks.current,e),n()},remove:i,removeAll:function(){Object.keys(t.hooks.current).forEach(t=>i(t)),n()},push:function(e,i){t.hooks.current[e]?t.hooks.current[e].indexOf(i)<0&&t.hooks.current[e].push(i):t.hooks.current[e]=[i];n()},filter:function(e,i){t.hooks.current[e]=t.hooks.current[e].filter(t=>t!==i),n()}};function i(e){Array.isArray(t.hooks.current[e])?t.hooks.current[e].length=0:delete t.hooks.current[e],n()}function n(){try{history.pushState({hooks:!0},"hooks","?"+t.utils.paramString(t.hooks.current))}catch(t){console.log(t)}}})(e),e.mapview={lib:{Map:yd,View:Uh,Feature:ko,Overlay:Od,control:{defaults:hd,Zoom:cd,ScaleLine:Vd},interaction:{defaults:$c,PinchZoom:qc,PinchRotate:Vc,DragPan:dc,Draw:ph,Modify:Ch},draw:{createBox:dh,createRegularPolygon:hh},events:{click:tc},proj:{transform:Xe,transformExtent:Ue,fromLonLat:We},geom:o,format:{MVT:Co,GeoJSON:Ao},source:{OSM:ua,VectorTile:ba,Vector:za},loadingstrategy:{bbox:Ta},layer:{Tile:js,VectorTile:Iu,Vector:Hu},style:{Style:al,Fill:Qs,Stroke:tl,Circle:Js,Icon:xu,Text:Bu}}},Object.assign(e.mapview,(t=>({create:Wd(t),changeEndEvent:new CustomEvent("changeEnd"),attribution:qd(t),locate:$d(t),interaction:Qd(t),popup:Xd(t),infotip:ip(t),geoJSON:Yd(t),icon:ep(t),layer:pp(t),getBounds:tp(t),flyToBounds:(e,i={})=>{t.map.getView().fit(e,Object.assign({padding:[50,50,50,50],duration:1e3},i))},getZoom:()=>t.map.getView().getZoom()}))(e)),e.layers=(t=>({decorate:function(e){const i=Object.assign({tableCurrent:Gp(t),tableMin:Vp(),tableMax:Wp(),zoomToExtent:qp(t),show:$p(t),remove:Yp(t),count:Xp(t),bringToFront:Up(t),_dataviews:new Set},e);i.filter=Object.assign(i.filter||{},{current:{}}),i.style&&i.style.themes&&(i.style.theme=i.style.themes[Object.keys(i.style.themes)[0]]);return t.mapview.layer[e.format](i),i},list:{},view:Hp(t),listview:Bp(t)}))(e),e.locations=(t=>({select:Kp(t),selectCallback:Zp(t),list:[{style:{strokeColor:"#9c27b0"},colorFilter:"invert(22%) sepia(80%) saturate(1933%) hue-rotate(272deg) brightness(97%) contrast(104%)"}],view:pf(t),listview:ff(t),custom:{},decorate:function(e,i={}){Object.assign(e,{remove:mf(t),trash:bf(t),flyTo:vf(t),update:yf(t),draw:gf(t),geometries:[],tables:[],tabviews:[],geometryCollection:[],style:Object.assign({strokeColor:"#1F964D"},e.style||{})},i)}}))(e),e.gazetteer=(t=>{const e={init:function(i){if(!i)return;Object.assign(e,i),e.result=e.group.querySelector("ul"),e.input=e.group.querySelector("input"),e.input.placeholder=t.workspace.locale.gazetteer.placeholder||"",e.input.addEventListener("keyup",t=>{!new Set([37,38,39,40,13]).has(t.keyCode||t.charCode)&&t.target.value.length>0&&e.search(t.target.value)}),e.input.addEventListener("keydown",i=>{const n=i.keyCode||i.charCode;if(46===n||8===n)return e.xhr&&e.xhr.abort(),e.clear(),void(e.layer&&t.map.removeLayer(e.layer));if(13===n){let t=i.target.value.split(",").map(parseFloat);t[1]>-90&&t[1]<90&&t[0]>-180&&t[0]<180&&(e.xhr&&e.xhr.abort(),e.clear(),e.createFeature({type:"Point",coordinates:[t[1],t[0]]})),e.result.querySelector("li").click()}}),e.input.addEventListener("focusout",()=>{e.xhr&&e.xhr.abort(),setTimeout(e.clear,400)}),e.clear=()=>{e.group.classList.remove("active"),e.result.innerHTML=""}},search:function(i,n={}){e.clear&&e.clear(),e.xhr&&e.xhr.abort(),e.xhr=new XMLHttpRequest,e.xhr.open("GET",t.host+"/api/gazetteer?"+t.utils.paramString({locale:t.workspace.locale.key,q:encodeURIComponent(i),source:n.source})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=i=>{if(200===i.target.status)return n.callback?n.callback(i.target.response):0===i.target.response.length?(e.result.appendChild(t.utils.wire()`
        <li>No results for this search.`),e.group.classList.add("active")):void Object.values(i.target.response).forEach(i=>{e.result.appendChild(t.utils.wire()`
        <li style="cursor:pointer;" onclick=${t=>{if(t.preventDefault(),!i.source||!i.id)return e.callback?e.callback(i):void(i.marker&&e.createFeature({type:"Point",coordinates:i.marker.split(",")}));e.select({label:i.label,id:i.id,source:i.source,layer:i.layer,table:i.table,marker:i.marker,callback:n.callback})}}>
        <span>${i.label}</span>
        <span class="secondary-colour-bg" style="float: right; font-size: smaller; padding: 2px; cursor: help; border-radius: 2px;">${i.layer||i.source}`),e.group.classList.add("active")})},e.xhr.send()},sources:{glx:function(i){if(e.callback)return e.callback(i);t.locations.select({locale:t.workspace.locale.key,layer:t.layers.list[i.layer],table:i.table,id:i.id,_flyTo:!0}),i.callback&&i.callback()},mapbox:function(t){e.createFeature({type:"Point",coordinates:t.marker}),t.callback&&t.callback()},google:function(i){const n=new XMLHttpRequest;n.open("GET",`${t.host}/api/provider/google?url=maps.googleapis.com/maps/api/place/details/json?placeid=${i.id}`),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=t=>{if(200!==t.target.status||!t.target.response.result)return;let n={type:"Point",coordinates:[t.target.response.result.geometry.location.lng,t.target.response.result.geometry.location.lat]};if(e.createFeature(n),e.callback)return e.callback(n);i.callback&&i.callback(n)},n.send()},opencage:function(t){e.createFeature({type:"Point",coordinates:t.marker}),t.callback&&t.callback()}},select:function(t){e.clear&&e.clear(),e.input&&(e.input.value=t.label);e.sources[t.source](t)},createFeature:function(i){i="string"==typeof i?JSON.parse(i):i,e.layer&&t.map.removeLayer(e.layer);e.layer=t.mapview.geoJSON({geometry:i,dataProjection:"4326",style:new t.mapview.lib.style.Style({image:t.mapview.icon(e.icon)})}),t.mapview.flyToBounds(e.layer.getSource().getExtent())},icon:{type:"markerColor",colorMarker:"#64dd17",colorDot:"#33691e",anchor:[.5,1],scale:.05}};return e})(e),e.dataviews=xf(e),t.callback?e.workspace.getLocales(t.callback):(await e.workspace.fetchLocales(),e)}window._xyz=Cf;e.default=Cf},function(t,e,i){"use strict";function n(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=function t(e){var i={};return e?(Object.keys(e).forEach((function(n){var o=e[n];"object"==typeof o?null===o?i[n]=null:o.length?i[n]=o.map((function(t){return t})):i[n]=t(o):i[n]=o})),i):i}(t.properties),e.geometry=o(t.geometry),e}function o(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return o(t)})),e):(e.coordinates=function t(e){if("object"!=typeof e[0])return e.slice();return e.map((function(e){return t(e)}))}(t.coordinates),e)}i.r(e);var r=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return n(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return n(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(t);default:throw new Error("unknown GeoJSON type")}},a=i(3),s={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function l(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=s[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t*i}function u(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function c(t){return!!t&&t.constructor===Object}var h=function(t,e,i){if(!c(i=i||{}))throw new Error("options is invalid");var n=i.units,o=Object(a.a)(t),r=Object(a.a)(e),s=u(r[1]-o[1]),h=u(r[0]-o[0]),d=u(o[1]),p=u(r[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(d)*Math.cos(p);return l(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),n)},d=i(1);e.default=function(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var i,n=1/0;return Object(d.featureEach)(e,(function(e,o){var a=h(t,e);a<n&&((i=r(e)).properties.featureIndex=o,i.properties.distanceToPoint=a,n=a)})),i}},function(t,e,i){"use strict";i.r(e);var n=i(1);var o=function(t){var e=[1/0,1/0,-1/0,-1/0];return Object(n.coordEach)(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e};function r(t,e,i){if(!l(i=i||{}))throw new Error("options is invalid");var n=i.bbox,o=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&u(n),o&&c(o);var r={type:"Feature"};return o&&(r.id=o),n&&(r.bbox=n),r.properties=e||{},r.geometry=t,r}function a(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(t[0])||!s(t[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:t},e,i)}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function l(t){return!!t&&t.constructor===Object}function u(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!s(t))throw new Error("bbox must only contain numbers")}))}function c(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}e.default=function(t,e){if(!l(e=e||{}))throw new Error("options is invalid");var i=e.properties;if(!t)throw new Error("geojson is required");var n=o(t);return a([(n[0]+n[2])/2,(n[1]+n[3])/2],i)}},function(t,e,i){"use strict";i.r(e);var n=i(1);function o(t,e,i){if(!l(i=i||{}))throw new Error("options is invalid");var n=i.bbox,o=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&u(n),o&&c(o);var r={type:"Feature"};return o&&(r.id=o),n&&(r.bbox=n),r.properties=e||{},r.geometry=t,r}function r(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(t[0])||!s(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,i)}function a(t,e){if(!l(e=e||{}))throw new Error("options is invalid");var i=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");i&&u(i),n&&c(n);var o={type:"FeatureCollection"};return n&&(o.id=n),i&&(o.bbox=i),o.features=t,o}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function l(t){return!!t&&t.constructor===Object}function u(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!s(t))throw new Error("bbox must only contain numbers")}))}function c(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}e.default=function(t){var e=[];return"FeatureCollection"===t.type?Object(n.featureEach)(t,(function(t){Object(n.coordEach)(t,(function(i){e.push(r(i,t.properties))}))})):Object(n.coordEach)(t,(function(i){e.push(r(i,t.properties))})),a(e)}}]);
//# sourceMappingURL=xyz_openlayers.js.map